(this["webpackJsonpSAT-Flex"]=this["webpackJsonpSAT-Flex"]||[]).push([[0],{263:function(e,t){},280:function(e,t,a){e.exports=a(660)},297:function(e,t,a){},298:function(e,t,a){},299:function(e,t,a){},300:function(e,t,a){},301:function(e,t,a){},302:function(e,t,a){},303:function(e,t,a){},304:function(e,t,a){},306:function(e,t,a){},461:function(e,t,a){},462:function(e,t,a){},463:function(e,t,a){},464:function(e,t,a){},465:function(e,t,a){},466:function(e,t,a){},469:function(e,t){},471:function(e,t){},493:function(e,t){},495:function(e,t,a){},528:function(e,t){},530:function(e,t){},561:function(e,t){},562:function(e,t){},622:function(e,t,a){},633:function(e,t,a){},638:function(e,t){},639:function(e,t){},643:function(e,t,a){},644:function(e,t,a){},645:function(e,t,a){},646:function(e,t,a){},647:function(e,t,a){},648:function(e,t,a){},649:function(e,t,a){},650:function(e,t,a){},651:function(e,t,a){},652:function(e,t,a){},653:function(e,t,a){},654:function(e,t,a){},655:function(e,t,a){},656:function(e,t){Number.prototype.format=function(e,t,a){var o=this;e=isNaN(e=Math.abs(e))?2:e,t=void 0===t?",":t,a=void 0===a?".":a;var r=o<0?"-":"",n=String(parseInt(o=Math.abs(+o||0).toFixed(e),10)),i=n.length>3?n.length%3:0;return r+(i?n.substr(0,i)+a:"")+n.substr(i).replace(/(\d{3})(?=\d)/g,"$1"+a)+(e?t+Math.abs(o-n).toFixed(e).slice(2):"")},Number.prototype.toFloat=function(){return this},String.prototype.byteList=function(e){return e.split("").map((function(e){return e.charCodeAt(0)}))},String.prototype.cpad=function(e,t){for(var a=this,o=0;a.length<e;)o++%2===0?a+=t:a=t+a;return String(a)},String.prototype.format=function(e,t,a){return this.toFloat().format(e,t,a)},String.prototype.lpad=function(e,t){for(var a=this;a.length<e;)a=t+a;return String(a)},String.prototype.removeFormat=function(){var e=this;return[" ",".",",","-","/","\\","(",")"].forEach((function(t){e=e.replaceAll(t,"")})),e},String.prototype.removeSpecial=function(){for(var e=["\xe1","\xe0","\xe3","\xe2","\xe9","\xe8","\xea","\xed","\xec","\xee","\xf3","\xf2","\xf5","\xf4","\xfa","\xf9","\xfb","\xfc","\xe7","\xc1","\xc0","\xc3","\xc2","\xc9","\xc8","\xca","\xcd","\xcc","\xce","\xd3","\xd2","\xd5","\xd4","\xda","\xd9","\xdb","\xdc","\xc7","\xaa","\xba"],t=["a","a","a","a","e","e","e","i","i","i","o","o","o","o","u","u","u","u","c","A","A","A","A","E","E","E","I","I","I","O","O","O","O","U","U","U","U","C","a","o"],a=this,o=0;o<e.length;o++)a=a.replaceAll(e[o],t[o]);return a},String.prototype.replaceAll=function(e,t){return this.split(e).join(t)},String.prototype.rpad=function(e,t){for(var a=this;a.length<e;)a+=t;return String(a)},String.prototype.toFloat=function(){var e=this;return-1===e.indexOf(".")&&e.indexOf(",")>-1?e=e.replace(",","."):e.indexOf(".")>-1&&e.indexOf(",")>-1&&(e.indexOf(".")<e.indexOf(",")?e=e.replace(".","").replace(",","."):e.indexOf(".")>e.indexOf(",")&&(e=e.replace(",",""))),parseFloat(e)}},657:function(e,t,a){},658:function(e,t,a){},659:function(e,t,a){},660:function(e,t,a){"use strict";a.r(t);var o=a(3),r=a.n(o),n=a(10),i=a(4),s=a(5),c=a(8),l=a(7),u=a(9),d=a(0),p=a.n(d),m=a(20),h=a.n(m),f=a(26),v=a(6),b=a.n(v);window.jQuery=window.$=v;var g=a(269),E=a.n(g);window.Tether=E.a;var x=a(147);window.Popper=x.default;a(295),a(296);var C=a(2),O=(a(297),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=["icon","mif-"+this.props.name];this.props.className&&e.push(this.props.className);var t={};return this.props.onClick&&(t.cursor="pointer"),p.a.createElement("span",Object.assign({},this.props,{className:e.join(" "),style:t}))}}]),t}(p.a.Component)),k=(a(298),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return p.a.createElement("div",{id:"menu"},p.a.createElement(y,null))}}]),t}(p.a.Component)),y=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={activeItem:"Vender"},a.changeActiveItem=a.changeActiveItem.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"changeActiveItem",value:function(e){this.setState({activeItem:e})}},{key:"listItem",value:function(){return[{text:"Vender",icon:"shop",link:"/"},{text:"Cadastros",icon:"stack",link:"/produto",active:!1},{text:"Relat\xf3rios",icon:"chart-line",link:"/relatorio",active:!1},{text:"Contador",icon:"suitcase",link:"/contador",active:!1},{text:"Configura\xe7\xf5es",icon:"cogs",link:"/configuracao",active:!1},{text:"Suporte",icon:"help",link:"/suporte",active:!1},{text:"Sair",icon:"exit",active:!1,action:function(){window.MessageBox.show({title:"Sair do SAT-Flex",text:"Voc\xea tem certeza que deseja encerrar o SAT-Flex agora?",buttons:[{text:"Sim",color:"green",icon:"thumbs-up",onClick:function(){window.close()}},{text:"N\xe3o",color:"red",icon:"thumbs-down",onClick:function(){window.MessageBox.hide()}}]})}}]}},{key:"render",value:function(){var e=this;return p.a.createElement("div",{className:"menu-list"},p.a.createElement("ul",null,this.listItem().map((function(t,a){return p.a.createElement(w,{key:a,pKey:a,item:t,activeItem:e.state.activeItem,changeActiveItem:e.changeActiveItem})}))))}}]),t}(p.a.Component),w=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).onClick=a.onClick.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"onClick",value:function(){this.props.item.link&&this.props.changeActiveItem(this.props.item.text),this.props.item.action&&this.props.item.action()}},{key:"render",value:function(){var e=null;return this.props.activeItem===this.props.item.text&&(e="active"),this.props.item.link?p.a.createElement(f.b,{to:this.props.item.link,onClick:this.onClick,className:e},p.a.createElement(O,{name:this.props.item.icon}),p.a.createElement("span",null,this.props.item.text)):p.a.createElement("a",{onClick:this.onClick,className:e},p.a.createElement(O,{name:this.props.item.icon}),p.a.createElement("span",null,this.props.item.text))}}]),t}(p.a.Component),S=a(23),j=(a(299),function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(c.a)(this,Object(l.a)(t).call(this))).data={icon:null,text:null,visible:!1},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"addChangeListener",value:function(e){this.on("change",e)}},{key:"commitChange",value:function(){this.emit("change")}},{key:"getData",value:function(){return Object.assign({},this.data)}},{key:"getElement",value:function(){return void 0===this.element&&(this.element=b()("#FastMessage").get(0)),this.element}},{key:"removeChangeListener",value:function(e){this.removeListener("change",e)}},{key:"hide",value:function(){this.data.visible=!1,this.commitChange()}},{key:"show",value:function(e){"string"===typeof e&&(e={text:e}),e=b.a.extend({icon:null,text:null,visible:!0},e),this.data=b.a.extend(this.data,e),this.commitChange()}}]),t}(S.EventEmitter)),N=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).animateHide=a.animateHide.bind(Object(C.a)(a)),a.animateShow=a.animateShow.bind(Object(C.a)(a)),a.onChangeData=a.onChangeData.bind(Object(C.a)(a)),a.onDocumentClick=a.onDocumentClick.bind(Object(C.a)(a)),a.state=e.FastMessageEmitter.getData(),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"animateHide",value:function(){var e=this;if(!this.state.visible)return!0;b()(this.element).stop().animate({opacity:0,top:window.innerHeight},180,(function(){e.setState({visible:!1})}))}},{key:"animateShow",value:function(){var e=this;b()(this.element).show();var t=0,a=[{progress:0,opacity:0,top:0},{progress:.05,opacity:1,top:.3},{progress:.95,opacity:1,top:.35},{progress:1,opacity:0,top:1}];!function o(){var r=a.shift(),n=3e3*r.progress-t;t+=n,b()(e.element).stop().animate({opacity:r.opacity,top:window.innerHeight*r.top},n,(function(){a.length>0?o():e.setState({visible:!1})}))}()}},{key:"componentDidMount",value:function(){this.element=this.props.FastMessageEmitter.getElement(),this.props.FastMessageEmitter.addChangeListener(this.onChangeData),document.addEventListener("click",this.onDocumentClick)}},{key:"componentWillUnmount",value:function(){this.props.FastMessageEmitter.removeChangeListener(this.onChangeData),document.removeEventListener("click",this.onDocumentClick)}},{key:"onChangeData",value:function(){var e=this.props.FastMessageEmitter.getData();e.visible!==this.state.visible&&(e.visible?this.animateShow():this.animateHide()),this.setState(e)}},{key:"onDocumentClick",value:function(){this.state.visible&&this.animateHide()}},{key:"render",value:function(){return p.a.createElement("div",{id:"FastMessage"},this.state.icon?p.a.createElement(O,{name:this.state.icon}):null,p.a.createElement("span",null,this.state.text))}}]),t}(p.a.Component),P=a(270),D=a.n(P),A=(a(300),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=null;if(this.props.icon)if(this.props.text){var t="lg"===this.props.size?"3":"2";switch(this.props.iconPosition){default:case"left":e=[p.a.createElement(O,{name:this.props.icon,key:"0"}),p.a.createElement("span",{className:"ml-"+t,key:"1",dangerouslySetInnerHTML:{__html:this.props.text}})];break;case"right":e=[p.a.createElement("span",{className:"mr-2",key:"0",dangerouslySetInnerHTML:{__html:this.props.text}}),p.a.createElement(O,{name:this.props.icon,key:"1"})]}}else e=p.a.createElement(O,{name:this.props.icon});else e=p.a.createElement("span",{dangerouslySetInnerHTML:{__html:this.props.text}});var a=["btn","btn-primary","btn-"+this.props.size,"btn-color-"+this.props.color];return this.props.className&&a.push(this.props.className),this.props.active&&a.push("active"),this.props.block&&a.push("btn-block"),p.a.createElement("button",{className:a.join(" "),onClick:this.props.onClick,disabled:this.props.disabled},e)}}]),t}(p.a.Component));A.defaultProps={active:!1,block:!1,disabled:!1,iconPosition:"left",size:"md",color:"blue"};var T=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=["col-"+(void 0===this.props.size?1:this.props.size)];this.props.className&&e.push(this.props.className),this.props.offset&&e.push("offset-"+this.props.offset);var t=null;return this.props.labelMargin&&(t=p.a.createElement("label",null,"\xa0")),p.a.createElement("div",{className:e.join(" ")},t,this.props.children)}}]),t}(p.a.Component),R=(a(301),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.element=h.a.findDOMNode(this),b()(this.element).on("show.bs.modal",this.props.beforeOpen),b()(this.element).on("shown.bs.modal",this.props.afterOpen),b()(this.element).on("hide.bs.modal",this.props.beforeClose),b()(this.element).on("hidden.bs.modal",this.props.afterClose),b()(this.element).on("show.bs.modal",(function(){var t=1040+10*b()(".modal:visible").length;b()(e.element).css("z-index",t),setTimeout((function(){b()(".modal-backdrop").not(".modal-stack").css("z-index",t-1).addClass("modal-stack")}),0)}))}},{key:"componentWillReceiveProps",value:function(e){e.show!==this.props.show&&(e.show?b()(this.element).modal("show"):b()(this.element).modal("hide"))}},{key:"shouldComponentUpdate",value:function(e){return e.size!==this.props.size||e.title!==this.props.title||e.children!==this.props.children}},{key:"render",value:function(){return p.a.createElement("div",{id:this.props.id,className:"modal fade","data-backdrop":!!this.props.closeOnOutClick||"static"},p.a.createElement("div",{className:"modal-dialog modal-"+this.props.size},p.a.createElement("div",{className:"modal-content"},p.a.createElement("div",{className:"modal-header"},this.props.title),p.a.createElement("div",{className:"modal-body"},this.props.children))))}}]),t}(p.a.Component));R.defaultProps={closeOnOutClick:!0,id:null,size:"md",title:null};var I=R,M=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=["row"];this.props.className&&e.push(this.props.className);var t=Object.assign({},this.props);return delete t.className,p.a.createElement("div",Object.assign({},t,{className:e.join(" ")}),this.props.children)}}]),t}(p.a.Component),q=(a(302),function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(c.a)(this,Object(l.a)(t).call(this))).data={decimal:0,mask:null,money:!1,title:null,value:"",visible:!1,success:function(){},fail:function(){}},e.lastHide=(new Date).getTime(),e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"addChangeListener",value:function(e){this.on("change",e)}},{key:"commitChange",value:function(){this.emit("change")}},{key:"getData",value:function(){return Object.assign({},this.data)}},{key:"getElement",value:function(){return void 0===this.element&&(this.element=b()("#informarvalor").get(0)),this.element}},{key:"removeChangeListener",value:function(e){this.removeListener("change",e)}},{key:"hide",value:function(){this.lastHide=(new Date).getTime(),this.data.visible=!1,this.commitChange()}},{key:"show",value:function(e){var t=this;e=b.a.extend({decimal:0,mask:null,money:!1,title:"Informe o valor",value:"",visible:!0,success:function(){},fail:function(){}},e);var a=0,o=(new Date).getTime()-this.lastHide;o<750&&(a=750-o),setTimeout((function(){t.data=b.a.extend(t.data,e),t.commitChange()}),a)}}]),t}(S.EventEmitter)),L=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={decimal:0,mask:null,money:!1,title:null,value:"",visible:!1,success:function(){},fail:function(){}},a.backspace=a.backspace.bind(Object(C.a)(a)),a.beforeClose=a.beforeClose.bind(Object(C.a)(a)),a.beforeOpen=a.beforeOpen.bind(Object(C.a)(a)),a.cancelar=a.cancelar.bind(Object(C.a)(a)),a.confirmar=a.confirmar.bind(Object(C.a)(a)),a.drawButton=a.drawButton.bind(Object(C.a)(a)),a.onChangeData=a.onChangeData.bind(Object(C.a)(a)),a.pressNumber=a.pressNumber.bind(Object(C.a)(a)),a.valorKeyDown=a.valorKeyDown.bind(Object(C.a)(a)),a.valorKeyUp=a.valorKeyUp.bind(Object(C.a)(a)),a.pristine=!0,a.visible=!1,a.StringMask=D.a,a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"afterOpen",value:function(){b()("#informarvalor-valor").focus()}},{key:"backspace",value:function(){var e=b()("#informarvalor-valor").val();b()("#informarvalor-valor").val(e.substr(0,e.length-1)),this.valorKeyUp()}},{key:"beforeClose",value:function(){this.visible=!1}},{key:"beforeOpen",value:function(){this.visible=!0}},{key:"cancelar",value:function(){window.InformarValor.hide(),this.state.fail()}},{key:"confirmar",value:function(){window.InformarValor.hide();var e=b()("#informarvalor-valor").val();e="string"===typeof this.state.mask?this.maskedValue(e):(e/=Math.pow(10,this.state.decimal)).format(this.state.decimal,",","."),this.state.success(e)}},{key:"componentDidMount",value:function(){var e=this;this.props.InformarValorEmitter.addChangeListener(this.onChangeData),this.element=this.props.InformarValorEmitter.getElement(),document.addEventListener("keyup",(function(t){if(e.visible)switch(t.keyCode){case 8:return void e.backspace();case 48:return void e.pressNumber(0);case 49:return void e.pressNumber(1);case 50:return void e.pressNumber(2);case 51:return void e.pressNumber(3);case 52:return void e.pressNumber(4);case 53:return void e.pressNumber(5);case 54:return void e.pressNumber(6);case 55:return void e.pressNumber(7);case 56:return void e.pressNumber(8);case 57:return void e.pressNumber(9);case 96:return void e.pressNumber(0);case 97:return void e.pressNumber(1);case 98:return void e.pressNumber(2);case 99:return void e.pressNumber(3);case 100:return void e.pressNumber(4);case 101:return void e.pressNumber(5);case 102:return void e.pressNumber(6);case 103:return void e.pressNumber(7);case 104:return void e.pressNumber(8);case 105:return void e.pressNumber(9);default:return}}))}},{key:"componentWillUnmount",value:function(){this.props.InformarValorEmitter.removeChangeListener(this.onChangeData)}},{key:"drawButton",value:function(e,t){var a=this;return p.a.createElement(T,{size:"4",key:t},p.a.createElement(A,{text:e,block:!0,color:"blue",onClick:function(){a.pressNumber(e)}}))}},{key:"maskedValue",value:function(e){return new this.StringMask(this.state.mask).apply(e)}},{key:"onChangeData",value:function(){var e=this,t=this.props.InformarValorEmitter.getData();t.visible?b()(this.element).modal("show"):b()(this.element).modal("hide"),void 0!==t.value&&t.value.length>0&&(t.value=t.value.toFloat().format(t.decimal,"","")),this.setState(t,(function(){e.pristine=!1,b()("#informarvalor-valor").val(t.value),e.valorKeyUp(),e.pristine=!0}))}},{key:"pressNumber",value:function(e){b()("#informarvalor-valor").val(b()("#informarvalor-valor").val()+e),this.valorKeyUp()}},{key:"valorKeyDown",value:function(e){if(-1===[8,13,27,48,49,50,51,52,53,54,55,56,57].indexOf(e.keyCode))return!1;13===e.keyCode&&this.confirmar()}},{key:"valorKeyUp",value:function(){this.pristine&&(this.pristine=!1,b()("#informarvalor-valor").val(b()("#informarvalor-valor").val().substr(-1)));var e=b()("#informarvalor-valor").val();"string"===typeof this.state.mask?e=this.maskedValue(e):(0===e.length&&b()("#informarvalor-valor").val(0),e=(e/=Math.pow(10,this.state.decimal)).format(this.state.decimal,",",".")),b()("#informarvalor-display").html(e),this.verificarTamanho(),e.length>0?b()("#informarvalor-backspace").show():b()("#informarvalor-backspace").hide(),b()("#informarvalor-valor").focus()}},{key:"verificarTamanho",value:function(){b()("#informarvalor-display").text().length<10?b()("#informarvalor-display").removeClass("informarvalor-display-sm"):b()("#informarvalor-display").addClass("informarvalor-display-sm")}},{key:"render",value:function(){var e=this.state.money?"informarvalor-display-money":"";return p.a.createElement(I,{id:"informarvalor",size:"sm",title:this.state.title,afterOpen:this.afterOpen,beforeOpen:this.beforeOpen,beforeClose:this.beforeClose},p.a.createElement("input",{type:"text",id:"informarvalor-valor",readOnly:!0,onKeyDown:this.valorKeyDown,onKeyUp:this.valorKeyUp}),p.a.createElement("div",{id:"informarvalor-display-parent"},p.a.createElement("div",{id:"informarvalor-display",className:e}),p.a.createElement(O,{id:"informarvalor-backspace",name:"chevron-left",onClick:this.backspace})),p.a.createElement(M,{id:"informarvalor-keyboard"},[7,8,9,4,5,6,1,2,3].map(this.drawButton),p.a.createElement(T,{size:"4"},p.a.createElement(A,{icon:"cross",block:!0,color:"red",onClick:this.cancelar})),this.drawButton(0),p.a.createElement(T,{size:"4"},p.a.createElement(A,{icon:"checkmark",block:!0,color:"green",onClick:this.confirmar}))))}}]),t}(p.a.Component),F=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=Math.round(this.props.value)+"%",t=null;switch(this.props.color){case"green":t="bg-success";break;case"yellow":t="bg-warning";break;case"red":t="bg-danger";break;default:t="bg-primary"}var a="progress";return this.props.className&&(a+=" "+this.props.className),p.a.createElement("div",{className:a},p.a.createElement("div",{className:"progress-bar progress-bar-striped progress-bar-animated "+t,style:{width:e}},e))}}]),t}(p.a.Component),z=(a(303),function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(c.a)(this,Object(l.a)(t).call(this))).data={visible:!1,progress:null},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"addChangeListener",value:function(e){this.on("change",e)}},{key:"commitChange",value:function(){this.emit("change")}},{key:"getData",value:function(){return Object.assign({},this.data)}},{key:"getElement",value:function(){return void 0===this.element&&(this.element=b()("#Loading").get(0)),this.element}},{key:"removeChangeListener",value:function(e){this.removeListener("change",e)}},{key:"hide",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.data.visible=!1,this.commitChange();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"show",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.data.visible=!0,this.data.progress=null,this.commitChange();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"progress",value:function(){var e=Object(n.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.data.progress=t,this.commitChange();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(S.EventEmitter)),U=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).onChangeData=a.onChangeData.bind(Object(C.a)(a)),a.state=e.LoadingEmitter.getData(),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.element=this.props.LoadingEmitter.getElement(),this.props.LoadingEmitter.addChangeListener(this.onChangeData)}},{key:"componentWillUnmount",value:function(){this.props.LoadingEmitter.removeChangeListener(this.onChangeData)}},{key:"onChangeData",value:function(){var e=this.props.LoadingEmitter.getData();this.setState(e)}},{key:"render",value:function(){return this.state.visible?p.a.createElement("div",{className:"Loading"},p.a.createElement("div",{className:"Loading-Spinner"}),p.a.createElement(F,{value:this.state.progress,color:"green",className:null===this.state.progress?"d-none":null})):null}}]),t}(p.a.Component),V=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(c.a)(this,Object(l.a)(t).call(this))).data={buttons:[],focusOnClose:null,size:"md",text:null,title:null,visible:!1},e.lastHide=(new Date).getTime(),e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"addChangeListener",value:function(e){this.on("change",e)}},{key:"commitChange",value:function(){this.emit("change")}},{key:"getData",value:function(){return Object.assign({},this.data)}},{key:"getElement",value:function(){return void 0===this.element&&(this.element=b()("#__messagebox").get(0)),this.element}},{key:"removeChangeListener",value:function(e){this.removeListener("change",e)}},{key:"hide",value:function(){this.lastHide=(new Date).getTime(),this.data.visible=!1,this.commitChange()}},{key:"show",value:function(e){var t=this;e=b.a.extend({title:null,text:null,focusOnClose:null,size:"md",visible:!0,buttons:[{text:"Ok",color:"blue",icon:"thumbs-up",onClick:function(){t.hide()}}]},e);var a=0,o=(new Date).getTime()-this.lastHide;o<750&&(a=750-o),setTimeout((function(){t.data=b.a.extend(t.data,e),t.commitChange()}),a)}}]),t}(S.EventEmitter),B=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).onChangeData=a.onChangeData.bind(Object(C.a)(a)),a.state=e.MessageBoxEmitter.getData(),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.MessageBoxEmitter.addChangeListener(this.onChangeData);var e=this.props.MessageBoxEmitter.getElement();b()(e).on("shown.bs.modal",(function(){b()(e).find(".btn").first().focus()}))}},{key:"componentWillUnmount",value:function(){this.props.MessageBoxEmitter.removeChangeListener(this.onChangeData)}},{key:"onChangeData",value:function(){var e=this.props.MessageBoxEmitter.getData();if(e.visible!==this.state.visible){var t=this.props.MessageBoxEmitter.getElement();e.visible?b()(t).modal("show"):b()(t).modal("hide")}this.setState(e)}},{key:"render",value:function(){return p.a.createElement("div",{id:"__messagebox",className:"messagebox modal fade","data-backdrop":"static"},p.a.createElement("div",{className:"modal-dialog modal-"+this.state.size},p.a.createElement("div",{className:"modal-content"},p.a.createElement("div",{className:"modal-header"},p.a.createElement("h4",{className:"modal-title"},this.state.title)),p.a.createElement("div",{className:"modal-body",dangerouslySetInnerHTML:{__html:this.state.text}}),p.a.createElement("div",{className:"modal-footer"},this.state.buttons.map((function(e,t){return p.a.createElement(A,{key:t,color:e.color,text:e.text,icon:e.icon,onClick:e.onClick})}))))))}}]),t}(p.a.Component),_=window.require("fs"),$=window.require("os"),H=window.require("path"),W=window.require("child_process"),G=window.require("serial-number"),Y=window.require("electron-is-dev");function Q(){return Y?H.resolve():"C:/SAT-Flex/resources/app/"}function J(){return K().split("T")[0]}function K(){var e=6e4*(new Date).getTimezoneOffset();return new Date(Date.now()-e).toISOString()}function X(e){var t=String(e).split(".")[1];return void 0===t||0===t.length||0===parseInt(t,10)?0:3}function Z(e){var t=null;void 0===e||null===e?t="Erro n\xe3o identificado.":"string"===typeof e?t=e:(t=e.message,console.log(e.stack)),window.MessageBox.show({title:"Houve uma falha",text:t})}function ee(){return te.apply(this,arguments)}function te(){return(te=Object(n.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("win32"!==$.platform()){e.next=7;break}return"wmic diskdrive get SerialNumber",t=(t=W.execSync("wmic diskdrive get SerialNumber").toString()).trim().split(" ").splice(-1)[0].trim(),e.abrupt("return",t);case 7:return e.abrupt("return",new Promise((function(e){G((function(t,a){e(a)}))})));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(e){return new Promise((function(t){return setTimeout(t,e)}))}function oe(){return $.homedir()+"/SAT-Flex/"}function re(e){if(""===(e=e.replace(/[^\d]+/g,"")))return!1;if(14!==e.length)return!1;if("00000000000000"===e||"11111111111111"===e||"22222222222222"===e||"33333333333333"===e||"44444444444444"===e||"55555555555555"===e||"66666666666666"===e||"77777777777777"===e||"88888888888888"===e||"99999999999999"===e)return!1;for(var t=e.length-2,a=e.substring(0,t),o=e.substring(t),r=0,n=t-7,i=t;i>=1;i--)r+=a.charAt(t-i)*n--,n<2&&(n=9);var s=r%11<2?0:11-r%11;if(parseInt(s,10)!==parseInt(o.charAt(0),10))return!1;t+=1,a=e.substring(0,t),r=0,n=t-7;for(var c=t;c>=1;c--)r+=a.charAt(t-c)*n--,n<2&&(n=9);return s=r%11<2?0:11-r%11,parseInt(s,10)===parseInt(o.charAt(1),10)}function ne(e){if(""===(e=e.replace(/[^\d]+/g,"")))return!1;if(11!==e.length||"00000000000"===e||"11111111111"===e||"22222222222"===e||"33333333333"===e||"44444444444"===e||"55555555555"===e||"66666666666"===e||"77777777777"===e||"88888888888"===e||"99999999999"===e)return!1;for(var t=0,a=0;a<9;a++)t+=parseInt(e.charAt(a),10)*(10-a);var o=11-t%11;if(10!==o&&11!==o||(o=0),parseInt(o,10)!==parseInt(e.charAt(9),10))return!1;t=0;for(var r=0;r<10;r++)t+=parseInt(e.charAt(r),10)*(11-r);return 10!==(o=11-t%11)&&11!==o||(o=0),parseInt(o,10)===parseInt(e.charAt(10),10)}function ie(e,t,a,o){return se.apply(this,arguments)}function se(){return(se=Object(n.a)(r.a.mark((function e(t,a,o,n){var i,s,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.query("SELECT valor FROM parametro WHERE grupo = $1 AND nome = $2",[a,o]);case 2:if(i=e.sent,0!==(s=i.rows).length){e.next=7;break}return window.MessageBox.show({title:"Banco de dados desatualizado",text:"Seu banco de dados est\xe1 desatualizado para trabalhar com o aplicativo atual.<br>Atualize o banco de dados para continuar."}),e.abrupt("return",!1);case 7:return c=s[0].valor,"function"===typeof n&&n(c),e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e,t){var a=oe();_.existsSync(a)||_.mkdirSync(a);var o=a+e,r=void 0;return".zip"===e.substr(-4)&&(r="binary"),_.writeFileSync(o,t,r),o}var le=function(){function e(t){Object(i.a)(this,e),this.Pool=t,this.cnpj=null,this.serialNumber=null}return Object(s.a)(e,[{key:"api",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=s.length>1&&void 0!==s[1]?s[1]:{},o=s.length>2&&void 0!==s[2]?s[2]:function(){},n=s.length>3&&void 0!==s[3]?s[3]:function(){},i="http://server.satflex.com.br/serv/terminal/"+t+".php",b.a.ajax({url:i,type:"POST",data:JSON.stringify(a),success:function(e){o(JSON.parse(e))},error:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"atualizarRequisicao",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a,o){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarDados();case 2:n=null,e.t0=t.status,e.next="0"===e.t0?6:"1"===e.t0?8:"2"===e.t0?8:10;break;case 6:return n="1",e.abrupt("break",11);case 8:return n="2",e.abrupt("break",11);case 10:return e.abrupt("break",11);case 11:this.api("atualizar_requisicao",{numeroserie:this.serialNumber,cnpj:this.cnpj,requisicao:{idrequisicao:t.referencia,status:n,resposta:t.resposta}},(function(e){switch(e.status){case"0":a();break;case"2":o(e.message)}}),(function(){o("Houve uma falha na conex\xe3o com o servidor.")}));case 12:case"end":return e.stop()}}),e,this)})));return function(t,a,o){return e.apply(this,arguments)}}()},{key:"carregarDados",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.cnpj&&this.serialnumber){e.next=7;break}return e.next=3,ie(this.Pool,"EMITENTE","CNPJ");case 3:return this.cnpj=e.sent,e.next=6,ee();case 6:this.serialNumber=e.sent;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"verificarRequisicao",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarDados();case 2:this.api("verificar_requisicao",{numeroserie:this.serialNumber,cnpj:this.cnpj},(function(e){switch(e.status){case"0":t(e.requisicao);break;case"2":a(e.message)}}),(function(){a("Houve uma falha na conex\xe3o com o servidor.")}));case 3:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"verificarTerminal",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(){var e=Object(n.a)(r.a.mark((function e(a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.carregarDados();case 2:t.api("verificar_terminal",{numeroserie:t.serialNumber,cnpj:t.cnpj},(function(e){switch(e.status){case"0":a(e.terminal.status);break;case"2":a(!1)}}),(function(){a(!1)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),ue=a(43),de=window.require("pg");function pe(){return new de.Pool({user:"postgres",host:"127.0.0.1",database:"satflex",password:"postgres",port:5432})}a(304);var me=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return p.a.createElement("div",Object.assign({id:"content"},this.props),this.props.children)}}]),t}(p.a.Component),he=(a(305),a(306),function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).calcBlankSpace=a.calcBlankSpace.bind(Object(C.a)(a)),a.elementScroll=a.elementScroll.bind(Object(C.a)(a)),a.onClickHeadCell=a.onClickHeadCell.bind(Object(C.a)(a)),a.onScroll=a.onScroll.bind(Object(C.a)(a)),a.updateBlankSpace=a.updateBlankSpace.bind(Object(C.a)(a)),a.updateReceivedProps=a.updateReceivedProps.bind(Object(C.a)(a));var o=a.updateReceivedProps(e.header,e.data);return a.state={data:o.data,header:o.header,limit:100,offset:0,blankSpace:{bottom:0,top:0}},a.scrollActive=!0,a.longScroll=!1,a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.elementScroll().addEventListener("scroll",this.onScroll),this.element=h.a.findDOMNode(this),window.grid=this.element}},{key:"componentWillUnmount",value:function(){this.elementScroll().removeEventListener("scroll",this.onScroll)}},{key:"componentDidUpdate",value:function(){if(this.referenceElement&&!this.longScroll){var e=this.elementScroll(),t=b()(this.referenceElement.element).position().top;this.scrollActive=!1;var a=b()(e).scrollTop()-(t-this.referenceElement.top);a>this.element.scrollHeight&&(a=this.element.scrollHeight),b()(e).scrollTop(a),this.scrollActive=!0}!0!==this.firstUpdateBlankSpace&&(this.firstUpdateBlankSpace=!0,this.updateBlankSpace()),b()(this.element).children("table").floatThead(),b()(this.element).children("table").floatThead("reflow")}},{key:"componentWillUpdate",value:function(){var e=b()(this.element).children("table"),t=b()(e).children("tbody").children(),a=b()(t).eq(Math.floor(.5*this.state.limit));b()(a).length>0&&(this.referenceElement={element:a,top:b()(a).position().top})}},{key:"componentWillReceiveProps",value:function(e){e=this.updateReceivedProps(e.header,e.data),this.setState({header:e.header,data:e.data}),this.firstUpdateBlankSpace=!1}},{key:"elementIsVisibleByScroll",value:function(e,t){if(!b()(this.element).is(":visible"))return!1;t=void 0===t?window:t;var a=b()(t).scrollTop(),o=a+b()(t).height(),r=t===window?b()(e).offset().top:b()(e).position().top,n=r+b()(e).height();return r<a&&n>a||(r>a&&n<o||r<o&&n>o)}},{key:"elementScroll",value:function(){return void 0===this.props.height?window:h.a.findDOMNode(this)}},{key:"onClickHeadCell",value:function(e){var t=b()(e.target).attr("cellkey"),a=null,o=null,r=null,n=this.state.header;for(var i in n)(a=n[i]).key===t?(o=i,r=1===a.order?-1:1,a.order=r):a.order=0,n[i]=a;var s=this.state.data;s.sort((function(e,t){return e.data[o].text<t.data[o].text?1===r?-1:1:e.data[o].text>t.data[o].text?1===r?1:-1:0})),this.setState({header:n,data:s})}},{key:"onScroll",value:function(){if(!this.scrollActive)return!0;if(!b()(this.element).is(":visible"))return!0;var e=this.elementScroll();if(!(void 0===this.currentScroll||Math.abs(this.currentScroll-b()(e).scrollTop())>50))return!0;this.currentScroll=b()(e).scrollTop();var t=this.element,a=b()(t).children("table"),o=b()(a).children("thead"),r=b()(a).children("tbody").children(),n=b()(r).first(),i=b()(r).last(),s=b()(n).next(),c=b()(i).prev(),l=b()(r).eq(Math.floor(.2*this.state.limit)),u=b()(r).eq(Math.floor(.8*this.state.limit)),d=-1*(b()(o).position().top-b()(e).scrollTop());d<0&&(d=0);var p=this.state.limit,m=this.state.offset,h=this.state.data.length;if(this.longScroll=!1,m>0&&(this.elementIsVisibleByScroll(s,e)||this.elementIsVisibleByScroll(l,e)))(m-=Math.floor(p/2))<0&&(m=0);else if(m+p<h&&(this.elementIsVisibleByScroll(c,e)||this.elementIsVisibleByScroll(u,e)))m+=Math.floor(p/2);else if((this.elementIsVisibleByScroll(n,e)||this.elementIsVisibleByScroll(i,e))&&!this.elementIsVisibleByScroll(s,e)&&!this.elementIsVisibleByScroll(c,e)){var f=null;f=e===window?(b()(e).scrollTop()-b()(t).offset().top)/b()(t).height():b()(e).scrollTop()/b()(a).height(),m=Math.round(this.state.data.length*f),this.longScroll=!0}if(m>h-p&&(m=h-p),m<0&&(m=0),m!==this.state.offset){var v=this.calcBlankSpace(m);void 0===this.initialBlankSpace&&(this.initialBlankSpace=v,this.initialBlankSpace.height=v.top+v.bottom),this.setState({offset:m,blankSpace:v})}}},{key:"calcBlankSpace",value:function(e){e=void 0===e?this.state.offset:e;var t=this.state.data,a=this.state.limit,o=b()(this.element).children(".table"),r=b()(o).children("tbody").children(),n=b()(r).first(),i=b()(n).next(),s=b()(i).height()-5,c=e*s,l=(t.length-e-a)*s;if(this.longScroll&&void 0!==this.initialBlankSpace){var u=this.elementScroll(),d=b()(r).not(":first, :last").map((function(){return b()(this).height()})).get().reduce((function(e,t){return e+t}),0);c=b()(u).scrollTop()-10*s,l=b()(o).height()-d-c,c>this.initialBlankSpace.height&&(c=this.initialBlankSpace.height),l>this.initialBlankSpace.height&&(l=this.initialBlankSpace.height)}return c<0&&(c=0),l<0&&(l=0),{top:c,bottom:l}}},{key:"updateBlankSpace",value:function(){this.setState({blankSpace:this.calcBlankSpace()})}},{key:"updateReceivedProps",value:function(e,t){for(var a in e=void 0===e?this.state.header:e,t=void 0===t?this.state.data:t,e){var o=e[a];"string"===typeof o&&(o={text:o}),o=b.a.extend({align:"left",key:a,order:0,text:""},o),e[a]=o}var r=0;for(var n in t){var i=t[n];for(var s in b.a.isArray(i)&&(i={data:i}),t[n]=i,t[n].data){var c=t[n].data[s];"string"===typeof c&&(c={text:c}),c=b.a.extend({align:"left",key:r++,text:"",width:null},c),t[n].data[s]=c}}return{header:e,data:t}}},{key:"render",value:function(){var e=this.state.data.slice(this.state.offset,this.state.offset+this.state.limit);return p.a.createElement("div",{className:"DataGrid",style:{height:this.props.height}},p.a.createElement("table",{className:"DataGridTable table table-striped table-hover "+this.props.className},p.a.createElement(ge,{header:this.state.header,onClickHeadCell:this.onClickHeadCell}),p.a.createElement(fe,{data:e,blankSpace:this.state.blankSpace})))}}]),t}(p.a.Component)),fe=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return p.a.createElement("tbody",null,p.a.createElement(xe,{height:this.props.blankSpace.top}),this.props.data.map((function(e,t){return p.a.createElement(be,{row:e,key:t})})),p.a.createElement(xe,{height:this.props.blankSpace.bottom}))}}]),t}(p.a.Component),ve=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return p.a.createElement("td",{className:"text-"+this.props.cell.align,onClick:this.props.cell.onClick,style:{width:this.props.cell.width}},this.props.cell.text)}}]),t}(p.a.Component),be=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return p.a.createElement("tr",{onClick:this.props.row.onClick},this.props.row.data.map((function(e,t){return p.a.createElement(ve,{cell:e,key:t})})))}}]),t}(p.a.Component),ge=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return p.a.createElement("thead",null,p.a.createElement("tr",null,this.props.header.map((function(t,a){return p.a.createElement(Ee,{cell:t,onClick:e.props.onClickHeadCell,key:a})}))))}}]),t}(p.a.Component),Ee=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return p.a.createElement("th",{className:"text-"+this.props.cell.align+" DataGridHeadCellOrder-"+this.props.cell.order,onClick:this.props.onClick,cellkey:this.props.cell.key},this.props.cell.text)}}]),t}(p.a.Component),xe=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=void 0===this.props.height?0:this.props.height;return p.a.createElement("tr",null,p.a.createElement("td",{style:{border:0,height:e,padding:0}}))}}]),t}(p.a.Component),Ce=a(271),Oe=(a(461),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={picker:!1,value:e.value},a.onChange=a.onChange.bind(Object(C.a)(a)),a.onClick=a.onClick.bind(Object(C.a)(a)),a.onDocumentClick=a.onDocumentClick.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({value:e.value})}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.onDocumentClick),this.element=h.a.findDOMNode(this)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onDocumentClick)}},{key:"onChange",value:function(e,t){var a=this;t.persist(),this.setState({picker:!1,value:e.hex},(function(){if(a.props.onChange){var e=b()(t.target).parents("[class*='-picker']").first().prev().get(0);t.target=e,a.props.onChange(t)}}))}},{key:"onClick",value:function(e){this.setState({picker:!0}),e.preventDefault()}},{key:"onDocumentClick",value:function(e){if(this.state.picker){var t=!1;b()(this.element).find("*").each((function(a,o){e.target===o&&(t=!0)})),t||this.setState({picker:!1})}}},{key:"render",value:function(){var e=Object.assign({},this.props);return delete e.value,p.a.createElement("div",null,p.a.createElement("input",Object.assign({},e,{value:this.state.value,onClick:this.onClick})),p.a.createElement(Ce.SwatchesPicker,{value:this.state.value,onChange:this.onChange,className:this.state.picker?null:"d-none"}))}}]),t}(p.a.Component)),ke=a(272),ye=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={options:void 0===e.options?[]:e.options,value:void 0===e.value?"":e.value},a.getDBOptions=a.getDBOptions.bind(Object(C.a)(a)),a.onChange=a.onChange.bind(Object(C.a)(a)),a.verifyComponentId=a.verifyComponentId.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.element=h.a.findDOMNode(this),this.verifyComponentId(),this.getDBOptions()}},{key:"componentWillReceiveProps",value:function(e){this.getDBOptions(e),e.value!==this.props.value&&this.setState({value:e.value})}},{key:"getDBOptions",value:function(e){var t=this;if(void 0===(e=void 0===e?this.props:e).dbtable)return!0;var a=e.dbtable,o=e.dbcolumn,r=e.dbfilter,n=e.dbparent;if(void 0===o&&(o="descricao"),void 0===r&&void 0!==n){var i=document.getElementById(n);r="id"+b()(i).attr("dbtable")+"="+b()(i).val()}null!==this.ajaxDBOptions&&void 0!==this.ajaxDBOptions&&(this.ajaxDBOptions.abort(),this.ajaxDBOptions=null);var s="SELECT id"+a+", "+o+" FROM "+a+" ORDER BY 2";this.props.Pool.query({text:s,rowMode:"array"},(function(e,a){if(e)return Z(e.message),!1;var o=[];for(var r in a.rows){var n=a.rows[r];o.push({value:n[0],label:n[1]})}t.state.options!==o&&t.setState({options:o})}))}},{key:"onChange",value:function(e){var t=e?e.value:null;if(this.setState({value:t}),this.props.onChange){var a={target:{id:this.props.id,value:t}};this.props.onChange(a)}}},{key:"verifyComponentId",value:function(){if(this.props.id){var e=b()("[name='"+this.props.id+"']");e.length>0&&e.attr("id",b()(e).attr("name"))}}},{key:"render",value:function(){var e=this.state.options;if(!Array.isArray(e)){var t=[];for(var a in e)t.push({value:a,label:e[a]});e=t}return Array.isArray(e)||(e=[]),p.a.createElement(ke.a,{clearable:!1,disabled:this.props.disabled,id:this.props.id,name:this.props.id,onChange:this.onChange,onInputChange:this.verifyComponentId,options:e,placeholder:"",searchable:!1,value:this.state.value?this.state.value:this.props.defaultValue})}}]),t}(p.a.Component),we=(a(462),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).onFocus=a.onFocus.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.element=h.a.findDOMNode(this)}},{key:"onFocus",value:function(){var e=this;if(this.props.InformarValor){var t=this.props.InformarValor;void 0===t.success&&(t.success=function(t){if(b()(e.element).val(t),e.props.onChange){var a={target:{id:e.props.id,value:t}};e.props.onChange(a)}}),window.InformarValor.show(t)}}},{key:"render",value:function(){var e=Object.assign({},this.props);delete e.InformarValor;var t=e.value;null===t&&(t=""),void 0===t&&e.id&&"modal"===e.id.substr(0,5)&&(t="");var a=e.className?e.className.split(" "):[];switch(a.push("form-control"),e.size&&a.push("form-control-"+e.size),"date"===e.type&&a.push("text-center"),e.className=a.join(" "),e.value=t,void 0===this.props.onFocus&&(e.onFocus=this.onFocus),e.type){case"checkbox":return p.a.createElement("div",{className:"form-check"},p.a.createElement("input",{type:"checkbox",id:this.props.id,className:"form-check-input",checked:"S"===t,defaultValue:this.props.defaultValue,disabled:this.props.disabled,onChange:this.props.onChange,onClick:this.props.onClick}),p.a.createElement("label",{className:"form-check-label",htmlFor:this.props.id},this.props.label));case"color":return p.a.createElement(Oe,e);case"select":return delete e.type,p.a.createElement(ye,e);case"textarea":return delete e.type,p.a.createElement("textarea",e);default:return p.a.createElement("input",e)}}}]),t}(p.a.Component)),Se=a(101),je=(a(463),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return p.a.createElement("label",this.props,this.props.children)}}]),t}(p.a.Component)),Ne=(a(464),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=Object.assign({},this.props),t=["form-group"];return e.className&&t.push(e.className),e.warning&&(t.push("form-group-warning"),delete e.warning),e.InformarValor&&void 0===e.InformarValor.title&&(e.InformarValor.title=this.props.label),e.className=e.inputClassName,delete e.inputClassName,p.a.createElement("div",{className:t.join(" ")},["checkbox"].indexOf(this.props.type)>-1?null:p.a.createElement(je,{htmlFor:this.props.id},this.props.label),p.a.createElement(we,e))}}]),t}(p.a.Component)),Pe=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return p.a.createElement("hr",this.props)}}]),t}(p.a.Component),De=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={show:a.props.show,showDiv:"principal",title:null},a.cancelar=a.cancelar.bind(Object(C.a)(a)),a.changeDiv=a.changeDiv.bind(Object(C.a)(a)),a.changeTitle=a.changeTitle.bind(Object(C.a)(a)),a.excluir=a.excluir.bind(Object(C.a)(a)),a.gravar=a.gravar.bind(Object(C.a)(a)),a.limpar=a.limpar.bind(Object(C.a)(a)),a.onChangeNcm=a.onChangeNcm.bind(Object(C.a)(a)),a.onChangeInput=a.onChangeInput.bind(Object(C.a)(a)),a.onChangeSincTributacao=a.onChangeSincTributacao.bind(Object(C.a)(a)),a.sincronizarTributacao=a.sincronizarTributacao.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"carregar",value:function(e,t){var a=this,o=["SELECT categoria.descricao, categoria.dthrcriacao, categoria.cor,","  categoria.sinctributacao, ncm.codigoncm, categoria.origem,","  categoria.cfop, categoria.csosn, categoria.aliqicms, ","  categoria.cstpis, categoria.aliqpis, categoria.cstcofins, ","  categoria.aliqcofins, categoria.codcontribsocial, categoria.cest","FROM categoria","LEFT JOIN ncm USING (idncm)","WHERE categoria.idcategoria = $1"].join(" ");this.props.Pool.query(o,[e],(function(e,o){if(e)return Z(e.message),!1;if(0===o.rows.length)return window.MessageBox.show({title:"Categoria n\xe3o encontrada",text:"A categoria selecionada n\xe3o p\xf4de ser encontrada."}),!1;var r={},n=o.rows[0];for(var i in n){var s=n[i];switch(i){case"dthrcriacao":s=s.toLocaleString();break;case"aliqicms":case"aliqpis":case"aliqcofins":s=s.format(2,",",".")}r["input_"+i]=s}a.setState(r),"function"===typeof t&&t()}))}},{key:"changeDiv",value:function(e){this.setState({showDiv:e})}},{key:"changeTitle",value:function(e){var t=this;e.idcategoria?e.Pool.query("SELECT descricao FROM categoria WHERE idcategoria = $1",[e.idcategoria],(function(e,a){if(e)return Z(e.message),!1;t.setState({title:"Alterando categoria: "+a.rows[0].descricao})})):this.setState({title:"Criando nova categoria"})}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(!e.show)return!1;this.changeTitle(e);var a=function(){t.setState({show:e.show})};e.idcategoria?this.carregar(e.idcategoria,a):(this.limpar(),a())}},{key:"excluir",value:function(){var e=this;window.MessageBox.show({title:"Exclu\xedr categoria",text:"Tem certeza que deseja exclu\xedr a categoria <b>"+this.state.input_descricao+"</b>?",buttons:[{text:"Sim",icon:"thumbs-up",color:"green",onClick:function(){window.MessageBox.hide(),e.props.Pool.query("DELETE FROM categoria WHERE idcategoria = $1",[e.props.idcategoria],(function(t,a){if(t)return Z(t.message),!1;e.setState({show:!1}),window.FastMessage.show("Categoria exclu\xedda com sucesso.")}))}},{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:function(){window.MessageBox.hide()}}]})}},{key:"gravar",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,l,u,d,p,m,h=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=null,a=[],o=[],e.t0=r.a.keys(this.state);case 4:if((e.t1=e.t0()).done){e.next=37;break}if("input_"!==(n=e.t1.value).substr(0,6)){e.next=35;break}if(i=n.replace("input_",""),s=this.state[n],"codigoncm"!==i||!s){e.next=25;break}return e.prev=10,e.next=13,this.props.Pool.query("SELECT idncm FROM ncm WHERE codigoncm = $1",[s]);case 13:if(0!==(c=e.sent).rows.length){e.next=17;break}return window.MessageBox.show({title:"NCM inexistente",text:"O c\xf3digo de NCM "+s+" n\xe3o p\xf4de ser encontrado.<br>Verifique se foi informado corretamente."}),e.abrupt("return",!1);case 17:i="idncm",s=c.rows[0].idncm,e.next=25;break;case 21:return e.prev=21,e.t2=e.catch(10),Z(e.t2.message),e.abrupt("return",!1);case 25:if(!(["idcategoria","dthrcriacao"].indexOf(i)>-1)){e.next=27;break}return e.abrupt("continue",4);case 27:e.t3=i,e.next="aliqicms"===e.t3?30:"aliqpis"===e.t3?30:"aliqcofins"===e.t3?30:32;break;case 30:return s&&(s=s.toFloat()),e.abrupt("break",33);case 32:return e.abrupt("break",33);case 33:a.push(i),o.push(s);case 35:e.next=4;break;case 37:if(this.props.idcategoria){for(d in l=1,u=[],a)u.push(a[d]+" = $"+l++);t="UPDATE categoria SET "+u.join(", ")+" WHERE idcategoria = "+this.props.idcategoria}else{for(p=[],m=0;m<a.length;m++)p.push("$"+(m+1));t="INSERT INTO categoria ("+a.join(", ")+") VALUES ("+p.join(", ")+")"}this.props.Pool.query(t,o,(function(e,t){if(e)return Z(e.message),!1;h.setState({show:!1}),window.FastMessage.show("Categoria gravada com sucesso.")}));case 39:case"end":return e.stop()}}),e,this,[[10,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"limpar",value:function(){var e={};for(var t in this.state)"input_"===t.substr(0,6)&&(e[t]=null);this.setState(e)}},{key:"onChangeInput",value:function(e,t){var a=e.target,o=a.id.replace("modalcategoria-",""),r=a.value;"checkbox"===a.type&&(r=a.checked?"S":"N"),this.setState(Object(Se.a)({},"input_"+o,r),t)}},{key:"onChangeNcm",value:function(e){var t=this;this.onChangeInput(e,(function(){t.sincronizarTributacao()}))}},{key:"onChangeSincTributacao",value:function(e){var t=this;this.onChangeInput(e,(function(){t.sincronizarTributacao()}))}},{key:"sincronizarTributacao",value:function(){var e=this;if("S"!==this.state.input_sinctributacao)return!0;var t=["SELECT origem, cfop, csosn, aliqicms, cstpis, aliqpis, ","  cstcofins, aliqcofins, codcontribsocial, cest","FROM ncm","WHERE codigoncm = $1"].join(" ");this.props.Pool.query(t,[this.state.input_codigoncm],(function(t,a){if(t)return Z(t.message),!1;if(0===a.rows.length)return window.MessageBox.show({title:"NCM n\xe3o encontrado",text:"O NCM informado na categoria n\xe3o p\xf4de ser encontrado."}),!1;var o={},r=a.rows[0];for(var n in r){var i=r[n];switch(n){case"aliqicms":case"aliqpis":case"aliqcofins":i=i.format(2,",",".")}o["input_"+n]=i}e.setState(o)}))}},{key:"shouldComponentUpdate",value:function(e){return e.show}},{key:"render",value:function(){return p.a.createElement(I,{title:this.state.title,size:"lg",show:this.state.show,beforeClose:this.props.beforeClose,afterClose:this.props.afterClose,closeOnOutClick:!1},p.a.createElement(M,null,p.a.createElement(Ne,{type:"text",id:"modalcategoria-descricao",className:"col-5",label:"Descri\xe7\xe3o",value:this.state.input_descricao,onChange:this.onChangeInput}),p.a.createElement(Ne,{type:"color",id:"modalcategoria-cor",className:"col-3",label:"Cor representativa",value:this.state.input_cor,onChange:this.onChangeInput}),p.a.createElement(Ne,{type:"text",id:"modalcategoria-dthrcriacao",className:"col-4",label:"Criado em",readOnly:!0,value:this.state.input_dthrcriacao,onChange:this.onChangeInput,disabled:!0}),p.a.createElement(Ne,{type:"text",id:"modalcategoria-codigoncm",label:"NCM da categoria",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"9999.99.99"},value:this.state.input_codigoncm,onChange:this.onChangeNcm}),p.a.createElement(Ne,{type:"checkbox",id:"modalcategoria-sinctributacao",label:"Usar as mesmas tributa\xe7\xf5es da categoria",className:"col-9",value:this.state.input_sinctributacao,onChange:this.onChangeSincTributacao}),p.a.createElement(Ne,{type:"select",id:"modalcategoria-origem",className:"col-6",label:"Origem do categoria",options:{0:"0 - Nacional, exceto as indicadas nos c\xf3digos 3, 4, 5 e 8",1:"1 - Estrangeira - Importa\xe7\xe3o direta, exceto a indicada no c\xf3digo 6",2:"2 - Estrangeira - Adquirida no mercado interno, exceto a indicada no c\xf3digo 7",3:"3 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o superior a 40% e inferior ou igual a 70%",4:"4 - Nacional, cuja produ\xe7\xe3o tenha sido feita em conformidade com os processos produtivos b\xe1sicos de que tratam o Decreto-Lei n\xba 288/67, e as Leis n\xbas 8.248/91, 8.387/91, 10.176/01 e 11.484/ 07",5:"5 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o inferior ou igual a 40%",6:"6 - Estrangeira - Importa\xe7\xe3o direta, sem similar nacional, constante em lista da Resolu\xe7\xe3o CAMEX n\xba 79/2012 e g\xe1s natural",7:"7 - Estrangeira - Adquirida no mercado interno, sem similar nacional, constante em lista da Resolu\xe7\xe3o CAMEX n\xba 79/2012 e g\xe1s natural",8:"8 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o superior a 70%"},value:this.state.input_origem,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalcategoria-cfop",label:"CFOP",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"9.999"},value:this.state.input_cfop,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"select",id:"modalcategoria-csosn",className:"col-3",inputClassName:"text-center",label:"CSOSN",options:{102:"102",300:"300",400:"400",500:"500"},value:this.state.input_csosn,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalcategoria-aliqicms",label:"Al\xedquota de ICMS",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqicms,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalcategoria-cstpis",label:"CST do PIS",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_cstpis,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalcategoria-aliqpis",label:"Al\xedquota de PIS",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqpis,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalcategoria-cstcofins",label:"CST do Cofins",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_cstcofins,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalcategoria-aliqcofins",label:"Al\xedquota de Cofins",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqcofins,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalcategoria-codcontribsocial",label:"Contribui\xe7\xe3o social",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_codcontribsocial,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalcategoria-cest",label:"CEST",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99.999.99"},value:this.state.input_cest,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao})),p.a.createElement(Pe,{className:"mt-0"}),p.a.createElement(M,null,p.a.createElement(T,{size:"6"},p.a.createElement(A,{text:"Exclu\xedr",icon:"bin",color:"red",onClick:this.excluir,className:this.props.idcategoria?"":"d-none"})),p.a.createElement(T,{size:"6",className:"text-right"},p.a.createElement(A,{text:"Cancelar",icon:"undo",color:"red",onClick:this.cancelar}),p.a.createElement(A,{text:"Gravar categoria",icon:"thumbs-up",color:"green",className:"ml-2",onClick:this.gravar}))))}}]),t}(p.a.Component),Ae=(a(465),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=void 0!==this.props.text?this.props.text:this.props.children,t=void 0!==this.props.model?this.props.model:1;return p.a.createElement("h1",{className:"title-model-"+t},e)}}]),t}(p.a.Component)),Te=(a(466),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={dataGrid:[],pesquisa:"",idcategoria:null,showModalCategoria:!1,redirectToProduto:!1},a.beforeCloseModal=a.beforeCloseModal.bind(Object(C.a)(a)),a.loadDataGrid=a.loadDataGrid.bind(Object(C.a)(a)),a.novaCategoria=a.novaCategoria.bind(Object(C.a)(a)),a.onChangePesquisa=a.onChangePesquisa.bind(Object(C.a)(a)),a.onClickBtnProduto=a.onClickBtnProduto.bind(Object(C.a)(a)),a.onKeyUpPesquisa=a.onKeyUpPesquisa.bind(Object(C.a)(a)),a.pesquisaLimpar=a.pesquisaLimpar.bind(Object(C.a)(a)),a.Pool=new pe,a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"beforeCloseModal",value:function(){var e=this;this.setState({showModalCategoria:!1},(function(){e.loadDataGrid()}))}},{key:"carregarCategoria",value:function(e){this.setState({showModalCategoria:!0,idcategoria:e})}},{key:"componentDidMount",value:function(){this.loadDataGrid()}},{key:"componentWillUnmount",value:function(){this.Pool.end()}},{key:"loadDataGrid",value:function(){var e=this,t=["SELECT categoria.idcategoria, categoria.descricao, ","  ncm.codigoncm AS codigoncm, categoria.dthrcriacao,","  (SELECT COUNT(idproduto) FROM produto WHERE idcategoria = categoria.idcategoria) AS produtos","FROM categoria","LEFT JOIN ncm USING (idncm)","WHERE categoria.descricao ILIKE '%'||$1||'%'","ORDER BY categoria.descricao"].join(" ");this.Pool.query(t,[this.state.pesquisa],(function(t,a){if(t)return Z(t.message),!1;var o=[],r=function(t){var r=a.rows[t];o.push({data:[{text:r.descricao,align:"left"},{text:r.codigoncm,align:"center"},{text:r.produtos,align:"center"},{text:r.dthrcriacao.toLocaleString(),align:"center"}],onClick:function(){e.carregarCategoria(r.idcategoria)}})};for(var n in a.rows)r(n);e.setState({dataGrid:o})}))}},{key:"novaCategoria",value:function(){this.setState({showModalCategoria:!0,idcategoria:null})}},{key:"onChangePesquisa",value:function(e){this.setState({pesquisa:e.target.value})}},{key:"onClickBtnProduto",value:function(){this.setState({redirectToProduto:!0})}},{key:"onKeyUpPesquisa",value:function(e){13===e.keyCode&&this.loadDataGrid()}},{key:"pesquisaLimpar",value:function(){var e=this;this.setState({pesquisa:""},(function(){e.loadDataGrid()}))}},{key:"render",value:function(){if(this.state.redirectToProduto)return p.a.createElement(ue.a,{to:"/produto"});return p.a.createElement(me,null,p.a.createElement(Ae,{model:"2"},"Cadastro de ",p.a.createElement("b",null,"Categorias")),p.a.createElement(M,{className:"mb-4"},p.a.createElement(T,{size:"4"},p.a.createElement(we,{type:"search",id:"pesquisa",value:this.state.pesquisa,placeholder:"Pesquise uma categoria...",onKeyUp:this.onKeyUpPesquisa,onChange:this.onChangePesquisa}),p.a.createElement(O,{name:"cross",id:"pesquisa-limpar",onClick:this.pesquisaLimpar,className:this.state.pesquisa.length>0?null:"d-none"})),p.a.createElement(T,{size:"2",className:"pl-0"},p.a.createElement(A,{text:"Buscar",icon:"search",color:"green",onClick:this.loadDataGrid})),p.a.createElement(T,{size:"6",className:"text-right"},p.a.createElement(A,{text:"Produtos",icon:"layers",color:"blue",className:"mr-3",onClick:this.onClickBtnProduto}),p.a.createElement(A,{text:"Nova categoria",icon:"plus",color:"green",onClick:this.novaCategoria}))),p.a.createElement(he,{header:[{text:"Descri\xe7\xe3o",align:"left"},{text:"NCM",align:"center"},{text:"Produtos",align:"center"},{text:"Criado em",align:"center"}],data:this.state.dataGrid}),p.a.createElement(De,{Pool:this.Pool,show:this.state.showModalCategoria,idcategoria:this.state.idcategoria,beforeClose:this.beforeCloseModal}))}}]),t}(p.a.Component)),Re=a(274),Ie=a.n(Re),Me=a(28),qe=a.n(Me),Le=window.require("fs"),Fe=window.require("electron"),ze=function(){function e(t){Object(i.a)(this,e),this.Pool=t,this.atualizarAplicativoParcial=this.atualizarAplicativoParcial.bind(this),this.atualizarBancoDeDados=this.atualizarBancoDeDados.bind(this),this.baixarAplicativoParcial=this.baixarAplicativoParcial.bind(this),this.verificarAtualizacao=this.verificarAtualizacao.bind(this),this.fs=Le}return Object(s.a)(e,[{key:"atualizarAplicativoParcial",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.baixarAplicativoParcial(function(){var e=Object(n.a)(r.a.mark((function e(o){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=2;break}return e.abrupt("return",t(o));case 2:return e.next=4,a.atualizarBancoDeDados((function(e){if(e)return t(e);t()}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"atualizarBancoDeDados",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,i,s=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===this.ftp&&(this.ftp=Ie.a),a=function(){var e=Object(n.a)(r.a.mark((function e(t,a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.get(a,!1,(function(t,a){if(t)throw new Error(t);var o=[];a.on("data",(function(e){o.push(e.toString())})).on("end",(function(){e(o.join(""))}))}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),e.t0=parseInt,e.next=5,ie(this.Pool,"ATUALIZACAO","INSTRUCAOSQL");case 5:e.t1=e.sent,o=(0,e.t0)(e.t1,10);try{(i=new this.ftp).on("ready",(function(){i.list("/sql",!1,function(){var e=Object(n.a)(r.a.mark((function e(n,c){var l,u,d,p,m,h,f,v,b,g;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=2;break}return e.abrupt("return",t(n));case 2:for(l=[],u=!0,d=!1,p=void 0,e.prev=6,m=c[Symbol.iterator]();!(u=(h=m.next()).done);u=!0)f=h.value,parseInt(f.name.replace(".sql",""),10)>o&&l.push(f.name);e.next=14;break;case 10:e.prev=10,e.t0=e.catch(6),d=!0,p=e.t0;case 14:e.prev=14,e.prev=15,u||null==m.return||m.return();case 17:if(e.prev=17,!d){e.next=20;break}throw p;case 20:return e.finish(17);case 21:return e.finish(14);case 22:l.sort(),e.prev=23,e.t1=r.a.keys(l);case 25:if((e.t2=e.t1()).done){e.next=37;break}return v=e.t2.value,b=l[v],e.next=30,a(i,"/sql/"+b);case 30:return g=e.sent,console.log("Executar SQL: \n"+g),e.next=34,s.Pool.query(g);case 34:console.log("SQL Finalizada"),e.next=25;break;case 37:t(),e.next=44;break;case 40:e.prev=40,e.t3=e.catch(23),console.log("Erro ao atualizar BD: "+e.t3.message),t(e.t3);case 44:case"end":return e.stop()}}),e,null,[[6,10,14,22],[15,,17,21],[23,40]])})));return function(t,a){return e.apply(this,arguments)}}())})).connect({host:"websac.net",port:"21",user:"satflex-update",password:"automacao"})}catch(c){t(c)}case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"baixarAplicativoParcial",value:function(e){var t=this;if(!0===window.__ignoreAppUpdate)return e();void 0===this.childProcess&&(this.childProcess=qe.a),this.childProcess.exec("git --version",[],(function(a){if(a)return e(new Error("git-not-found"));var o=Q()+"/.git";console.log("Diret\xf3rio .git: "+o);try{t.childProcess.execSync('git config --global git.user "satflex@controlware.com.br"')}catch(a){return e(a)}var r=t.childProcess.spawn('cd "'+Q()+'" && git pull',{shell:!0});r.stdout.on("data",(function(e){console.log("stdout: "+e.toString())})),r.stderr.on("data",(function(e){console.log("stderr: "+e.toString())})),r.on("close",(function(t){console.log("exit: "+t.toString()),e()}))}))}},{key:"baixarGit",value:function(){window.MessageBox.show({title:"Git n\xe3o est\xe1 instalado",text:"Para atualizar o SAT-Flex, \xe9 necess\xe1rio que o Git esteja instalado.",buttons:[{text:"Baixar o Git",color:"green",icon:"github",onClick:function(){window.MessageBox.hide(),Fe.shell.openExternal("ftp://instalacao:123@websac.net/SATFlex/Git-2.18.0-32-bit.exe")}},{text:"Mais tarde...",color:"blue",icon:"undo",onClick:function(){window.MessageBox.hide()}}]})}},{key:"versaoAtual",value:function(){var e=Q()+"/package.json";return window.require(e).version}},{key:"verificarAtualizacao",value:function(){var e=this;window.MessageBox.show({title:"Atualiza\xe7\xe3o do SAT-Flex",text:"Deseja iniciar a atualiza\xe7\xe3o do SAT-Flex agora?<br>Isso pode levar alguns minutos.",buttons:[{text:"Sim",icon:"thumbs-up",color:"green",onClick:function(){window.MessageBox.hide(),window.Loading.show(),console.log("Inicio da atualiza\xe7\xe3o: "+(new Date).toLocaleString()),e.atualizarAplicativoParcial((function(t){if(console.log("Fim da atualiza\xe7\xe3o: "+(new Date).toLocaleString()),window.Loading.hide(),t)return"git-not-found"===t.message?e.baixarGit():Z(t),!1;window.MessageBox.show({title:"Atualizado com sucesso!",text:"O seu SAT-Flex foi atualizado com sucesso!<br>A aplica\xe7\xe3o ser\xe1 reinciada.",buttons:[{text:"Ok",icon:"thumbs-up",onClick:function(){void 0===e.electron&&(e.electron=Fe);var t=e.electron.remote.app;t.relaunch(),t.exit()}}]})}))}},{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:function(){window.MessageBox.hide()}}]})}}]),e}(),Ue=(a(495),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={redirect:null,serialnumber:null,versaoAtual:null},a.verificarAtualizacao=a.verificarAtualizacao.bind(Object(C.a)(a)),a.Pool=new pe,a.Atualizacao=new ze(a.Pool),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,ee();case 3:t.t1=t.sent,t.t2={serialnumber:t.t1},t.t0.setState.call(t.t0,t.t2);case 6:case"end":return t.stop()}}),t)})))()}},{key:"verificarAtualizacao",value:function(){this.Atualizacao.verificarAtualizacao()}},{key:"render",value:function(){var e=this;if(this.state.redirect)return p.a.createElement(ue.a,{to:this.state.redirect});var t=this.Atualizacao.versaoAtual(),a=null;return a=this.state.serialnumber?p.a.createElement("b",null,this.state.serialnumber):p.a.createElement(O,{name:"spinner3",className:"ani-spin"}),p.a.createElement(me,null,p.a.createElement(Ae,null,"Configura\xe7\xf5es"),p.a.createElement(M,null,p.a.createElement(T,{size:"8",offset:"2"},p.a.createElement(M,null,p.a.createElement(T,{size:"6",className:"mb-4"},p.a.createElement(A,{text:"Verificar atualiza\xe7\xe3o<br><small>vers\xe3o atual: "+t+"</small>",icon:"safari",size:"xxl",block:!0,onClick:this.verificarAtualizacao})),p.a.createElement(T,{size:"6",className:"mb-4"},p.a.createElement(A,{text:"Par\xe2metros<br>do sistema",icon:"widgets",size:"xxl",block:!0,onClick:function(){e.setState({redirect:"/parametro"})}})),p.a.createElement(T,{size:"6",className:"mb-4"},p.a.createElement(A,{text:"Ferramentas",icon:"tools",size:"xxl",block:!0,onClick:function(){e.setState({redirect:"/ferramentas"})}}))))),p.a.createElement("div",{className:"serialnumber"},p.a.createElement("small",null,"N\xfamero de s\xe9rie"),p.a.createElement("br",null),a))}}]),t}(p.a.Component)),Ve=a(275),Be=a.n(Ve),_e=a(276),$e=a.n(_e),He=function(){function e(){Object(i.a)(this,e),this.nodemailer=$e.a,this._anexos=[],this._destinatario=null,this._titulo=null,this._remetente=null}return Object(s.a)(e,[{key:"anexo",value:function(e){this._anexos.push({filename:e.split("/").reverse()[0],path:e,cid:String(Math.random())})}},{key:"corpo",value:function(e){this._corpo=e}},{key:"destinatario",value:function(e){Array.isArray(e)&&(e=e.join(", ")),this._destinatario=e}},{key:"enviar",value:function(e,t){var a=this.nodemailer.createTransport({host:"smtp-relay.sendinblue.com",port:587,secure:!1,auth:{user:"murilo@controlware.com.br",pass:"2xhH64OnTwBPYvKF"},tls:{rejectUnauthorized:!1}}),o={from:'"'+this._remetente+'" <satflex@controlware.com.br>',to:this._destinatario,subject:this._titulo,html:this._corpo,attachments:this._anexos};a.sendMail(o,(function(a,o){return a?(t(a),a):(e(),!0)}))}},{key:"remetente",value:function(e){this._remetente=e}},{key:"titulo",value:function(e){this._titulo=e}}]),e}(),We=(a(622),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=void 0!==this.props.text?this.props.text:this.props.children,t=void 0!==this.props.model?this.props.model:1;return p.a.createElement("h3",{className:"subtitle-model-"+t},e)}}]),t}(p.a.Component)),Ge=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).atualizarEmailContador=a.atualizarEmailContador.bind(Object(C.a)(a)),a.carregarDocumentos=a.carregarDocumentos.bind(Object(C.a)(a)),a.enviarEmail=a.enviarEmail.bind(Object(C.a)(a)),a.Pool=new pe,a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"atualizarEmailContador",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Pool.query("UPDATE parametro SET valor = $1 WHERE grupo = $2 AND nome = $3",[b()("#email").val(),"CONTADOR","EMAIL"]);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"carregarDocumentos",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["SELECT chave, xml, chavecanc, xmlcanc","FROM documento","WHERE xml IS NOT NULL","  AND chave IS NOT NULL","  AND dthrcriacao::DATE BETWEEN $1 AND $2","ORDER BY dthrcriacao"].join(" "),e.next=3,this.Pool.query(t,[b()("#dtinicial").val(),b()("#dtfinal").val()]);case 3:return a=e.sent,e.abrupt("return",a.rows);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"carregarEmailContador",value:function(){ie(this.Pool,"CONTADOR","EMAIL",(function(e){b()("#email").val(e)}))}},{key:"componentDidMount",value:function(){this.carregarEmailContador()}},{key:"enviarEmail",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=b()("#email").val(),a=b()("#dtinicial").val(),o=b()("#dtfinal").val(),0!==t.length){e.next=6;break}return window.MessageBox.show({text:"Informe o e-mail do contador antes de prosseguir."}),e.abrupt("return",!1);case 6:if(0!==a.length){e.next=9;break}return window.MessageBox.show({text:"Informe a data inicial antes de prosseguir."}),e.abrupt("return",!1);case 9:if(0!==o.length){e.next=12;break}return window.MessageBox.show({text:"Informe a data final antes de prosseguir."}),e.abrupt("return",!1);case 12:return window.Loading.show(),e.next=15,ie(this.Pool,"EMITENTE","NOMEFANTASIA");case 15:return n=e.sent,a=a.split("-").reverse().join("/"),o=o.split("-").reverse().join("/"),e.next=20,this.atualizarEmailContador();case 20:return e.next=22,this.carregarDocumentos();case 22:if(0!==(i=e.sent).length){e.next=27;break}return window.Loading.hide(),window.MessageBox.show({text:"Nenhum documento fiscal foi encontrado no per\xedodo especificado."}),e.abrupt("return",!1);case 27:s=new Be.a,i.forEach((function(e){e.xml&&s.file(e.chave+".xml",e.xml),e.xmlcanc&&s.file(e.chavecanc+".xml",e.xmlcanc)})),c=s.generate({base64:!1,compression:"DEFLATE"}),l=(new Date).toISOString().substr(0,10)+".zip",u=ce(l,c),(d=new He).remetente(n),d.destinatario(t),d.titulo("SAT-Flex: XMLs de "+a+" at\xe9 "+o),d.anexo(u),d.corpo("Seguem os XMLs do per\xedodo de "+a+" at\xe9 "+o+" anexados ao e-mail."),d.enviar((function(){window.Loading.hide(),window.MessageBox.show({title:"Enviado com sucesso",text:"O e-mail contendo os XMLs no per\xedodo especificado foi enviado com sucesso para o e-mail do contador."})}),(function(e){window.Loading.hide(),window.MessageBox.show({title:"Houve uma falha",text:e.message})}));case 39:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=new Date,t=new Date(e.getFullYear(),e.getMonth()-1,1).toISOString().substr(0,10),a=new Date(e.getFullYear(),e.getMonth(),0).toISOString().substr(0,10);return p.a.createElement(me,null,p.a.createElement(Ae,null,"M\xf3dulo do contador"),p.a.createElement(We,null,"Enviar arquivos fiscais por e-mail"),p.a.createElement(M,null,p.a.createElement(T,{size:"6",offset:"3"},p.a.createElement(M,null,p.a.createElement(Ne,{type:"email",id:"email",label:"E-mail do contador",className:"col-12",size:"lg"}),p.a.createElement(Ne,{type:"date",id:"dtinicial",label:"Data inicial",className:"col-6",size:"lg",defaultValue:t}),p.a.createElement(Ne,{type:"date",id:"dtfinal",label:"Data final",className:"col-6",size:"lg",defaultValue:a})),p.a.createElement("div",{className:"text-center mt-2"},p.a.createElement(A,{text:"Enviar arquivos por e-mail",icon:"mail-read",size:"lg",onClick:this.enviarEmail})))))}}]),t}(p.a.Component),Ye=a(277),Qe=a.n(Ye),Je=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=["btn-group","btn-group-"+this.props.size];return this.props.className&&e.push(this.props.className),p.a.createElement("div",{className:e.join(" ")},this.props.children)}}]),t}(p.a.Component);Je.defaultProps={size:"md"};var Ke=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=[this.props.className];return e.push("text-center"),p.a.createElement("div",{className:e.join(" ")},this.props.children)}}]),t}(p.a.Component),Xe=(a(633),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).carregarDados=a.carregarDados.bind(Object(C.a)(a)),a.carregarDadosCategoria=a.carregarDadosCategoria.bind(Object(C.a)(a)),a.carregarDadosFormaPagamento=a.carregarDadosFormaPagamento.bind(Object(C.a)(a)),a.carregarDadosGeral=a.carregarDadosGeral.bind(Object(C.a)(a)),a.carregarDadosProduto=a.carregarDadosProduto.bind(Object(C.a)(a)),a.state={tabela:null,dados:null},a.LineChart=Qe.a.Line,a.Pool=new pe,a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"carregarDados",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,window.Loading.show(),a=null,e.t0=t,e.next="categoria"===e.t0?6:"formapagamento"===e.t0?10:"produto"===e.t0?14:18;break;case 6:return e.next=8,this.carregarDadosCategoria();case 8:return a=e.sent,e.abrupt("break",22);case 10:return e.next=12,this.carregarDadosFormaPagamento();case 12:return a=e.sent,e.abrupt("break",22);case 14:return e.next=16,this.carregarDadosProduto();case 16:return a=e.sent,e.abrupt("break",22);case 18:return e.next=20,this.carregarDadosGeral();case 20:return a=e.sent,e.abrupt("break",22);case 22:this.setState({tabela:t,dados:a}),e.next=28;break;case 25:e.prev=25,e.t1=e.catch(0),Z(e.t1);case 28:return e.prev=28,window.Loading.hide(),e.finish(28);case 31:case"end":return e.stop()}}),e,this,[[0,25,28,31]])})));return function(t){return e.apply(this,arguments)}}()},{key:"carregarDadosCategoria",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,l,u,d,p,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["SELECT categoria.descricao AS a,","  v_vendaprodutodiario.dtvenda AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","LEFT JOIN categoria USING (idcategoria)","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '30 days'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=3,this.Pool.query(t);case 3:return a=e.sent,o=this.prepararDados(a.rows,"D"),n=["SELECT categoria.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","LEFT JOIN categoria USING (idcategoria)","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '6 months'::INTERVAL","  AND EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda) != 0","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=8,this.Pool.query(n);case 8:return i=e.sent,s=this.prepararDados(i.rows,"S"),c=["SELECT categoria.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(MONTH FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","LEFT JOIN categoria USING (idcategoria)","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '2 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=13,this.Pool.query(c);case 13:return l=e.sent,u=this.prepararDados(l.rows,"M"),d=["SELECT categoria.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda)) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","LEFT JOIN categoria USING (idcategoria)","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '10 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=18,this.Pool.query(d);case 18:return p=e.sent,m=this.prepararDados(p.rows,"Y"),e.abrupt("return",{diario:o,semanal:s,mensal:u,anual:m});case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"carregarDadosFormaPagamento",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,l,u,d,p,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["SELECT formapagamento.descricao AS a,","  v_vendapagamentodiario.dtvenda AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendapagamentodiario, formapagamento","WHERE (v_vendapagamentodiario.idformapagamento IS NULL OR v_vendapagamentodiario.idformapagamento = formapagamento.idformapagamento)","  AND (formapagamento.status IS NULL OR formapagamento.status = 'A')","  AND v_vendapagamentodiario.dtvenda >= CURRENT_DATE - '30 days'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=3,this.Pool.query(t);case 3:return a=e.sent,o=this.prepararDados(a.rows,"D"),n=["SELECT formapagamento.descricao AS a,","  (EXTRACT(YEAR FROM v_vendapagamentodiario.dtvenda) || '-' || LPAD(EXTRACT(WEEK FROM v_vendapagamentodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendapagamentodiario, formapagamento","WHERE (v_vendapagamentodiario.idformapagamento IS NULL OR v_vendapagamentodiario.idformapagamento = formapagamento.idformapagamento)","  AND (formapagamento.status IS NULL OR formapagamento.status = 'A')","  AND v_vendapagamentodiario.dtvenda >= CURRENT_DATE - '6 months'::INTERVAL","  AND EXTRACT(WEEK FROM v_vendapagamentodiario.dtvenda) != 0","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=8,this.Pool.query(n);case 8:return i=e.sent,s=this.prepararDados(i.rows,"S"),c=["SELECT formapagamento.descricao AS a,","  (EXTRACT(YEAR FROM v_vendapagamentodiario.dtvenda) || '-' || LPAD(EXTRACT(MONTH FROM v_vendapagamentodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendapagamentodiario, formapagamento","WHERE (v_vendapagamentodiario.idformapagamento IS NULL OR v_vendapagamentodiario.idformapagamento = formapagamento.idformapagamento)","  AND (formapagamento.status IS NULL OR formapagamento.status = 'A')","  AND v_vendapagamentodiario.dtvenda >= CURRENT_DATE - '2 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=13,this.Pool.query(c);case 13:return l=e.sent,u=this.prepararDados(l.rows,"M"),d=["SELECT formapagamento.descricao AS a,","  (EXTRACT(YEAR FROM v_vendapagamentodiario.dtvenda)) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendapagamentodiario, formapagamento","WHERE (v_vendapagamentodiario.idformapagamento IS NULL OR v_vendapagamentodiario.idformapagamento = formapagamento.idformapagamento)","  AND (formapagamento.status IS NULL OR formapagamento.status = 'A')","  AND v_vendapagamentodiario.dtvenda >= CURRENT_DATE - '10 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=18,this.Pool.query(d);case 18:return p=e.sent,m=this.prepararDados(p.rows,"Y"),e.abrupt("return",{diario:o,semanal:s,mensal:u,anual:m});case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"carregarDadosGeral",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,l,u,d,p,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["SELECT 'Venda' AS a,","  v_vendaprodutodiario.dtvenda AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario","WHERE v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '30 days'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=3,this.Pool.query(t);case 3:return a=e.sent,o=this.prepararDados(a.rows,"D"),n=["SELECT 'Venda' AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario","WHERE v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '6 months'::INTERVAL","  AND EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda) != 0","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=8,this.Pool.query(n);case 8:return i=e.sent,s=this.prepararDados(i.rows,"S"),c=["SELECT 'Venda' AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(MONTH FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario","WHERE v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '2 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=13,this.Pool.query(c);case 13:return l=e.sent,u=this.prepararDados(l.rows,"M"),d=["SELECT 'Venda' AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda)) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario","WHERE v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '10 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=18,this.Pool.query(d);case 18:return p=e.sent,m=this.prepararDados(p.rows,"Y"),e.abrupt("return",{diario:o,semanal:s,mensal:u,anual:m});case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"carregarDadosProduto",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,l,u,d,p,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["SELECT produto.descricao AS a,","  v_vendaprodutodiario.dtvenda AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '30 days'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=3,this.Pool.query(t);case 3:return a=e.sent,o=this.prepararDados(a.rows,"D"),n=["SELECT produto.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '6 months'::INTERVAL","  AND EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda) != 0","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=8,this.Pool.query(n);case 8:return i=e.sent,s=this.prepararDados(i.rows,"S"),c=["SELECT produto.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(MONTH FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '2 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=13,this.Pool.query(c);case 13:return l=e.sent,u=this.prepararDados(l.rows,"M"),d=["SELECT produto.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda)) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '10 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=18,this.Pool.query(d);case 18:return p=e.sent,m=this.prepararDados(p.rows,"Y"),e.abrupt("return",{diario:o,semanal:s,mensal:u,anual:m});case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.carregarDados("categoria")}},{key:"prepararDados",value:function(e,t){var a=[],o=[];for(var r in e){var n=e[r];switch(t){case"D":n.x=String(n.x.getDate()).lpad(2,"0")+"/"+String(n.x.getMonth()+1).lpad(2,"0")+"/"+n.x.getFullYear();break;case"S":case"M":n.x=n.x.split("-").reverse().join("/")}e[r].x=n.x,-1===o.indexOf(n.x)&&o.push(n.x),-1===a.indexOf(n.a)&&a.push(n.a)}for(var i={},s=0,c=o;s<c.length;s++){var l=c[s],u=!0,d=!1,p=void 0;try{for(var m,h=a[Symbol.iterator]();!(u=(m=h.next()).done);u=!0){var f=m.value;void 0===i[f]&&(i[f]=[]);var v=!1,b=!0,g=!1,E=void 0;try{for(var x,C=e[Symbol.iterator]();!(b=(x=C.next()).done);b=!0){var O=x.value;if(O.a===f&&O.x===l){i[f].push(O.y),v=!0;break}}}catch(S){g=!0,E=S}finally{try{b||null==C.return||C.return()}finally{if(g)throw E}}v||i[f].push(0)}}catch(S){d=!0,p=S}finally{try{u||null==h.return||h.return()}finally{if(d)throw p}}}var k=[];for(var y in i){void 0===this.cor&&(this.cor={}),"D"===t&&(this.cor[y]=Math.round(255*Math.random())+","+Math.round(255*Math.random())+","+Math.round(255*Math.random()));var w=this.cor[y];k.push({label:y,fillColor:"rgba("+w+",0.2)",strokeColor:"rgba("+w+",1)",pointColor:"rgba("+w+",1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba("+w+",1)",data:i[y]})}return{labels:o,datasets:k}}},{key:"render",value:function(){var e=this,t={legend:{display:!0}},a=null;null!==this.state.dados&&(a=p.a.createElement(this.LineChart,{data:this.state.dados.diario,options:t,height:"300px",width:"900px",redraw:!0}));var o=null;null!==this.state.dados&&(o=p.a.createElement(this.LineChart,{data:this.state.dados.semanal,options:t,height:"300px",width:"900px",redraw:!0}));var r=null;null!==this.state.dados&&(r=p.a.createElement(this.LineChart,{data:this.state.dados.mensal,options:t,height:"300px",width:"900px",redraw:!0}));var n=null;return null!==this.state.dados&&(n=p.a.createElement(this.LineChart,{data:this.state.dados.anual,options:t,height:"300px",width:"900px",redraw:!0})),p.a.createElement(me,null,p.a.createElement(Ae,null,"Estat\xedsticas"),p.a.createElement(Ke,{className:"mb-5"},p.a.createElement(Je,null,p.a.createElement(A,{text:"Geral",color:"green",size:"lg",active:null===this.state.tabela,onClick:function(){e.carregarDados(null)}}),p.a.createElement(A,{text:"Finalizadora",color:"green",size:"lg",active:"formapagamento"===this.state.tabela,onClick:function(){e.carregarDados("formapagamento")}}),p.a.createElement(A,{text:"Categoria",color:"green",size:"lg",active:"categoria"===this.state.tabela,onClick:function(){e.carregarDados("categoria")}}),p.a.createElement(A,{text:"Produto",color:"green",size:"lg",active:"produto"===this.state.tabela,onClick:function(){e.carregarDados("produto")}})),p.a.createElement(We,{model:"2"},"Venda di\xe1ria nos \xfaltimos 30 dias"),a,p.a.createElement(We,{model:"2"},"Venda semanal nos \xfaltimos 6 meses"),o,p.a.createElement(We,{model:"2"},"Venda mensal nos \xfaltimos 2 anos"),r,p.a.createElement(We,{model:"2"},"Venda anual nos \xfaltimos 10 anos"),n))}}]),t}(p.a.Component)),Ze=a(99),et=a.n(Ze),tt=a(103),at=a.n(tt),ot=function(){function e(t){Object(i.a)(this,e),this.font=t,this.content=[]}return Object(s.a)(e,[{key:"barcode",value:function(e,t,a){t=void 0===t?50:t,a=void 0===a?1:a;var o=null;switch(e.length){case 7:case 8:o=68;break;case 12:case 13:o=67;break;default:o=70}this.content.push("\x1dh"+String.fromCharCode(t)),this.content.push("\x1dw"+String.fromCharCode(a)),this.content.push("\x1ba"+String.fromCharCode(1)),this.content.push("\x1dk"+String.fromCharCode(o)+String.fromCharCode(e.length)+e),this.content.push("\x1ba"+String.fromCharCode(0))}},{key:"bold",value:function(e){this.content.push("\x1bG"+String.fromCharCode(e?1:0))}},{key:"cut",value:function(){this.content.push("\x1dV"+String.fromCharCode(1))}},{key:"drawer",value:function(){this.content.push("\x1bp"+String.fromCharCode(0)+String.fromCharCode(13)+String.fromCharCode(10))}},{key:"feed",value:function(e){this.content.push("\x1bd"+String.fromCharCode(e))}},{key:"getContent",value:function(){return this.content.join("")}},{key:"reset",value:function(){this.content=[],this.content.push("\x1b"+String.fromCharCode(0)),this.content.push("\x1b "+String.fromCharCode(0)),this.content.push("\x1bM"+String.fromCharCode(this.font)),this.content.push("\x1d!"+String.fromCharCode(0)),this.content.push("\x1bt"+String.fromCharCode(3)),this.content.push("\x1bR"+String.fromCharCode(12)),this.content.push("\x1dB"+String.fromCharCode(0)),this.content.push("\x1bG"+String.fromCharCode(0)),this.content.push("\x1ba"+String.fromCharCode(0))}},{key:"qrcode",value:function(e){var t=e.length+3,a=t%256,o=t/256;this.content.push("\x1ba"+String.fromCharCode(1)),this.content.push("\x1d(k"+String.fromCharCode(4)+String.fromCharCode(0)+String.fromCharCode(49)+String.fromCharCode(65)+String.fromCharCode(50)+String.fromCharCode(0)),this.content.push("\x1d(k"+String.fromCharCode(3)+String.fromCharCode(0)+String.fromCharCode(49)+String.fromCharCode(67)+String.fromCharCode(3)),this.content.push("\x1d(k"+String.fromCharCode(3)+String.fromCharCode(0)+String.fromCharCode(49)+String.fromCharCode(69)+String.fromCharCode(51)),this.content.push("\x1d(k"+String.fromCharCode(a)+String.fromCharCode(o)+String.fromCharCode(49)+String.fromCharCode(80)+String.fromCharCode(48)+e),this.content.push("\x1d(k"+String.fromCharCode(3)+String.fromCharCode(0)+String.fromCharCode(49)+String.fromCharCode(81)+String.fromCharCode(48)),this.content.push("\x1ba"+String.fromCharCode(0))}},{key:"text",value:function(e,t){e=(e=e.removeSpecial()).replaceAll("|",String.fromCharCode(179)),t&&this.bold(!0),this.content.push(e+"\n"),t&&this.bold(!1)}}]),e}(),rt=function(){function e(t){Object(i.a)(this,e),this.Pool=t,this.os=et.a,this.childProcess=qe.a,this.escpos=null,this.colunas=null,this.nome=null,this.modelo=null,this.documento=null,this.documentoprodutos=null,this.documentopagamentos=null,this.parametroImpressoraGuilhotina=null,this.parametroImpressoraModeloImpressao=null}return Object(s.a)(e,[{key:"alimentar",value:function(){var e=Object(n.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0===t?1:t,e.next=3,this.carregarEscPos();case 3:e.sent.feed(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"barcode",value:function(){var e=Object(n.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarEscPos();case 2:e.sent.barcode(t);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"carregarEscPos",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===this.escpos&&(t=this.colunas>48?"1":"0",this.escpos=new ot(t)),e.abrupt("return",this.escpos);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"carregarDadosDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Pool.connect();case 2:return i=e.sent,e.prev=3,e.next=6,i.query("SELECT * FROM documento WHERE iddocumento = $1",[t]);case 6:if(0!==(s=e.sent).rows.length){e.next=9;break}throw new Error("Nenhum documento foi encontrado.");case 9:return a=s.rows[0],c=["SELECT documentoproduto.*, unidade.precisao, unidade.sigla","FROM documentoproduto","LEFT JOIN produto USING (idproduto)","LEFT JOIN unidade USING (idunidade)","WHERE documentoproduto.iddocumento = $1","ORDER BY documentoproduto.sequencial"].join(" "),e.next=13,i.query(c,[t]);case 13:return s=e.sent,o=s.rows,l=["SELECT documentopagamento.*, formapagamento.descricao AS formapagamento","FROM documentopagamento","LEFT JOIN formapagamento USING (idformapagamento)","WHERE documentopagamento.iddocumento = $1"].join(" "),e.next=18,i.query(l,[t]);case 18:s=e.sent,n=s.rows,e.next=25;break;case 22:throw e.prev=22,e.t0=e.catch(3),e.t0;case 25:return e.prev=25,i.release(),e.finish(25);case 28:this.documento=a,this.documentoprodutos=o,this.documentopagamentos=n;case 31:case"end":return e.stop()}}),e,this,[[3,22,25,28]])})));return function(t){return e.apply(this,arguments)}}()},{key:"conteudo",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarEscPos();case 2:return t=e.sent,e.abrupt("return",t.getContent());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"gaveta",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarEscPos();case 2:e.sent.drawer();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"guilhotina",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.parametroImpressoraGuilhotina){e.next=4;break}return e.next=3,ie(this.Pool,"IMPRESSORA","GUILHOTINA");case 3:this.parametroImpressoraGuilhotina=e.sent;case 4:if("S"!==this.parametroImpressoraGuilhotina){e.next=9;break}return e.next=7,this.carregarEscPos();case 7:e.sent.cut();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"imprimir",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a,o){var n,i,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t&&null!==t){e.next=4;break}return e.next=3,this.conteudo();case 3:t=e.sent;case 4:if(void 0!==o){e.next=12;break}if(null!==this.modelo){e.next=11;break}return e.next=8,ie(this.Pool,"IMPRESSORA","MODELO");case 8:o=e.sent,e.next=12;break;case 11:o=this.modelo;case 12:if("nenhum"!==o){e.next=14;break}return e.abrupt("return",!0);case 14:return n=ce("printer.txt",t),a=void 0===a?this.nome:a,i=this.childProcess.execSync||window.require("child_process").execSync,s=(s='copy "'+n+'" '+a.toUpperCase()).replaceAll("/","\\"),i(s),e.abrupt("return",!0);case 17:case"end":return e.stop()}}),e,this)})));return function(t,a,o){return e.apply(this,arguments)}}()},{key:"imprimirCabecalho",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,l,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie(this.Pool,"EMITENTE","NOMEFANTASIA");case 2:return t=e.sent,e.next=5,this.texto(t,"center",!0);case 5:return e.next=7,ie(this.Pool,"EMITENTE","RAZAOSOCIAL");case 7:if((a=e.sent)===t){e.next=11;break}return e.next=11,this.texto(a,"center",!0);case 11:return e.next=13,ie(this.Pool,"EMITENTE","ENDERECO");case 13:return o=e.sent,e.next=16,ie(this.Pool,"EMITENTE","NUMERO");case 16:return n=e.sent,e.next=19,this.texto(o+", "+n,"center");case 19:return e.next=21,ie(this.Pool,"EMITENTE","BAIRRO");case 21:return i=e.sent,e.next=24,ie(this.Pool,"EMITENTE","MUNICIPIO");case 24:return s=e.sent,e.next=27,ie(this.Pool,"EMITENTE","UF");case 27:return c=e.sent,e.next=30,this.texto(i+" - "+s+" - "+c,"center");case 30:return e.next=32,ie(this.Pool,"EMITENTE","CNPJ");case 32:return l=e.sent,e.next=35,ie(this.Pool,"EMITENTE","IE");case 35:return u=e.sent,e.next=38,this.texto("CNPJ "+l+" IE "+u,"center");case 38:return e.next=40,this.linha();case 40:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"imprimirDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a,o){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.reiniciar();case 2:return e.next=4,this.carregarDadosDocumento(t);case 4:n=!1,e.t0=this.documento.status,e.next="A"===e.t0?8:"C"===e.t0?12:16;break;case 8:return e.next=10,this.imprimirDocumentoAtivo();case 10:return n=e.sent,e.abrupt("break",17);case 12:return e.next=14,this.imprimirDocumentoCancelado();case 14:return n=e.sent,e.abrupt("break",17);case 16:return e.abrupt("break",17);case 17:n&&"function"===typeof a?a():n||"function"!==typeof o||o();case 18:case"end":return e.stop()}}),e,this)})));return function(t,a,o){return e.apply(this,arguments)}}()},{key:"imprimirDocumentoAtivo",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,i,s,c,l,u,d,p,m,h,f,v,b,g,E,x,C=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0===t?1:t,a=null,o=null,"CU"===this.documento.operacao&&this.documento.xml&&(i=at.a.xml2json(this.documento.xml,{compact:!0}),i=JSON.parse(i),a=i.CFe.infCFe.infAdic.infCpl._text,i.CFe.infCFe.ide.assinaturaQRCODE&&(o=i.CFe.infCFe.ide.assinaturaQRCODE._text)),e.next=6,this.imprimirCabecalho();case 6:s=null,c=this.documento.dthrcriacao,l=c.toLocaleString().split(" ")[0],u=String(c.getHours()).lpad(2,"0")+":"+String(c.getMinutes()).lpad(2,"0")+":"+String(c.getSeconds()).lpad(2,"0"),e.t0=this.documento.operacao,e.next="CU"===e.t0?13:"NC"===e.t0?19:"OR"===e.t0?25:"RE"===e.t0?31:37;break;case 13:return s=String(this.documento.numero?this.documento.numero:this.documento.iddocumento).lpad(6,"0"),e.next=16,this.texto("CUPOM FISCAL ELETR\xd4NICO - SAT","center",!0);case 16:return e.next=18,this.texto("COO: "+s+"  Data: "+l+"  Hora: "+u,"center");case 18:return e.abrupt("break",38);case 19:return s=String(this.documento.numero?this.documento.numero:"").lpad(6,"0"),e.next=22,this.texto("NOTA FISCAL A PARTIR DE CUPOM","center",!0);case 22:return e.next=24,this.texto("N\xfam: "+s+"  Data: "+l+"  Hora: "+u,"center");case 24:return e.abrupt("break",38);case 25:return s=String(this.documento.iddocumento?this.documento.iddocumento:"").lpad(6,"0"),e.next=28,this.texto("OR\xc7AMENTO - SEM VALOR FISCAL","center",!0);case 28:return e.next=30,this.texto("N\xfam: "+s+"  Data: "+l+"  Hora: "+u,"center");case 30:return e.abrupt("break",38);case 31:return s=String(this.documento.numero?this.documento.numero:"").lpad(6,"0"),e.next=34,this.texto("NOTA FISCAL DE REMESSA","center",!0);case 34:return e.next=36,this.texto("N\xfam: "+s+"  Data: "+l+"  Hora: "+u,"center");case 36:case 37:return e.abrupt("break",38);case 38:return e.next=40,this.linha();case 40:d=null,e.t1=this.documento.operacao,e.next="CU"===e.t1?44:"OR"===e.t1?48:"NC"===e.t1?55:"RE"===e.t1?55:79;break;case 44:return d=this.documento.cpfcnpj?this.documento.cpfcnpj:"n\xe3o informado",e.next=47,this.texto("CPF/CNPJ do consumidor: "+d);case 47:return e.abrupt("break",80);case 48:return d=this.documento.cpfcnpj?this.documento.cpfcnpj:"n\xe3o informado",p=this.documento.nomeorcamento?this.documento.nomeorcamento:"n\xe3o informado",e.next=52,this.texto("Nome do cliente: "+p);case 52:return e.next=54,this.texto("CPF/CNPJ do cliente: "+d);case 54:return e.abrupt("break",80);case 55:return m=["SELECT parceiro.nome, parceiro.tipopessoa, parceiro.cpfcnpj,","  parceiro.inscricaoestadual, cidade.nome AS cidade, estado.sigla AS estado,","  parceiro.cep, parceiro.bairro, parceiro.endereco, parceiro.numero,","  parceiro.complemento","FROM parceiro","LEFT JOIN cidade USING (idcidade)","LEFT JOIN estado USING (idestado)","WHERE parceiro.idparceiro = $1"].join(" "),e.next=58,this.Pool.query(m,[this.documento.idparceiro]);case 58:return h=e.sent,f=h.rows[0],e.next=62,this.texto("DADOS DO DESTINATARIO","center",!0);case 62:return e.next=64,this.texto("Nome: "+f.nome);case 64:return e.next=66,this.texto(("F"===f.tipopessoa?"CPF":"CNPJ")+": "+f.cpfcnpj);case 66:if(!f.inscricaoestadual){e.next=69;break}return e.next=69,this.texto("Inscricao estadual: "+f.inscricaoestadual);case 69:return e.next=71,this.texto("Cidade: "+f.cidade+" - "+f.estado);case 71:return e.next=73,this.texto("CEP: "+f.cep+"   Bairro: "+f.bairro);case 73:return e.next=75,this.texto("Endere\xe7o: "+f.endereco+", "+f.numero);case 75:if(!f.complemento){e.next=78;break}return e.next=78,this.texto("Complemento: "+this.complemento);case 78:case 79:return e.abrupt("break",80);case 80:return e.next=82,this.linha();case 82:if(null!==this.parametroImpressoraModeloImpressao){e.next=86;break}return e.next=85,ie(this.Pool,"IMPRESSORA","MODELOIMPRESSAO");case 85:this.parametroImpressoraModeloImpressao=e.sent;case 86:e.t2=this.parametroImpressoraModeloImpressao,e.next="1"===e.t2?89:"2"===e.t2?92:95;break;case 89:return e.next=91,this.imprimirListaProdutosModelo01();case 91:return e.abrupt("break",98);case 92:return e.next=94,this.imprimirListaProdutosModelo02();case 94:return e.abrupt("break",98);case 95:return e.next=97,this.imprimirListaProdutosModelo01();case 97:return e.abrupt("break",98);case 98:return v=this.documento.totaldocumento.format(2,",","."),e.next=101,this.texto("TOTAL"+" ".repeat(this.colunas-(5+v.length))+v,"left",!0);case 101:return e.next=103,this.alimentar(1);case 103:return e.next=105,this.documentopagamentos.forEach(function(){var e=Object(n.a)(r.a.mark((function e(t,a){var o,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=0,n=t.formapagamento.removeSpecial(),o=(o=a+1===C.documentopagamentos.length?parseFloat(t.totalpagamento)+parseFloat(C.documento.totaltroco):t.totalpagamento).format(2,",","."),e.next=6,C.texto(n+" ".repeat(C.colunas-n.length-o.length)+o);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}());case 105:if(!(this.documento.totaltroco>0)){e.next=110;break}return"Troco",b=this.documento.totaltroco.format(2,",","."),e.next=110,this.texto("Troco"+" ".repeat(this.colunas-"Troco".length-b.length)+b);case 110:if(!this.documento.chave){e.next=145;break}return e.next=113,this.linha();case 113:if("CU"!==this.documento.operacao){e.next=129;break}return e.next=116,this.texto("OBSERVA\xc7\xd5ES DO CONTRIBUINTE","center");case 116:return e.next=118,this.texto("ICMS recolhido conforme LC 123/2006 - Simples Nacional.");case 118:return e.next=120,this.texto(a);case 120:return e.next=122,this.linha();case 122:return e.next=124,ie(this.Pool,"SAT","SERIE");case 124:return g=e.sent,e.next=127,this.texto("SAT No. "+g,"center");case 127:return e.next=129,this.texto(l+" - "+u,"center");case 129:return E=this.documento.chave.substr(-44),e.next=132,this.alimentar(1);case 132:return e.next=134,this.texto(E,"center");case 134:return e.next=136,this.barcode(E.substr(0,22));case 136:return e.next=138,this.alimentar(1);case 138:return e.next=140,this.barcode(E.substr(22));case 140:if(!o){e.next=145;break}return e.next=143,this.alimentar(1);case 143:return e.next=145,this.qrcode(o);case 145:return e.next=147,this.alimentar(3);case 147:return e.next=149,this.guilhotina();case 149:x=0;case 150:if(!(x<t)){e.next=156;break}if(this.imprimir()){e.next=153;break}return e.abrupt("return",!1);case 153:x++,e.next=150;break;case 156:return e.abrupt("return",!0);case 157:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"imprimirDocumentoCancelado",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,l,u,d,p,m,h,f,v,b,g;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie(this.Pool,"SAT","SERIE");case 2:return a=e.sent,o=null,n=null,i=null,s=null,"CU"===this.documento.operacao&&this.documento.xml&&(o=at.a.xml2json(this.documento.xml,{compact:!0}),(o=JSON.parse(o)).CFe.infCFe.ide.assinaturaQRCODE&&(n=o.CFe.infCFe.ide.assinaturaQRCODE._text),i=at.a.xml2json(this.documento.xml,{compact:!0}),(i=JSON.parse(i)).CFe.infCFe.ide.assinaturaQRCODE&&(s=i.CFe.infCFe.ide.assinaturaQRCODE._text)),e.next=10,this.imprimirCabecalho();case 10:c=null,l=this.documento.dthrcriacao,u=l.toLocaleString().split(" ")[0],d=String(l.getHours()).lpad(2,"0")+":"+String(l.getMinutes()).lpad(2,"0")+":"+String(l.getSeconds()).lpad(2,"0"),e.t0=this.documento.operacao,e.next="CU"===e.t0?17:"NC"===e.t0?23:"OR"===e.t0?29:"RE"===e.t0?35:41;break;case 17:return c=String(this.documento.numero?this.documento.numero:this.documento.iddocumento).lpad(6,"0"),e.next=20,this.texto("CUPOM FISCAL ELETR\xd4NICO - SAT","center",!0);case 20:return e.next=22,this.texto("COO: "+c+"  Data: "+u+"  Hora: "+d,"center");case 22:return e.abrupt("break",42);case 23:return c=String(this.documento.numero?this.documento.numero:"").lpad(6,"0"),e.next=26,this.texto("NOTA FISCAL A PARTIR DE CUPOM","center",!0);case 26:return e.next=28,this.texto("N\xfamero: "+c+"  Data: "+u+"  Hora: "+d,"center");case 28:return e.abrupt("break",42);case 29:return c=String(this.documento.iddocumento?this.documento.iddocumento:"").lpad(6,"0"),e.next=32,this.texto("OR\xc7AMENTO - SEM VALOR FISCAL","center",!0);case 32:return e.next=34,this.texto("N\xfamero: "+c+"  Data: "+u+"  Hora: "+d,"center");case 34:return e.abrupt("break",42);case 35:return c=String(this.documento.numero?this.documento.numero:"").lpad(6,"0"),e.next=38,this.texto("NOTA FISCAL DE REMESSA","center",!0);case 38:return e.next=40,this.texto("N\xfamero: "+c+"  Data: "+u+"  Hora: "+d,"center");case 40:case 41:return e.abrupt("break",42);case 42:return e.next=44,this.texto("CANCELAMENTO","center",!0);case 44:return e.next=46,this.linha();case 46:e.t1=this.documento.operacao,e.next="CU"===e.t1?49:"OR"===e.t1?54:60;break;case 49:return e.next=51,this.texto("Dados do cupom fiscal eletronico cancelado","center",!0);case 51:return e.next=53,this.texto("SAT No. "+a,"center");case 53:return e.abrupt("break",66);case 54:return p=this.documento.iddocumento.lpad(6,"0"),e.next=57,this.texto("Dados do or\xe7amento cancelado","center",!0);case 57:return e.next=59,this.texto("Or\xe7amento No. "+p,"center");case 59:return e.abrupt("break",66);case 60:return m=this.documento.numero.lpad(6,"0"),e.next=63,this.texto("Dados do nota fiscal eletronica cancelada","center",!0);case 63:return e.next=65,this.texto("Nota Fiscal No. "+m,"center");case 65:return e.abrupt("break",66);case 66:return e.next=68,this.texto("TOTAL R$ "+this.documento.totaldocumento.format(2,",","."),"center");case 68:return e.next=70,this.texto(u+" "+d,"center");case 70:if(!this.documento.chave){e.next=87;break}return e.next=73,this.alimentar(1);case 73:return h=this.documento.chave.substr(-44),e.next=76,this.texto(h,"center");case 76:return e.next=78,this.barcode(h.substr(0,22));case 78:return e.next=80,this.alimentar(1);case 80:return e.next=82,this.barcode(h.substr(22));case 82:if(!n){e.next=87;break}return e.next=85,this.alimentar(1);case 85:return e.next=87,this.qrcode(n);case 87:return e.next=89,this.linha();case 89:if("CU"!==this.documento.operacao){e.next=116;break}return f=this.documento.dthrcancelamento,v=f.toLocaleString().split(" ")[0],b=String(f.getHours()).lpad(2,"0")+":"+String(f.getMinutes()).lpad(2,"0")+":"+String(f.getSeconds()).lpad(2,"0"),e.next=95,this.texto("Dados do cupom fiscal eletronico de cancelamento","center",!0);case 95:return e.next=97,this.texto("SAT No. "+a,"center");case 97:return e.next=99,this.texto(v+" "+b,"center");case 99:if(!this.documento.chavecanc){e.next=116;break}return e.next=102,this.alimentar(1);case 102:return g=this.documento.chavecanc.substr(-44),e.next=105,this.texto(g,"center");case 105:return e.next=107,this.barcode(g.substr(0,22));case 107:return e.next=109,this.alimentar(1);case 109:return e.next=111,this.barcode(g.substr(22));case 111:if(!s){e.next=116;break}return e.next=114,this.alimentar(1);case 114:return e.next=116,this.qrcode(s);case 116:return e.next=118,this.alimentar(6);case 118:return e.next=120,this.guilhotina();case 120:if(this.imprimir()){e.next=122;break}return e.abrupt("return",!1);case 122:return e.abrupt("return",!0);case 123:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"imprimirListaProdutosModelo01",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.texto("#   Descri\xe7\xe3o"+" ".repeat(this.colunas-40)+"   Qtde X Pre\xe7o       Total");case 2:return e.next=4,this.linha();case 4:return e.next=6,this.documentoprodutos.forEach(function(){var e=Object(n.a)(r.a.mark((function e(a){var o,n,i,s,c,l,u,d,p,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=String(a.sequencial).lpad(3,"0"),n=(a.quantidade*a.preco).format(2,",","."),i=a.quantidade.format(a.precisao,",",".")+" "+a.sigla,s=i.lpad(10," ")+" X "+a.preco.format(2,",",".").rpad(8," ")+" "+n.lpad(8," "),c=t.colunas-(o.length+s.length+2),l=a.descricao.removeSpecial().substr(0,c).rpad(c," "),e.next=8,t.texto(o+" "+l+" "+s);case 8:if(!(a.totaldesconto>0)){e.next=13;break}return u="-"+a.totaldesconto.format(2,",","."),d="    Desconto"+" ".repeat(t.colunas-(12+u.length))+u,e.next=13,t.texto(d);case 13:if(!(a.totalacrescimo>0)){e.next=18;break}return p="+"+a.totalacrescimo.format(2,",","."),m="    Acrescimo"+" ".repeat(t.colunas-(13+p.length))+p,e.next=18,t.texto(m);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"imprimirListaProdutosModelo02",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,l,u,d,p,m,h,f;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.texto("Descri\xe7\xe3o do produto");case 2:return e.next=4,this.texto("Quantidade X Pre\xe7o"+" ".repeat(this.colunas-23)+"Total");case 4:return e.next=6,this.linha();case 6:t=0;case 7:if(!(t<this.documentoprodutos.length)){e.next=34;break}return a=this.documentoprodutos[t],o=a.descricao.removeSpecial(),n=String(a.sequencial).lpad(3,"0"),i=a.quantidade.format(a.precisao,",",".")+" "+a.sigla,s=a.preco.format(2,",","."),c=(a.quantidade*a.preco).format(2,",","."),l=n+" "+o,e.next=17,this.texto(l);case 17:return d=(u="    "+i+" X "+s)+" ".repeat(this.colunas-u.length-c.length)+c,e.next=21,this.texto(d);case 21:if(!(a.totaldesconto>0)){e.next=26;break}return p="-"+a.totaldesconto.format(2,",","."),m="    Desconto"+" ".repeat(this.colunas-(12+p.length))+p,e.next=26,this.texto(m);case 26:if(!(a.totalacrescimo>0)){e.next=31;break}return h="+"+a.totalacrescimo.format(2,",","."),f="    Acrescimo"+" ".repeat(this.colunas-(13+h.length))+h,e.next=31,this.texto(f);case 31:t++,e.next=7;break;case 34:return e.next=36,this.linha();case 36:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"linha",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.texto("-".repeat(this.colunas));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"qrcode",value:function(){var e=Object(n.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarEscPos();case 2:e.sent.qrcode(t);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reiniciar",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.colunas){e.next=6;break}return e.t0=parseInt,e.next=4,ie(this.Pool,"IMPRESSORA","COLUNAS");case 4:e.t1=e.sent,this.colunas=(0,e.t0)(e.t1,10);case 6:if(null!==this.nome){e.next=10;break}return e.next=9,ie(this.Pool,"IMPRESSORA","NOME");case 9:this.nome=e.sent;case 10:if(null!==this.modelo){e.next=14;break}return e.next=13,ie(this.Pool,"IMPRESSORA","MODELO");case 13:this.modelo=e.sent;case 14:return e.next=16,this.carregarEscPos();case 16:e.sent.reset();case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"texto",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a,o){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=void 0===a?"left":a,o=void 0!==o&&o,null===t&&(t=""),e.next=5,this.carregarEscPos();case 5:n=e.sent,e.t0=a,e.next="center"===e.t0?9:"left"===e.t0?11:"right"===e.t0?13:15;break;case 9:return t=t.cpad(this.colunas," "),e.abrupt("break",16);case 11:return t=t.rpad(this.colunas," "),e.abrupt("break",16);case 13:return t=t.lpad(this.colunas," "),e.abrupt("break",16);case 15:return e.abrupt("break",16);case 16:t=t.substr(0,this.colunas),n.text(t,o);case 18:case"end":return e.stop()}}),e,this)})));return function(t,a,o){return e.apply(this,arguments)}}()}]),e}(),nt=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={tipo:null,dtinicial:null,dtfinal:null,ativarFechamentoRelatorio:!1,ativarFechamentoResumo:!1},a.gerar=a.gerar.bind(Object(C.a)(a)),a.imprimir=a.imprimir.bind(Object(C.a)(a)),a.Pool=new pe,a.Printer=new rt(a.Pool);var o=["CU"];for(var r in o)o[r]="'"+o[r]+"'";return a.operacaoQuery="("+o.join(", ")+")",a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"gerar",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b()("#tipo").val()){e.next=3;break}return window.MessageBox.show({text:"Por favor, informe o tipo de fechamento antes de prosseguir."}),e.abrupt("return",!1);case 3:if(b()("#dtinicial").val()){e.next=6;break}return window.MessageBox.show({text:"Por favor, informe a data inicial do fechamento antes de prosseguir."}),e.abrupt("return",!1);case 6:if(b()("#dtfinal").val()){e.next=9;break}return window.MessageBox.show({text:"Por favor, informe a data final do fechamento antes de prosseguir."}),e.abrupt("return",!1);case 9:return e.next=11,this.prepararImpressao();case 11:this.setState({tipo:b()("#tipo").val(),dtinicial:b()("#dtinicial").val(),dtfinal:b()("#dtfinal").val(),ativarFechamentoRelatorio:!1,ativarFechamentoResumo:!1},(function(){t.setState({ativarFechamentoRelatorio:!0},(function(){t.setState({ativarFechamentoResumo:!0})}))}));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"imprimir",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Printer.alimentar(3);case 2:return e.next=4,this.Printer.guilhotina();case 4:return e.next=6,this.Printer.imprimir();case 6:window.FastMessage.show("Fechamento impresso com sucesso!");case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"prepararImpressao",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Printer.reiniciar();case 2:return t=b()("#dtinicial").val().split("-").reverse().join("/"),a=b()("#dtfinal").val().split("-").reverse().join("/"),e.t0=this.Printer,e.next=7,ie(this.Pool,"EMITENTE","NOMEFANTASIA");case 7:return e.t1=e.sent,e.next=10,e.t0.texto.call(e.t0,e.t1,"center",!0);case 10:return e.next=12,this.Printer.texto("FECHAMENTO: "+t+" a "+a,"center",!0);case 12:return e.next=14,this.Printer.alimentar();case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=!this.state.tipo;return p.a.createElement(me,{className:"Fechamento"},p.a.createElement(Ae,null,"Fechamento"),p.a.createElement(M,null,p.a.createElement(T,{size:"6",offset:"3"},p.a.createElement(M,null,p.a.createElement(Ne,{type:"select",id:"tipo",label:"Fechamento por",className:"col-12",options:{data:"Data",categoria:"Categoria",formapagamento:"Forma de pagamento",produto:"Produto"},defaultValue:"data"}),p.a.createElement(Ne,{type:"date",id:"dtinicial",label:"Data inicial",className:"col-6",defaultValue:J()}),p.a.createElement(Ne,{type:"date",id:"dtfinal",label:"Data final",className:"col-6",defaultValue:J()})),p.a.createElement(M,null,p.a.createElement(T,{size:"6",className:"pr-0"},p.a.createElement(A,{text:"Gerar",block:!0,color:"green",icon:"file-play",onClick:this.gerar})),p.a.createElement(T,{size:"6",className:"pl-0"},p.a.createElement(A,{text:"Imprimir",block:!0,color:"blue",icon:"printer",onClick:this.imprimir,disabled:e}))))),p.a.createElement(it,{Pool:this.Pool,Printer:this.Printer,tipo:this.state.tipo,dtinicial:this.state.dtinicial,dtfinal:this.state.dtfinal,operacaoQuery:this.operacaoQuery,ativar:this.state.ativarFechamentoRelatorio}),p.a.createElement(st,{Pool:this.Pool,Printer:this.Printer,dtinicial:this.state.dtinicial,dtfinal:this.state.dtfinal,operacaoQuery:this.operacaoQuery,ativar:this.state.ativarFechamentoResumo}))}}]),t}(p.a.Component),it=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={dados:[]},a.tipoDescritivo=a.tipoDescritivo.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"carregarDados",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,l,u,d,p,m,h,f;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=void 0===t?this.props:t).ativar){e.next=3;break}return e.abrupt("return");case 3:a=null,e.t0=t.tipo,e.next="categoria"===e.t0?7:"data"===e.t0?9:"formapagamento"===e.t0?11:"produto"===e.t0?13:15;break;case 7:return a=["SELECT categoria.descricao,","  SUM(documentoproduto.quantidade) AS quantidade,","  SUM(documentoproduto.totalproduto) AS total","FROM documentoproduto","INNER JOIN documento USING (iddocumento)","INNER JOIN produto USING (idproduto)","INNER JOIN categoria USING (idcategoria)","WHERE documento.dthrcriacao::DATE BETWEEN $1 AND $2","  AND documento.status = 'A'","  AND documento.operacao IN "+t.operacaoQuery,"GROUP BY 1","ORDER BY 3 DESC"].join(" "),e.abrupt("break",16);case 9:return a=["SELECT TO_CHAR(documento.dthrcriacao, 'DD/MM/YYYY') AS descricao,","  SUM(documentoproduto.quantidade) AS quantidade,","  SUM(documentoproduto.totalproduto) AS total,","  documento.dthrcriacao::DATE AS dtcriacao","FROM documentoproduto","INNER JOIN documento USING (iddocumento)","WHERE documento.dthrcriacao::DATE BETWEEN $1 AND $2","  AND documento.status = 'A'","  AND documento.operacao IN "+t.operacaoQuery,"GROUP BY 1, 4","ORDER BY 4"].join(" "),e.abrupt("break",16);case 11:return a=["SELECT formapagamento.descricao,","  COUNT(documentopagamento.iddocumentopagamento) AS quantidade,","  SUM(documentopagamento.totalpagamento) AS total","FROM documentopagamento","INNER JOIN documento USING (iddocumento)","INNER JOIN formapagamento USING (idformapagamento)","WHERE documento.dthrcriacao::DATE BETWEEN $1 AND $2","  AND documento.status = 'A'","  AND documento.operacao IN "+t.operacaoQuery,"GROUP BY 1","ORDER BY 3 DESC"].join(" "),e.abrupt("break",16);case 13:return a=["SELECT produto.descricao,","  SUM(documentoproduto.quantidade) AS quantidade,","  SUM(documentoproduto.totalproduto) AS total","FROM documentoproduto","INNER JOIN documento USING (iddocumento)","INNER JOIN produto USING (idproduto)","WHERE documento.dthrcriacao::DATE BETWEEN $1 AND $2","  AND documento.status = 'A'","  AND documento.operacao IN "+t.operacaoQuery,"GROUP BY 1","ORDER BY 3 DESC"].join(" "),e.abrupt("break",16);case 15:return e.abrupt("break",16);case 16:return e.next=18,t.Pool.query(a,[t.dtinicial,t.dtfinal]);case 18:return o=e.sent,n=this.props.Printer.colunas,c=n-(i=6)-(s=10),l=this.tipoDescritivo().substr(0,c).rpad(c," "),l+="Qtde".substr(0,i).cpad(i," "),l+="Total".substr(0,s).lpad(s," "),e.next=28,this.props.Printer.texto(l,"left",!0);case 28:e.t1=r.a.keys(o.rows);case 29:if((e.t2=e.t1()).done){e.next=42;break}return u=e.t2.value,d=o.rows[u],p=d.descricao.removeSpecial(),m=d.quantidade.format(0,",","."),h=d.total.format(2,",","."),f=p.substr(0,c).rpad(c," "),f+=m.substr(0,i).cpad(i," "),f+=h.substr(0,s).lpad(s," "),e.next=40,this.props.Printer.texto(f);case 40:e.next=29;break;case 42:return e.next=44,this.props.Printer.alimentar(2);case 44:this.setState({dados:o.rows});case 45:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillUpdate",value:function(e){e!==this.props&&this.carregarDados(e)}},{key:"tipoDescritivo",value:function(){switch(this.props.tipo){case"categoria":return"Categoria";case"data":return"Data";case"formapagamento":return"Forma de pagamento";case"produto":return"Produto";default:return this.props.tipo}}},{key:"render",value:function(){if(!this.props.ativar||null===this.props.tipo)return null;var e=0,t=0;return p.a.createElement(M,{className:"mt-5"},p.a.createElement(T,{size:"8",offset:"2"},p.a.createElement("table",{className:"table table-striped"},p.a.createElement("thead",null,p.a.createElement("tr",null,p.a.createElement("th",null,this.tipoDescritivo()),p.a.createElement("th",{className:"text-center"},"Quantidade"),p.a.createElement("th",{className:"text-right"},"Total"))),p.a.createElement("tbody",null,this.state.dados.map((function(a,o){return e+=parseFloat(a.quantidade),t+=parseFloat(a.total),p.a.createElement("tr",{key:o},p.a.createElement("td",null,a.descricao),p.a.createElement("td",{className:"text-center"},a.quantidade.format(0,",",".")),p.a.createElement("td",{className:"text-right"},"R$ "+a.total.format(2,",",".")))}))),p.a.createElement("tfoot",null,p.a.createElement("tr",null,p.a.createElement("th",null),p.a.createElement("th",{className:"text-center"},e.format(0,",",".")),p.a.createElement("th",{className:"text-right"},"R$ "+t.format(2,",",".")))))))}}]),t}(p.a.Component),st=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={totalbruto:0,totalcancelado:0,qtdecancelado:0,totalativo:0,qtdeativo:0,totalorcamento:0},a.carregarDados=a.carregarDados.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"carregarDados",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=void 0===t?this.props:t).ativar){e.next=3;break}return e.abrupt("return");case 3:return a=["SELECT COALESCE((SELECT SUM(totaldocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND operacao IN ("+t.operacaoQuery+")), 0) AS totalbruto,","  COALESCE((SELECT SUM(totaldocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND status = 'C' AND operacao IN ("+t.operacaoQuery+")), 0) AS totalcancelado,","  COALESCE((SELECT COUNT(iddocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND status = 'C' AND operacao IN ("+t.operacaoQuery+")), 0) AS qtdecancelado,","  COALESCE((SELECT SUM(totaldocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND status = 'A' AND operacao IN ("+t.operacaoQuery+")), 0) AS totalativo,","  COALESCE((SELECT COUNT(iddocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND status = 'A' AND operacao IN ("+t.operacaoQuery+")), 0) AS qtdeativo,","  COALESCE((SELECT SUM(totaldocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND status = 'A' AND operacao IN ('OR')), 0) AS totalorcamento"].join(" "),e.next=6,t.Pool.query(a,[t.dtinicial,t.dtfinal]);case 6:return o=e.sent,n=o.rows[0],i=15,s=this.props.Printer.colunas-i,e.next=12,this.props.Printer.texto("RESUMO","center",!0);case 12:return e.next=14,this.props.Printer.texto("Total bruto das vendas".rpad(s," ")+n.totalbruto.format(2,",",".").lpad(i," "));case 14:return e.next=16,this.props.Printer.texto("Total de vendas canceladas".rpad(s," ")+n.totalcancelado.format(2,",",".").lpad(i," "));case 16:return e.next=18,this.props.Printer.texto("Quantidade de vendas canceladas".rpad(s," ")+n.qtdecancelado.format(0,",",".").lpad(i," "));case 18:return e.next=20,this.props.Printer.texto("Total liquido das vendas".rpad(s," ")+n.totalativo.format(2,",",".").lpad(i," "));case 20:return e.next=22,this.props.Printer.texto("Quantidade de vendas".rpad(s," ")+n.qtdeativo.format(0,",",".").lpad(i," "));case 22:return e.next=24,this.props.Printer.texto("Total liquido das vendas".rpad(s," ")+(n.totalativo/n.qtdeativo).format(2,",",".").lpad(i," "));case 24:return e.next=26,this.props.Printer.texto("Total bruto dos orcamentos".rpad(s," ")+n.totalorcamento.format(2,",",".").lpad(i," "));case 26:return e.next=28,this.props.Printer.alimentar(2);case 28:this.setState({totalbruto:n.totalbruto,totalcancelado:n.totalcancelado,qtdecancelado:n.qtdecancelado,totalativo:n.totalativo,qtdeativo:n.qtdeativo,totalorcamento:n.totalorcamento});case 29:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillUpdate",value:function(e){e!==this.props&&this.carregarDados(e)}},{key:"render",value:function(){return this.props.ativar&&null!==this.props.dtinicial&&null!==this.props.dtfinal?p.a.createElement("div",{className:"mb-5"},p.a.createElement(We,{text:"Resumo"}),p.a.createElement(M,null,p.a.createElement(T,{size:"8",offset:"2"},p.a.createElement("table",{className:"table table-striped"},p.a.createElement("tbody",null,p.a.createElement("tr",null,p.a.createElement("td",null,"Total bruto das vendas"),p.a.createElement("td",{className:"text-right"},"R$ "+this.state.totalbruto.format(2,",","."))),p.a.createElement("tr",null,p.a.createElement("td",null,"Total de vendas canceladas"),p.a.createElement("td",{className:"text-right"},"R$ "+this.state.totalcancelado.format(2,",","."))),p.a.createElement("tr",null,p.a.createElement("td",null,"Quantidade de vendas canceladas"),p.a.createElement("td",{className:"text-right"},this.state.qtdecancelado)),p.a.createElement("tr",null,p.a.createElement("td",null,"Total liquido de vendas"),p.a.createElement("td",{className:"text-right"},"R$ "+this.state.totalativo.format(2,",","."))),p.a.createElement("tr",null,p.a.createElement("td",null,"Quantidade de vendas"),p.a.createElement("td",{className:"text-right"},this.state.qtdeativo)),p.a.createElement("tr",null,p.a.createElement("td",null,"Ticket m\xe9dio das vendas"),p.a.createElement("td",{className:"text-right"},"R$ "+(this.state.totalativo/this.state.qtdeativo).format(2,",","."))),p.a.createElement("tr",null,p.a.createElement("td",null,"Total dos or\xe7amentos"),p.a.createElement("td",{className:"text-right"},"R$ "+this.state.totalorcamento.format(2,",",".")))))))):null}}]),t}(p.a.Component),ct=a(278),lt=a.n(ct),ut=window.require("electron"),dt=function(){function e(t){Object(i.a)(this,e),this.Pool=t}return Object(s.a)(e,[{key:"corAleatoria",value:function(){var e=["#b71c1c","#d32f2f","#f44336","#e57373","#ffcdd2","#880e4f","#c2185b","#e91e63","#f06292","#f8bbd0","#4a148c","#7b1fa2","#9c27b0","#ba68c8","#e1bee7","#311b92","#512da8","#673ab7","#9575cd","#d1c4e9","#1a237e","#303f9f","#3f51b5","#7986cb","#c5cae9","#0d47a1","#1976d2","#2196f3","#64b5f6","#bbdefb","#01579b","#0288d1","#03a9f4","#4fc3f7","#b3e5fc","#006064","#0097a7","#00bcd4","#4dd0e1","#b2ebf2","#004d40","#00796b","#009688","#4db6ac","#b2dfdb","#194D33","#388e3c","#4caf50","#81c784","#c8e6c9","#33691e","#689f38","#8bc34a","#aed581","#dcedc8","#827717","#afb42b","#cddc39","#dce775","#f0f4c3","#f57f17","#fbc02d","#ffeb3b","#fff176","#fff9c4","#ff6f00","#ffa000","#ffc107","#ffd54f","#ffecb3","#e65100","#f57c00","#ff9800","#ffb74d","#ffe0b2","#bf360c","#e64a19","#ff5722","#ff8a65","#ffccbc","#3e2723","#5d4037","#795548","#a1887f","#d7ccc8","#263238","#455a64","#607d8b","#90a4ae","#cfd8dc","#000000","#525252","#969696","#D9D9D9","#FFFFFF"];return e[Math.floor(Math.random()*e.length)]}},{key:"incluirCategoria",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a){var o,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.corAleatoria(),"INSERT INTO categoria (descricao, idncm, sinctributacao, cor) VALUES ($1, $2, $3, $4) RETURNING idcategoria",e.next=4,t.query("INSERT INTO categoria (descricao, idncm, sinctributacao, cor) VALUES ($1, $2, $3, $4) RETURNING idcategoria",[a.descricao,a.idncm,"S",o]);case 4:return n=e.sent,e.abrupt("return",n.rows[0].idcategoria);case 6:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"incluirProduto",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a){var o,n,i,s,c,l,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(a),a.balanca&&(a.balanca=a.balanca.substr(0,1).toUpperCase()),a.precovariavel&&(a.precovariavel=a.precovariavel.substr(0,1).toUpperCase()),a.preco&&(a.preco=a.preco.toFloat()),a.aliqicms&&(a.aliqicms=a.aliqicms.toFloat()),a.aliqpis&&(a.aliqpis=a.aliqpis.toFloat()),a.aliqcofins&&(a.aliqcofins=a.aliqcofins.toFloat()),a.idunidade="S"===a.balanca?2:1,delete a.balanca,a.preco||(a.preco=0),a.codigoncm&&(a.codigoncm=String(a.codigoncm).removeFormat(),a.codigoncm=a.codigoncm.substr(0,4)+"."+a.codigoncm.substr(4,2)+"."+a.codigoncm.substr(6,2)),a.cest&&(a.cest=a.cest.removeFormat(),a.cest=a.cest.substr(0,2)+"."+a.cest.substr(2,4)+"."+a.cest.substr(6,2)),a.cfop&&(a.cfop=a.cfop.removeFormat(),a.cfop=a.cfop.substr(0,1)+"."+a.cfop.substr(1,3)),console.log([a.csosn,a.cstpis,a.cstcofins,a.csosn||a.cstpis||a.cstcofins]),a.csosn||a.cstpis||a.cstcofins?a.sinctributacao="N":a.sinctributacao="S",!a.codigoncm||a.idncm){e.next=22;break}return e.next=18,t.query("SELECT idncm FROM ncm WHERE codigoncm = $1",[a.codigoncm]);case 18:if(0!==(o=e.sent).rows.length){e.next=21;break}throw new Error("O NCM "+a.codigoncm+" n\xe3o foi encontrado na base de NCMs do SAT-Flex.");case 21:a.idncm=o.rows[0].idncm;case 22:if(!a.categoria||a.idcateogria){e.next=33;break}return e.next=25,t.query("SELECT idcategoria FROM categoria WHERE descricao = $1",[a.categoria]);case 25:if(0!==(n=e.sent).rows.length){e.next=32;break}return e.next=29,this.incluirCategoria(t,{descricao:a.categoria,idncm:a.idncm});case 29:a.idcategoria=e.sent,e.next=33;break;case 32:a.idcategoria=n.rows[0].idcategoria;case 33:for(delete a.codigoncm,delete a.categoria,i=Object.keys(a),s=Object.values(a),c=[],l=1;l<=s.length;l++)c.push("$"+String(l));return u="INSERT INTO produto ("+i.join(", ")+") VALUES ("+c.join(", ")+")",e.next=42,t.query(u,s);case 42:this.importados++;case 43:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"processarPlanilha",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a){var o,n,i,s,c,l,u,d,p,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Pool.connect();case 2:if(o=e.sent,e.prev=3,o.query("BEGIN"),n=lt.a.parse(t),(i=n[0].data).shift(),"object"===typeof i&&0!==i.length&&0!==i[0].length){e.next=10;break}throw new Error("Nenhum produto foi encontrado na planilha.");case 10:s=!0,c=!1,l=void 0,e.prev=13,u=i[Symbol.iterator]();case 15:if(s=(d=u.next()).done){e.next=25;break}if((p=d.value)[0]){e.next=19;break}return e.abrupt("continue",22);case 19:return m={descricao:p[0],categoria:p[1],codigoean:p[2],balanca:p[3],precovariavel:p[4],preco:p[5],codigoncm:p[6],origem:p[7],csosn:p[8],aliqicms:p[9],cstpis:p[10],aliqpis:p[11],cstcofins:p[12],aliqcofins:p[13],codcontribsocial:p[14],cest:p[15],cfop:p[16]},e.next=22,this.incluirProduto(o,m);case 22:s=!0,e.next=15;break;case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(13),c=!0,l=e.t0;case 31:e.prev=31,e.prev=32,s||null==u.return||u.return();case 34:if(e.prev=34,!c){e.next=37;break}throw l;case 37:return e.finish(34);case 38:return e.finish(31);case 39:return e.next=41,o.query("COMMIT");case 41:a(),e.next=49;break;case 44:return e.prev=44,e.t1=e.catch(3),e.next=48,o.query("ROLLBACK");case 48:a(e.t1);case 49:return e.prev=49,o.release(),e.finish(49);case 52:case"end":return e.stop()}}),e,this,[[3,44,49,52],[13,27,31,39],[32,,34,38]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"selecionarPlanilha",value:function(){var e=this;ut.remote.dialog.showOpenDialog({title:"Selecone a planilha de produtos",filters:[{name:"MS-Excel",extensions:["xls","xlsx"]}]},(function(t){t&&t.length>0&&(e.importados=0,window.Loading.show(),e.processarPlanilha(t[0],(function(t){if(window.Loading.hide(),t)return Z(t);window.MessageBox.show({title:"Planilha importada com sucesso!",text:"A planilha de produtos foi importada com sucesso.<br>Total de produtos: "+String(e.importados)})})))}))}}]),e}(),pt=window.require("electron"),mt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={redirect:null},a.descobrirPortaImpressora=a.descobrirPortaImpressora.bind(Object(C.a)(a)),a.importarPlanilha=a.importarPlanilha.bind(Object(C.a)(a)),a.Pool=new pe,a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"consoleDesenvolvedor",value:function(){pt.remote.getCurrentWebContents().openDevTools()}},{key:"descobrirPortaImpressora",value:function(){var e=this;window.Loading.show(),new Promise(function(){var t=Object(n.a)(r.a.mark((function t(a){var o,n,i,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=new rt(e.Pool),n=1;case 2:if(!(n<=20)){t.next=16;break}return i="COM"+String(n),s="Porta configurada para impressora: "+i+" ".repeat(90),t.prev=5,t.next=8,o.imprimir(i,s,"escpos");case 8:t.next=13;break;case 10:return t.prev=10,t.t0=t.catch(5),t.abrupt("continue",13);case 13:n++,t.next=2;break;case 16:a();case 17:case"end":return t.stop()}}),t,null,[[5,10]])})));return function(e){return t.apply(this,arguments)}}()).then((function(){window.Loading.hide(),window.FastMessage.show("Texto enviado para as portas COM")}))}},{key:"importarPlanilha",value:function(){new dt(this.Pool).selecionarPlanilha()}},{key:"render",value:function(){return p.a.createElement(me,null,p.a.createElement(Ae,null,"Ferramentas"),p.a.createElement(M,null,p.a.createElement(T,{size:"8",offset:"2"},p.a.createElement(M,null,p.a.createElement(T,{size:"6",className:"mb-4"},p.a.createElement(A,{text:"Descobrir porta<br>COM da impressora",icon:"printer",size:"xxl",block:!0,onClick:this.descobrirPortaImpressora})),p.a.createElement(T,{size:"6",className:"mb-4"},p.a.createElement(A,{text:"Importar planilha<br>de produtos",icon:"download",size:"xxl",block:!0,onClick:this.importarPlanilha})),p.a.createElement(T,{size:"6",className:"mb-4"},p.a.createElement(A,{text:"Abrir console de<br>desenvolvedor",icon:"embed2",size:"xxl",block:!0,onClick:this.consoleDesenvolvedor}))))))}}]),t}(p.a.Component),ht=(a(643),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=["list-group"];return this.props.className&&e.push(this.props.className),p.a.createElement("div",{className:e.join(" ")},this.props.children)}}]),t}(p.a.Component)),ft=(a(644),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=Object.assign({},this.props),t=["list-group-item"];return e.className&&t.push(e.className),e.active&&t.push("active"),delete e.active,delete e.className,p.a.createElement("div",Object.assign({className:t.join(" ")},e),e.children)}}]),t}(p.a.Component)),vt=(a(645),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={listaGrupo:[],listaParametro:[],grupoAtivo:null,parametroAtivo:null,idparametro:null,valor:null,observacao:null},a.ajustarAltura=a.ajustarAltura.bind(Object(C.a)(a)),a.carregarListaGrupo=a.carregarListaGrupo.bind(Object(C.a)(a)),a.carregarListaParametro=a.carregarListaParametro.bind(Object(C.a)(a)),a.carregarParametro=a.carregarParametro.bind(Object(C.a)(a)),a.gravar=a.gravar.bind(Object(C.a)(a)),a.onChangeValor=a.onChangeValor.bind(Object(C.a)(a)),a.Pool=new pe,a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"ajustarAltura",value:function(){b()("#content .list-group").each((function(){var e=window.innerHeight-b()(this).offset().top-30;b()(this).height(e)}))}},{key:"carregarListaGrupo",value:function(){var e=this;this.Pool.query("SELECT DISTINCT grupo FROM parametro WHERE visivel = 'S' ORDER BY grupo",[],(function(t,a){if(t)return Z(t.message),!1;e.setState({listaGrupo:a.rows})}))}},{key:"carregarListaParametro",value:function(e){var t=this;this.Pool.query("SELECT idparametro, nome FROM parametro WHERE visivel = 'S' AND grupo = $1 ORDER BY ordem, nome",[e],(function(a,o){if(a)return Z(a.message),!1;t.setState({listaParametro:o.rows,grupoAtivo:e,parametroAtivo:null,idparametro:null,valor:null,observacao:null})}))}},{key:"carregarParametro",value:function(e){var t=this;this.Pool.query("SELECT idparametro, valor, observacao FROM parametro WHERE idparametro = $1",[e],(function(a,o){if(a)return Z(a.message),!1;var r=o.rows.shift();t.setState({parametroAtivo:e,idparametro:r.idparametro,valor:r.valor,observacao:r.observacao})}))}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.ajustarAltura),this.ajustarAltura(),this.carregarListaGrupo()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.ajustarAltura)}},{key:"gravar",value:function(){this.Pool.query("UPDATE parametro SET valor = $1 WHERE idparametro = $2",[this.state.valor,this.state.idparametro],(function(e){if(e)return Z(e.message),!1;window.FastMessage.show("Par\xe2metro atualizado com sucesso!")}))}},{key:"onChangeValor",value:function(e){this.setState({valor:e.target.value})}},{key:"render",value:function(){var e=this,t=null;return this.state.observacao&&(t=this.state.observacao.replaceAll("\\n","<br>")),p.a.createElement(me,{className:"Parametro"},p.a.createElement(Ae,null,"Par\xe2metros do sistema"),p.a.createElement(M,null,p.a.createElement(T,{size:"3",offset:"1"},p.a.createElement(ht,null,this.state.listaGrupo.map((function(t,a){return p.a.createElement(ft,{key:a,active:e.state.grupoAtivo===t.grupo,onClick:function(){e.carregarListaParametro(t.grupo)}},t.grupo)})))),p.a.createElement(T,{size:"3"},p.a.createElement(ht,null,this.state.listaParametro.map((function(t,a){return p.a.createElement(ft,{key:a,active:e.state.parametroAtivo===t.idparametro,onClick:function(){e.carregarParametro(t.idparametro)}},t.nome)})))),p.a.createElement(T,{size:"4"},p.a.createElement(we,{type:"textarea",rows:"7",value:this.state.valor,onChange:this.onChangeValor,disabled:!this.state.idparametro}),p.a.createElement(A,{text:"Gravar altera\xe7\xf5es",icon:"floppy-disk",color:"green",size:"lg",block:!0,className:"mt-2 mb-2",disabled:!this.state.idparametro,onClick:this.gravar}),p.a.createElement("div",{className:"observacao"+(t?"":" d-none"),dangerouslySetInnerHTML:{__html:t}}))))}}]),t}(p.a.Component)),bt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={show:a.props.show,showDiv:null,title:null},a.cancelar=a.cancelar.bind(Object(C.a)(a)),a.changeDiv=a.changeDiv.bind(Object(C.a)(a)),a.changeTitle=a.changeTitle.bind(Object(C.a)(a)),a.excluir=a.excluir.bind(Object(C.a)(a)),a.gravar=a.gravar.bind(Object(C.a)(a)),a.limpar=a.limpar.bind(Object(C.a)(a)),a.onChangeCategoria=a.onChangeCategoria.bind(Object(C.a)(a)),a.onChangeInput=a.onChangeInput.bind(Object(C.a)(a)),a.onChangeSincTributacao=a.onChangeSincTributacao.bind(Object(C.a)(a)),a.sincronizarTributacao=a.sincronizarTributacao.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"cancelar",value:function(){this.setState({show:!1,showDiv:null})}},{key:"carregar",value:function(e,t){var a=this,o=["SELECT produto.descricao, produto.dthrcriacao,","  produto.idcategoria, produto.codigoean, produto.idunidade,","  produto.precovariavel, produto.preco, produto.status,","  produto.sinctributacao, ncm.codigoncm, produto.origem,","  produto.cfop, produto.csosn, produto.aliqicms, ","  produto.cstpis, produto.aliqpis, produto.cstcofins, ","  produto.aliqcofins, produto.codcontribsocial, produto.cest","FROM produto","LEFT JOIN ncm USING (idncm)","WHERE produto.idproduto = $1"].join(" ");this.props.Pool.query(o,[e],(function(e,o){if(e)return Z(e.message),!1;if(0===o.rows.length)return window.MessageBox.show({title:"Produto n\xe3o encontrado",text:"O produto selecionado n\xe3o p\xf4de ser encontrado."}),!1;var r={},n=o.rows[0];for(var i in n){var s=n[i];switch(i){case"dthrcriacao":s=s.toLocaleString();break;case"preco":case"aliqicms":case"aliqpis":case"aliqcofins":s=s.format(2,",",".")}r["input_"+i]=s}a.setState(r),"function"===typeof t&&t()}))}},{key:"changeDiv",value:function(e){this.setState({showDiv:e})}},{key:"changeTitle",value:function(e){var t=this;e.idproduto?e.Pool.query("SELECT descricao FROM produto WHERE idproduto = $1",[e.idproduto],(function(e,a){if(e)return Z(e.message),!1;t.setState({title:"Alterando produto: "+a.rows[0].descricao})})):this.setState({title:"Criando novo produto"})}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(!e.show)return!1;this.changeTitle(e);var a=function(){t.setState({show:e.show},(function(){setTimeout((function(){t.changeDiv("principal")}),1e3)}))};e.idproduto?this.carregar(e.idproduto,a):(this.limpar(),a())}},{key:"excluir",value:function(){var e=this;window.MessageBox.show({title:"Exclu\xedr produto",text:"Tem certeza que deseja exclu\xedr o produto <b>"+this.state.input_descricao+"</b>?",buttons:[{text:"Sim",icon:"thumbs-up",color:"green",onClick:function(){window.MessageBox.hide(),e.props.Pool.query("DELETE FROM produto WHERE idproduto = $1",[e.props.idproduto],(function(t,a){if(t)return Z(t.message),!1;e.setState({show:!1}),window.FastMessage.show("Produto exclu\xeddo com sucesso.")}))}},{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:function(){window.MessageBox.hide()}}]})}},{key:"gravar",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,l,u,d,p,m,h=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=null,a=[],o=[],e.t0=r.a.keys(this.state);case 4:if((e.t1=e.t0()).done){e.next=37;break}if("input_"!==(n=e.t1.value).substr(0,6)){e.next=35;break}if(i=n.replace("input_",""),s=this.state[n],"codigoncm"!==i||!s){e.next=25;break}return e.prev=10,e.next=13,this.props.Pool.query("SELECT idncm FROM ncm WHERE codigoncm = $1",[s]);case 13:if(0!==(c=e.sent).rows.length){e.next=17;break}return window.MessageBox.show({title:"NCM inexistente",text:"O c\xf3digo de NCM "+s+" n\xe3o p\xf4de ser encontrado.<br>Verifique se foi informado corretamente."}),e.abrupt("return",!1);case 17:i="idncm",s=c.rows[0].idncm,e.next=25;break;case 21:return e.prev=21,e.t2=e.catch(10),Z(e.t2.message),e.abrupt("return",!1);case 25:if(!(["idproduto","dthrcriacao"].indexOf(i)>-1)){e.next=27;break}return e.abrupt("continue",4);case 27:e.t3=i,e.next="preco"===e.t3?30:"aliqicms"===e.t3?30:"aliqpis"===e.t3?30:"aliqcofins"===e.t3?30:32;break;case 30:return s&&(s=s.toFloat()),e.abrupt("break",33);case 32:return e.abrupt("break",33);case 33:a.push(i),o.push(s);case 35:e.next=4;break;case 37:if(this.props.idproduto){for(d in l=1,u=[],a)u.push(a[d]+" = $"+l++);t="UPDATE produto SET "+u.join(", ")+" WHERE idproduto = "+this.props.idproduto}else{for(p=[],m=0;m<a.length;m++)p.push("$"+(m+1));t="INSERT INTO produto ("+a.join(", ")+") VALUES ("+p.join(", ")+")"}this.props.Pool.query(t,o,(function(e,t){if(e)return Z(e.message),!1;h.setState({show:!1}),window.FastMessage.show("Produto gravado com sucesso.")}));case 39:case"end":return e.stop()}}),e,this,[[10,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"limpar",value:function(){var e={};for(var t in this.state)"input_"===t.substr(0,6)&&(e[t]=null);this.setState(e)}},{key:"onChangeCategoria",value:function(e){var t=this;this.onChangeInput(e,(function(){t.sincronizarTributacao()}))}},{key:"onChangeInput",value:function(e,t){var a=e.target,o=a.id.replace("modalproduto-",""),r=a.value;"checkbox"===a.type&&(r=a.checked?"S":"N"),this.setState(Object(Se.a)({},"input_"+o,r),t)}},{key:"onChangeSincTributacao",value:function(e){var t=this;this.onChangeInput(e,(function(){t.sincronizarTributacao()}))}},{key:"sincronizarTributacao",value:function(){var e=this;if("S"!==this.state.input_sinctributacao)return!0;var t=["SELECT ncm.codigoncm, categoria.origem,","  categoria.cfop, categoria.csosn, categoria.aliqicms, ","  categoria.cstpis, categoria.aliqpis, categoria.cstcofins, ","  categoria.aliqcofins, categoria.codcontribsocial, categoria.cest","FROM categoria","LEFT JOIN ncm USING (idncm)","WHERE categoria.idcategoria = $1"].join(" ");this.props.Pool.query(t,[this.state.input_idcategoria],(function(t,a){if(t)return Z(t.message),!1;if(0===a.rows.length)return window.MessageBox.show({title:"Categoria n\xe3o encontrada",text:"A categoria informada no produto n\xe3o p\xf4de ser encontrada."}),!1;var o={},r=a.rows[0];for(var n in r){var i=r[n];switch(n){case"aliqicms":case"aliqpis":case"aliqcofins":i=i.format(2,",",".")}o["input_"+n]=i}e.setState(o)}))}},{key:"shouldComponentUpdate",value:function(e){return e.show}},{key:"render",value:function(){var e=this;return p.a.createElement(I,{title:this.state.title,size:"lg",show:this.state.show,beforeClose:this.props.beforeClose,afterClose:this.props.afterClose,closeOnOutClick:!1},p.a.createElement("div",{className:"principal"!==this.state.showDiv?"d-none":""},p.a.createElement(M,null,p.a.createElement(Ne,{type:"text",id:"modalproduto-descricao",className:"col-8",label:"Descri\xe7\xe3o",value:this.state.input_descricao,onChange:this.onChangeInput}),p.a.createElement(Ne,{type:"text",id:"modalproduto-dthrcriacao",className:"col-4",label:"Criado em",readOnly:!0,value:this.state.input_dthrcriacao,onChange:this.onChangeInput,disabled:!0}),p.a.createElement(Ne,{type:"select",id:"modalproduto-idcategoria",className:"col-5",label:"Categoria",dbtable:"categoria",dbcolumn:"descricao",Pool:this.props.Pool,value:this.state.input_idcategoria,onChange:this.onChangeCategoria}),p.a.createElement(Ne,{type:"text",id:"modalproduto-codigoean",className:"col-4",label:"C\xf3digo EAN",value:this.state.input_codigoean,onChange:this.onChangeInput}),p.a.createElement(Ne,{type:"select",id:"modalproduto-idunidade",className:"col-3",label:"Unidade de venda",dbtable:"unidade",dbcolumn:"descricao",Pool:this.props.Pool,value:this.state.input_idunidade,onChange:this.onChangeInput}),p.a.createElement(Ne,{type:"select",id:"modalproduto-precovariavel",className:"col-3",label:"Pre\xe7o vari\xe1vel",options:{S:"Sim",N:"N\xe3o"},value:this.state.input_precovariavel,onChange:this.onChangeInput}),p.a.createElement(Ne,{type:"text",id:"modalproduto-preco",className:"col-3",inputClassName:"text-center",label:"Pre\xe7o de venda",InformarValor:{money:!0,decimal:2},value:this.state.input_preco,onChange:this.onChangeInput,disabled:"S"===this.state.input_precovariavel}),p.a.createElement(Ne,{type:"select",id:"modalproduto-status",className:"col-3",label:"Status",options:{A:"Ativo",I:"Inativo"},value:this.state.input_status,onChange:this.onChangeInput}),p.a.createElement(T,{size:"3",labelMargin:!0},p.a.createElement(A,{text:"Tributa\xe7\xf5es...",icon:"file-text",color:"blue",block:!0,onClick:function(){e.changeDiv("tributacao")}}))),p.a.createElement(Pe,{className:"mt-0"}),p.a.createElement(M,null,p.a.createElement(T,{size:"6"},p.a.createElement(A,{text:"Exclu\xedr",icon:"bin",color:"red",onClick:this.excluir,className:this.props.idproduto?"":"d-none"})),p.a.createElement(T,{size:"6",className:"text-right"},p.a.createElement(A,{text:"Cancelar",icon:"undo",color:"red",onClick:this.cancelar}),p.a.createElement(A,{text:"Gravar produto",icon:"thumbs-up",color:"green",className:"ml-2",onClick:this.gravar})))),p.a.createElement("div",{className:"tributacao"!==this.state.showDiv?"d-none":""},p.a.createElement(M,null,p.a.createElement(T,{size:"12"},p.a.createElement(we,{type:"checkbox",id:"modalproduto-sinctributacao",label:"Usar as mesmas tributa\xe7\xf5es da categoria",className:"col-12",value:this.state.input_sinctributacao,onChange:this.onChangeSincTributacao})),p.a.createElement(Ne,{type:"text",id:"modalproduto-codigoncm",label:"NCM do produto",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"9999.99.99"},value:this.state.input_codigoncm,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"select",id:"modalproduto-origem",className:"col-6",label:"Origem do produto",options:{0:"0 - Nacional, exceto as indicadas nos c\xf3digos 3, 4, 5 e 8",1:"1 - Estrangeira - Importa\xe7\xe3o direta, exceto a indicada no c\xf3digo 6",2:"2 - Estrangeira - Adquirida no mercado interno, exceto a indicada no c\xf3digo 7",3:"3 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o superior a 40% e inferior ou igual a 70%",4:"4 - Nacional, cuja produ\xe7\xe3o tenha sido feita em conformidade com os processos produtivos b\xe1sicos de que tratam o Decreto-Lei n\xba 288/67, e as Leis n\xbas 8.248/91, 8.387/91, 10.176/01 e 11.484/ 07",5:"5 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o inferior ou igual a 40%",6:"6 - Estrangeira - Importa\xe7\xe3o direta, sem similar nacional, constante em lista da Resolu\xe7\xe3o CAMEX n\xba 79/2012 e g\xe1s natural",7:"7 - Estrangeira - Adquirida no mercado interno, sem similar nacional, constante em lista da Resolu\xe7\xe3o CAMEX n\xba 79/2012 e g\xe1s natural",8:"8 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o superior a 70%"},value:this.state.input_origem,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalproduto-cfop",label:"CFOP",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"9.999"},value:this.state.input_cfop,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"select",id:"modalproduto-csosn",className:"col-3",inputClassName:"text-center",label:"CSOSN",options:{102:"102",300:"300",400:"400",500:"500"},value:this.state.input_csosn,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalproduto-aliqicms",label:"Al\xedquota de ICMS",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqicms,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalproduto-cstpis",label:"CST do PIS",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_cstpis,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalproduto-aliqpis",label:"Al\xedquota de PIS",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqpis,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalproduto-cstcofins",label:"CST do Cofins",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_cstcofins,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalproduto-aliqcofins",label:"Al\xedquota de Cofins",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqcofins,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalproduto-codcontribsocial",label:"Contribui\xe7\xe3o social",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_codcontribsocial,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(Ne,{type:"text",id:"modalproduto-cest",label:"CEST",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99.999.99"},value:this.state.input_cest,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),p.a.createElement(T,{size:"12",className:"text-right"},p.a.createElement(A,{text:"Voltar para o produto...",icon:"file-text",color:"blue",onClick:function(){e.changeDiv("principal")}})))))}}]),t}(p.a.Component),gt=(a(646),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={dataGrid:[],pesquisa:"",idproduto:null,showModalProduto:!1,redirectToCategoria:!1},a.beforeCloseModal=a.beforeCloseModal.bind(Object(C.a)(a)),a.loadDataGrid=a.loadDataGrid.bind(Object(C.a)(a)),a.novoProduto=a.novoProduto.bind(Object(C.a)(a)),a.onChangePesquisa=a.onChangePesquisa.bind(Object(C.a)(a)),a.onClickBtnCategoria=a.onClickBtnCategoria.bind(Object(C.a)(a)),a.onKeyUpPesquisa=a.onKeyUpPesquisa.bind(Object(C.a)(a)),a.pesquisaLimpar=a.pesquisaLimpar.bind(Object(C.a)(a)),a.Pool=new pe,a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"beforeCloseModal",value:function(){var e=this;this.setState({showModalProduto:!1},(function(){e.loadDataGrid()}))}},{key:"carregarProduto",value:function(e){this.setState({showModalProduto:!0,idproduto:e})}},{key:"componentDidMount",value:function(){this.loadDataGrid()}},{key:"componentWillUnmount",value:function(){this.Pool.end()}},{key:"loadDataGrid",value:function(){var e=this,t=["SELECT produto.idproduto, produto.descricao, categoria.descricao AS categoria,","  produto.preco, produto.codigoean, produto.dthrcriacao","FROM produto","LEFT JOIN categoria USING (idcategoria)","WHERE produto.descricao ILIKE '%'||$1||'%'","  OR produto.codigoean ILIKE '%'||$1||'%'","ORDER BY produto.descricao"].join(" ");this.Pool.query(t,[this.state.pesquisa],(function(t,a){if(t)return Z(t.message),!1;var o=[],r=function(t){var r=a.rows[t];o.push({data:[{text:r.descricao,align:"left"},{text:r.categoria,align:"left"},{text:r.preco.format(2,",","."),align:"center"},{text:r.codigoean,align:"center"},{text:r.dthrcriacao.toLocaleString(),align:"center"}],onClick:function(){e.carregarProduto(r.idproduto)}})};for(var n in a.rows)r(n);e.setState({dataGrid:o})}))}},{key:"novoProduto",value:function(){this.setState({showModalProduto:!0,idproduto:null})}},{key:"onChangePesquisa",value:function(e){this.setState({pesquisa:e.target.value})}},{key:"onClickBtnCategoria",value:function(){this.setState({redirectToCategoria:!0})}},{key:"onKeyUpPesquisa",value:function(e){13===e.keyCode&&this.loadDataGrid()}},{key:"pesquisaLimpar",value:function(){var e=this;this.setState({pesquisa:""},(function(){e.loadDataGrid()}))}},{key:"render",value:function(){if(this.state.redirectToCategoria)return p.a.createElement(ue.a,{to:"/categoria"});return p.a.createElement(me,null,p.a.createElement(Ae,{model:"2"},"Cadastro de ",p.a.createElement("b",null,"Produtos")),p.a.createElement(M,{className:"mb-4"},p.a.createElement(T,{size:"4"},p.a.createElement(we,{type:"search",id:"pesquisa",value:this.state.pesquisa,placeholder:"Pesquise um produto...",onKeyUp:this.onKeyUpPesquisa,onChange:this.onChangePesquisa}),p.a.createElement(O,{name:"cross",id:"pesquisa-limpar",onClick:this.pesquisaLimpar,className:this.state.pesquisa.length>0?null:"d-none"})),p.a.createElement(T,{size:"2",className:"pl-0"},p.a.createElement(A,{text:"Buscar",icon:"search",color:"green",onClick:this.loadDataGrid})),p.a.createElement(T,{size:"6",className:"text-right"},p.a.createElement(A,{text:"Categorias",icon:"layers",color:"blue",className:"mr-3",onClick:this.onClickBtnCategoria}),p.a.createElement(A,{text:"Novo produto",icon:"plus",color:"green",onClick:this.novoProduto}))),p.a.createElement(he,{header:[{text:"Descri\xe7\xe3o",align:"left"},{text:"Categoria",align:"left"},{text:"Pre\xe7o",align:"center"},{text:"EAN",align:"left"},{text:"Criado em",align:"center"}],data:this.state.dataGrid}),p.a.createElement(bt,{Pool:this.Pool,show:this.state.showModalProduto,idproduto:this.state.idproduto,beforeClose:this.beforeCloseModal}))}}]),t}(p.a.Component)),Et=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={redirect:null},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return this.state.redirect?p.a.createElement(ue.a,{to:this.state.redirect}):p.a.createElement(me,null,p.a.createElement(Ae,null,"Relat\xf3rios"),p.a.createElement(M,null,p.a.createElement(T,{size:"3",offset:"3"},p.a.createElement(A,{text:"Fechamento",icon:"calendar",size:"xxl",block:!0,onClick:function(){e.setState({redirect:"/fechamento"})}})),p.a.createElement(T,{size:"3"},p.a.createElement(A,{text:"Estat\xedsticas",icon:"chart-dots",size:"xxl",block:!0,onClick:function(){e.setState({redirect:"/estatistica"})}}))),p.a.createElement(M,{className:"mt-4"},p.a.createElement(T,{size:"3",offset:"3"},p.a.createElement(A,{text:"Or\xe7amentos",icon:"files-empty",size:"xxl",block:!0,onClick:function(){e.setState({redirect:"/relorcamento"})}}))))}}]),t}(p.a.Component),xt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={dtinicial:null,dtfinal:null,redirect:null},a.acaoOrcamento=a.acaoOrcamento.bind(Object(C.a)(a)),a.gerar=a.gerar.bind(Object(C.a)(a)),a.imprimir=a.imprimir.bind(Object(C.a)(a)),a.Pool=new pe,a.Printer=new rt(a.Pool),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"acaoOrcamento",value:function(e){var t=this,a=["N\xfamero: "+String(e.iddocumento).lpad(6,"0"),"Cliente: "+(e.nomeorcamento?e.nomeorcamento:""),"Quantidade: "+e.totalquantidade.format(X(e.totalquantidade),",","."),"Total: R$ "+e.totaldocumento.format(2,",",".")].join("<br>");window.MessageBox.show({title:"O que voc\xea deseja fazer com o or\xe7amento?",text:a,size:"lg",buttons:[{text:"Efetivar or\xe7amento",color:"green",icon:"thumbs-up",onClick:function(){window.MessageBox.hide(),t.setState({redirect:"venda/"+e.iddocumento})}},{text:"Excluir",color:"red",icon:"bin",className:"btn-sm",onClick:function(){window.MessageBox.show({title:"Exclus\xe3o de or\xe7amento",text:"Tem certeza que deseja exclu\xedr o or\xe7amento?<br>Essa a\xe7\xe3o n\xe3o poder\xe1 ser desfeita.",buttons:[{text:"Sim",color:"green",icon:"thumbs-up",onClick:function(){var a=Object(n.a)(r.a.mark((function a(){return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return window.MessageBox.hide(),window.Loading.show(),a.prev=2,a.next=5,t.Pool.query("DELETE FROM documento WHERE iddocumento = $1",[e.iddocumento]);case 5:return a.next=7,t.gerar();case 7:a.next=12;break;case 9:a.prev=9,a.t0=a.catch(2),Z(a.t0);case 12:return a.prev=12,window.Loading.hide(),a.finish(12);case 15:case"end":return a.stop()}}),a,null,[[2,9,12,15]])})));return function(){return a.apply(this,arguments)}}()},{text:"N\xe3o",color:"red",icon:"thumbs-down",onClick:function(){window.MessageBox.hide()}}]})}},{text:"Voltar",color:"blue",icon:"undo",onClick:function(){window.MessageBox.hide()}}]})}},{key:"gerar",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b()("#dtinicial").val()){e.next=3;break}return window.MessageBox.show({text:"Por favor, informe a data inicial do fechamento antes de prosseguir."}),e.abrupt("return",!1);case 3:if(b()("#dtfinal").val()){e.next=6;break}return window.MessageBox.show({text:"Por favor, informe a data final do fechamento antes de prosseguir."}),e.abrupt("return",!1);case 6:return e.next=8,this.prepararImpressao();case 8:this.setState({dtinicial:b()("#dtinicial").val(),dtfinal:b()("#dtfinal").val()});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"imprimir",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.Printer.alimentar(3);case 3:return e.next=5,this.Printer.guilhotina();case 5:return e.next=7,this.Printer.imprimir();case 7:window.FastMessage.show("Relat\xf3rio impresso com sucesso!"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),Z(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"prepararImpressao",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Printer.reiniciar();case 2:return t=b()("#dtinicial").val().split("-").reverse().join("/"),a=b()("#dtfinal").val().split("-").reverse().join("/"),e.t0=this.Printer,e.next=7,ie(this.Pool,"EMITENTE","NOMEFANTASIA");case 7:return e.t1=e.sent,e.next=10,e.t0.texto.call(e.t0,e.t1,"center",!0);case 10:return e.next=12,this.Printer.texto("OR\xc7AMENTOS: "+(t===a?t:t+" \xe0 "+a),"center",!0);case 12:return e.next=14,this.Printer.alimentar();case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){if(this.state.redirect)return p.a.createElement(ue.a,{to:this.state.redirect});var e=!this.state.dtinicial||!this.state.dtfinal;return p.a.createElement(me,{className:"RelOrcamento"},p.a.createElement(Ae,null,"Relat\xf3rio de Or\xe7amento"),p.a.createElement(M,null,p.a.createElement(T,{size:"6",offset:"3"},p.a.createElement(M,null,p.a.createElement(Ne,{type:"date",id:"dtinicial",label:"Data inicial",className:"col-6",defaultValue:J()}),p.a.createElement(Ne,{type:"date",id:"dtfinal",label:"Data final",className:"col-6",defaultValue:J()})),p.a.createElement(M,null,p.a.createElement(T,{size:"6",className:"pr-0"},p.a.createElement(A,{text:"Gerar",block:!0,color:"green",icon:"file-play",onClick:this.gerar})),p.a.createElement(T,{size:"6",className:"pl-0"},p.a.createElement(A,{text:"Imprimir",block:!0,color:"blue",icon:"printer",onClick:this.imprimir,disabled:e}))))),p.a.createElement(Ct,{Pool:this.Pool,Printer:this.Printer,dtinicial:this.state.dtinicial,dtfinal:this.state.dtfinal,acaoOrcamento:this.acaoOrcamento}))}}]),t}(p.a.Component),Ct=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={dados:[]},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"carregarDados",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,l,u,d,p,m,h,f,v,b,g;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0===t?this.props:t,a=["SELECT iddocumento, totalquantidade, totaldocumento, nomeorcamento,","  dthrcriacao::DATE as dtcriacao, dthrcriacao::TIME as hrcriacao","FROM documento","WHERE operacao = $1","  AND dthrcriacao::DATE BETWEEN $2 AND $3","ORDER BY dthrcriacao"].join(" "),e.next=4,t.Pool.query(a,["OR",t.dtinicial,t.dtfinal]);case 4:return o=e.sent,n=this.props.Printer.colunas,l=n-(i=7)-(s=6)-(c=10),u="N\xfamero".substr(0,i).rpad(i," "),u+="Cliente".substr(0,l).cpad(l," "),u+="Qtde".substr(0,s).cpad(s," "),u+="Total".substr(0,c).lpad(c," "),e.next=16,this.props.Printer.texto(u,"left",!0);case 16:d=0,p=0,e.t0=r.a.keys(o.rows);case 19:if((e.t1=e.t0()).done){e.next=36;break}return m=e.t1.value,h=o.rows[m],f=String(h.iddocumento).lpad(6,"0"),v=null===h.nomeorcamento?"":String(h.nomeorcamento),b=h.totalquantidade.format(X(h.totalquantidade),",","."),g=h.totaldocumento.format(2,",","."),u=f.substr(0,i).rpad(i," "),u+=v.substr(0,l).rpad(l," "),u+=b.substr(0,s).cpad(s," "),u+=g.substr(0,c).lpad(c," "),e.next=32,this.props.Printer.texto(u);case 32:d+=parseFloat(h.totalquantidade),p+=parseFloat(h.totaldocumento),e.next=19;break;case 36:return d=d.format(X(d),",","."),p=p.format(2,",","."),u="Total".substr(0,i+l).rpad(i+l," "),u+=String(d).substr(0,s).cpad(s," "),u+=String(p).substr(0,c).lpad(c," "),e.next=43,this.props.Printer.texto(u,"left",!0);case 43:return e.next=45,this.props.Printer.alimentar(2);case 45:this.setState({dados:o.rows});case 46:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillUpdate",value:function(e){e!==this.props&&this.carregarDados(e)}},{key:"render",value:function(){var e=this;if(!this.props.dtinicial||!this.props.dtfinal)return null;var t=0,a=0;return p.a.createElement(M,{className:"mt-5"},p.a.createElement(T,{size:"8",offset:"2"},p.a.createElement("table",{className:"table table-striped mb-5"},p.a.createElement("thead",null,p.a.createElement("tr",null,p.a.createElement("th",{className:"text-center"},"N\xfamero"),p.a.createElement("th",{className:"text-left"},"Cliente"),p.a.createElement("th",{className:"text-center"},"Quantidade"),p.a.createElement("th",{className:"text-center"},"Total"))),p.a.createElement("tbody",null,this.state.dados.map((function(o,r){return t+=parseFloat(o.totalquantidade),a+=parseFloat(o.totaldocumento),p.a.createElement("tr",{key:r,onClick:function(){e.props.acaoOrcamento(o)}},p.a.createElement("td",{className:"text-center"},String(o.iddocumento).lpad(6,"0")),p.a.createElement("td",{className:"text-left"},o.nomeorcamento),p.a.createElement("td",{className:"text-center"},o.totalquantidade.format(X(o.totalquantidade),",",".")),p.a.createElement("td",{className:"text-right"},"R$ "+o.totaldocumento.format(2,",",".")))}))),p.a.createElement("tfoot",null,p.a.createElement("tr",null,p.a.createElement("th",null),p.a.createElement("th",null),p.a.createElement("th",{className:"text-center"},t.format(X(t),",",".")),p.a.createElement("th",{className:"text-right"},"R$ "+a.format(2,",",".")))))))}}]),t}(p.a.Component),Ot=window.require("fs"),kt=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=Object.assign({},this.props);if(e.src)if(Ot.existsSync(e.src)){var t=e.src.split(".").reverse()[0],a=Ot.readFileSync(e.src,"base64");e.src="data:image/"+t+";base64,"+a}else e.src=null;return p.a.createElement("img",Object.assign({},e,{alt:""}))}}]),t}(p.a.Component),yt=(a(647),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={logotipo:null,informativo:null,telefone:null,email:null,endereco:null},a.carregarDados=a.carregarDados.bind(Object(C.a)(a)),a.Pool=new pe,a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"carregarDados",value:function(){var e=this;this.Pool.query("SELECT nome, valor FROM parametro WHERE grupo = $1",["REVENDA"],(function(t,a){if(t)return Z(t),!1;var o={},r=!0,n=!1,i=void 0;try{for(var s,c=a.rows[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;o[l.nome.toLowerCase()]=l.valor.replaceAll("\n","</br>")}}catch(t){n=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(n)throw i}}e.setState(o)}))}},{key:"componentDidMount",value:function(){this.carregarDados()}},{key:"render",value:function(){return p.a.createElement(me,null,p.a.createElement(Ae,null,"Suporte"),p.a.createElement(M,null,p.a.createElement(T,{size:"5",offset:"1"},p.a.createElement(kt,{className:"logotipo",src:this.state.logotipo}))),p.a.createElement(M,null,p.a.createElement(T,{size:"5",offset:"1"},p.a.createElement("p",{className:"informativo",dangerouslySetInnerHTML:{__html:this.state.informativo}})),p.a.createElement(T,{className:"contatos",size:"4",offset:"1"},p.a.createElement(M,null,p.a.createElement(T,{size:"1"},p.a.createElement(O,{name:"phone"})),p.a.createElement(T,{size:"11"},p.a.createElement("p",{dangerouslySetInnerHTML:{__html:this.state.telefone}}))),p.a.createElement(Pe,null),p.a.createElement(M,null,p.a.createElement(T,{size:"1"},p.a.createElement(O,{name:"mail"})),p.a.createElement(T,{size:"11"},p.a.createElement("p",{dangerouslySetInnerHTML:{__html:this.state.email}}))),p.a.createElement(Pe,null),p.a.createElement(M,null,p.a.createElement(T,{size:"1"},p.a.createElement(O,{name:"location"})),p.a.createElement(T,{size:"11"},p.a.createElement("p",{dangerouslySetInnerHTML:{__html:this.state.endereco}}))))))}}]),t}(p.a.Component)),wt=a(102),St=a.n(wt),jt=(a(648),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={pesquisa:e.pesquisa,produtos:[],totalproduto:null},a.carregarProdutos=a.carregarProdutos.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"carregarProdutos",value:function(e){var t=this;if("string"===typeof(e=e||this.props.pesquisa)&&0!==e.length){var a=null,o=null,r=[];13===e.length&&"2"===e.substr(0,1)?(a=parseInt(e.substr(1,6),10),o=parseInt(e.substr(7,5),10)/100,e=a,r.push("produto.codigoean = $1")):(r.push("produto.descricao ILIKE '%'||$1||'%'"),r.push("produto.codigoean = $1")),this.totalproduto=o;var n=["SELECT produto.idproduto, produto.descricao, produto.precovariavel,","  produto.preco, categoria.cor, unidade.precisao, unidade.descricao AS unidade","FROM produto","INNER JOIN categoria USING (idcategoria)","INNER JOIN unidade USING (idunidade)","WHERE "+r.join(" OR "),"ORDER BY descricao"].join(" ");this.props.Pool.query(n,[e],(function(e,a){if(e)return Z(e),!1;t.setState({produtos:a.rows})}))}else this.setState({produtos:[]})}},{key:"componentDidMount",value:function(){this.carregarProdutos()}},{key:"componentWillReceiveProps",value:function(e){this.carregarProdutos(e.pesquisa)}},{key:"render",value:function(){var e=this,t=["painelrapido","painelrapido-pesquisa"];"0"===this.props.layoutVendas&&t.push("painelrapido-poucosprodutos");var a=!isNaN(this.props.pesquisa)&&1===this.state.produtos.length;return p.a.createElement("div",{className:t.join(" ")},p.a.createElement(M,{className:"painelrapido-produto"},this.state.produtos.map((function(t,o){return p.a.createElement(Nt,Object.assign({key:o},t,{onSelectProduto:e.props.onSelectProduto,layoutVendas:e.props.layoutVendas,selecionarProduto:a,totalproduto:e.totalproduto}))}))))}}]),t}(p.a.Component)),Nt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).onClick=a.onClick.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.selecionarProduto&&this.props.onSelectProduto(this.props,null,this.props.totalproduto)}},{key:"onClick",value:function(e){this.props.onSelectProduto&&this.props.onSelectProduto(this.props,e,this.props.totalproduto)}},{key:"render",value:function(){var e="0"===this.props.layoutVendas?3:2;return p.a.createElement(T,{size:e},p.a.createElement("div",{className:"painelrapido-produto-item",style:{borderColor:this.props.cor},onClick:this.onClick},p.a.createElement("span",null,this.props.descricao)))}}]),t}(p.a.Component),Pt=(a(649),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={categorias:[],produtos:[],categoria:null},a.carregarCategorias=a.carregarCategorias.bind(Object(C.a)(a)),a.carregarProdutos=a.carregarProdutos.bind(Object(C.a)(a)),a.trocarCategoria=a.trocarCategoria.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"carregarCategorias",value:function(){var e=this;this.props.Pool.query("SELECT idcategoria, descricao, cor FROM categoria ORDER BY descricao",(function(t,a){if(t)return Z(t),!1;e.setState({categorias:a.rows,categoria:a.rows.length>0?a.rows[0]:null},(function(){e.carregarProdutos()}))}))}},{key:"carregarProdutos",value:function(){var e=this;if(null===this.state.categoria)return!1;var t=["SELECT produto.idproduto, produto.descricao, produto.precovariavel,","  produto.preco, unidade.precisao, unidade.descricao AS unidade","FROM produto","INNER JOIN unidade USING (idunidade)","WHERE produto.status = $1","  AND produto.idcategoria = $2","ORDER BY produto.descricao"].join(" ");this.props.Pool.query(t,["A",this.state.categoria.idcategoria],(function(t,a){if(t)return Z(t),!1;e.setState({produtos:a.rows})}))}},{key:"componentDidMount",value:function(){this.carregarCategorias()}},{key:"trocarCategoria",value:function(e){var t=this;this.setState({categoria:e},(function(){t.carregarProdutos()}))}},{key:"render",value:function(){var e=this;return p.a.createElement("div",{className:"painelrapido painelrapido-poucosprodutos"},p.a.createElement(M,{className:"painelrapido-categoria"},this.state.categorias.map((function(t,a){return p.a.createElement(Dt,Object.assign({key:a},t,{trocarCategoria:e.trocarCategoria}))}))),p.a.createElement(M,{className:"painelrapido-produto"},this.state.produtos.map((function(t,a){return p.a.createElement(At,Object.assign({key:a},t,{cor:e.state.categoria.cor,onSelectProduto:e.props.onSelectProduto}))}))))}}]),t}(p.a.Component)),Dt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).onClick=a.onClick.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"onClick",value:function(){this.props.trocarCategoria(this.props)}},{key:"render",value:function(){return p.a.createElement(T,{size:"3"},p.a.createElement("div",{className:"painelrapido-categoria-item",style:{backgroundColor:this.props.cor},onClick:this.onClick},p.a.createElement("span",null,this.props.descricao)))}}]),t}(p.a.Component),At=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).onClick=a.onClick.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"onClick",value:function(e){this.props.onSelectProduto&&this.props.onSelectProduto(this.props,e)}},{key:"render",value:function(){return p.a.createElement(T,{size:"3"},p.a.createElement("div",{className:"painelrapido-produto-item",style:{borderColor:this.props.cor},onClick:this.onClick},p.a.createElement("span",null,this.props.descricao)))}}]),t}(p.a.Component),Tt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={categorias:[],produtos:[],categoria:null},a.carregarCategorias=a.carregarCategorias.bind(Object(C.a)(a)),a.carregarProdutos=a.carregarProdutos.bind(Object(C.a)(a)),a.trocarCategoria=a.trocarCategoria.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"carregarCategorias",value:function(){var e=this;this.props.Pool.query("SELECT idcategoria, descricao, cor FROM categoria ORDER BY descricao",(function(t,a){if(t)return Z(t),!1;e.setState({categorias:a.rows,categoria:a.rows.length>0?a.rows[0]:null},(function(){e.carregarProdutos()}))}))}},{key:"carregarProdutos",value:function(){var e=this;if(null!==this.state.categoria){var t=["SELECT produto.idproduto, produto.descricao, produto.precovariavel,","  produto.preco, unidade.precisao, unidade.descricao AS unidade","FROM produto","INNER JOIN unidade USING (idunidade)","WHERE produto.status = $1","  AND produto.idcategoria = $2","ORDER BY produto.descricao"].join(" ");this.props.Pool.query(t,["A",this.state.categoria.idcategoria],(function(t,a){if(t)return Z(t),!1;e.setState({produtos:a.rows})}))}}},{key:"componentDidMount",value:function(){this.carregarCategorias()}},{key:"trocarCategoria",value:function(e){var t=this;this.setState({categoria:e},(function(){t.carregarProdutos()}))}},{key:"render",value:function(){var e=this;return p.a.createElement("div",{className:"painelrapido painelrapido-mediosprodutos"},p.a.createElement(M,{className:"painelrapido-categoria"},this.state.categorias.map((function(t,a){return p.a.createElement(Rt,Object.assign({key:a},t,{trocarCategoria:e.trocarCategoria}))}))),p.a.createElement(M,{className:"painelrapido-produto"},this.state.produtos.map((function(t,a){return p.a.createElement(It,Object.assign({key:a},t,{cor:e.state.categoria.cor,onSelectProduto:e.props.onSelectProduto}))}))))}}]),t}(p.a.Component),Rt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).onClick=a.onClick.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"onClick",value:function(){this.props.trocarCategoria(this.props)}},{key:"render",value:function(){return p.a.createElement(T,{size:"2"},p.a.createElement("div",{className:"painelrapido-categoria-item",style:{backgroundColor:this.props.cor},onClick:this.onClick},p.a.createElement("span",null,this.props.descricao)))}}]),t}(p.a.Component),It=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).onClick=a.onClick.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"onClick",value:function(e){this.props.onSelectProduto&&this.props.onSelectProduto(this.props,e)}},{key:"render",value:function(){return p.a.createElement(T,{size:"2"},p.a.createElement("div",{className:"painelrapido-produto-item",style:{borderColor:this.props.cor},onClick:this.onClick},p.a.createElement("span",null,this.props.descricao)))}}]),t}(p.a.Component),Mt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={categorias:[],produtos:[],categoria:null},a.carregarCategorias=a.carregarCategorias.bind(Object(C.a)(a)),a.carregarProdutos=a.carregarProdutos.bind(Object(C.a)(a)),a.trocarCategoria=a.trocarCategoria.bind(Object(C.a)(a)),a.voltarCategoria=a.voltarCategoria.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"carregarCategorias",value:function(){var e=this;this.props.Pool.query("SELECT idcategoria, descricao, cor FROM categoria ORDER BY descricao",(function(t,a){if(t)return Z(t),!1;e.setState({categorias:a.rows,categoria:null},(function(){e.carregarProdutos()}))}))}},{key:"carregarProdutos",value:function(){var e=this;if(null!==this.state.categoria){var t=["SELECT produto.idproduto, produto.descricao, produto.precovariavel,","  produto.preco, unidade.precisao, unidade.descricao AS unidade","FROM produto","INNER JOIN unidade USING (idunidade)","WHERE produto.status = $1","  AND produto.idcategoria = $2","ORDER BY produto.descricao"].join(" ");this.props.Pool.query(t,["A",this.state.categoria.idcategoria],(function(t,a){if(t)return Z(t),!1;e.setState({produtos:a.rows})}))}}},{key:"componentDidMount",value:function(){this.carregarCategorias()}},{key:"trocarCategoria",value:function(e){var t=this;this.setState({categoria:e},(function(){t.carregarProdutos()}))}},{key:"voltarCategoria",value:function(){this.setState({categoria:null,produtos:[]})}},{key:"render",value:function(){var e=this,t=null;null===this.state.categoria&&(t=p.a.createElement(M,{className:"painelrapido-categoria"},this.state.categorias.map((function(t,a){return p.a.createElement(qt,{key:a,idcategoria:t.idcategoria,descricao:t.descricao,cor:t.cor,trocarCategoria:e.trocarCategoria})}))));var a=null;return null!==this.state.categoria&&(a=p.a.createElement(M,{className:"painelrapido-produto"},p.a.createElement(T,{size:"2"},p.a.createElement("div",{className:"painelrapido-categoria-item",style:{backgroundColor:this.state.categoria.cor},onClick:this.voltarCategoria},p.a.createElement(O,{name:"chevron-left"}))),this.state.produtos.map((function(t,a){return p.a.createElement(Lt,Object.assign({key:a},t,{cor:e.state.categoria.cor,onSelectProduto:e.props.onSelectProduto}))})))),p.a.createElement("div",{className:"painelrapido painelrapido-muitosprodutos"},t,a)}}]),t}(p.a.Component),qt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).onClick=a.onClick.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"onClick",value:function(){this.props.trocarCategoria(this.props)}},{key:"render",value:function(){return p.a.createElement(T,{size:"2"},p.a.createElement("div",{className:"painelrapido-categoria-item",style:{backgroundColor:this.props.cor},onClick:this.onClick},p.a.createElement("span",null,this.props.descricao)))}}]),t}(p.a.Component),Lt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).onClick=a.onClick.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"onClick",value:function(e){this.props.onSelectProduto&&this.props.onSelectProduto(this.props,e)}},{key:"render",value:function(){return p.a.createElement(T,{size:"2"},p.a.createElement("div",{className:"painelrapido-produto-item",style:{borderColor:this.props.cor},onClick:this.onClick},p.a.createElement("span",null,this.props.descricao)))}}]),t}(p.a.Component),Ft=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={layoutVendas:null},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"ajustarAltura",value:function(){if(b()(".painelrapido").length>0){var e=window.innerHeight-b()(".painelrapido").offset().top;b()(".painelrapido").height(e)}}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.ajustarAltura),ie(this.props.Pool,"DIVERSOS","LAYOUTVENDAS",(function(t){e.setState({layoutVendas:t})}),(function(e){Z(e)})),this.ajustarAltura()}},{key:"componentDidUpdate",value:function(){this.ajustarAltura()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.ajustarAltura)}},{key:"render",value:function(){if(this.props.pesquisa.length>0)return p.a.createElement(jt,Object.assign({},this.props,{layoutVendas:this.state.layoutVendas}));switch(this.state.layoutVendas){case"0":return p.a.createElement(Pt,this.props);case"1":return p.a.createElement(Tt,this.props);case"2":return p.a.createElement(Mt,this.props);default:return null}}}]),t}(p.a.Component),zt=(a(650),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={acrescimovalor:0,acrescimopercentual:0,totaldocumento:e.totalbruto,show:e.show},a.cancelar=a.cancelar.bind(Object(C.a)(a)),a.confirmar=a.confirmar.bind(Object(C.a)(a)),a.onChangeAcrescimoPercentual=a.onChangeAcrescimoPercentual.bind(Object(C.a)(a)),a.onChangeAcrescimoValor=a.onChangeAcrescimoValor.bind(Object(C.a)(a)),a.onChangeTotalLiquido=a.onChangeTotalLiquido.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"componentWillReceiveProps",value:function(e){this.setState({acrescimovalor:0,acrescimopercentual:0,totaldocumento:e.totalbruto,show:e.show})}},{key:"confirmar",value:function(){this.props.aplicarAcrescimo(this.props.totalbruto,this.state.acrescimovalor)}},{key:"onChangeAcrescimoPercentual",value:function(e){var t=e.target.value.toFloat(),a=this.props.totalbruto*t/100,o=this.props.totalbruto-this.props.totaldesconto+a;this.setState({acrescimopercentual:t,acrescimovalor:a,totaldocumento:o})}},{key:"onChangeAcrescimoValor",value:function(e){var t=e.target.value.toFloat(),a=t/this.props.totalbruto*100,o=this.props.totalbruto-this.props.totaldesconto+t;this.setState({acrescimopercentual:a,acrescimovalor:t,totaldocumento:o})}},{key:"onChangeTotalLiquido",value:function(e){var t=e.target.value.toFloat();t<this.props.totalbruto&&(t=this.props.totalbruto);var a=t-this.props.totalbruto+this.props.totaldesconto,o=a/this.props.totalbruto*100;this.setState({acrescimopercentual:o,acrescimovalor:a,totaldocumento:t})}},{key:"render",value:function(){return p.a.createElement(I,{id:"VendaAplicarAcrescimo",title:"Aplicando acr\xe9scimo...",show:this.state.show,size:"md",beforeClose:this.props.beforeClose},p.a.createElement(M,null,p.a.createElement(T,{size:"6"},p.a.createElement(je,null,"Total dos itens")),p.a.createElement(T,{size:"6"},p.a.createElement(we,{type:"text",className:"text-center",disabled:!0,value:this.props.totalbruto.format(2,",",".")}))),p.a.createElement(M,null,p.a.createElement(T,{size:"6"},p.a.createElement(je,null,"Total de desconto")),p.a.createElement(T,{size:"6"},p.a.createElement(we,{type:"text",className:"text-center",disabled:!0,value:this.props.totaldesconto.format(2,",",".")}))),p.a.createElement(M,null,p.a.createElement(T,{size:"6"},p.a.createElement(je,null,"Acr\xe9scimo em percentual")),p.a.createElement(T,{size:"6"},p.a.createElement(we,{type:"text",className:"text-center",value:this.state.acrescimopercentual.format(0,",","."),InformarValor:{decimal:0},onChange:this.onChangeAcrescimoPercentual}))),p.a.createElement(M,null,p.a.createElement(T,{size:"6"},p.a.createElement(je,null,"Acr\xe9scimo em valor")),p.a.createElement(T,{size:"6"},p.a.createElement(we,{type:"text",className:"text-center",value:this.state.acrescimovalor.format(2,",","."),InformarValor:{decimal:2,money:!0},onChange:this.onChangeAcrescimoValor}))),p.a.createElement(M,null,p.a.createElement(T,{size:"6"},p.a.createElement(je,null,"Total final")),p.a.createElement(T,{size:"6"},p.a.createElement(we,{type:"text",className:"text-center",value:this.state.totaldocumento.format(2,",","."),InformarValor:{decimal:2,money:!0},onChange:this.onChangeTotalLiquido}))),p.a.createElement("div",{className:"text-right mt-2"},p.a.createElement(A,{icon:"undo",color:"red",className:"float-left",onClick:this.cancelar}),p.a.createElement(A,{text:"Confirmar",icon:"thumbs-up",color:"green",onClick:this.confirmar})))}}]),t}(p.a.Component)),Ut=(a(651),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={descontovalor:0,descontopercentual:0,totaldocumento:e.totalbruto,show:e.show},a.cancelar=a.cancelar.bind(Object(C.a)(a)),a.confirmar=a.confirmar.bind(Object(C.a)(a)),a.onChangeDescontoPercentual=a.onChangeDescontoPercentual.bind(Object(C.a)(a)),a.onChangeDescontoValor=a.onChangeDescontoValor.bind(Object(C.a)(a)),a.onChangeTotalLiquido=a.onChangeTotalLiquido.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"componentWillReceiveProps",value:function(e){this.setState({descontovalor:0,descontopercentual:0,totaldocumento:e.totalbruto,show:e.show})}},{key:"confirmar",value:function(){this.props.aplicarDesconto(this.props.totalbruto,this.state.descontovalor)}},{key:"onChangeDescontoPercentual",value:function(e){var t=e.target.value.toFloat(),a=this.props.totalbruto*t/100,o=this.props.totalbruto-a;this.setState({descontopercentual:t,descontovalor:a,totaldocumento:o})}},{key:"onChangeDescontoValor",value:function(e){var t=e.target.value.toFloat(),a=t/this.props.totalbruto*100,o=this.props.totalbruto-t;this.setState({descontopercentual:a,descontovalor:t,totaldocumento:o})}},{key:"onChangeTotalLiquido",value:function(e){var t=e.target.value.toFloat();t>this.props.totalbruto&&(t=this.props.totalbruto);var a=this.props.totalbruto-t,o=a/this.props.totalbruto*100;this.setState({descontopercentual:o,descontovalor:a,totaldocumento:t})}},{key:"render",value:function(){return p.a.createElement(I,{id:"VendaAplicarDesconto",title:"Aplicando desconto...",show:this.state.show,size:"md",beforeClose:this.props.beforeClose},p.a.createElement(M,null,p.a.createElement(T,{size:"6"},p.a.createElement(je,null,"Total dos itens")),p.a.createElement(T,{size:"6"},p.a.createElement(we,{type:"text",className:"text-center",disabled:!0,value:this.props.totalbruto.format(2,",",".")}))),p.a.createElement(M,null,p.a.createElement(T,{size:"6"},p.a.createElement(je,null,"Desconto em percentual")),p.a.createElement(T,{size:"6"},p.a.createElement(we,{type:"text",className:"text-center",value:this.state.descontopercentual.format(0,",","."),InformarValor:{decimal:0},onChange:this.onChangeDescontoPercentual}))),p.a.createElement(M,null,p.a.createElement(T,{size:"6"},p.a.createElement(je,null,"Desconto em valor")),p.a.createElement(T,{size:"6"},p.a.createElement(we,{type:"text",className:"text-center",value:this.state.descontovalor.format(2,",","."),InformarValor:{decimal:2,money:!0},onChange:this.onChangeDescontoValor}))),p.a.createElement(M,null,p.a.createElement(T,{size:"6"},p.a.createElement(je,null,"Total final")),p.a.createElement(T,{size:"6"},p.a.createElement(we,{type:"text",className:"text-center",value:this.state.totaldocumento.format(2,",","."),InformarValor:{decimal:2,money:!0},onChange:this.onChangeTotalLiquido}))),p.a.createElement("div",{className:"text-right mt-2"},p.a.createElement(A,{icon:"undo",color:"red",className:"float-left",onClick:this.cancelar}),p.a.createElement(A,{text:"Confirmar",icon:"thumbs-up",color:"green",onClick:this.confirmar})))}}]),t}(p.a.Component)),Vt=a(279),Bt=a.n(Vt),_t=window.require("fs"),$t=window.require("child_process"),Ht=function(){function e(){Object(i.a)(this,e),this.appPath=Q(),this.childProcess=$t,this.fs=_t,this.srcPath=this.appPath+"/src",this.comDLLPath=this.srcPath+"/lib/comdll-1.0.0"}return Object(s.a)(e,[{key:"execute",value:function(e,t,a,o){try{var r=this.comDLLPath+"/ComDLL.exe",n=[this.srcPath+"/"+e,t].concat(a),i=this.comDLLPath+"/entrada.xml",s=this.comDLLPath+"/retorno.txt";return this.fs.existsSync(i)&&this.fs.unlinkSync(i),this.fs.existsSync(s)&&this.fs.unlinkSync(s),void 0!==o&&this.fs.writeFileSync(i,o,"utf8"),this.childProcess.execFileSync(r,n,{timeout:6e4}),this.fs.readFileSync(s).toString().trim()}catch(c){switch(c.code){case"ETIMEDOUT":throw new Error("O tempo m\xe1ximo de comunica\xe7\xe3o com o equipamento fiscal SAT foi excedido.<br>Desconecte todos os cabos conectados ao SAT, espere 5 segundos, conecte-os de volta e tente efetuar a opera\xe7\xe3o novamente.<br><br>Caso o problema persista, entre em contato com o suporte.");default:throw c}}}}]),e}(),Wt=window.require("fs"),Gt=window.require("os"),Yt=function(){function e(t){Object(i.a)(this,e),this.Pool=t,this.ComDLL=new Ht,this.jsontoxml=Bt.a,this.os=Gt,this.fs=Wt,this.error=null}return Object(s.a)(e,[{key:"cancelarDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie(this.Pool,"SAT","MODELO");case 2:return a=e.sent,e.next=5,ie(this.Pool,"SAT","ATIVACAO");case 5:return o=e.sent,e.next=8,this.carregarDadosDocumento(t);case 8:if(n=e.sent,i=n.documento,s=null,"sweda"!==a){e.next=17;break}return e.next=14,this.gerarXMLCancelamento(t);case 14:s=e.sent,e.next=18;break;case 17:s=i.xml;case 18:if(ce("cancelamento.xml",s),"nenhum"!==a){e.next=21;break}return e.abrupt("return",{xmlcanc:null,chavecanc:null});case 21:c="lib/comdll-1.0.0/SAT-"+a+".dll",l=null,u=null;case 24:if(null!==l&&"06098"!==u[1]){e.next=34;break}if(null===l){e.next=28;break}return e.next=28,ae(500);case 28:if(!1!==(l=this.ComDLL.execute(c,"CancelarUltimaVenda",[o,i.chave],s))){e.next=31;break}return e.abrupt("return",!1);case 31:u=l.split("|"),e.next=24;break;case 34:if(this.validarRetorno(l)){e.next=36;break}return e.abrupt("return",!1);case 36:return d=atob(u[6]),p=u[8].trim(),"string"===typeof d&&0===d.length&&"sweda"===a&&(u=this.fs.readFileSync("C:/Sweda/Retorno.txt").toString(),d=atob(u[6])),e.abrupt("return",{xmlcanc:d,chavecanc:p});case 40:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"carregarDadosDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,l,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.Pool.constructor.name,s=null,"Pool"!==i){e.next=8;break}return e.next=5,this.Pool.connect();case 5:s=e.sent,e.next=9;break;case 8:s=this.Pool;case 9:return e.prev=9,e.next=12,s.query("SELECT * FROM documento WHERE iddocumento = $1",[t]);case 12:if(0!==(c=e.sent).rows.length){e.next=15;break}throw new Error("Nenhum documento foi encontrado.");case 15:return a=c.rows[0],l=["SELECT documentoproduto.*, unidade.sigla","FROM documentoproduto","LEFT JOIN produto USING (idproduto)","LEFT JOIN unidade USING (idunidade)","WHERE documentoproduto.iddocumento = $1","ORDER BY documentoproduto.sequencial"].join(" "),e.next=19,s.query(l,[t]);case 19:return c=e.sent,o=c.rows,u=["SELECT documentopagamento.*, formapagamento.especie","FROM documentopagamento","LEFT JOIN formapagamento USING (idformapagamento)","WHERE documentopagamento.iddocumento = $1"].join(" "),e.next=24,s.query(u,[t]);case 24:c=e.sent,n=c.rows,e.next=31;break;case 28:throw e.prev=28,e.t0=e.catch(9),e.t0;case 31:return e.prev=31,"Pool"===i&&s.release(),e.finish(31);case 34:return e.abrupt("return",{documento:a,documentoprodutos:o,documentopagamentos:n});case 35:case"end":return e.stop()}}),e,this,[[9,28,31,34]])})));return function(t){return e.apply(this,arguments)}}()},{key:"consultarUltimaSessaoFiscal",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"gerarXMLCancelamento",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a,o){var n,i,s,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarDadosDocumento(t);case 2:return n=e.sent,i=n.documento,e.next=6,ie(this.Pool,"DESENVOLVEDORA","CNPJ");case 6:return s=e.sent,e.next=9,ie(this.Pool,"DESENVOLVEDORA","ASSINATURA");case 9:return c=e.sent,e.next=12,ie(this.Pool,"SAT","CAIXA");case 12:return l=e.sent,u=[{name:"infCFe",attrs:{chCanc:i.chave},children:[{name:"ide",children:{CNPJ:s.removeFormat(),signAC:c,numeroCaixa:l.lpad(3,"0")}},{name:"emit",children:[]},{name:"dest",children:[]},{name:"total",children:[]},{name:"infAdic",children:[]}]}],d=[{name:"CFeCanc",children:[u]}],p=this.jsontoxml(d),"function"===typeof a&&a(p),e.abrupt("return",p);case 18:case"end":return e.stop()}}),e,this)})));return function(t,a,o){return e.apply(this,arguments)}}()},{key:"gerarXMLDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a,o){var n,i,s,c,l,u,d,p,m,h,f,v,b,g,E,x,C,O,k,y,w,S,j,N,P,D;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarDadosDocumento(t);case 2:return n=e.sent,i=n.documento,s=n.documentoprodutos,c=n.documentopagamentos,e.next=8,ie(this.Pool,"DESENVOLVEDORA","CNPJ");case 8:return l=e.sent,e.next=11,ie(this.Pool,"DESENVOLVEDORA","ASSINATURA");case 11:return u=e.sent,e.next=14,ie(this.Pool,"SAT","CAIXA");case 14:return d=e.sent,e.next=17,ie(this.Pool,"EMITENTE","CNPJ");case 17:return p=e.sent,e.next=20,ie(this.Pool,"EMITENTE","IE");case 20:return m=e.sent,e.next=23,ie(this.Pool,"EMITENTE","IMPOSTOFEDERAL");case 23:return h=e.sent,e.next=26,ie(this.Pool,"EMITENTE","IMPOSTOESTADUAL");case 26:return f=e.sent,h||(h=0),f||(f=0),v={name:"ide",children:{CNPJ:l.removeFormat(),signAC:u,numeroCaixa:d.lpad(3,"0")}},b={name:"emit",children:{CNPJ:p.removeFormat(),IE:m.removeFormat(),cRegTribISSQN:1,indRatISSQN:"N"}},g={},(E=i.cpfcnpj?i.cpfcnpj.removeFormat():"").length>11?g={CNPJ:E}:E.length>9&&(g={CPF:E}),x={name:"dest",children:g},C=s.map((function(e){var t=[{name:"cProd",text:e.idproduto},{name:"xProd",text:e.descricao.replaceAll("&","&amp;")},{name:"NCM",text:e.codigoncm.removeFormat()},{name:"CFOP",text:e.cfop.removeFormat()},{name:"uCom",text:e.sigla},{name:"qCom",text:e.quantidade.format(4,".","")},{name:"vUnCom",text:e.preco},{name:"indRegra",text:"T"},{name:"vDesc",text:e.totaldesconto},{name:"vOutro",text:e.totalacrescimo}];null!==e.cest&&e.cest.length>0&&t.push({name:"obsFiscoDet",attrs:{xCampoDet:"Cod. CEST"},children:{xTextoDet:e.cest.removeFormat()}});var a={};["102","300","400","500"].indexOf(e.csosn)>-1&&(a={ICMSSN102:{Orig:e.origem,CSOSN:e.csosn}});var o={};["01","02"].indexOf(e.cstpis)>-1?o={PISAliq:{CST:e.cstpis,vBC:e.basepis,pPIS:e.aliqpis.format(4,".","")}}:["03"].indexOf(e.cstpis)>-1?o={PISQtde:{CST:e.cstpis,qBCProd:e.quantidade,vAliqProd:e.aliqpis.format(4,".","")}}:["04","06","07","08","09"].indexOf(e.cstpis)>-1?o={PISNT:{CST:e.cstpis}}:["49"].indexOf(e.cstpis)>-1?o={PISSN:{CST:e.cstpis}}:["99"].indexOf(e.cstpis)>-1&&(o={PISOutr:{CST:e.cstpis,vBC:e.basepis,pPIS:e.aliqpis.format(4,".","")}});var r={};return["01","02"].indexOf(e.cstcofins)>-1?r={COFINSAliq:{CST:e.cstcofins,vBC:e.basecofins,pCOFINS:e.aliqcofins.format(4,".","")}}:["03"].indexOf(e.cstcofins)>-1?r={COFINSQtde:{CST:e.cstcofins,qBCProd:e.quantidade,vAliqProd:e.aliqcofins.format(4,".","")}}:["04","06","07","08","09"].indexOf(e.cstcofins)>-1?r={COFINSNT:{CST:e.cstcofins}}:["49"].indexOf(e.cstcofins)>-1?r={COFINSSN:{CST:e.cstcofins}}:["99"].indexOf(e.cstcofins)>-1&&(r={COFINSOutr:{CST:e.cstcofins,vBC:e.basecofins,pCOFINS:e.aliqcofins.format(4,".","")}}),{name:"det",attrs:{nItem:e.sequencial},children:{prod:t,imposto:{ICMS:a,PIS:o,COFINS:r}}}})),O={name:"total"},k=c.map((function(e){return{name:"MP",children:{cMP:e.especie,vMP:e.totalpagamento}}})),y={name:"pgto",children:k},w=(i.totaldocumento*h.toFloat()/100).format(2,",","."),S=(i.totaldocumento*f.toFloat()/100).format(2,",","."),j={name:"infAdic",children:{infCpl:"Valor aprox. imposto: R$ "+w+" Fed / R$ "+S+" Est / Fonte SEBRAE"}},N=[v,b,x].concat(C).concat([O,y,j]),P=[{name:"CFe",children:[[{name:"infCFe",attrs:{versaoDadosEnt:"0.07"},children:N}]]}],D=this.jsontoxml(P),"function"===typeof a&&a(D),e.abrupt("return",D);case 49:case"end":return e.stop()}}),e,this)})));return function(t,a,o){return e.apply(this,arguments)}}()},{key:"novoNumSessao",value:function(){return String(Math.round(Math.random()*Math.pow(10,6))).lpad(6,"0")}},{key:"transmitirDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie(this.Pool,"SAT","MODELO");case 2:return a=e.sent,e.next=5,ie(this.Pool,"SAT","ATIVACAO");case 5:return o=e.sent,e.next=8,this.gerarXMLDocumento(t);case 8:if(ce("venda.xml",n=e.sent),"nenhum"!==a){e.next=12;break}return e.abrupt("return",{xml:null,chave:null,numero:null});case 12:i="lib/comdll-1.0.0/SAT-"+a+".dll",s=null,c=null;case 15:if(null!==s&&"06098"!==c[1]){e.next=25;break}if(null===s){e.next=19;break}return e.next=19,ae(500);case 19:if(!1!==(s=this.ComDLL.execute(i,"EnviarDadosVenda",[o],n))){e.next=22;break}return e.abrupt("return",!1);case 22:c=s.split("|"),e.next=15;break;case 25:if(this.validarRetorno(s)){e.next=27;break}return e.abrupt("return",!1);case 27:return l=atob(c[6]),u=c[8].trim(),d=u.substr(-13,6),"string"===typeof l&&0===l.length&&"sweda"===a&&(c=this.fs.readFileSync("C:/Sweda/Retorno.txt").toString(),l=atob(c[6])),e.abrupt("return",{xml:l,chave:u,numero:d});case 32:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"validarRetorno",value:function(e){var t=e.split("|");this.error=null;var a=!1;switch(t[1]){case"04000":case"04006":case"06000":case"07000":case"08000":case"09000":case"10000":a=!0;break;default:this.error=t[3],void 0===this.error||null===this.error||0===this.error.length?this.error="Erro desconhecido. (C\xf3digo "+t[1]+")":["98","99"].indexOf(t[1].substr(-2))>-1&&(this.error="N\xe3o foi poss\xedvel comunicar com o equipamento fiscal SAT.<br><br>Reinicie o equipamento da seguinte maneira:<br>1. Desconecte todos os cabos ligados ao SAT.<br>2. Aguarde 5 segundos.<br>3. Conecte os cabos de volta ao SAT.<br>4. Tente efetuar a venda novamente.<br><br>Caso o problema persista, entre em contato com nosso suporte."),a=!1}return a}}]),e}(),Qt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={iddocumento:null,numero:null,totaldocumento:null,cpfcnpj:null,show:!1},a.atualizarState=a.atualizarState.bind(Object(C.a)(a)),a.cancelar=a.cancelar.bind(Object(C.a)(a)),a.carregarUltimoDocumento=a.carregarUltimoDocumento.bind(Object(C.a)(a)),a.confirmar=a.confirmar.bind(Object(C.a)(a)),a.outroCupom=a.outroCupom.bind(Object(C.a)(a)),a.Printer=new rt(a.props.Pool),a.SAT=new Yt(a.props.Pool),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"atualizarState",value:function(e){var t=e.numero?e.numero:"",a=e.cpfcnpj?e.cpfcnpj:"n\xe3o informado";this.setState({iddocumento:e.iddocumento,numero:String(t).lpad(6,"0"),totaldocumento:"R$ "+e.totaldocumento.format(2,",","."),cpfcnpj:a})}},{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"carregarDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=["SELECT iddocumento, numero, totaldocumento, cpfcnpj","FROM documento","WHERE operacao = $1","  AND numero = $2","ORDER BY iddocumento DESC","LIMIT 1"].join(" "),e.next=3,this.props.Pool.query(a,["CU",t]);case 3:if(0!==(o=e.sent).rowCount){e.next=8;break}return this.setState({show:!1}),window.MessageBox.show({title:"Houve uma falha",text:"Nenhum documento foi encontrado com o n\xfamero "+t+"."}),e.abrupt("return",!1);case 8:n=o.rows[0],this.atualizarState(n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"carregarUltimoDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["SELECT iddocumento, numero, totaldocumento, cpfcnpj","FROM documento","WHERE operacao = $1","ORDER BY iddocumento DESC","LIMIT 1"].join(" "),e.next=3,this.props.Pool.query(t,["CU"]);case 3:if(0!==(a=e.sent).rowCount){e.next=8;break}return this.setState({show:!1}),window.MessageBox.show({title:"Houve uma falha",text:"Nenhum documento foi encontrado."}),e.abrupt("return",!1);case 8:o=a.rows[0],this.atualizarState(o);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(e){this.setState({show:e.show}),!this.state.show&&e.show&&this.carregarUltimoDocumento()}},{key:"confirmar",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,window.Loading.show(),e.next=4,ie(this.props.Pool,"SAT","MODELO");case 4:if(t=e.sent,a={xmlcanc:null,chavecanc:null},"nenhum"===t){e.next=12;break}return e.next=9,this.SAT.cancelarDocumento(this.state.iddocumento);case 9:if(!1!==(a=e.sent)){e.next=12;break}throw new Error(this.SAT.error);case 12:return o=["UPDATE documento SET","  status = $2, dthrcancelamento = $3,","  xmlcanc = $4, chavecanc = $5","WHERE iddocumento = $1"].join(" "),n=[this.state.iddocumento,"C",K(),a.xmlcanc,a.chavecanc],e.next=16,this.props.Pool.query(o,n);case 16:return e.t0=St.a,e.next=19,ie(this.props.Pool,"IMPRESSORA","NUMEROVIAS");case 19:for(e.t1=e.sent,i=e.t0.parse.call(e.t0,e.t1),s=1;s<=i.cancelamento;s++)this.Printer.imprimirDocumento(this.state.iddocumento);window.FastMessage.show("Venda cancelada com sucesso!"),this.setState({show:!1}),e.next=30;break;case 26:e.prev=26,e.t2=e.catch(0),console.error(e.t2.stack),Z(e.t2.message);case 30:return e.prev=30,window.Loading.hide(),e.finish(30);case 33:case"end":return e.stop()}}),e,this,[[0,26,30,33]])})));return function(){return e.apply(this,arguments)}}()},{key:"outroCupom",value:function(){var e=this;window.InformarValor.show({title:"Informe o n\xfamero do cupom",mask:"999999",success:function(t){e.carregarDocumento(t)}})}},{key:"render",value:function(){return p.a.createElement(I,{id:"VendaCancelarCupom",title:"Cancelamento de venda",show:this.state.show,size:"md",beforeClose:this.props.beforeClose},p.a.createElement(M,null,p.a.createElement(T,{size:"12",className:"text-left"},"Tem certeza que deseja cancelar a venda?",p.a.createElement("br",null),p.a.createElement("br",null),"Cupom: ",this.state.numero,p.a.createElement("br",null),"Total: ",this.state.totaldocumento,p.a.createElement("br",null),"CPF: ",this.state.cpfcnpj)),p.a.createElement(Pe,null),p.a.createElement(M,null,p.a.createElement(T,{size:"5"},p.a.createElement(A,{text:"Outro cupom",color:"blue",onClick:this.outroCupom})),p.a.createElement(T,{size:"7",className:"text-right"},p.a.createElement(A,{text:"Sim",icon:"thumbs-up",color:"green",className:"mr-2",onClick:this.confirmar}),p.a.createElement(A,{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:this.cancelar}))))}}]),t}(p.a.Component),Jt=(a(652),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={height:"0px"},a.ajustarAltura=a.ajustarAltura.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"ajustarAltura",value:function(){this.setState({height:window.innerHeight})}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.ajustarAltura),this.ajustarAltura()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.ajustarAltura)}},{key:"render",value:function(){return p.a.createElement("div",{className:"vendadetalhe",style:{height:this.state.height}},p.a.createElement(Kt,{cancelarUltimaVenda:this.props.cancelarUltimaVenda,cancelarVendaAtual:this.props.cancelarVendaAtual,carregarOrcamento:this.props.carregarOrcamento,listaDocumentoProduto:this.props.listaDocumentoProduto,operacao:this.props.operacao,reimprimirCupom:this.props.reimprimirCupom,trocarOperacao:this.props.trocarOperacao}),p.a.createElement(Xt,{aumentarQuantidade:this.props.aumentarQuantidade,diminuirQuantidade:this.props.diminuirQuantidade,editarProduto:this.props.editarProduto,listaDocumentoProduto:this.props.listaDocumentoProduto,removerProduto:this.props.removerProduto}),p.a.createElement(ea,{abrirFinalizacao:this.props.abrirFinalizacao,cpfcnpj:this.props.cpfcnpj,informarCPF:this.props.informarCPF,listaDocumentoProduto:this.props.listaDocumentoProduto,operacao:this.props.operacao}))}}]),t}(p.a.Component)),Kt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).alternarOrcamento=a.alternarOrcamento.bind(Object(C.a)(a)),a.alternarVenda=a.alternarVenda.bind(Object(C.a)(a)),a.efetivarOrcamento=a.efetivarOrcamento.bind(Object(C.a)(a)),a.onClickDocument=a.onClickDocument.bind(Object(C.a)(a)),a.onClickIcon=a.onClickIcon.bind(Object(C.a)(a)),a.exibindoOpcoes=!1,a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"abrirOpcoes",value:function(){var e=h.a.findDOMNode(this.opcoes);b()(e).stop().animate({height:"show"},350),this.exibindoOpcoes=!0}},{key:"alternarOrcamento",value:function(){this.props.trocarOperacao("OR")}},{key:"alternarVenda",value:function(){this.props.trocarOperacao("CU")}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.onClickDocument)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onClickDocument)}},{key:"efetivarOrcamento",value:function(){var e=this;window.InformarValor.show({title:"N\xfamero do or\xe7amento",mask:"999999",success:function(t){t.length>0&&e.props.carregarOrcamento(t)}})}},{key:"fecharOpcoes",value:function(){var e=h.a.findDOMNode(this.opcoes);b()(e).stop().animate({height:"hide"},350),this.exibindoOpcoes=!1}},{key:"onClickDocument",value:function(e){var t=h.a.findDOMNode(this.icon);!this.iconClicked&&t.contains(e.target)?this.iconClicked=!0:this.exibindoOpcoes&&(this.iconClicked=!1,this.fecharOpcoes())}},{key:"onClickIcon",value:function(){this.abrirOpcoes()}},{key:"render",value:function(){var e=this,t=this.props.listaDocumentoProduto.length,a=this.props.operacao,o=null;switch(a){case"OR":o="Or\xe7amento";break;case"CU":default:o="Detalhe da venda"}return p.a.createElement("div",{className:"vendadetalhe-cabecalho"},p.a.createElement("div",null,p.a.createElement("h4",null,o),p.a.createElement(O,{name:"menu",onClick:this.onClickIcon,ref:function(t){e.icon=t}}),p.a.createElement("div",{className:"vendadetalhe-cabecalho-opcoes",ref:function(t){e.opcoes=t}},p.a.createElement(ht,null,p.a.createElement(ft,{className:0===t?" d-none":"",onClick:this.props.cancelarVendaAtual},"Cancelar venda atual"),p.a.createElement(ft,{className:0===t?"":" d-none",onClick:this.props.cancelarUltimaVenda},"Cancelar \xfaltima venda"),p.a.createElement(ft,{onClick:this.props.reimprimirCupom},"Reimprimir cupom"),p.a.createElement(ft,{className:"CU"!==a?"":" d-none",onClick:this.alternarVenda},"Alternar para venda"),p.a.createElement(ft,{className:"OR"!==a?"":" d-none",onClick:this.alternarOrcamento},"Alternar para or\xe7amento"),p.a.createElement(ft,{onClick:this.efetivarOrcamento},"Efetivar um or\xe7amento")))))}}]),t}(p.a.Component),Xt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).countLista=e.listaDocumentoProduto.length,a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(){this.props.listaDocumentoProduto.length>this.countLista&&this.scrollToBottom(),this.countLista=this.props.listaDocumentoProduto.length}},{key:"scrollToBottom",value:function(){b()("#vendadetalhe-corpo-conteudo").stop().animate({scrollTop:b()("#vendadetalhe-corpo-conteudo").get(0).scrollHeight},1e3)}},{key:"render",value:function(){var e=this;return p.a.createElement("div",{className:"vendadetalhe-corpo"},p.a.createElement("div",null,p.a.createElement("div",{id:"vendadetalhe-corpo-conteudo"},this.props.listaDocumentoProduto.map((function(t,a){return t.i=a,p.a.createElement(Zt,{key:a,documentoproduto:t,aumentarQuantidade:e.props.aumentarQuantidade,diminuirQuantidade:e.props.diminuirQuantidade,editarProduto:e.props.editarProduto,removerProduto:e.props.removerProduto})})))))}}]),t}(p.a.Component),Zt=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(e){var t=this,a="R$ "+this.props.documentoproduto.preco.format(2,",","."),o=this.props.documentoproduto.quantidade.format(this.props.documentoproduto.precisao,",","."),r="R$ "+this.props.documentoproduto.totaldesconto.format(2,",","."),n="R$ "+this.props.documentoproduto.totalacrescimo.format(2,",","."),i="R$ "+this.props.documentoproduto.totalproduto.format(2,",","."),s=null;return s=this.props.documentoproduto.descontounitario>0&&this.props.documentoproduto.acrescimounitario>0?a+"   x   "+o+"   -   "+r+"   +   "+n+"   =   <b>"+i+"</b>":this.props.documentoproduto.descontounitario>0?a+"   x   "+o+"   -   "+r+"   =   <b>"+i+"</b>":this.props.documentoproduto.acrescimounitario>0?a+"   x   "+o+"   +   "+n+"   =   <b>"+i+"</b>":a+"   x   "+o+"   =   <b>"+i+"</b>",p.a.createElement("div",null,p.a.createElement(M,{className:"vendadetalhe-produto",onClick:function(){t.props.editarProduto(t.props.documentoproduto)}},p.a.createElement(T,{size:"8"},p.a.createElement("div",{className:"vendadetalhe-produto-descricao"},this.props.documentoproduto.descricao),p.a.createElement("div",{className:"vendadetalhe-produto-calculo",dangerouslySetInnerHTML:{__html:s}})),p.a.createElement(T,{size:"4",className:"vendadetalhe-produto-botao text-right"},p.a.createElement("div",null,p.a.createElement(A,{icon:"plus",color:"green",onClick:function(e){t.props.aumentarQuantidade(t.props.documentoproduto),e.stopPropagation()}}),p.a.createElement(A,{icon:"minus",color:"red",onClick:function(e){t.props.diminuirQuantidade(t.props.documentoproduto),e.stopPropagation()}})),p.a.createElement(A,{icon:"bin",color:"red",onClick:function(e){t.props.removerProduto(t.props.documentoproduto),e.stopPropagation()}}))),p.a.createElement(Pe,null))}}]),t}(p.a.Component),ea=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={cpfcnpj:e.cpfcnpj},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({cpfcnpj:e.cpfcnpj})}},{key:"render",value:function(){var e=0,t=0,a=0,o=0;return this.props.listaDocumentoProduto.forEach((function(r){e+=parseFloat(r.quantidade),t+=parseFloat(r.preco*r.quantidade),a+=parseFloat(r.totaldesconto),o+=parseFloat(r.totalproduto)})),p.a.createElement("div",{className:"vendadetalhe-rodape"},p.a.createElement("div",null,p.a.createElement(M,null,p.a.createElement(T,{size:"6"},p.a.createElement("div",{className:"vendadetalhe-rodape-informacao mb-3 mt-1"},p.a.createElement("div",null,"Quantidade de itens ",p.a.createElement("strong",null,e)),p.a.createElement("div",null,"Total dos itens ",p.a.createElement("strong",null,p.a.createElement("small",null,"R$"),t.format(2,",","."))),p.a.createElement("div",null,"Total de desconto ",p.a.createElement("strong",null,p.a.createElement("small",null,"R$"),a.format(2,",",".")))),p.a.createElement("div",{className:"CU"===this.props.operacao?"":"d-none"},p.a.createElement("div",{className:"vendadetalhe-rodape-cpfcnpj"+(this.state.cpfcnpj?"":" d-none"),style:{position:"absolute",bottom:"0px"}},p.a.createElement("span",null,"CPF: ",p.a.createElement("strong",null,this.state.cpfcnpj)),p.a.createElement(A,{text:"alterar",color:"green",size:"xs",className:"ml-2",onClick:this.props.informarCPF})),p.a.createElement("div",{className:this.state.cpfcnpj?" d-none":"",style:{position:"absolute",bottom:"0px"}},p.a.createElement(A,{text:"Informar CPF",color:"green",size:"sm",onClick:this.props.informarCPF})))),p.a.createElement(T,{size:"6"},p.a.createElement("div",{className:"vendadetalhe-rodape-totaldocumento"},o.format(2,",",".")),p.a.createElement(A,{text:"F I N A L I Z A R",icon:"dollar2",size:"lg",block:"true",color:"green",disabled:0===o,onClick:this.props.abrirFinalizacao})))))}}]),t}(p.a.Component),ta=(a(653),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={quantidade:a.props.documentoproduto.quantidade,preco:a.props.documentoproduto.preco,descontounitario:a.props.documentoproduto.descontounitario,acrescimounitario:a.props.documentoproduto.acrescimounitario,totaldesconto:a.props.documentoproduto.totaldesconto,totalacrescimo:a.props.documentoproduto.totalacrescimo,totalproduto:a.props.documentoproduto.totalproduto,show:a.props.show},a.calcularTotais=a.calcularTotais.bind(Object(C.a)(a)),a.cancelar=a.cancelar.bind(Object(C.a)(a)),a.confirmar=a.confirmar.bind(Object(C.a)(a)),a.onChangeAcrescimoPercentual=a.onChangeAcrescimoPercentual.bind(Object(C.a)(a)),a.onChangeAcrescimoUnitario=a.onChangeAcrescimoUnitario.bind(Object(C.a)(a)),a.onChangeDescontoPercentual=a.onChangeDescontoPercentual.bind(Object(C.a)(a)),a.onChangeDescontoUnitario=a.onChangeDescontoUnitario.bind(Object(C.a)(a)),a.onChangePreco=a.onChangePreco.bind(Object(C.a)(a)),a.onChangeQuantidade=a.onChangeQuantidade.bind(Object(C.a)(a)),a.onChangeTotalAcrescimo=a.onChangeTotalAcrescimo.bind(Object(C.a)(a)),a.onChangeTotalDesconto=a.onChangeTotalDesconto.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"calcularTotais",value:function(){var e=this.state.preco*this.state.quantidade,t=this.state.acrescimounitario*this.state.quantidade,a=this.state.descontounitario*this.state.quantidade,o=e-a+t;this.setState({totalbruto:e,totalacrescimo:t,totaldesconto:a,totalproduto:o})}},{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"componentWillReceiveProps",value:function(e){this.setState({quantidade:e.documentoproduto.quantidade,preco:e.documentoproduto.preco,descontounitario:e.documentoproduto.descontounitario,acrescimounitario:e.documentoproduto.acrescimounitario,show:e.show},this.calcularTotais)}},{key:"confirmar",value:function(){var e=this,t=Object.assign({},this.props.documentoproduto);t.quantidade=this.state.quantidade,t.preco=this.state.preco,t.descontounitario=this.state.descontounitario,t.acrescimounitario=this.state.acrescimounitario,t.totaldesconto=this.state.totaldesconto,t.totalacrescimo=this.state.totalacrescimo,t.totalproduto=this.state.totalproduto,this.setState({show:!1},(function(){e.props.atualizarDocumentoProduto(t)}))}},{key:"onChangeAcrescimoPercentual",value:function(e){var t=e.target.value.toFloat(),a=this.state.preco*t/100;this.setState({acrescimounitario:a},this.calcularTotais)}},{key:"onChangeAcrescimoUnitario",value:function(e){var t=e.target.value.toFloat();this.setState({acrescimounitario:t},this.calcularTotais)}},{key:"onChangeDescontoPercentual",value:function(e){var t=e.target.value.toFloat(),a=this.state.preco*t/100;this.setState({descontounitario:a},this.calcularTotais)}},{key:"onChangeDescontoUnitario",value:function(e){var t=e.target.value.toFloat();this.setState({descontounitario:t},this.calcularTotais)}},{key:"onChangePreco",value:function(e){var t=e.target.value.toFloat();this.setState({preco:t},this.calcularTotais)}},{key:"onChangeQuantidade",value:function(e){var t=e.target.value.toFloat();this.setState({quantidade:t},this.calcularTotais)}},{key:"onChangeTotalAcrescimo",value:function(e){var t=e.target.value.toFloat()/this.state.quantidade;this.setState({acrescimounitario:t},this.calcularTotais)}},{key:"onChangeTotalDesconto",value:function(e){var t=e.target.value.toFloat()/this.state.quantidade;this.setState({descontounitario:t},this.calcularTotais)}},{key:"render",value:function(){var e=this.state.preco*this.state.quantidade,t=e>0?this.state.totalacrescimo/e*100:0,a=e>0?this.state.totaldesconto/e*100:0,o=this.props.documentoproduto.precisao;return p.a.createElement(I,{id:"VendaEditarProduto",title:this.props.documentoproduto.descricao,show:this.state.show,size:"md",beforeClose:this.props.beforeClose},p.a.createElement(M,null,p.a.createElement(Ne,{type:"text",label:"Quantidade",className:"col-4",inputClassName:"text-center",value:this.state.quantidade.format(o,",","."),onChange:this.onChangeQuantidade,InformarValor:{decimal:o}}),p.a.createElement(Ne,{type:"text",label:"Pre\xe7o unit\xe1rio",className:"col-4",inputClassName:"text-center",value:this.state.preco.format(2,",","."),onChange:this.onChangePreco,InformarValor:{decimal:2,money:!0}}),p.a.createElement(Ne,{type:"text",label:"Valor do item",className:"col-4",inputClassName:"text-center",value:e.format(2,",","."),disabled:!0,readOnly:!0}),p.a.createElement(Ne,{type:"text",label:"Desconto unit\xe1rio",className:"col-4",inputClassName:"text-center",value:this.state.descontounitario.format(2,",","."),onChange:this.onChangeDescontoUnitario,InformarValor:{decimal:2,money:!0}}),p.a.createElement(Ne,{type:"text",label:"Desconto percentual",className:"col-4",inputClassName:"text-center",value:a.format(2,",","."),onChange:this.onChangeDescontoPercentual,InformarValor:{decimal:0}}),p.a.createElement(Ne,{type:"text",label:"Total de desconto",className:"col-4",inputClassName:"text-center",value:this.state.totaldesconto.format(2,",","."),onChange:this.onChangeTotalDesconto,InformarValor:{decimal:2,money:!0}}),p.a.createElement(Ne,{type:"text",label:"Acr\xe9scimo unit\xe1rio",className:"col-4",inputClassName:"text-center",value:this.state.acrescimounitario.format(2,",","."),onChange:this.onChangeAcrescimoUnitario,InformarValor:{decimal:2,money:!0}}),p.a.createElement(Ne,{type:"text",label:"Acr\xe9sc percentual",className:"col-4",inputClassName:"text-center",value:t.format(2,",","."),onChange:this.onChangeAcrescimoPercentual,InformarValor:{decimal:0}}),p.a.createElement(Ne,{type:"text",label:"Total de acr\xe9scimo",className:"col-4",inputClassName:"text-center",value:this.state.totalacrescimo.format(2,",","."),onChange:this.onChangeTotalAcrescimo,InformarValor:{decimal:2,money:!0}}),p.a.createElement(Ne,{type:"text",label:"Total final",className:"col-4 offset-8",inputClassName:"text-center",value:this.state.totalproduto.format(2,",","."),disabled:!0,readOnly:!0})),p.a.createElement(Pe,null),p.a.createElement("div",{className:"text-right"},p.a.createElement(A,{text:"Confirmar",icon:"thumbs-up",color:"green",className:"mr-2",onClick:this.confirmar}),p.a.createElement(A,{text:"Voltar",icon:"thumbs-down",color:"red",onClick:this.cancelar})))}}]),t}(p.a.Component)),aa=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=[this.props.className];return e.push("card"),p.a.createElement("div",{className:e.join(" ")},this.props.children)}}]),t}(p.a.Component),oa=(a(654),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={documentopagamentos:e.listaDocumentoPagamento,formaspagamento:[],show:!1},a.finalizarVenda=a.finalizarVenda.bind(Object(C.a)(a)),a.removerPagamento=a.removerPagamento.bind(Object(C.a)(a)),a.totalpago=0,a.totalrestante=0,a.totaltroco=0,a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"carregarFormasPagamento",value:function(){var e=this;this.props.Pool.query("SELECT idformapagamento, descricao, especie FROM formapagamento WHERE status = $1 ORDER BY especie",["A"],(function(t,a){if(t)return Z(t),!1;e.setState({formaspagamento:a.rows})}))}},{key:"componentDidMount",value:function(){this.carregarFormasPagamento()}},{key:"componentWillReceiveProps",value:function(e){this.setState({documentopagamentos:e.listaDocumentoPagamento,show:e.show})}},{key:"finalizarVenda",value:function(){this.props.finalizarVenda(this.state.documentopagamentos,this.totaltroco)}},{key:"iconEspecie",value:function(e){switch(e){case"01":return"dollar";case"02":return"keyboard";case"03":case"04":return"credit-card";case"10":case"11":case"12":case"13":return"discout";case"99":default:return"money"}}},{key:"incluirPagamento",value:function(e){var t=this;window.InformarValor.show({title:e.descricao,decimal:2,money:!0,value:this.totalrestante.format(2,",","."),success:function(a){if((a=a.toFloat())>0){var o=t.state.documentopagamentos;o.push({idformapagamento:e.idformapagamento,descricao:e.descricao,totalpagamento:a}),t.setState({documentopagamentos:o},(function(){"01"===e.especie&&0===t.totalrestante&&t.finalizarVenda()}))}}})}},{key:"removerPagamento",value:function(e){var t=this.state.documentopagamentos;t.splice(e,1),this.setState({documentopagamentos:t})}},{key:"render",value:function(){var e=this;this.totalpago=0;var t=!0,a=!1,o=void 0;try{for(var r,n=this.state.documentopagamentos[Symbol.iterator]();!(t=(r=n.next()).done);t=!0){var i=r.value;this.totalpago+=i.totalpagamento}}catch(s){a=!0,o=s}finally{try{t||null==n.return||n.return()}finally{if(a)throw o}}return this.totalpago>this.props.totaldocumento?(this.totalrestante=0,this.totaltroco=Math.round(100*(this.totalpago-this.props.totaldocumento))/100):(this.totalrestante=Math.round(100*(this.props.totaldocumento-this.totalpago))/100,this.totaltroco=0),p.a.createElement("div",{className:"vendafinalizacao"+(this.state.show?"":" d-none")},p.a.createElement(I,{title:"Finaliza\xe7\xe3o da venda",size:"lg",show:this.state.show,beforeClose:this.props.beforeClose},p.a.createElement("div",{className:"vendafinalizacao-totaldocumento"},this.props.totaldocumento.format(2,",",".")),p.a.createElement(M,{className:"vendafinalizacao-formapagamento"},this.state.formaspagamento.map((function(t,a){return p.a.createElement(T,{size:"4",key:a},p.a.createElement(A,{text:t.descricao,block:!0,size:"lg",icon:e.iconEspecie(t.especie),disabled:0===e.totalrestante,onClick:function(){e.incluirPagamento(t)}}))}))),p.a.createElement(Pe,null),p.a.createElement(M,null,p.a.createElement(Ne,{label:"Total pago",className:"col-3",inputClassName:"text-center",size:"lg",value:this.totalpago.format(2,",","."),disabled:!0}),p.a.createElement(Ne,{label:"Total restante",className:"col-3",inputClassName:"text-center",size:"lg",value:this.totalrestante.format(2,",","."),disabled:!0,warning:this.totalrestante}),p.a.createElement(Ne,{label:"Total de troco",className:"col-3",inputClassName:"text-center",size:"lg",value:this.totaltroco.format(2,",","."),disabled:!0,warning:this.totaltroco}),p.a.createElement(T,{size:"3",labelMargin:!0},p.a.createElement(A,{text:"Finalizar!",icon:"thumbs-up",block:!0,size:"lg",color:"green",disabled:this.totalrestante>0,onClick:this.finalizarVenda}))),p.a.createElement(ra,{documentopagamentos:this.state.documentopagamentos,removerPagamento:this.removerPagamento})),p.a.createElement("div",{className:"vendafinalizacao-botoesextras"},p.a.createElement(M,null,p.a.createElement(T,{size:"4"},p.a.createElement(A,{text:"Desconto",icon:"folder-minus",size:"sm",block:!0,disabled:this.totalpago>0,onClick:this.props.aplicarDesconto})),p.a.createElement(T,{size:"4"},p.a.createElement(A,{text:"Acr\xe9scimo",icon:"folder-plus",size:"sm",block:!0,disabled:this.totalpago>0,onClick:this.props.aplicarAcrescimo})),p.a.createElement(T,{size:"4"},p.a.createElement(A,{text:"Incluir 10%",icon:"user-plus",size:"sm",block:!0,onClick:this.props.incluirDezPorcento})))))}}]),t}(p.a.Component)),ra=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return 0===this.props.documentopagamentos.length?null:p.a.createElement("div",null,p.a.createElement(Pe,{className:"mt-0"}),p.a.createElement(M,{className:"justify-content-center"},this.props.documentopagamentos.map((function(t,a){return p.a.createElement(T,{size:"6",key:a},p.a.createElement(aa,null,p.a.createElement(M,null,p.a.createElement(T,{size:"5"},p.a.createElement("span",null,t.descricao)),p.a.createElement(T,{size:"4"},p.a.createElement("span",null,t.totalpagamento.format(2,",","."))),p.a.createElement(T,{size:"3"},p.a.createElement(A,{icon:"bin",color:"red",size:"sm",block:!0,onClick:function(){e.props.removerPagamento(a)}})))))}))))}}]),t}(p.a.Component),na=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={nomeorcamento:a.props.nomeorcamento,cpfcnpj:a.props.cpfcnpj,show:a.props.show},a.cancelar=a.cancelar.bind(Object(C.a)(a)),a.confirmar=a.confirmar.bind(Object(C.a)(a)),a.onChangeCpfCnpj=a.onChangeCpfCnpj.bind(Object(C.a)(a)),a.onChangeNomeOrcamento=a.onChangeNomeOrcamento.bind(Object(C.a)(a)),a.onFocusCpfCnpj=a.onFocusCpfCnpj.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"componentWillReceiveProps",value:function(e){this.setState({nomeorcamento:e.nomeorcamento,cpfcnpj:e.cpfcnpj,show:e.show})}},{key:"confirmar",value:function(){this.props.finalizarOrcamento(this.state.nomeorcamento,this.state.cpfcnpj)}},{key:"onChangeCpfCnpj",value:function(e){this.setState({cpfcnpj:e.target.value})}},{key:"onChangeNomeOrcamento",value:function(e){this.setState({nomeorcamento:e.target.value})}},{key:"onFocusCpfCnpj",value:function(e){var t=this;window.InformarValor.show({title:"Informe o CPF ou CNPJ",mask:"99999999999999",success:function(e){var a=null;if(11===e.length&&ne(e))a=e.substr(0,3)+"."+e.substr(3,3)+"."+e.substr(6,3)+"-"+e.substr(9,2);else if(14===e.length&&re(e))a=e.substr(0,2)+"."+e.substr(2,3)+"."+e.substr(5,3)+"/"+e.substr(8,4)+"-"+e.substr(12,2);else if(e.length>0)return window.MessageBox.show({title:"CPF ou CNPJ inv\xe1lido",text:"O CPF ou CNPJ informado \xe9 inv\xe1lido."}),!1;t.setState({cpfcnpj:a})},fail:function(){t.setState({cpfcnpj:null})}})}},{key:"render",value:function(){return p.a.createElement(I,{id:"VendaFinalizacaoOrcamento",show:this.state.show,size:"sm",beforeClose:this.props.beforeClose},p.a.createElement(M,null,p.a.createElement(Ne,{type:"text",className:"col-12",label:"Nome do cliente",value:this.state.nomeorcamento,onChange:this.onChangeNomeOrcamento}),p.a.createElement(Ne,{type:"text",className:"col-12",label:"CPF/CNPJ",value:this.state.cpfcnpj,onChange:this.onChangeCpfCnpj,onFocus:this.onFocusCpfCnpj})),p.a.createElement(Pe,{className:"mt-0"}),p.a.createElement(M,null,p.a.createElement(T,{size:"6"},p.a.createElement(A,{text:"Cancelar",color:"red",block:!0,onClick:this.cancelar})),p.a.createElement(T,{size:"6",className:"pl-0"},p.a.createElement(A,{text:"Confirmar",color:"green",block:!0,onClick:this.confirmar}))))}}]),t}(p.a.Component),ia=(a(655),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={listaUltimosDocumentos:[],show:!1},a.carregarUltimosDocumentos=a.carregarUltimosDocumentos.bind(Object(C.a)(a)),a.imprimir=a.imprimir.bind(Object(C.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"atualizarState",value:function(e){var t=e.numero?e.numero:"",a=e.cpfcnpj?e.cpfcnpj:"n\xe3o informado";this.setState({iddocumento:e.iddocumento,numero:String(t).lpad(6,"0"),totaldocumento:"R$ "+e.totaldocumento.format(2,",","."),cpfcnpj:a})}},{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"carregarDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=["SELECT iddocumento, numero, totaldocumento, cpfcnpj","FROM documento","WHERE operacao = $1","  AND numero = $2","ORDER BY iddocumento DESC","LIMIT 1"].join(" "),e.next=3,this.props.Pool.query(a,["CU",t]);case 3:if(0!==(o=e.sent).rowCount){e.next=8;break}return this.setState({show:!1}),window.MessageBox.show({title:"Houve uma falha",text:"Nenhum documento foi encontrado com o n\xfamero "+t+"."}),e.abrupt("return",!1);case 8:n=o.rows[0],this.atualizarState(n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"carregarUltimosDocumentos",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,l,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["SELECT iddocumento, dthrcriacao, totaldocumento, totalquantidade, cpfcnpj","FROM documento","WHERE operacao = $1","ORDER BY dthrcriacao DESC","LIMIT 3"].join(" "),e.next=3,this.props.Pool.query(t,["CU"]);case 3:for(a=e.sent,o=[],n=!0,i=!1,s=void 0,e.prev=8,c=a.rows[Symbol.iterator]();!(n=(l=c.next()).done);n=!0)u=l.value,o.push(u);e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),i=!0,s=e.t0;case 16:e.prev=16,e.prev=17,n||null==c.return||c.return();case 19:if(e.prev=19,!i){e.next=22;break}throw s;case 22:return e.finish(19);case 23:return e.finish(16);case 24:this.setState({listaUltimosDocumentos:o});case 25:case"end":return e.stop()}}),e,this,[[8,12,16,24],[17,,19,23]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(e){this.setState({show:e.show}),!this.state.show&&e.show&&this.carregarUltimosDocumentos()}},{key:"imprimir",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new rt(this.props.Pool),e.next=3,a.imprimirDocumento(t,(function(){o.setState({show:!1}),window.FastMessage.show("Cupom enviado para impressora com sucesso!")}),(function(e){e&&Z(e)}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return p.a.createElement(I,{id:"VendaReimprimirCupom",title:"Reimpress\xe3o de cupom",show:this.state.show,size:"md",beforeClose:this.props.beforeClose},p.a.createElement(ht,null,this.state.listaUltimosDocumentos.map((function(t,a){var o=t.dthrcriacao.toLocaleString(),r="R$ "+t.totaldocumento.format(2,",","."),n=Math.round(t.totalquantidade),i=t.cpfcnpj;return p.a.createElement(ft,{key:a,onClick:function(){e.imprimir(t.iddocumento)}},p.a.createElement(M,null,p.a.createElement(T,{size:"12"},p.a.createElement("h3",{className:"text-center"},o)),p.a.createElement(T,{size:"4",className:"text-center"},p.a.createElement("span",null,"Total documento"),p.a.createElement("h4",null,r)),p.a.createElement(T,{size:"4",className:"text-center"},p.a.createElement("span",null,"Qtde de itens"),p.a.createElement("h4",null,n)),p.a.createElement(T,{size:"4",className:"text-center"},p.a.createElement("span",null,"CPF/CNPJ"),p.a.createElement("h4",null,i))))}))))}}]),t}(p.a.Component)),sa=(a(656),a(657),window.require("fs")),ca=function(e){function t(e){var a;Object(i.a)(this,t);var o=(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).criarObjetoDocumentoProduto();return a.state={documentoproduto:o,listaDocumentoProduto:[],listaDocumentoPagamento:[],operacao:"CU",cpfcnpj:null,nomeorcamento:null,iddocumentoorcamento:null,pesquisa:"",pesquisaEfetiva:"",showEditarProduto:!1,showVendaAplicarDesconto:!1,showVendaAplicarAcrescimo:!1,showVendaCancelarCupom:!1,showVendaFinalizacao:!1,showVendaFinalizacaoOrcamento:!1,showVendaReimprimirCupom:!1},a.abrirFinalizacao=a.abrirFinalizacao.bind(Object(C.a)(a)),a.aplicarAcrescimo=a.aplicarAcrescimo.bind(Object(C.a)(a)),a.aplicarDesconto=a.aplicarDesconto.bind(Object(C.a)(a)),a.atualizarDocumentoProduto=a.atualizarDocumentoProduto.bind(Object(C.a)(a)),a.aumentarQuantidade=a.aumentarQuantidade.bind(Object(C.a)(a)),a.cancelarUltimaVenda=a.cancelarUltimaVenda.bind(Object(C.a)(a)),a.cancelarVendaAtual=a.cancelarVendaAtual.bind(Object(C.a)(a)),a.carregarOrcamento=a.carregarOrcamento.bind(Object(C.a)(a)),a.carregarTemporario=a.carregarTemporario.bind(Object(C.a)(a)),a.diminuirQuantidade=a.diminuirQuantidade.bind(Object(C.a)(a)),a.editarProduto=a.editarProduto.bind(Object(C.a)(a)),a.finalizarDocumento=a.finalizarDocumento.bind(Object(C.a)(a)),a.finalizarOrcamento=a.finalizarOrcamento.bind(Object(C.a)(a)),a.finalizarVenda=a.finalizarVenda.bind(Object(C.a)(a)),a.gravarTemporario=a.gravarTemporario.bind(Object(C.a)(a)),a.incluirDezPorcento=a.incluirDezPorcento.bind(Object(C.a)(a)),a.incluirProduto=a.incluirProduto.bind(Object(C.a)(a)),a.informarCPF=a.informarCPF.bind(Object(C.a)(a)),a.onChangePesquisa=a.onChangePesquisa.bind(Object(C.a)(a)),a.onClickBuscar=a.onClickBuscar.bind(Object(C.a)(a)),a.onKeyUpPesquisa=a.onKeyUpPesquisa.bind(Object(C.a)(a)),a.pesquisaLimpar=a.pesquisaLimpar.bind(Object(C.a)(a)),a.reimprimirCupom=a.reimprimirCupom.bind(Object(C.a)(a)),a.reiniciar=a.reiniciar.bind(Object(C.a)(a)),a.removerProduto=a.removerProduto.bind(Object(C.a)(a)),a.trocarOperacao=a.trocarOperacao.bind(Object(C.a)(a)),a.Pool=new pe,a.temporaryFileName="venda.tmp",a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"abrirFinalizacao",value:function(){switch(this.state.operacao){case"CU":this.setState({showVendaFinalizacao:!0});break;case"OR":this.setState({showVendaFinalizacaoOrcamento:!0})}}},{key:"aplicarAcrescimo",value:function(e,t){var a=this;if(isNaN(e)||isNaN(t))this.setState({showVendaAplicarAcrescimo:!0});else{var o=this.state.listaDocumentoProduto;o.forEach((function(o){var r=o.preco*o.quantidade,n=t*(r/e)/o.quantidade;o.acrescimounitario=n,a.calcularDocumentoProduto(o)})),this.setState({listaDocumentoProduto:o,showVendaAplicarAcrescimo:!1})}}},{key:"aplicarDesconto",value:function(e,t){var a=this;if(isNaN(e)||isNaN(t))this.setState({showVendaAplicarDesconto:!0});else{var o=this.state.listaDocumentoProduto;o.forEach((function(o){var r=o.preco*o.quantidade,n=Math.round(t*(r/e)*100)/100,i=Math.round(n/o.quantidade*100)/100;o.descontounitario=i,a.calcularDocumentoProduto(o)}));for(var r=function(){var e=0;o.forEach((function(t){e+=t.descontounitario*t.quantidade}));var a=t-e;return a=Math.round(100*a)/100},n=0,i=r();0!==i&&n++<20;){var s=Math.round(Math.random()*(o.length-1)),c=o[s],l=c.descontounitario,u=l*c.quantidade+i;l=Math.round(u/c.quantidade*100)/100,c.descontounitario=l,this.calcularDocumentoProduto(c),i=r()}this.setState({listaDocumentoProduto:o,showVendaAplicarDesconto:!1})}}},{key:"atualizarDocumentoProduto",value:function(e){var t=e.i,a=this.state.listaDocumentoProduto;a[t]=e,this.setState({listaDocumentoProduto:a})}},{key:"aumentarQuantidade",value:function(e){var t=e.i,a=this.state.listaDocumentoProduto;(e=a[t]).quantidade++,this.calcularDocumentoProduto(e),a[t]=e,this.setState({listaDocumentoProduto:a})}},{key:"calcularDocumentoProduto",value:function(e){e.totaldesconto=e.descontounitario*e.quantidade,e.totalacrescimo=e.acrescimounitario*e.quantidade,e.totalproduto=e.preco*e.quantidade-e.totaldesconto+e.totalacrescimo}},{key:"cancelarUltimaVenda",value:function(){this.setState({showVendaCancelarCupom:!0})}},{key:"cancelarVendaAtual",value:function(){var e=this;window.MessageBox.show({title:"Cancelamento de venda",text:"Tem certeza que deseja cancelar a venda atual?",buttons:[{text:"Sim",icon:"thumbs-up",color:"green",onClick:function(){window.MessageBox.hide(),e.setState({cpfcnpj:null,listaDocumentoProduto:[],listaDocumentoPagamento:[]})}},{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:function(){window.MessageBox.hide()}}]})}},{key:"carregarOrcamento",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,window.Loading.show(),"SELECT iddocumento, cpfcnpj, nomeorcamento FROM documento WHERE operacao = $1 AND iddocumento = $2",e.next=5,this.Pool.query("SELECT iddocumento, cpfcnpj, nomeorcamento FROM documento WHERE operacao = $1 AND iddocumento = $2",["OR",t]);case 5:if(0!==(a=e.sent).rows.length){e.next=8;break}throw new Error("Or\xe7amento de n\xfamero <b>"+t+"</b> n\xe3o p\xf4de ser encontrado.");case 8:return o=a.rows[0],n=[],"SELECT * FROM documentoproduto WHERE iddocumento = $1",e.next=13,this.Pool.query("SELECT * FROM documentoproduto WHERE iddocumento = $1",[o.iddocumento]);case 13:for(i=e.sent,s=!0,c=!1,l=void 0,e.prev=17,u=i.rows[Symbol.iterator]();!(s=(d=u.next()).done);s=!0)p=d.value,n.push(this.criarObjetoDocumentoProduto({idproduto:p.idproduto,descricao:p.descricao,unidade:p.unidade,precisao:p.precisao,precovariavel:p.precovariavel,quantidade:p.quantidade,preco:p.preco,descontounitario:p.descontounitario,totaldesconto:p.totaldesconto,acrescimounitario:p.acrescimounitario,totalacrescimo:p.totalacrescimo,totalproduto:p.totalproduto}));e.next=25;break;case 21:e.prev=21,e.t0=e.catch(17),c=!0,l=e.t0;case 25:e.prev=25,e.prev=26,s||null==u.return||u.return();case 28:if(e.prev=28,!c){e.next=31;break}throw l;case 31:return e.finish(28);case 32:return e.finish(25);case 33:this.setState({operacao:"CU",cpfcnpj:o.cpfcnpj,nomeorcamento:o.nomeorcamento,listaDocumentoProduto:n,iddocumentoorcamento:t}),e.next=39;break;case 36:e.prev=36,e.t1=e.catch(0),Z(e.t1);case 39:return e.prev=39,window.Loading.hide(),e.finish(39);case 42:case"end":return e.stop()}}),e,this,[[0,36,39,42],[17,21,25,33],[26,,28,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"carregarTemporario",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=oe()+"/"+this.temporaryFileName,sa.existsSync(t)&&(a=sa.readFileSync(t),"object"===typeof(o=JSON.parse(a))&&this.setState(o));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.props.match.params.id?this.carregarOrcamento(this.props.match.params.id):this.carregarTemporario()}},{key:"componentWillUnmount",value:function(){this.Pool.end()}},{key:"componentWillUpdate",value:function(e,t){this.gravarTemporario(t)}},{key:"criarObjetoDocumentoProduto",value:function(e){return b.a.extend({idproduto:null,descricao:null,unidade:"Unidade",precisao:0,precovariavel:"N",quantidade:0,preco:0,descontounitario:0,totaldesconto:0,acrescimounitario:0,totalacrescimo:0,totalproduto:0},e)}},{key:"diminuirQuantidade",value:function(e){var t=e.i,a=this.state.listaDocumentoProduto;if((e=a[t]).quantidade-1<=0)return!0;e.quantidade--,this.calcularDocumentoProduto(e),a[t]=e,this.setState({listaDocumentoProduto:a})}},{key:"editarProduto",value:function(e){this.setState({documentoproduto:e,showEditarProduto:!0})}},{key:"finalizarDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,i,s,c,l,u,d,p,m,h,f,v,b,g,E,x,C,O,k,y,w,S,j,N,P,D,A,T,R,I,M,q,L,F,z,U,V,B,_,$,H,W,G=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.Loading.show(),e.next=3,this.Pool.connect();case 3:return t=e.sent,e.prev=4,e.next=7,t.query("BEGIN");case 7:return a=["INSERT INTO documento (operacao, modelo, cpfcnpj, nomeorcamento, totaltroco)","VALUES ($1, $2, $3, $4, $5)","RETURNING iddocumento"].join(" "),e.next=10,t.query(a,[this.state.operacao,"65",this.state.cpfcnpj,this.state.nomeorcamento,this.state.totaltroco]);case 10:for(o=e.sent,i=o.rows[0].iddocumento,s=[],c=!0,l=!1,u=void 0,e.prev=16,d=this.state.listaDocumentoProduto[Symbol.iterator]();!(c=(p=d.next()).done);c=!0)m=p.value,s.push(m.idproduto);e.next=24;break;case 20:e.prev=20,e.t0=e.catch(16),l=!0,u=e.t0;case 24:e.prev=24,e.prev=25,c||null==d.return||d.return();case 27:if(e.prev=27,!l){e.next=30;break}throw u;case 30:return e.finish(27);case 31:return e.finish(24);case 32:return h=["SELECT produto.idproduto, ncm.codigoncm, produto.origem,","  produto.csosn, produto.aliqicms, produto.cstpis, produto.aliqpis,","  produto.cstcofins, produto.aliqcofins, produto.codcontribsocial,","  produto.cest, produto.cfop","FROM produto","LEFT JOIN ncm USING (idncm)","WHERE idproduto IN ("+s.join(", ")+")"].join(" "),e.next=35,t.query(h);case 35:for(f=e.sent,v={},b=!0,g=!1,E=void 0,e.prev=40,x=f.rows[Symbol.iterator]();!(b=(C=x.next()).done);b=!0)O=C.value,k=O.idproduto,delete O.idproduto,v[k]=O;e.next=48;break;case 44:e.prev=44,e.t1=e.catch(40),g=!0,E=e.t1;case 48:e.prev=48,e.prev=49,b||null==x.return||x.return();case 51:if(e.prev=51,!g){e.next=54;break}throw E;case 54:return e.finish(51);case 55:return e.finish(48);case 56:y=1,w=!0,S=!1,j=void 0,e.prev=60,N=this.state.listaDocumentoProduto[Symbol.iterator]();case 62:if(w=(P=N.next()).done){e.next=71;break}return D=P.value,A=v[D.idproduto],T=["INSERT INTO documentoproduto (","  iddocumento, sequencial, idproduto,","  descricao, preco, quantidade,","  descontounitario, acrescimounitario, codigoncm,","  origem, csosn, aliqicms,","  cstpis, aliqpis, cstcofins,","  aliqcofins, codcontribsocial, cest,","  cfop",") VALUES (","  $1, $2, $3,","  $4, $5, $6,","  $7, $8, $9,","  $10, $11, $12,","  $13, $14, $15,","  $16, $17, $18,","  $19",")"].join(" "),e.next=68,t.query(T,[i,y++,D.idproduto,D.descricao,D.preco,D.quantidade,D.descontounitario,D.acrescimounitario,A.codigoncm,A.origem,A.csosn,A.aliqicms,A.cstpis,A.aliqpis,A.cstcofins,A.aliqcofins,A.codcontribsocial,A.cest,A.cfop]);case 68:w=!0,e.next=62;break;case 71:e.next=77;break;case 73:e.prev=73,e.t2=e.catch(60),S=!0,j=e.t2;case 77:e.prev=77,e.prev=78,w||null==N.return||N.return();case 80:if(e.prev=80,!S){e.next=83;break}throw j;case 83:return e.finish(80);case 84:return e.finish(77);case 85:if("CU"!==this.state.operacao){e.next=123;break}R=this.state.listaDocumentoPagamento,this.state.totaltroco>0&&(I=R.length-1,R[I].totalpagamento-=this.state.totaltroco),M=!0,q=!1,L=void 0,e.prev=91,F=R[Symbol.iterator]();case 93:if(M=(z=F.next()).done){e.next=101;break}return U=z.value,V=["INSERT INTO documentopagamento (iddocumento, idformapagamento, totalpagamento)","VALUES ($1, $2, $3)"].join(" "),e.next=98,t.query(V,[i,U.idformapagamento,U.totalpagamento]);case 98:M=!0,e.next=93;break;case 101:e.next=107;break;case 103:e.prev=103,e.t3=e.catch(91),q=!0,L=e.t3;case 107:e.prev=107,e.prev=108,M||null==F.return||F.return();case 110:if(e.prev=110,!q){e.next=113;break}throw L;case 113:return e.finish(110);case 114:return e.finish(107);case 115:return B=new Yt(t),e.next=118,B.transmitirDocumento(i);case 118:if(!1!==(_=e.sent)){e.next=121;break}throw new Error(B.error);case 121:return e.next=123,t.query("UPDATE documento SET xml = $1, chave = $2, numero = $3 WHERE iddocumento = $4",[_.xml,_.chave,_.numero,i]);case 123:if(!this.state.iddocumentoorcamento){e.next=126;break}return e.next=126,t.query("DELETE FROM documento WHERE iddocumento = $1",[this.state.iddocumentoorcamento]);case 126:return e.next=128,t.query("COMMIT");case 128:if(!(this.state.totaltroco>0)){e.next=132;break}window.MessageBox.show({text:"<div class='text-center'><h5>Venda finalizada com sucesso!</h5><h3>Total de troco</h3><h1><small>R$</small>"+this.state.totaltroco.format(2,",",".")+"</h1></div>"}),e.next=139;break;case 132:e.t4=this.state.operacao,e.next="CU"===e.t4?135:"OR"===e.t4?137:135;break;case 135:return window.FastMessage.show("Venda finalizada com sucesso!"),e.abrupt("break",139);case 137:return window.FastMessage.show("Or\xe7amento finalizado com sucesso!"),e.abrupt("break",139);case 139:return e.t5=St.a,e.next=142,ie(this.Pool,"IMPRESSORA","NUMEROVIAS");case 142:return e.t6=e.sent,$=e.t5.parse.call(e.t5,e.t6),$="OR"===this.state.operacao?$.orcamento:$.venda,e.next=147,ie(this.Pool,"IMPRESSORA","CONFIRMACAO");case 147:if(e.t7=e.sent,"S"!==e.t7){e.next=152;break}window.MessageBox.show({title:"Imprimir cupom",text:"Deseja imprimir o cupom da venda realizada?",buttons:[{text:"Sim",color:"green",icon:"thumbs-up",onClick:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.MessageBox.hide(),t=1;case 2:if(!(t<=$)){e.next=9;break}return a=new rt(G.Pool),e.next=6,a.imprimirDocumento(i);case 6:t++,e.next=2;break;case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{text:"N\xe3o",color:"red",icon:"thumbs-down",onClick:function(){window.MessageBox.hide()}}]}),e.next=160;break;case 152:H=1;case 153:if(!(H<=$)){e.next=160;break}return W=new rt(this.Pool),e.next=157,W.imprimirDocumento(i);case 157:H++,e.next=153;break;case 160:this.reiniciar(),e.next=168;break;case 163:return e.prev=163,e.t8=e.catch(4),e.next=167,t.query("ROLLBACK");case 167:Z(e.t8);case 168:return e.prev=168,t.release(),window.Loading.hide(),e.finish(168);case 172:case"end":return e.stop()}}),e,this,[[4,163,168,172],[16,20,24,32],[25,,27,31],[40,44,48,56],[49,,51,55],[60,73,77,85],[78,,80,84],[91,103,107,115],[108,,110,114]])})));return function(){return e.apply(this,arguments)}}()},{key:"finalizarOrcamento",value:function(e,t){var a=this;this.setState({nomeorcamento:e,cpfcnpj:t,listaDocumentoPagamento:[],totaltroco:0,showVendaFinalizacaoOrcamento:!1},(function(){a.finalizarDocumento()}))}},{key:"finalizarVenda",value:function(e,t){var a=this;this.setState({listaDocumentoPagamento:e,totaltroco:t},(function(){a.finalizarDocumento()}))}},{key:"gravarTemporario",value:function(){var e=Object(n.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=void 0===t?this.state:t,ce(this.temporaryFileName,JSON.stringify(t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"incluirDezPorcento",value:function(){var e=this,t=this.state.listaDocumentoProduto;t.forEach((function(t){t.acrescimounitario=.1*t.preco,e.calcularDocumentoProduto(t)})),this.setState({listaDocumentoProduto:t})}},{key:"incluirProduto",value:function(e,t,a){var o=this;e=Object.assign({},e);var r=function(e){window.InformarValor.show({title:"Quantidade em "+e.unidade.toLowerCase()+"s",decimal:e.precisao,success:function(t){e.quantidade=t.toFloat(),o.incluirProdutoDefinitivo(e)}})};"S"===e.precovariavel?window.InformarValor.show({title:"Pre\xe7o do produto",money:!0,decimal:2,success:function(t){e.preco=t.toFloat(),e.precisao>0&&!a?r(e):o.incluirProdutoDefinitivo(e,a)}}):e.precisao>0&&!a?r(e):this.incluirProdutoDefinitivo(e,a)}},{key:"incluirProdutoDefinitivo",value:function(e,t){var a=this,o=this.state.listaDocumentoProduto;t?e.quantidade=t/e.preco:e.quantidade||(e.quantidade=1);var r=this.criarObjetoDocumentoProduto({idproduto:e.idproduto,descricao:e.descricao,unidade:e.unidade,precisao:e.precisao,precovariavel:e.precovariavel,quantidade:e.quantidade,preco:e.preco});this.calcularDocumentoProduto(r);var n=!1;if(o.forEach((function(e){if(n)return!1;var t=Object.assign({},r),o=Object.assign({},e);delete t.quantidade,delete o.quantidade,delete t.totalproduto,delete o.totalproduto,delete o.i,JSON.stringify(t)===JSON.stringify(o)&&(e.quantidade+=r.quantidade,a.calcularDocumentoProduto(e),n=!0)})),0===parseFloat(r.preco))return window.MessageBox.show({title:"Produto sem pre\xe7o",text:"O pre\xe7o do produto precisa ser maior que zero."}),!1;n||o.push(r),this.setState({listaDocumentoProduto:o,pesquisa:"",pesquisaEfetiva:""})}},{key:"informarCPF",value:function(){var e=this;window.InformarValor.show({title:"Informe o CPF ou CNPJ",mask:"99999999999999",success:function(t){var a=null;if(11===t.length&&ne(t))a=t.substr(0,3)+"."+t.substr(3,3)+"."+t.substr(6,3)+"-"+t.substr(9,2);else if(14===t.length&&re(t))a=t.substr(0,2)+"."+t.substr(2,3)+"."+t.substr(5,3)+"/"+t.substr(8,4)+"-"+t.substr(12,2);else if(t.length>0)return window.MessageBox.show({title:"CPF ou CNPJ inv\xe1lido",text:"O CPF ou CNPJ informado \xe9 inv\xe1lido.<br>Por favor, digite novamente.",buttons:[{text:"Ok",icon:"thumbs-up",color:"blue",onClick:function(){window.MessageBox.hide(),e.informarCPF()}}]}),!1;e.setState({cpfcnpj:a})},fail:function(){e.setState({cpfcnpj:null})}})}},{key:"onChangePesquisa",value:function(e){this.setState({pesquisa:e.target.value})}},{key:"onClickBuscar",value:function(){this.setState({pesquisaEfetiva:this.state.pesquisa})}},{key:"onKeyUpPesquisa",value:function(e){13===e.keyCode&&this.onClickBuscar()}},{key:"pesquisaLimpar",value:function(){this.setState({pesquisa:"",pesquisaEfetiva:""})}},{key:"reimprimirCupom",value:function(){this.setState({showVendaReimprimirCupom:!0})}},{key:"reiniciar",value:function(){var e=this.criarObjetoDocumentoProduto();this.setState({documentoproduto:e,listaDocumentoProduto:[],listaDocumentoPagamento:[],cpfcnpj:null,nomeorcamento:null,iddocumentoorcamento:null,pesquisa:"",pesquisaEfetiva:"",showEditarProduto:!1,showVendaFinalizacao:!1,showVendaFinalizacaoOrcamento:!1,showVendaAplicarDesconto:!1,showVendaAplicarAcrescimo:!1})}},{key:"removerProduto",value:function(e){var t=this,a="R$ "+e.totalproduto.format(2,",",".");window.MessageBox.show({text:"Tem certeza que deseja remover o produto?<br><br>"+e.descricao+"<span class='float-right'>"+a+"</span>",buttons:[{text:"Sim",icon:"thumbs-up",color:"green",onClick:function(){window.MessageBox.hide();var a=t.state.listaDocumentoProduto;a.splice(e.i,1),t.setState({listaDocumentoProduto:a})}},{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:function(){window.MessageBox.hide()}}]})}},{key:"trocarOperacao",value:function(e){this.setState({operacao:e})}},{key:"render",value:function(){var e=this,t=0,a=0,o=0;this.state.listaDocumentoProduto.forEach((function(e){t+=parseFloat(e.preco*e.quantidade),a+=parseFloat(e.totaldesconto),o+=parseFloat(e.totalproduto)}));var r="operacao-"+this.state.operacao;return p.a.createElement(me,{className:r},p.a.createElement(M,null,p.a.createElement(T,{size:"7"},p.a.createElement(M,{className:"mb-4 mt-4"},p.a.createElement(T,{size:"9"},p.a.createElement(we,{type:"search",id:"pesquisa",value:this.state.pesquisa,placeholder:"Pesquise um produto...",onKeyUp:this.onKeyUpPesquisa,onChange:this.onChangePesquisa}),p.a.createElement(O,{name:"cross",id:"pesquisa-limpar",onClick:this.pesquisaLimpar,className:this.state.pesquisa.length>0?null:"d-none"})),p.a.createElement(T,{size:"3",className:"pl-0"},p.a.createElement(A,{text:"Buscar",icon:"search",color:"green",block:!0,onClick:this.onClickBuscar}))),p.a.createElement(Ft,{Pool:this.Pool,pesquisa:this.state.pesquisaEfetiva,onSelectProduto:this.incluirProduto})),p.a.createElement(T,{size:"5",className:"pr-0"},p.a.createElement(Jt,{abrirFinalizacao:this.abrirFinalizacao,aumentarQuantidade:this.aumentarQuantidade,cancelarUltimaVenda:this.cancelarUltimaVenda,cancelarVendaAtual:this.cancelarVendaAtual,carregarOrcamento:this.carregarOrcamento,reimprimirCupom:this.reimprimirCupom,cpfcnpj:this.state.cpfcnpj,diminuirQuantidade:this.diminuirQuantidade,editarProduto:this.editarProduto,informarCPF:this.informarCPF,listaDocumentoProduto:this.state.listaDocumentoProduto,operacao:this.state.operacao,removerProduto:this.removerProduto,trocarOperacao:this.trocarOperacao}))),p.a.createElement(ta,{show:this.state.showEditarProduto,documentoproduto:this.state.documentoproduto,atualizarDocumentoProduto:this.atualizarDocumentoProduto,beforeClose:function(){e.setState({showEditarProduto:!1})}}),p.a.createElement(oa,{Pool:this.Pool,show:this.state.showVendaFinalizacao,totaldocumento:o,aplicarAcrescimo:this.aplicarAcrescimo,aplicarDesconto:this.aplicarDesconto,incluirDezPorcento:this.incluirDezPorcento,finalizarVenda:this.finalizarVenda,listaDocumentoPagamento:this.state.listaDocumentoPagamento,beforeClose:function(){e.setState({showVendaFinalizacao:!1})}}),p.a.createElement(na,{nomeorcamento:this.state.nomeorcamento,cpfcnpj:this.state.cpfcnpj,finalizarOrcamento:this.finalizarOrcamento,show:this.state.showVendaFinalizacaoOrcamento,beforeClose:function(){e.setState({showVendaFinalizacaoOrcamento:!1})}}),p.a.createElement(Ut,{totalbruto:t,show:this.state.showVendaAplicarDesconto,aplicarDesconto:this.aplicarDesconto,beforeClose:function(){e.setState({showVendaAplicarDesconto:!1})}}),p.a.createElement(zt,{totalbruto:t,totaldesconto:a,show:this.state.showVendaAplicarAcrescimo,aplicarAcrescimo:this.aplicarAcrescimo,beforeClose:function(){e.setState({showVendaAplicarAcrescimo:!1})}}),p.a.createElement(Qt,{Pool:this.Pool,show:this.state.showVendaCancelarCupom,beforeClose:function(){e.setState({showVendaCancelarCupom:!1})}}),p.a.createElement(ia,{Pool:this.Pool,show:this.state.showVendaReimprimirCupom,beforeClose:function(){e.setState({showVendaReimprimirCupom:!1})}}))}}]),t}(p.a.Component),la=function(){function e(t,a){Object(i.a)(this,e),this.Pool=t,this.referencia=a,this.dthrinicial=K()}return Object(s.a)(e,[{key:"atualizarProcesso",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"UPDATE processo SET dthrinicial = $2, dthrfinal = $3 WHERE referencia = $1",t=[this.referencia,this.dthrinicial,K()],e.next=4,this.Pool.query("UPDATE processo SET dthrinicial = $2, dthrfinal = $3 WHERE referencia = $1",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"verificarIntervalo",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dthrinicial=K(),e.next=3,this.Pool.query("SELECT status, dthrinicial, intervalo FROM processo WHERE referencia = $1",[this.referencia]);case 3:if(t=e.sent,"A"===(a=t.rows[0]).status){e.next=7;break}return e.abrupt("return",!1);case 7:if(null!==a.dthrinicial){e.next=9;break}return e.abrupt("return",!0);case 9:if(!(Date.now()>=a.dthrinicial.getTime()+6e4*a.intervalo)){e.next=13;break}return e.abrupt("return",!0);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),ua=window.require("fs"),da=window.require("os"),pa=window.require("ftp"),ma=window.require("child_process"),ha=function(){function e(t){Object(i.a)(this,e),this.Pool=t,this.interval=null,this.running=!1,window.ProcessoAutomatico=this,this.executandoBackup=!1}return Object(s.a)(e,[{key:"iniciar",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.interval=setInterval(Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.executar();case 1:case"end":return e.stop()}}),e)}))),6e4),setTimeout(Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.executar();case 1:case"end":return e.stop()}}),e)}))),1e4);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pausar",value:function(){clearInterval(this.interval)}},{key:"executar",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.running){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,this.running=!0,e.next=6,this.executarRefreshView();case 6:return e.next=8,this.executarVerificarDtVerificacao();case 8:return e.next=10,this.executarVerificarTerminal();case 10:return e.next=12,this.executarBackup();case 12:e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(2),e.t0;case 17:return e.prev=17,this.running=!1,e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[2,14,17,20]])})));return function(){return e.apply(this,arguments)}}()},{key:"executarBackup",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,l,u,d,p,m,h,f,v,b,g,E,x=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.executandoBackup){e.next=2;break}return e.abrupt("return");case 2:return t=new la(this.Pool,"BACKUP"),e.next=5,t.verificarIntervalo();case 5:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:if(void 0===this.fs&&(this.fs=ua),void 0===this.os&&(this.os=da),void 0===this.ftp&&(this.ftp=pa),void 0===this.childProcess&&(this.childProcess=ma),"darwin"!==this.os.platform()){e.next=13;break}return e.abrupt("return");case 13:return a=null,e.prev=14,e.next=17,ie(this.Pool,"BACKUP","HOST");case 17:return e.t0=e.sent,e.next=20,ie(this.Pool,"BACKUP","PORTA");case 20:return e.t1=e.sent,e.next=23,ie(this.Pool,"BACKUP","USUARIO");case 23:return e.t2=e.sent,e.next=26,ie(this.Pool,"BACKUP","SENHA");case 26:e.t3=e.sent,a={host:e.t0,port:e.t1,user:e.t2,password:e.t3},e.next=34;break;case 30:return e.prev=30,e.t4=e.catch(14),console.log("Erro ao efetuar backup: n\xe3o foi poss\xedvel carregar os par\xe2metros do FTP."),e.abrupt("return",!1);case 34:this.executandoBackup=!0,o=null,e.t5=this.os.platform(),e.next="win32"===e.t5?39:47;break;case 39:return o="C:/Program Files/PostgreSQL/14/bin/pg_dump.exe",this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/13/bin/pg_dump.exe"),this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/12/bin/pg_dump.exe"),this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/11/bin/pg_dump.exe"),this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/10/bin/pg_dump.exe"),this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/9.6/bin/pg_dump.exe"),this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/9.3/bin/pg_dump.exe"),e.abrupt("break",48);case 47:return e.abrupt("break",48);case 48:for(n=oe(),this.fs.existsSync(n)||this.fs.mkdirSync(n),i=this.fs.readdirSync(n),s=!0,c=!1,l=void 0,e.prev=54,u=i[Symbol.iterator]();!(s=(d=u.next()).done);s=!0)".backup"===(p=d.value).substr(-7)&&this.fs.unlinkSync(n+"/"+p);e.next=62;break;case 58:e.prev=58,e.t6=e.catch(54),c=!0,l=e.t6;case 62:e.prev=62,e.prev=63,s||null==u.return||u.return();case 65:if(e.prev=65,!c){e.next=68;break}throw l;case 68:return e.finish(65);case 69:return e.finish(62);case 70:if(m=new Date,h=m.getFullYear()+"-"+String(m.getMonth()+1).lpad(2,"0")+"-"+String(m.getDate()).lpad(2,"0")+"-"+String(m.getHours()).lpad(2,"0")+"-"+String(m.getMinutes()).lpad(2,"0")+"-"+String(m.getSeconds()).lpad(2,"0"),v='"'+o+'" -F c -b -w -U postgres -f "'+(f=n+"/"+h+".backup")+'" satflex',this.childProcess.execSync(v),void 0!==this.serialNumber){e.next=79;break}return e.next=78,ee();case 78:this.serialNumber=e.sent;case 79:b=f,g="/"+this.serialNumber+"/"+h+".backup",(E=new this.ftp).on("ready",(function(){E.cwd("/",(function(){E.mkdir(x.serialNumber,!0,(function(e){if(e)throw x.executandoBackup=!1,e;E.put(b,g,!1,(function(e){if(e)throw e;E.end(),t.atualizarProcesso(),x.executandoBackup=!1}))}))}))})).connect(a);case 83:case"end":return e.stop()}}),e,this,[[14,30],[54,58,62,70],[63,,65,69]])})));return function(){return e.apply(this,arguments)}}()},{key:"executarRefreshView",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new la(this.Pool,"REFRESH_VIEW"),e.next=3,t.verificarIntervalo();case 3:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:a=0,o=["v_vendaprodutodiario","v_vendapagamentodiario"];case 7:if(!(a<o.length)){e.next=14;break}return n=o[a],e.next=11,this.Pool.query("REFRESH MATERIALIZED VIEW "+n);case 11:a++,e.next=7;break;case 14:return e.next=16,t.atualizarProcesso();case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executarVerificarDtVerificacao",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new la(this.Pool,"VERIFICAR_DTVERIFICACAO"),e.next=3,t.verificarIntervalo();case 3:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,ie(this.Pool,"SISTEMA","DTVERIFICACAO");case 7:return a=e.sent,o=new Date,(null===(a=null!==a&&a.length>0?new Date(a):null)||(o.getTime()-a.getTime())/864e5>10)&&("UPDATE parametro SET valor = $3 WHERE grupo = $1 AND nome = $2",this.Pool.query("UPDATE parametro SET valor = $3 WHERE grupo = $1 AND nome = $2",["SISTEMA","STATUS","0002"])),e.next=13,t.atualizarProcesso();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executarVerificarTerminal",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new la(this.Pool,"VERIFICAR_TERMINAL"),e.next=3,t.verificarIntervalo();case 3:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:return this.servidor||(this.servidor=new le(this.Pool)),e.next=8,this.servidor.verificarTerminal();case 8:return!1===(a=e.sent)?console.log("Houve uma falha ao verificar o terminal no servidor."):(this.Pool.query("UPDATE parametro SET valor = $3 WHERE grupo = $1 AND nome = $2",["SISTEMA","STATUS",a]),o=(new Date).toISOString().substr(0,10),this.Pool.query("UPDATE parametro SET valor = $3 WHERE grupo = $1 AND nome = $2",["SISTEMA","DTVERIFICACAO",o])),e.next=12,t.atualizarProcesso();case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),fa=(a(658),a(659),function(e){function t(e){var a;return Object(i.a)(this,t),a=Object(c.a)(this,Object(l.a)(t).call(this,e)),window.FastMessage=new j,window.InformarValor=new q,window.Loading=new z,window.MessageBox=new V,a.state={FastMessage:window.FastMessage,InformarValor:window.InformarValor,Loading:window.Loading,MessageBox:window.MessageBox},a.Pool=new pe,a.processoAutomatico=new ha(a.Pool),window.processoAutomatico=a.processoAutomatico,window.servidor=new le(a.Pool),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.processoAutomatico.iniciar(),window.addEventListener("keydown",this.onKeyDown),this.verificarTerminal()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.onKeyDown)}},{key:"onKeyDown",value:function(e){e.ctrlKey&&73===e.keyCode&&window.require("electron").remote.getCurrentWebContents().toggleDevTools()}},{key:"verificarTerminal",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie(this.Pool,"SISTEMA","STATUS");case 2:return t=e.sent,e.next=5,ie(this.Pool,"REVENDA","TELEFONE");case 5:a=e.sent,e.t0=t,e.next="0000"===e.t0?9:"0001"===e.t0?10:"0002"===e.t0?12:14;break;case 9:return e.abrupt("break",15);case 10:return window.MessageBox.show({title:"Terminal bloqueado",text:"Seu terminal foi bloqueado, para mais informa\xe7\xf5es, entre em contato com o suporte pelo n\xfamero <b>"+a+"</b>.",buttons:[{text:"Sair do SAT-Flex",color:"primary",onClick:function(){window.close()}}]}),e.abrupt("break",15);case 12:return window.MessageBox.show({title:"Terminal bloqueado",text:"Seu terminal foi bloqueado por falta de comunica\xe7\xe3o com a Internet. Verifique sua conex\xe3o com a Internet e tente novamente.<br> Caso o problema persista, entre em contato com o suporte pelo n\xfamero <b>"+a+"</b>.",buttons:[{text:"Sair do SAT-Flex",color:"primary",onClick:function(){window.close()}}]}),e.abrupt("break",15);case 14:return e.abrupt("break",15);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return p.a.createElement("div",null,p.a.createElement(f.a,null,p.a.createElement(f.c,{path:"/"},p.a.createElement("div",null,p.a.createElement(k,null),p.a.createElement("div",{id:"viewContainer"},p.a.createElement(f.c,{exact:!0,path:"/",component:ca}),p.a.createElement(f.c,{exact:!0,path:"/venda",component:ca}),p.a.createElement(f.c,{exact:!0,path:"/venda/:id",component:ca}),p.a.createElement(f.c,{path:"/categoria",component:Te}),p.a.createElement(f.c,{path:"/configuracao",component:Ue}),p.a.createElement(f.c,{path:"/contador",component:Ge}),p.a.createElement(f.c,{path:"/estatistica",component:Xe}),p.a.createElement(f.c,{path:"/fechamento",component:nt}),p.a.createElement(f.c,{path:"/ferramentas",component:mt}),p.a.createElement(f.c,{path:"/parametro",component:vt}),p.a.createElement(f.c,{path:"/produto",component:gt}),p.a.createElement(f.c,{path:"/relatorio",component:Et}),p.a.createElement(f.c,{path:"/relorcamento",component:xt}),p.a.createElement(f.c,{path:"/suporte",component:yt}))))),p.a.createElement(N,{FastMessageEmitter:this.state.FastMessage}),p.a.createElement(L,{InformarValorEmitter:this.state.InformarValor}),p.a.createElement(U,{LoadingEmitter:this.state.Loading}),p.a.createElement(B,{MessageBoxEmitter:this.state.MessageBox}))}}]),t}(p.a.Component));h.a.render(p.a.createElement(fa,null),document.getElementById("root"))}},[[280,1,2]]]);
//# sourceMappingURL=main.ea768d81.chunk.js.map