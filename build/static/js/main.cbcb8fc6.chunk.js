(this.webpackJsonpsatflex=this.webpackJsonpsatflex||[]).push([[0],{171:function(e,t){},181:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return l}));var o=a(3),r=a.n(o),n=a(10),i=a(4),s=a(5),c=a(9),u=window.require("fs"),l=function(){function t(e){Object(i.a)(this,t),this.Pool=e,this._anexos=[],this._destinatario=null,this._titulo=null,this._remetente=null}return Object(s.a)(t,[{key:"anexo",value:function(t){this._anexos.push({nome:t.split("/").reverse()[0],conteudo:e.from(u.readFileSync(t)).toString("base64")})}},{key:"corpo",value:function(e){this._corpo=e}},{key:"destinatario",value:function(e){Array.isArray(e)&&(e=e.join("; ")),this._destinatario=e}},{key:"enviar",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a){var o,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.l)(this.Pool,"EMITENTE","CNPJ");case 2:o=e.sent,n={remetente_email:"satflex@controlware.com.br",remtente_nome:this._remetente,destinatario:this._destinatario,assunto:this._titulo,corpo:this._corpo,anexos:this._anexos},console.log({data:n}),$.ajax({url:"https://andromeda.controlware.com.br/api/email/enviar",type:"POST",beforeSend:function(e){e.setRequestHeader("idchave","7ba93327-465f-41ee-975a-f208d4995bf1"),e.setRequestHeader("cnpj",o)},data:JSON.stringify(n),success:function(){return t()},error:function(e){var t=JSON.parse(e.responseText);t?(!t.message&&t.erro&&(t.message=t.erro),a(t)):a({message:e.statusText})}});case 6:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"remetente",value:function(e){this._remetente=e}},{key:"titulo",value:function(e){this._titulo=e}}]),t}()}).call(this,a(19).Buffer)},197:function(e,t,a){},199:function(e,t,a){},203:function(e,t,a){},204:function(e,t,a){},205:function(e,t,a){},206:function(e,t,a){},207:function(e,t,a){},208:function(e,t,a){},210:function(e,t,a){},309:function(e,t,a){},319:function(e,t,a){},320:function(e,t,a){},321:function(e,t,a){},322:function(e,t,a){},323:function(e,t,a){},329:function(e,t){},331:function(e,t){},354:function(e,t){},356:function(e,t,a){},377:function(e,t,a){},398:function(e,t,a){},403:function(e,t){},404:function(e,t){},408:function(e,t,a){},409:function(e,t,a){},410:function(e,t,a){},411:function(e,t,a){},412:function(e,t,a){},413:function(e,t,a){},414:function(e,t,a){},415:function(e,t,a){},416:function(e,t,a){},417:function(e,t,a){},418:function(e,t,a){},419:function(e,t,a){},420:function(e,t,a){},421:function(e,t){Number.prototype.format=function(e,t,a){var o=this;e=isNaN(e=Math.abs(e))?2:e,t=void 0===t?",":t,a=void 0===a?".":a;var r=o<0?"-":"",n=String(parseInt(o=Math.abs(+o||0).toFixed(e),10)),i=n.length>3?n.length%3:0;return r+(i?n.substr(0,i)+a:"")+n.substr(i).replace(/(\d{3})(?=\d)/g,"$1"+a)+(e?t+Math.abs(o-n).toFixed(e).slice(2):"")},Number.prototype.toFloat=function(){return this},String.prototype.byteList=function(e){return e.split("").map((function(e){return e.charCodeAt(0)}))},String.prototype.cpad=function(e,t){for(var a=this,o=0;a.length<e;)o++%2===0?a+=t:a=t+a;return String(a)},String.prototype.format=function(e,t,a){return this.toFloat().format(e,t,a)},String.prototype.lpad=function(e,t){for(var a=this;a.length<e;)a=t+a;return String(a)},String.prototype.removeFormat=function(){var e=this;return[" ",".",",","-","/","\\","(",")"].forEach((function(t){e=e.replaceAll(t,"")})),e},String.prototype.removeSpecial=function(){for(var e=["\xe1","\xe0","\xe3","\xe2","\xe9","\xe8","\xea","\xed","\xec","\xee","\xf3","\xf2","\xf5","\xf4","\xfa","\xf9","\xfb","\xfc","\xe7","\xc1","\xc0","\xc3","\xc2","\xc9","\xc8","\xca","\xcd","\xcc","\xce","\xd3","\xd2","\xd5","\xd4","\xda","\xd9","\xdb","\xdc","\xc7","\xaa","\xba"],t=["a","a","a","a","e","e","e","i","i","i","o","o","o","o","u","u","u","u","c","A","A","A","A","E","E","E","I","I","I","O","O","O","O","U","U","U","U","C","a","o"],a=this,o=0;o<e.length;o++)a=a.replaceAll(e[o],t[o]);return a},String.prototype.replaceAll=function(e,t){return this.split(e).join(t)},String.prototype.rpad=function(e,t){for(var a=this;a.length<e;)a+=t;return String(a)},String.prototype.toFloat=function(){var e=this;return-1===e.indexOf(".")&&e.indexOf(",")>-1?e=e.replace(",","."):e.indexOf(".")>-1&&e.indexOf(",")>-1&&(e.indexOf(".")<e.indexOf(",")?e=e.replace(".","").replace(",","."):e.indexOf(".")>e.indexOf(",")&&(e=e.replace(",",""))),parseFloat(e)}},422:function(e,t,a){},423:function(e,t,a){},424:function(e,t,a){},425:function(e,t,a){"use strict";a.r(t);var o=a(3),r=a.n(o),n=a(10),i=a(4),s=a(5),c=a(7),u=a(6),l=a(1),d=a.n(l),p=a(20),h=a.n(p),m=a(71),b=a(16),f=a(8),v=a.n(f);window.jQuery=window.$=f;var j=a(172);window.Tether=j.a;var O=a(109);window.Popper=O.default;a(195),a(196);var x=a(2),g=a(14),C=(a(197),a(0)),k=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=["icon","mif-"+this.props.name];this.props.className&&e.push(this.props.className);var t={};return this.props.onClick&&(t.cursor="pointer"),Object(C.jsx)("span",Object(g.a)(Object(g.a)({},this.props),{},{className:e.join(" "),style:t}))}}]),a}(d.a.Component),y=(a(199),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsx)("div",{id:"menu",children:Object(C.jsx)(w,{})})}}]),a}(d.a.Component)),w=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={activeItem:"Vender"},o.changeActiveItem=o.changeActiveItem.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"changeActiveItem",value:function(e){this.setState({activeItem:e})}},{key:"listItem",value:function(){return[{text:"Vender",icon:"shop",link:"/"},{text:"Cadastros",icon:"stack",link:"/produto",active:!1},{text:"Relat\xf3rios",icon:"chart-line",link:"/relatorio",active:!1},{text:"Contador",icon:"suitcase",link:"/contador",active:!1},{text:"Configura\xe7\xf5es",icon:"cogs",link:"/configuracao",active:!1},{text:"Suporte",icon:"help",link:"/suporte",active:!1},{text:"Sair",icon:"exit",active:!1,action:function(){window.MessageBox.show({title:"Sair do SAT-Flex",text:"Voc\xea tem certeza que deseja encerrar o SAT-Flex agora?",buttons:[{text:"Sim",color:"green",icon:"thumbs-up",onClick:function(){window.close()}},{text:"N\xe3o",color:"red",icon:"thumbs-down",onClick:function(){window.MessageBox.hide()}}]})}}]}},{key:"render",value:function(){var e=this;return Object(C.jsx)("div",{className:"menu-list",children:Object(C.jsx)("ul",{children:this.listItem().map((function(t,a){return Object(C.jsx)(S,{pKey:a,item:t,activeItem:e.state.activeItem,changeActiveItem:e.changeActiveItem},a)}))})})}}]),a}(d.a.Component),S=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).onClick=o.onClick.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"onClick",value:function(){this.props.item.link&&this.props.changeActiveItem(this.props.item.text),this.props.item.action&&this.props.item.action()}},{key:"render",value:function(){var e=null;return this.props.activeItem===this.props.item.text&&(e="active"),this.props.item.link?Object(C.jsxs)(m.b,{to:this.props.item.link,onClick:this.onClick,className:e,children:[Object(C.jsx)(k,{name:this.props.item.icon}),Object(C.jsx)("span",{children:this.props.item.text})]}):Object(C.jsxs)("a",{onClick:this.onClick,className:e,children:[Object(C.jsx)(k,{name:this.props.item.icon}),Object(C.jsx)("span",{children:this.props.item.text})]})}}]),a}(d.a.Component),E=a(25),N=(a(203),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).data={icon:null,text:null,visible:!1},e}return Object(s.a)(a,[{key:"addChangeListener",value:function(e){this.on("change",e)}},{key:"commitChange",value:function(){this.emit("change")}},{key:"getData",value:function(){return Object.assign({},this.data)}},{key:"getElement",value:function(){return void 0===this.element&&(this.element=v()("#FastMessage").get(0)),this.element}},{key:"removeChangeListener",value:function(e){this.removeListener("change",e)}},{key:"hide",value:function(){this.data.visible=!1,this.commitChange()}},{key:"show",value:function(e){"string"===typeof e&&(e={text:e}),e=v.a.extend({icon:null,text:null,visible:!0},e),this.data=v.a.extend(this.data,e),this.commitChange()}}]),a}(E.EventEmitter)),P=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).animateHide=o.animateHide.bind(Object(x.a)(o)),o.animateShow=o.animateShow.bind(Object(x.a)(o)),o.onChangeData=o.onChangeData.bind(Object(x.a)(o)),o.onDocumentClick=o.onDocumentClick.bind(Object(x.a)(o)),o.state=e.FastMessageEmitter.getData(),o}return Object(s.a)(a,[{key:"animateHide",value:function(){var e=this;if(!this.state.visible)return!0;v()(this.element).stop().animate({opacity:0,top:window.innerHeight},180,(function(){e.setState({visible:!1})}))}},{key:"animateShow",value:function(){var e=this;v()(this.element).show();var t=0,a=[{progress:0,opacity:0,top:0},{progress:.05,opacity:1,top:.3},{progress:.95,opacity:1,top:.35},{progress:1,opacity:0,top:1}];!function o(){var r=a.shift(),n=3e3*r.progress-t;t+=n,v()(e.element).stop().animate({opacity:r.opacity,top:window.innerHeight*r.top},n,(function(){a.length>0?o():e.setState({visible:!1})}))}()}},{key:"componentDidMount",value:function(){this.element=this.props.FastMessageEmitter.getElement(),this.props.FastMessageEmitter.addChangeListener(this.onChangeData),document.addEventListener("click",this.onDocumentClick)}},{key:"componentWillUnmount",value:function(){this.props.FastMessageEmitter.removeChangeListener(this.onChangeData),document.removeEventListener("click",this.onDocumentClick)}},{key:"onChangeData",value:function(){var e=this.props.FastMessageEmitter.getData();e.visible!==this.state.visible&&(e.visible?this.animateShow():this.animateHide()),this.setState(e)}},{key:"onDocumentClick",value:function(){this.state.visible&&this.animateHide()}},{key:"render",value:function(){return Object(C.jsxs)("div",{id:"FastMessage",children:[this.state.icon?Object(C.jsx)(k,{name:this.state.icon}):null,Object(C.jsx)("span",{children:this.state.text})]})}}]),a}(d.a.Component),D=a(174),A=a.n(D),T=(a(204),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=null;if(this.props.icon)if(this.props.text){var t="lg"===this.props.size?"3":"2";if("right"===this.props.iconPosition)e=[Object(C.jsx)("span",{className:"mr-2",dangerouslySetInnerHTML:{__html:this.props.text}},"0"),Object(C.jsx)(k,{name:this.props.icon},"1")];else e=[Object(C.jsx)(k,{name:this.props.icon},"0"),Object(C.jsx)("span",{className:"ml-"+t,dangerouslySetInnerHTML:{__html:this.props.text}},"1")]}else e=Object(C.jsx)(k,{name:this.props.icon});else e=Object(C.jsx)("span",{dangerouslySetInnerHTML:{__html:this.props.text}});var a=["btn","btn-primary","btn-"+this.props.size,"btn-color-"+this.props.color];return this.props.className&&a.push(this.props.className),this.props.active&&a.push("active"),this.props.block&&a.push("btn-block"),Object(C.jsx)("button",{className:a.join(" "),onClick:this.props.onClick,disabled:this.props.disabled,children:e})}}]),a}(d.a.Component));T.defaultProps={active:!1,block:!1,disabled:!1,iconPosition:"left",size:"md",color:"blue"};var R=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=["col-"+(void 0===this.props.size?1:this.props.size)];this.props.className&&e.push(this.props.className),this.props.offset&&e.push("offset-"+this.props.offset);var t=null;return this.props.labelMargin&&(t=Object(C.jsx)("label",{children:"\xa0"})),Object(C.jsxs)("div",{className:e.join(" "),children:[t,this.props.children]})}}]),a}(d.a.Component),I=(a(205),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.element=h.a.findDOMNode(this),v()(this.element).on("show.bs.modal",this.props.beforeOpen),v()(this.element).on("shown.bs.modal",this.props.afterOpen),v()(this.element).on("hide.bs.modal",this.props.beforeClose),v()(this.element).on("hidden.bs.modal",this.props.afterClose),v()(this.element).on("show.bs.modal",(function(){var t=1040+10*v()(".modal:visible").length;v()(e.element).css("z-index",t),setTimeout((function(){v()(".modal-backdrop").not(".modal-stack").css("z-index",t-1).addClass("modal-stack")}),0)}))}},{key:"componentWillReceiveProps",value:function(e){e.show!==this.props.show&&(e.show?v()(this.element).modal("show"):v()(this.element).modal("hide"))}},{key:"shouldComponentUpdate",value:function(e){return e.size!==this.props.size||e.title!==this.props.title||e.children!==this.props.children}},{key:"render",value:function(){return Object(C.jsx)("div",{id:this.props.id,className:"modal fade","data-backdrop":!!this.props.closeOnOutClick||"static",children:Object(C.jsx)("div",{className:"modal-dialog modal-"+this.props.size,children:Object(C.jsxs)("div",{className:"modal-content",children:[Object(C.jsx)("div",{className:"modal-header",children:this.props.title}),Object(C.jsx)("div",{className:"modal-body",children:this.props.children})]})})})}}]),a}(d.a.Component));I.defaultProps={closeOnOutClick:!0,id:null,size:"md",title:null};var M=I,q=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=["row"];this.props.className&&e.push(this.props.className);var t=Object.assign({},this.props);return delete t.className,Object(C.jsx)("div",Object(g.a)(Object(g.a)({},t),{},{className:e.join(" "),children:this.props.children}))}}]),a}(d.a.Component),L=(a(206),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).data={decimal:0,mask:null,money:!1,title:null,value:"",visible:!1,success:function(){},fail:function(){}},e.lastHide=(new Date).getTime(),e}return Object(s.a)(a,[{key:"addChangeListener",value:function(e){this.on("change",e)}},{key:"commitChange",value:function(){this.emit("change")}},{key:"getData",value:function(){return Object.assign({},this.data)}},{key:"getElement",value:function(){return void 0===this.element&&(this.element=v()("#informarvalor").get(0)),this.element}},{key:"removeChangeListener",value:function(e){this.removeListener("change",e)}},{key:"hide",value:function(){this.lastHide=(new Date).getTime(),this.data.visible=!1,this.commitChange()}},{key:"show",value:function(e){var t=this;e=v.a.extend({decimal:0,mask:null,money:!1,title:"Informe o valor",value:"",visible:!0,success:function(){},fail:function(){}},e);var a=0,o=(new Date).getTime()-this.lastHide;o<750&&(a=750-o),setTimeout((function(){t.data=v.a.extend(t.data,e),t.commitChange()}),a)}}]),a}(E.EventEmitter)),F=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={decimal:0,mask:null,money:!1,title:null,value:"",visible:!1,success:function(){},fail:function(){}},o.backspace=o.backspace.bind(Object(x.a)(o)),o.beforeClose=o.beforeClose.bind(Object(x.a)(o)),o.beforeOpen=o.beforeOpen.bind(Object(x.a)(o)),o.cancelar=o.cancelar.bind(Object(x.a)(o)),o.confirmar=o.confirmar.bind(Object(x.a)(o)),o.drawButton=o.drawButton.bind(Object(x.a)(o)),o.onChangeData=o.onChangeData.bind(Object(x.a)(o)),o.pressNumber=o.pressNumber.bind(Object(x.a)(o)),o.valorKeyDown=o.valorKeyDown.bind(Object(x.a)(o)),o.valorKeyUp=o.valorKeyUp.bind(Object(x.a)(o)),o.pristine=!0,o.visible=!1,o.StringMask=A.a,o}return Object(s.a)(a,[{key:"afterOpen",value:function(){v()("#informarvalor-valor").focus()}},{key:"backspace",value:function(){var e=v()("#informarvalor-valor").val();v()("#informarvalor-valor").val(e.substr(0,e.length-1)),this.valorKeyUp()}},{key:"beforeClose",value:function(){this.visible=!1}},{key:"beforeOpen",value:function(){this.visible=!0}},{key:"cancelar",value:function(){window.InformarValor.hide(),this.state.fail()}},{key:"confirmar",value:function(){window.InformarValor.hide();var e=v()("#informarvalor-valor").val();e="string"===typeof this.state.mask?this.maskedValue(e):(e/=Math.pow(10,this.state.decimal)).format(this.state.decimal,",","."),this.state.success(e)}},{key:"componentDidMount",value:function(){var e=this;this.props.InformarValorEmitter.addChangeListener(this.onChangeData),this.element=this.props.InformarValorEmitter.getElement(),document.addEventListener("keyup",(function(t){if(e.visible)switch(t.keyCode){case 8:return void e.backspace();case 48:return void e.pressNumber(0);case 49:return void e.pressNumber(1);case 50:return void e.pressNumber(2);case 51:return void e.pressNumber(3);case 52:return void e.pressNumber(4);case 53:return void e.pressNumber(5);case 54:return void e.pressNumber(6);case 55:return void e.pressNumber(7);case 56:return void e.pressNumber(8);case 57:return void e.pressNumber(9);case 96:return void e.pressNumber(0);case 97:return void e.pressNumber(1);case 98:return void e.pressNumber(2);case 99:return void e.pressNumber(3);case 100:return void e.pressNumber(4);case 101:return void e.pressNumber(5);case 102:return void e.pressNumber(6);case 103:return void e.pressNumber(7);case 104:return void e.pressNumber(8);case 105:return void e.pressNumber(9);default:return}}))}},{key:"componentWillUnmount",value:function(){this.props.InformarValorEmitter.removeChangeListener(this.onChangeData)}},{key:"drawButton",value:function(e,t){var a=this;return Object(C.jsx)(R,{size:"4",children:Object(C.jsx)(T,{text:e,block:!0,color:"blue",onClick:function(){a.pressNumber(e)}})},t)}},{key:"maskedValue",value:function(e){return new this.StringMask(this.state.mask).apply(e)}},{key:"onChangeData",value:function(){var e=this,t=this.props.InformarValorEmitter.getData();t.visible?v()(this.element).modal("show"):v()(this.element).modal("hide"),void 0!==t.value&&t.value.length>0&&(t.value=t.value.toFloat().format(t.decimal,"","")),this.setState(t,(function(){e.pristine=!1,v()("#informarvalor-valor").val(t.value),e.valorKeyUp(),e.pristine=!0}))}},{key:"pressNumber",value:function(e){v()("#informarvalor-valor").val(v()("#informarvalor-valor").val()+e),this.valorKeyUp()}},{key:"valorKeyDown",value:function(e){if(-1===[8,13,27,48,49,50,51,52,53,54,55,56,57].indexOf(e.keyCode))return!1;13===e.keyCode&&this.confirmar()}},{key:"valorKeyUp",value:function(){this.pristine&&(this.pristine=!1,v()("#informarvalor-valor").val(v()("#informarvalor-valor").val().substr(-1)));var e=v()("#informarvalor-valor").val();"string"===typeof this.state.mask?e=this.maskedValue(e):(0===e.length&&v()("#informarvalor-valor").val(0),e=(e/=Math.pow(10,this.state.decimal)).format(this.state.decimal,",",".")),v()("#informarvalor-display").html(e),this.verificarTamanho(),e.length>0?v()("#informarvalor-backspace").show():v()("#informarvalor-backspace").hide(),v()("#informarvalor-valor").focus()}},{key:"verificarTamanho",value:function(){v()("#informarvalor-display").text().length<10?v()("#informarvalor-display").removeClass("informarvalor-display-sm"):v()("#informarvalor-display").addClass("informarvalor-display-sm")}},{key:"render",value:function(){var e=this.state.money?"informarvalor-display-money":"";return Object(C.jsxs)(M,{id:"informarvalor",size:"sm",title:this.state.title,afterOpen:this.afterOpen,beforeOpen:this.beforeOpen,beforeClose:this.beforeClose,children:[Object(C.jsx)("input",{type:"text",id:"informarvalor-valor",readOnly:!0,onKeyDown:this.valorKeyDown,onKeyUp:this.valorKeyUp}),Object(C.jsxs)("div",{id:"informarvalor-display-parent",children:[Object(C.jsx)("div",{id:"informarvalor-display",className:e}),Object(C.jsx)(k,{id:"informarvalor-backspace",name:"chevron-left",onClick:this.backspace})]}),Object(C.jsxs)(q,{id:"informarvalor-keyboard",children:[[7,8,9,4,5,6,1,2,3].map(this.drawButton),Object(C.jsx)(R,{size:"4",children:Object(C.jsx)(T,{icon:"cross",block:!0,color:"red",onClick:this.cancelar})}),this.drawButton(0),Object(C.jsx)(R,{size:"4",children:Object(C.jsx)(T,{icon:"checkmark",block:!0,color:"green",onClick:this.confirmar})})]})]})}}]),a}(d.a.Component),z=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=Math.round(this.props.value)+"%",t=null;switch(this.props.color){case"green":t="bg-success";break;case"yellow":t="bg-warning";break;case"red":t="bg-danger";break;default:t="bg-primary"}var a="progress";return this.props.className&&(a+=" "+this.props.className),Object(C.jsx)("div",{className:a,children:Object(C.jsx)("div",{className:"progress-bar progress-bar-striped progress-bar-animated "+t,style:{width:e},children:e})})}}]),a}(d.a.Component),U=(a(207),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).data={visible:!1,progress:null},e}return Object(s.a)(a,[{key:"addChangeListener",value:function(e){this.on("change",e)}},{key:"commitChange",value:function(){this.emit("change")}},{key:"getData",value:function(){return Object.assign({},this.data)}},{key:"getElement",value:function(){return void 0===this.element&&(this.element=v()("#Loading").get(0)),this.element}},{key:"removeChangeListener",value:function(e){this.removeListener("change",e)}},{key:"hide",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.data.visible=!1,this.commitChange();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"show",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.data.visible=!0,this.data.progress=null,this.commitChange();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"progress",value:function(){var e=Object(n.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.data.progress=t,this.commitChange();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),a}(E.EventEmitter)),V=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).onChangeData=o.onChangeData.bind(Object(x.a)(o)),o.state=e.LoadingEmitter.getData(),o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.element=this.props.LoadingEmitter.getElement(),this.props.LoadingEmitter.addChangeListener(this.onChangeData)}},{key:"componentWillUnmount",value:function(){this.props.LoadingEmitter.removeChangeListener(this.onChangeData)}},{key:"onChangeData",value:function(){var e=this.props.LoadingEmitter.getData();this.setState(e)}},{key:"render",value:function(){return this.state.visible?Object(C.jsxs)("div",{className:"Loading",children:[Object(C.jsx)("div",{className:"Loading-Spinner"}),Object(C.jsx)(z,{value:this.state.progress,color:"green",className:null===this.state.progress?"d-none":null})]}):null}}]),a}(d.a.Component),B=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).data={buttons:[],focusOnClose:null,size:"md",text:null,title:null,visible:!1},e.lastHide=(new Date).getTime(),e}return Object(s.a)(a,[{key:"addChangeListener",value:function(e){this.on("change",e)}},{key:"commitChange",value:function(){this.emit("change")}},{key:"getData",value:function(){return Object.assign({},this.data)}},{key:"getElement",value:function(){return void 0===this.element&&(this.element=v()("#__messagebox").get(0)),this.element}},{key:"removeChangeListener",value:function(e){this.removeListener("change",e)}},{key:"hide",value:function(){this.lastHide=(new Date).getTime(),this.data.visible=!1,this.commitChange()}},{key:"show",value:function(e){var t=this;e=v.a.extend({title:null,text:null,focusOnClose:null,size:"md",visible:!0,buttons:[{text:"Ok",color:"blue",icon:"thumbs-up",onClick:function(){t.hide()}}]},e);var a=0,o=(new Date).getTime()-this.lastHide;o<750&&(a=750-o),setTimeout((function(){t.data=v.a.extend(t.data,e),t.commitChange()}),a)}}]),a}(E.EventEmitter),_=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).onChangeData=o.onChangeData.bind(Object(x.a)(o)),o.state=e.MessageBoxEmitter.getData(),o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.props.MessageBoxEmitter.addChangeListener(this.onChangeData);var e=this.props.MessageBoxEmitter.getElement();v()(e).on("shown.bs.modal",(function(){v()(e).find(".btn").first().focus()}))}},{key:"componentWillUnmount",value:function(){this.props.MessageBoxEmitter.removeChangeListener(this.onChangeData)}},{key:"onChangeData",value:function(){var e=this.props.MessageBoxEmitter.getData();if(e.visible!==this.state.visible){var t=this.props.MessageBoxEmitter.getElement();e.visible?v()(t).modal("show"):v()(t).modal("hide")}this.setState(e)}},{key:"render",value:function(){return Object(C.jsx)("div",{id:"__messagebox",className:"messagebox modal fade","data-backdrop":"static",children:Object(C.jsx)("div",{className:"modal-dialog modal-"+this.state.size,children:Object(C.jsxs)("div",{className:"modal-content",children:[Object(C.jsx)("div",{className:"modal-header",children:Object(C.jsx)("h4",{className:"modal-title",children:this.state.title})}),Object(C.jsx)("div",{className:"modal-body",dangerouslySetInnerHTML:{__html:this.state.text}}),Object(C.jsx)("div",{className:"modal-footer",children:this.state.buttons.map((function(e,t){return Object(C.jsx)(T,{color:e.color,text:e.text,icon:e.icon,onClick:e.onClick},t)}))})]})})})}}]),a}(d.a.Component),$=a(9),H=function(){function e(t){Object(i.a)(this,e),this.Pool=t,this.cnpj=null,this.serialNumber=null}return Object(s.a)(e,[{key:"api",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=s.length>1&&void 0!==s[1]?s[1]:{},o=s.length>2&&void 0!==s[2]?s[2]:function(){},n=s.length>3&&void 0!==s[3]?s[3]:function(){},i="http://server.satflex.com.br/serv/terminal/"+t+".php",v.a.ajax({url:i,type:"POST",data:JSON.stringify(a),success:function(e){o(JSON.parse(e))},error:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"atualizarRequisicao",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a,o){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarDados();case 2:n=null,e.t0=t.status,e.next="0"===e.t0?6:"1"===e.t0||"2"===e.t0?8:10;break;case 6:return n="1",e.abrupt("break",11);case 8:return n="2",e.abrupt("break",11);case 10:return e.abrupt("break",11);case 11:this.api("atualizar_requisicao",{numeroserie:this.serialNumber,cnpj:this.cnpj,requisicao:{idrequisicao:t.referencia,status:n,resposta:t.resposta}},(function(e){switch(e.status){case"0":a();break;case"2":o(e.message)}}),(function(){o("Houve uma falha na conex\xe3o com o servidor.")}));case 12:case"end":return e.stop()}}),e,this)})));return function(t,a,o){return e.apply(this,arguments)}}()},{key:"carregarDados",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.cnpj&&this.serialnumber){e.next=7;break}return e.next=3,Object($.l)(this.Pool,"EMITENTE","CNPJ");case 3:return this.cnpj=e.sent,e.next=6,Object($.g)();case 6:this.serialNumber=e.sent;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"verificarRequisicao",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarDados();case 2:this.api("verificar_requisicao",{numeroserie:this.serialNumber,cnpj:this.cnpj},(function(e){switch(e.status){case"0":t(e.requisicao);break;case"2":a(e.message)}}),(function(){a("Houve uma falha na conex\xe3o com o servidor.")}));case 3:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"verificarTerminal",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(){var e=Object(n.a)(r.a.mark((function e(a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.carregarDados();case 2:t.api("verificar_terminal",{numeroserie:t.serialNumber,cnpj:t.cnpj},(function(e){switch(e.status){case"0":a(e.terminal.status);break;case"2":a(!1)}}),(function(){a(!1)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),W=window.require("pg");function G(){return new W.Pool({user:"postgres",host:"127.0.0.1",database:"satflex",password:"postgres",port:5432})}a(208);var Y=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsx)("div",Object(g.a)(Object(g.a)({id:"content"},this.props),{},{children:this.props.children}))}}]),a}(d.a.Component),Q=(a(209),a(210),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;Object(i.a)(this,a),(o=t.call(this,e)).calcBlankSpace=o.calcBlankSpace.bind(Object(x.a)(o)),o.elementScroll=o.elementScroll.bind(Object(x.a)(o)),o.onClickHeadCell=o.onClickHeadCell.bind(Object(x.a)(o)),o.onScroll=o.onScroll.bind(Object(x.a)(o)),o.updateBlankSpace=o.updateBlankSpace.bind(Object(x.a)(o)),o.updateReceivedProps=o.updateReceivedProps.bind(Object(x.a)(o));var r=o.updateReceivedProps(e.header,e.data);return o.state={data:r.data,header:r.header,limit:100,offset:0,blankSpace:{bottom:0,top:0}},o.scrollActive=!0,o.longScroll=!1,o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.elementScroll().addEventListener("scroll",this.onScroll),this.element=h.a.findDOMNode(this),window.grid=this.element}},{key:"componentWillUnmount",value:function(){this.elementScroll().removeEventListener("scroll",this.onScroll)}},{key:"componentDidUpdate",value:function(){if(this.referenceElement&&!this.longScroll){var e=this.elementScroll(),t=v()(this.referenceElement.element).position().top;this.scrollActive=!1;var a=v()(e).scrollTop()-(t-this.referenceElement.top);a>this.element.scrollHeight&&(a=this.element.scrollHeight),v()(e).scrollTop(a),this.scrollActive=!0}!0!==this.firstUpdateBlankSpace&&(this.firstUpdateBlankSpace=!0,this.updateBlankSpace()),v()(this.element).children("table").floatThead(),v()(this.element).children("table").floatThead("reflow")}},{key:"componentWillUpdate",value:function(){var e=v()(this.element).children("table"),t=v()(e).children("tbody").children(),a=v()(t).eq(Math.floor(.5*this.state.limit));v()(a).length>0&&(this.referenceElement={element:a,top:v()(a).position().top})}},{key:"componentWillReceiveProps",value:function(e){e=this.updateReceivedProps(e.header,e.data),this.setState({header:e.header,data:e.data}),this.firstUpdateBlankSpace=!1}},{key:"elementIsVisibleByScroll",value:function(e,t){if(!v()(this.element).is(":visible"))return!1;t=void 0===t?window:t;var a=v()(t).scrollTop(),o=a+v()(t).height(),r=t===window?v()(e).offset().top:v()(e).position().top,n=r+v()(e).height();return r<a&&n>a||(r>a&&n<o||r<o&&n>o)}},{key:"elementScroll",value:function(){return void 0===this.props.height?window:h.a.findDOMNode(this)}},{key:"onClickHeadCell",value:function(e){var t=v()(e.target).attr("cellkey"),a=null,o=null,r=null,n=this.state.header;for(var i in n)(a=n[i]).key===t?(o=i,r=1===a.order?-1:1,a.order=r):a.order=0,n[i]=a;var s=this.state.data;s.sort((function(e,t){return e.data[o].text<t.data[o].text?1===r?-1:1:e.data[o].text>t.data[o].text?1===r?1:-1:0})),this.setState({header:n,data:s})}},{key:"onScroll",value:function(){if(!this.scrollActive)return!0;if(!v()(this.element).is(":visible"))return!0;var e=this.elementScroll();if(!(void 0===this.currentScroll||Math.abs(this.currentScroll-v()(e).scrollTop())>50))return!0;this.currentScroll=v()(e).scrollTop();var t=this.element,a=v()(t).children("table"),o=v()(a).children("thead"),r=v()(a).children("tbody").children(),n=v()(r).first(),i=v()(r).last(),s=v()(n).next(),c=v()(i).prev(),u=v()(r).eq(Math.floor(.2*this.state.limit)),l=v()(r).eq(Math.floor(.8*this.state.limit)),d=-1*(v()(o).position().top-v()(e).scrollTop());d<0&&(d=0);var p=this.state.limit,h=this.state.offset,m=this.state.data.length;if(this.longScroll=!1,h>0&&(this.elementIsVisibleByScroll(s,e)||this.elementIsVisibleByScroll(u,e)))(h-=Math.floor(p/2))<0&&(h=0);else if(h+p<m&&(this.elementIsVisibleByScroll(c,e)||this.elementIsVisibleByScroll(l,e)))h+=Math.floor(p/2);else if((this.elementIsVisibleByScroll(n,e)||this.elementIsVisibleByScroll(i,e))&&!this.elementIsVisibleByScroll(s,e)&&!this.elementIsVisibleByScroll(c,e)){var b=null;b=e===window?(v()(e).scrollTop()-v()(t).offset().top)/v()(t).height():v()(e).scrollTop()/v()(a).height(),h=Math.round(this.state.data.length*b),this.longScroll=!0}if(h>m-p&&(h=m-p),h<0&&(h=0),h!==this.state.offset){var f=this.calcBlankSpace(h);void 0===this.initialBlankSpace&&(this.initialBlankSpace=f,this.initialBlankSpace.height=f.top+f.bottom),this.setState({offset:h,blankSpace:f})}}},{key:"calcBlankSpace",value:function(e){e=void 0===e?this.state.offset:e;var t=this.state.data,a=this.state.limit,o=v()(this.element).children(".table"),r=v()(o).children("tbody").children(),n=v()(r).first(),i=v()(n).next(),s=v()(i).height()-5,c=e*s,u=(t.length-e-a)*s;if(this.longScroll&&void 0!==this.initialBlankSpace){var l=this.elementScroll(),d=v()(r).not(":first, :last").map((function(){return v()(this).height()})).get().reduce((function(e,t){return e+t}),0);c=v()(l).scrollTop()-10*s,u=v()(o).height()-d-c,c>this.initialBlankSpace.height&&(c=this.initialBlankSpace.height),u>this.initialBlankSpace.height&&(u=this.initialBlankSpace.height)}return c<0&&(c=0),u<0&&(u=0),{top:c,bottom:u}}},{key:"updateBlankSpace",value:function(){this.setState({blankSpace:this.calcBlankSpace()})}},{key:"updateReceivedProps",value:function(e,t){for(var a in e=void 0===e?this.state.header:e,t=void 0===t?this.state.data:t,e){var o=e[a];"string"===typeof o&&(o={text:o}),o=v.a.extend({align:"left",key:a,order:0,text:""},o),e[a]=o}var r=0;for(var n in t){var i=t[n];for(var s in v.a.isArray(i)&&(i={data:i}),t[n]=i,t[n].data){var c=t[n].data[s];"string"===typeof c&&(c={text:c}),c=v.a.extend({align:"left",key:r++,text:"",width:null},c),t[n].data[s]=c}}return{header:e,data:t}}},{key:"render",value:function(){var e=this.state.data.slice(this.state.offset,this.state.offset+this.state.limit);return Object(C.jsx)("div",{className:"DataGrid",style:{height:this.props.height},children:Object(C.jsxs)("table",{className:"DataGridTable table table-striped table-hover "+this.props.className,children:[Object(C.jsx)(Z,{header:this.state.header,onClickHeadCell:this.onClickHeadCell}),Object(C.jsx)(J,{data:e,blankSpace:this.state.blankSpace})]})})}}]),a}(d.a.Component)),J=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsxs)("tbody",{children:[Object(C.jsx)(te,{height:this.props.blankSpace.top}),this.props.data.map((function(e,t){return Object(C.jsx)(X,{row:e},t)})),Object(C.jsx)(te,{height:this.props.blankSpace.bottom})]})}}]),a}(d.a.Component),K=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsx)("td",{className:"text-"+this.props.cell.align,onClick:this.props.cell.onClick,style:{width:this.props.cell.width},children:this.props.cell.text})}}]),a}(d.a.Component),X=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsx)("tr",{onClick:this.props.row.onClick,children:this.props.row.data.map((function(e,t){return Object(C.jsx)(K,{cell:e},t)}))})}}]),a}(d.a.Component),Z=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this;return Object(C.jsx)("thead",{children:Object(C.jsx)("tr",{children:this.props.header.map((function(t,a){return Object(C.jsx)(ee,{cell:t,onClick:e.props.onClickHeadCell},a)}))})})}}]),a}(d.a.Component),ee=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsx)("th",{className:"text-"+this.props.cell.align+" DataGridHeadCellOrder-"+this.props.cell.order,onClick:this.props.onClick,cellkey:this.props.cell.key,children:this.props.cell.text})}}]),a}(d.a.Component),te=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=void 0===this.props.height?0:this.props.height;return Object(C.jsx)("tr",{children:Object(C.jsx)("td",{style:{border:0,height:e,padding:0}})})}}]),a}(d.a.Component),ae=a(187),oe=(a(309),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={picker:!1,value:e.value},o.onChange=o.onChange.bind(Object(x.a)(o)),o.onClick=o.onClick.bind(Object(x.a)(o)),o.onDocumentClick=o.onDocumentClick.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState({value:e.value})}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.onDocumentClick),this.element=h.a.findDOMNode(this)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onDocumentClick)}},{key:"onChange",value:function(e,t){var a=this;t.persist(),this.setState({picker:!1,value:e.hex},(function(){if(a.props.onChange){var e=v()(t.target).parents("[class*='-picker']").first().prev().get(0);t.target=e,a.props.onChange(t)}}))}},{key:"onClick",value:function(e){this.setState({picker:!0}),e.preventDefault()}},{key:"onDocumentClick",value:function(e){if(this.state.picker){var t=!1;v()(this.element).find("*").each((function(a,o){e.target===o&&(t=!0)})),t||this.setState({picker:!1})}}},{key:"render",value:function(){var e=Object.assign({},this.props);return delete e.value,Object(C.jsxs)("div",{children:[Object(C.jsx)("input",Object(g.a)(Object(g.a)({},e),{},{value:this.state.value,onClick:this.onClick})),Object(C.jsx)(ae.a,{value:this.state.value,onChange:this.onChange,className:this.state.picker?null:"d-none"})]})}}]),a}(d.a.Component)),re=a(188),ne=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={options:void 0===e.options?[]:e.options,value:void 0===e.value?"":e.value},o.getDBOptions=o.getDBOptions.bind(Object(x.a)(o)),o.onChange=o.onChange.bind(Object(x.a)(o)),o.verifyComponentId=o.verifyComponentId.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.element=h.a.findDOMNode(this),this.verifyComponentId(),this.getDBOptions()}},{key:"componentWillReceiveProps",value:function(e){this.getDBOptions(e),e.value!==this.props.value&&this.setState({value:e.value})}},{key:"getDBOptions",value:function(e){var t=this;if(void 0===(e=void 0===e?this.props:e).dbtable)return!0;var a=e.dbtable,o=e.dbcolumn,r=e.dbfilter,n=e.dbparent;if(void 0===o&&(o="descricao"),void 0===r&&void 0!==n){var i=document.getElementById(n);r="id"+v()(i).attr("dbtable")+"="+v()(i).val()}null!==this.ajaxDBOptions&&void 0!==this.ajaxDBOptions&&(this.ajaxDBOptions.abort(),this.ajaxDBOptions=null);var s="SELECT id"+a+", "+o+" FROM "+a+" ORDER BY 2";this.props.Pool.query({text:s,rowMode:"array"},(function(e,a){if(e)return Object($.e)(e.message),!1;var o=[];for(var r in a.rows){var n=a.rows[r];o.push({value:n[0],label:n[1]})}t.state.options!==o&&t.setState({options:o})}))}},{key:"onChange",value:function(e){var t=e?e.value:null;if(this.setState({value:t}),v()("#".concat(this.props.id)).val(t),this.props.onChange){var a={target:{id:this.props.id,value:t}};this.props.onChange(a)}}},{key:"verifyComponentId",value:function(){if(this.props.id){var e=v()("[name='"+this.props.id+"']");e.length>0&&e.attr("id",v()(e).attr("name"))}}},{key:"render",value:function(){var e=this.state.options;if(!Array.isArray(e)){var t=[];for(var a in e)t.push({value:a,label:e[a]});e=t}return Array.isArray(e)||(e=[]),Object(C.jsx)(re.a,{clearable:!1,disabled:this.props.disabled,id:this.props.id,name:this.props.id,className:"Select",classNamePrefix:"Select",onChange:this.onChange,onInputChange:this.verifyComponentId,options:e,placeholder:"",searchable:!1,hasValue:!0,setValue:this.state.value?this.state.value:this.props.defaultValue})}}]),a}(d.a.Component),ie=(a(319),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).onFocus=o.onFocus.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.element=h.a.findDOMNode(this)}},{key:"onFocus",value:function(){var e=this;if(this.props.InformarValor){var t=this.props.InformarValor;void 0===t.success&&(t.success=function(t){if(v()(e.element).val(t),e.props.onChange){var a={target:{id:e.props.id,value:t}};e.props.onChange(a)}}),window.InformarValor.show(t)}}},{key:"render",value:function(){var e=Object.assign({},this.props);delete e.InformarValor;var t=e.value;null===t&&(t=""),void 0===t&&e.id&&"modal"===e.id.substr(0,5)&&(t="");var a=e.className?e.className.split(" "):[];switch(a.push("form-control"),e.size&&a.push("form-control-"+e.size),"date"===e.type&&a.push("text-center"),e.className=a.join(" "),e.value=t,void 0===this.props.onFocus&&(e.onFocus=this.onFocus),e.type){case"checkbox":return Object(C.jsxs)("div",{className:"form-check",children:[Object(C.jsx)("input",{type:"checkbox",id:this.props.id,className:"form-check-input",checked:"S"===t,defaultValue:this.props.defaultValue,disabled:this.props.disabled,onChange:this.props.onChange,onClick:this.props.onClick}),Object(C.jsx)("label",{className:"form-check-label",htmlFor:this.props.id,children:this.props.label})]});case"color":return Object(C.jsx)(oe,Object(g.a)({},e));case"select":return delete e.type,Object(C.jsx)(ne,Object(g.a)({},e));case"textarea":return delete e.type,Object(C.jsx)("textarea",Object(g.a)({},e));default:return Object(C.jsx)("input",Object(g.a)({},e))}}}]),a}(d.a.Component)),se=a(18),ce=(a(320),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsx)("label",Object(g.a)(Object(g.a)({},this.props),{},{children:this.props.children}))}}]),a}(d.a.Component)),ue=(a(321),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=Object.assign({},this.props),t=["form-group"];return e.className&&t.push(e.className),e.warning&&(t.push("form-group-warning"),delete e.warning),e.InformarValor&&void 0===e.InformarValor.title&&(e.InformarValor.title=this.props.label),e.className=e.inputClassName,delete e.inputClassName,Object(C.jsxs)("div",{className:t.join(" "),children:[["checkbox"].indexOf(this.props.type)>-1?null:Object(C.jsx)(ce,{htmlFor:this.props.id,children:this.props.label}),Object(C.jsx)(ie,Object(g.a)({},e))]})}}]),a}(d.a.Component)),le=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsx)("hr",Object(g.a)({},this.props))}}]),a}(d.a.Component),de=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={show:o.props.show,showDiv:"principal",title:null},o.cancelar=o.cancelar.bind(Object(x.a)(o)),o.changeDiv=o.changeDiv.bind(Object(x.a)(o)),o.changeTitle=o.changeTitle.bind(Object(x.a)(o)),o.excluir=o.excluir.bind(Object(x.a)(o)),o.gravar=o.gravar.bind(Object(x.a)(o)),o.limpar=o.limpar.bind(Object(x.a)(o)),o.onChangeNcm=o.onChangeNcm.bind(Object(x.a)(o)),o.onChangeInput=o.onChangeInput.bind(Object(x.a)(o)),o.onChangeSincTributacao=o.onChangeSincTributacao.bind(Object(x.a)(o)),o.sincronizarTributacao=o.sincronizarTributacao.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"carregar",value:function(e,t){var a=this,o=["SELECT categoria.descricao, categoria.dthrcriacao, categoria.cor,","  categoria.sinctributacao, ncm.codigoncm, categoria.origem,","  categoria.cfop, categoria.csosn, categoria.aliqicms, ","  categoria.cstpis, categoria.aliqpis, categoria.cstcofins, ","  categoria.aliqcofins, categoria.codcontribsocial, categoria.cest","FROM categoria","LEFT JOIN ncm USING (idncm)","WHERE categoria.idcategoria = $1"].join(" ");this.props.Pool.query(o,[e],(function(e,o){if(e)return Object($.e)(e.message),!1;if(0===o.rows.length)return window.MessageBox.show({title:"Categoria n\xe3o encontrada",text:"A categoria selecionada n\xe3o p\xf4de ser encontrada."}),!1;var r={},n=o.rows[0];for(var i in n){var s=n[i];switch(i){case"dthrcriacao":s=s.toLocaleString();break;case"aliqicms":case"aliqpis":case"aliqcofins":s=s.format(2,",",".")}r["input_"+i]=s}a.setState(r),"function"===typeof t&&t()}))}},{key:"changeDiv",value:function(e){this.setState({showDiv:e})}},{key:"changeTitle",value:function(e){var t=this;e.idcategoria?e.Pool.query("SELECT descricao FROM categoria WHERE idcategoria = $1",[e.idcategoria],(function(e,a){if(e)return Object($.e)(e.message),!1;t.setState({title:"Alterando categoria: "+a.rows[0].descricao})})):this.setState({title:"Criando nova categoria"})}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(!e.show)return!1;this.changeTitle(e);var a=function(){t.setState({show:e.show})};e.idcategoria?this.carregar(e.idcategoria,a):(this.limpar(),a())}},{key:"excluir",value:function(){var e=this;window.MessageBox.show({title:"Exclu\xedr categoria",text:"Tem certeza que deseja exclu\xedr a categoria <b>"+this.state.input_descricao+"</b>?",buttons:[{text:"Sim",icon:"thumbs-up",color:"green",onClick:function(){window.MessageBox.hide(),e.props.Pool.query("DELETE FROM categoria WHERE idcategoria = $1",[e.props.idcategoria],(function(t,a){if(t)return Object($.e)(t.message),!1;e.setState({show:!1}),window.FastMessage.show("Categoria exclu\xedda com sucesso.")}))}},{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:function(){window.MessageBox.hide()}}]})}},{key:"gravar",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,u,l,d,p,h,m=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=null,a=[],o=[],e.t0=r.a.keys(this.state);case 4:if((e.t1=e.t0()).done){e.next=37;break}if("input_"!==(n=e.t1.value).substr(0,6)){e.next=35;break}if(i=n.replace("input_",""),s=this.state[n],"codigoncm"!==i||!s){e.next=25;break}return e.prev=10,e.next=13,this.props.Pool.query("SELECT idncm FROM ncm WHERE codigoncm = $1",[s]);case 13:if(0!==(c=e.sent).rows.length){e.next=17;break}return window.MessageBox.show({title:"NCM inexistente",text:"O c\xf3digo de NCM "+s+" n\xe3o p\xf4de ser encontrado.<br>Verifique se foi informado corretamente."}),e.abrupt("return",!1);case 17:i="idncm",s=c.rows[0].idncm,e.next=25;break;case 21:return e.prev=21,e.t2=e.catch(10),Object($.e)(e.t2.message),e.abrupt("return",!1);case 25:if(!(["idcategoria","dthrcriacao"].indexOf(i)>-1)){e.next=27;break}return e.abrupt("continue",4);case 27:e.t3=i,e.next="aliqicms"===e.t3||"aliqpis"===e.t3||"aliqcofins"===e.t3?30:32;break;case 30:return s&&(s=s.toFloat()),e.abrupt("break",33);case 32:return e.abrupt("break",33);case 33:a.push(i),o.push(s);case 35:e.next=4;break;case 37:if(this.props.idcategoria){for(d in u=1,l=[],a)l.push(a[d]+" = $"+u++);t="UPDATE categoria SET "+l.join(", ")+" WHERE idcategoria = "+this.props.idcategoria}else{for(p=[],h=0;h<a.length;h++)p.push("$"+(h+1));t="INSERT INTO categoria ("+a.join(", ")+") VALUES ("+p.join(", ")+")"}this.props.Pool.query(t,o,(function(e,t){if(e)return Object($.e)(e.message),!1;m.setState({show:!1}),window.FastMessage.show("Categoria gravada com sucesso.")}));case 39:case"end":return e.stop()}}),e,this,[[10,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"limpar",value:function(){var e={};for(var t in this.state)"input_"===t.substr(0,6)&&(e[t]=null);this.setState(e)}},{key:"onChangeInput",value:function(e,t){var a=e.target,o=a.id.replace("modalcategoria-",""),r=a.value;"checkbox"===a.type&&(r=a.checked?"S":"N"),this.setState(Object(se.a)({},"input_"+o,r),t)}},{key:"onChangeNcm",value:function(e){var t=this;this.onChangeInput(e,(function(){t.sincronizarTributacao()}))}},{key:"onChangeSincTributacao",value:function(e){var t=this;this.onChangeInput(e,(function(){t.sincronizarTributacao()}))}},{key:"sincronizarTributacao",value:function(){var e=this;if("S"!==this.state.input_sinctributacao)return!0;var t=["SELECT origem, cfop, csosn, aliqicms, cstpis, aliqpis, ","  cstcofins, aliqcofins, codcontribsocial, cest","FROM ncm","WHERE codigoncm = $1"].join(" ");this.props.Pool.query(t,[this.state.input_codigoncm],(function(t,a){if(t)return Object($.e)(t.message),!1;if(0===a.rows.length)return window.MessageBox.show({title:"NCM n\xe3o encontrado",text:"O NCM informado na categoria n\xe3o p\xf4de ser encontrado."}),!1;var o={},r=a.rows[0];for(var n in r){var i=r[n];switch(n){case"aliqicms":case"aliqpis":case"aliqcofins":i=i.format(2,",",".")}o["input_"+n]=i}e.setState(o)}))}},{key:"shouldComponentUpdate",value:function(e){return e.show}},{key:"render",value:function(){return Object(C.jsxs)(M,{title:this.state.title,size:"lg",show:this.state.show,beforeClose:this.props.beforeClose,afterClose:this.props.afterClose,closeOnOutClick:!1,children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(ue,{type:"text",id:"modalcategoria-descricao",className:"col-5",label:"Descri\xe7\xe3o",value:this.state.input_descricao,onChange:this.onChangeInput}),Object(C.jsx)(ue,{type:"color",id:"modalcategoria-cor",className:"col-3",label:"Cor representativa",value:this.state.input_cor,onChange:this.onChangeInput}),Object(C.jsx)(ue,{type:"text",id:"modalcategoria-dthrcriacao",className:"col-4",label:"Criado em",readOnly:!0,value:this.state.input_dthrcriacao,onChange:this.onChangeInput,disabled:!0}),Object(C.jsx)(ue,{type:"text",id:"modalcategoria-codigoncm",label:"NCM da categoria",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"9999.99.99"},value:this.state.input_codigoncm,onChange:this.onChangeNcm}),Object(C.jsx)(ue,{type:"checkbox",id:"modalcategoria-sinctributacao",label:"Usar as mesmas tributa\xe7\xf5es da categoria",className:"col-9",value:this.state.input_sinctributacao,onChange:this.onChangeSincTributacao}),Object(C.jsx)(ue,{type:"select",id:"modalcategoria-origem",className:"col-6",label:"Origem do categoria",options:{0:"0 - Nacional, exceto as indicadas nos c\xf3digos 3, 4, 5 e 8",1:"1 - Estrangeira - Importa\xe7\xe3o direta, exceto a indicada no c\xf3digo 6",2:"2 - Estrangeira - Adquirida no mercado interno, exceto a indicada no c\xf3digo 7",3:"3 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o superior a 40% e inferior ou igual a 70%",4:"4 - Nacional, cuja produ\xe7\xe3o tenha sido feita em conformidade com os processos produtivos b\xe1sicos de que tratam o Decreto-Lei n\xba 288/67, e as Leis n\xbas 8.248/91, 8.387/91, 10.176/01 e 11.484/ 07",5:"5 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o inferior ou igual a 40%",6:"6 - Estrangeira - Importa\xe7\xe3o direta, sem similar nacional, constante em lista da Resolu\xe7\xe3o CAMEX n\xba 79/2012 e g\xe1s natural",7:"7 - Estrangeira - Adquirida no mercado interno, sem similar nacional, constante em lista da Resolu\xe7\xe3o CAMEX n\xba 79/2012 e g\xe1s natural",8:"8 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o superior a 70%"},value:this.state.input_origem,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalcategoria-cfop",label:"CFOP",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"9.999"},value:this.state.input_cfop,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"select",id:"modalcategoria-csosn",className:"col-3",inputClassName:"text-center",label:"CSOSN",options:{102:"102",300:"300",400:"400",500:"500"},value:this.state.input_csosn,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalcategoria-aliqicms",label:"Al\xedquota de ICMS",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqicms,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalcategoria-cstpis",label:"CST do PIS",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_cstpis,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalcategoria-aliqpis",label:"Al\xedquota de PIS",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqpis,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalcategoria-cstcofins",label:"CST do Cofins",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_cstcofins,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalcategoria-aliqcofins",label:"Al\xedquota de Cofins",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqcofins,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalcategoria-codcontribsocial",label:"Contribui\xe7\xe3o social",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_codcontribsocial,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalcategoria-cest",label:"CEST",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99.999.99"},value:this.state.input_cest,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao})]}),Object(C.jsx)(le,{className:"mt-0"}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(T,{text:"Exclu\xedr",icon:"bin",color:"red",onClick:this.excluir,className:this.props.idcategoria?"":"d-none"})}),Object(C.jsxs)(R,{size:"6",className:"text-right",children:[Object(C.jsx)(T,{text:"Cancelar",icon:"undo",color:"red",onClick:this.cancelar}),Object(C.jsx)(T,{text:"Gravar categoria",icon:"thumbs-up",color:"green",className:"ml-2",onClick:this.gravar})]})]})]})}}]),a}(d.a.Component),pe=(a(322),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=void 0!==this.props.text?this.props.text:this.props.children,t=void 0!==this.props.model?this.props.model:1;return Object(C.jsx)("h1",{className:"title-model-"+t,children:e})}}]),a}(d.a.Component)),he=(a(323),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={dataGrid:[],pesquisa:"",idcategoria:null,showModalCategoria:!1,redirectToProduto:!1},o.beforeCloseModal=o.beforeCloseModal.bind(Object(x.a)(o)),o.loadDataGrid=o.loadDataGrid.bind(Object(x.a)(o)),o.novaCategoria=o.novaCategoria.bind(Object(x.a)(o)),o.onChangePesquisa=o.onChangePesquisa.bind(Object(x.a)(o)),o.onClickBtnProduto=o.onClickBtnProduto.bind(Object(x.a)(o)),o.onKeyUpPesquisa=o.onKeyUpPesquisa.bind(Object(x.a)(o)),o.pesquisaLimpar=o.pesquisaLimpar.bind(Object(x.a)(o)),o.Pool=new G,o}return Object(s.a)(a,[{key:"beforeCloseModal",value:function(){var e=this;this.setState({showModalCategoria:!1},(function(){e.loadDataGrid()}))}},{key:"carregarCategoria",value:function(e){this.setState({showModalCategoria:!0,idcategoria:e})}},{key:"componentDidMount",value:function(){this.loadDataGrid()}},{key:"componentWillUnmount",value:function(){this.Pool.end()}},{key:"loadDataGrid",value:function(){var e=this,t=["SELECT categoria.idcategoria, categoria.descricao, ","  ncm.codigoncm AS codigoncm, categoria.dthrcriacao,","  (SELECT COUNT(idproduto) FROM produto WHERE idcategoria = categoria.idcategoria) AS produtos","FROM categoria","LEFT JOIN ncm USING (idncm)","WHERE categoria.descricao ILIKE '%'||$1||'%'","ORDER BY categoria.descricao"].join(" ");this.Pool.query(t,[this.state.pesquisa],(function(t,a){if(t)return Object($.e)(t.message),!1;var o=[],r=function(t){var r=a.rows[t];o.push({data:[{text:r.descricao,align:"left"},{text:r.codigoncm,align:"center"},{text:r.produtos,align:"center"},{text:r.dthrcriacao.toLocaleString(),align:"center"}],onClick:function(){e.carregarCategoria(r.idcategoria)}})};for(var n in a.rows)r(n);e.setState({dataGrid:o})}))}},{key:"novaCategoria",value:function(){this.setState({showModalCategoria:!0,idcategoria:null})}},{key:"onChangePesquisa",value:function(e){this.setState({pesquisa:e.target.value})}},{key:"onClickBtnProduto",value:function(){this.setState({redirectToProduto:!0})}},{key:"onKeyUpPesquisa",value:function(e){13===e.keyCode&&this.loadDataGrid()}},{key:"pesquisaLimpar",value:function(){var e=this;this.setState({pesquisa:""},(function(){e.loadDataGrid()}))}},{key:"render",value:function(){if(this.state.redirectToProduto)return Object(C.jsx)(b.a,{to:"/produto"});return Object(C.jsxs)(Y,{children:[Object(C.jsxs)(pe,{model:"2",children:["Cadastro de ",Object(C.jsx)("b",{children:"Categorias"})]}),Object(C.jsxs)(q,{className:"mb-4",children:[Object(C.jsxs)(R,{size:"4",children:[Object(C.jsx)(ie,{type:"search",id:"pesquisa",value:this.state.pesquisa,placeholder:"Pesquise uma categoria...",onKeyUp:this.onKeyUpPesquisa,onChange:this.onChangePesquisa}),Object(C.jsx)(k,{name:"cross",id:"pesquisa-limpar",onClick:this.pesquisaLimpar,className:this.state.pesquisa.length>0?null:"d-none"})]}),Object(C.jsx)(R,{size:"2",className:"pl-0",children:Object(C.jsx)(T,{text:"Buscar",icon:"search",color:"green",onClick:this.loadDataGrid})}),Object(C.jsxs)(R,{size:"6",className:"text-right",children:[Object(C.jsx)(T,{text:"Produtos",icon:"layers",color:"blue",className:"mr-3",onClick:this.onClickBtnProduto}),Object(C.jsx)(T,{text:"Nova categoria",icon:"plus",color:"green",onClick:this.novaCategoria})]})]}),Object(C.jsx)(Q,{header:[{text:"Descri\xe7\xe3o",align:"left"},{text:"NCM",align:"center"},{text:"Produtos",align:"center"},{text:"Criado em",align:"center"}],data:this.state.dataGrid}),Object(C.jsx)(de,{Pool:this.Pool,show:this.state.showModalCategoria,idcategoria:this.state.idcategoria,beforeClose:this.beforeCloseModal})]})}}]),a}(d.a.Component)),me=a(15),be=a(179),fe=a.n(be),ve=window.require("fs"),je=window.require("electron"),Oe=function(){function e(t){Object(i.a)(this,e),this.Pool=t,this.atualizarAplicativoParcial=this.atualizarAplicativoParcial.bind(this),this.atualizarBancoDeDados=this.atualizarBancoDeDados.bind(this),this.baixarAplicativoParcial=this.baixarAplicativoParcial.bind(this),this.verificarAtualizacao=this.verificarAtualizacao.bind(this),this.fs=ve}return Object(s.a)(e,[{key:"atualizarAplicativoParcial",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.baixarAplicativoParcial(function(){var e=Object(n.a)(r.a.mark((function e(o){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=2;break}return e.abrupt("return",t(o));case 2:return e.next=4,a.atualizarBancoDeDados((function(e){if(e)return t(e);t()}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"atualizarBancoDeDados",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,i,s=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===this.ftp&&(this.ftp=fe.a),a=function(){var e=Object(n.a)(r.a.mark((function e(t,a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.get(a,!1,(function(t,a){if(t)throw new Error(t);var o=[];a.on("data",(function(e){o.push(e.toString())})).on("end",(function(){e(o.join(""))}))}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),e.t0=parseInt,e.next=5,Object($.l)(this.Pool,"ATUALIZACAO","INSTRUCAOSQL");case 5:e.t1=e.sent,o=(0,e.t0)(e.t1,10);try{(i=new this.ftp).on("ready",(function(){i.list("/sql",!1,function(){var e=Object(n.a)(r.a.mark((function e(n,c){var u,l,d,p,h,m,b;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=2;break}return e.abrupt("return",t(n));case 2:u=[],l=Object(me.a)(c);try{for(l.s();!(d=l.n()).done;)p=d.value,parseInt(p.name.replace(".sql",""),10)>o&&u.push(p.name)}catch(n){l.e(n)}finally{l.f()}u.sort(),e.prev=6,e.t0=r.a.keys(u);case 8:if((e.t1=e.t0()).done){e.next=20;break}return h=e.t1.value,m=u[h],e.next=13,a(i,"/sql/"+m);case 13:return b=e.sent,console.log("Executar SQL: \n"+b),e.next=17,s.Pool.query(b);case 17:console.log("SQL Finalizada"),e.next=8;break;case 20:t(),e.next=27;break;case 23:e.prev=23,e.t2=e.catch(6),console.log("Erro ao atualizar BD: "+e.t2.message),t(e.t2);case 27:case"end":return e.stop()}}),e,null,[[6,23]])})));return function(t,a){return e.apply(this,arguments)}}())})).connect({host:"websac.net",port:"21",user:"satflex-update",password:"automacao"})}catch(c){t(c)}case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"baixarAplicativoParcial",value:function(e){var t=this;if(!0===window.__ignoreAppUpdate)return e();void 0===this.childProcess&&(this.childProcess=window.require("childProcess")),this.childProcess.exec("git --version",[],(function(a){if(a)return e(new Error("git-not-found"));var o=Object($.a)()+"/.git";console.log("Diret\xf3rio .git: "+o);try{t.childProcess.execSync('git config --global git.user "satflex@controlware.com.br"')}catch(a){return e(a)}var r=t.childProcess.spawn('cd "'+Object($.a)()+'" && git pull',{shell:!0});r.stdout.on("data",(function(e){console.log("stdout: "+e.toString())})),r.stderr.on("data",(function(e){console.log("stderr: "+e.toString())})),r.on("close",(function(t){console.log("exit: "+t.toString()),e()}))}))}},{key:"baixarGit",value:function(){window.MessageBox.show({title:"Git n\xe3o est\xe1 instalado",text:"Para atualizar o SAT-Flex, \xe9 necess\xe1rio que o Git esteja instalado.",buttons:[{text:"Baixar o Git",color:"green",icon:"github",onClick:function(){window.MessageBox.hide(),je.shell.openExternal("ftp://instalacao:123@websac.net/SATFlex/Git-2.18.0-32-bit.exe")}},{text:"Mais tarde...",color:"blue",icon:"undo",onClick:function(){window.MessageBox.hide()}}]})}},{key:"versaoAtual",value:function(){var e=Object($.a)()+"/package.json";return window.require(e).version}},{key:"verificarAtualizacao",value:function(){var e=this;window.MessageBox.show({title:"Atualiza\xe7\xe3o do SAT-Flex",text:"Deseja iniciar a atualiza\xe7\xe3o do SAT-Flex agora?<br>Isso pode levar alguns minutos.",buttons:[{text:"Sim",icon:"thumbs-up",color:"green",onClick:function(){window.MessageBox.hide(),window.Loading.show(),console.log("Inicio da atualiza\xe7\xe3o: "+(new Date).toLocaleString()),e.atualizarAplicativoParcial((function(t){if(console.log("Fim da atualiza\xe7\xe3o: "+(new Date).toLocaleString()),window.Loading.hide(),t)return"git-not-found"===t.message?e.baixarGit():Object($.e)(t),!1;window.MessageBox.show({title:"Atualizado com sucesso!",text:"O seu SAT-Flex foi atualizado com sucesso!<br>A aplica\xe7\xe3o ser\xe1 reinciada.",buttons:[{text:"Ok",icon:"thumbs-up",onClick:function(){window.require("electron").ipcRenderer.sendSync("restart")}}]})}))}},{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:function(){window.MessageBox.hide()}}]})}}]),e}(),xe=(a(356),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={redirect:null,serialnumber:null,versaoAtual:null},o.verificarAtualizacao=o.verificarAtualizacao.bind(Object(x.a)(o)),o.Pool=new G,o.Atualizacao=new Oe(o.Pool),o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this;Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,Object($.g)();case 3:t.t1=t.sent,t.t2={serialnumber:t.t1},t.t0.setState.call(t.t0,t.t2);case 6:case"end":return t.stop()}}),t)})))()}},{key:"verificarAtualizacao",value:function(){this.Atualizacao.verificarAtualizacao()}},{key:"render",value:function(){var e=this;if(this.state.redirect)return Object(C.jsx)(b.a,{to:this.state.redirect});var t=this.Atualizacao.versaoAtual(),a=null;return a=this.state.serialnumber?Object(C.jsx)("b",{children:this.state.serialnumber}):Object(C.jsx)(k,{name:"spinner3",className:"ani-spin"}),Object(C.jsxs)(Y,{children:[Object(C.jsx)(pe,{children:"Configura\xe7\xf5es"}),Object(C.jsx)(q,{children:Object(C.jsx)(R,{size:"8",offset:"2",children:Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",className:"mb-4",children:Object(C.jsx)(T,{text:"Verificar atualiza\xe7\xe3o<br><small>vers\xe3o atual: "+t+"</small>",icon:"safari",size:"xxl",block:!0,onClick:this.verificarAtualizacao})}),Object(C.jsx)(R,{size:"6",className:"mb-4",children:Object(C.jsx)(T,{text:"Par\xe2metros<br>do sistema",icon:"widgets",size:"xxl",block:!0,onClick:function(){e.setState({redirect:"/parametro"})}})}),Object(C.jsx)(R,{size:"6",className:"mb-4",children:Object(C.jsx)(T,{text:"Ferramentas",icon:"tools",size:"xxl",block:!0,onClick:function(){e.setState({redirect:"/ferramentas"})}})})]})})}),Object(C.jsxs)("div",{className:"serialnumber",children:[Object(C.jsx)("small",{children:"N\xfamero de s\xe9rie"}),Object(C.jsx)("br",{}),a]})]})}}]),a}(d.a.Component)),ge=a(180),Ce=a.n(ge),ke=a(181),ye=(a(377),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=void 0!==this.props.text?this.props.text:this.props.children,t=void 0!==this.props.model?this.props.model:1;return Object(C.jsx)("h3",{className:"subtitle-model-"+t,children:e})}}]),a}(d.a.Component)),we=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).atualizarEmailContador=o.atualizarEmailContador.bind(Object(x.a)(o)),o.carregarDocumentos=o.carregarDocumentos.bind(Object(x.a)(o)),o.enviarEmail=o.enviarEmail.bind(Object(x.a)(o)),o.Pool=new G,o}return Object(s.a)(a,[{key:"atualizarEmailContador",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Pool.query("UPDATE parametro SET valor = $1 WHERE grupo = $2 AND nome = $3",[v()("#email").val(),"CONTADOR","EMAIL"]);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"carregarDocumentos",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["SELECT chave, xml, chavecanc, xmlcanc","FROM documento","WHERE xml IS NOT NULL","  AND chave IS NOT NULL","  AND dthrcriacao::DATE BETWEEN $1 AND $2","ORDER BY dthrcriacao"].join(" "),e.next=3,this.Pool.query(t,[v()("#dtinicial").val(),v()("#dtfinal").val()]);case 3:return a=e.sent,e.abrupt("return",a.rows);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"carregarEmailContador",value:function(){Object($.l)(this.Pool,"CONTADOR","EMAIL",(function(e){v()("#email").val(e)}))}},{key:"componentDidMount",value:function(){this.carregarEmailContador()}},{key:"enviarEmail",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,u,l,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=v()("#email").val(),a=v()("#dtinicial").val(),o=v()("#dtfinal").val(),0!==t.length){e.next=6;break}return window.MessageBox.show({text:"Informe o e-mail do contador antes de prosseguir."}),e.abrupt("return",!1);case 6:if(0!==a.length){e.next=9;break}return window.MessageBox.show({text:"Informe a data inicial antes de prosseguir."}),e.abrupt("return",!1);case 9:if(0!==o.length){e.next=12;break}return window.MessageBox.show({text:"Informe a data final antes de prosseguir."}),e.abrupt("return",!1);case 12:return window.Loading.show(),e.next=15,Object($.l)(this.Pool,"EMITENTE","NOMEFANTASIA");case 15:return n=e.sent,a=a.split("-").reverse().join("/"),o=o.split("-").reverse().join("/"),e.next=20,this.atualizarEmailContador();case 20:return e.next=22,this.carregarDocumentos();case 22:if(0!==(i=e.sent).length){e.next=27;break}return window.Loading.hide(),window.MessageBox.show({text:"Nenhum documento fiscal foi encontrado no per\xedodo especificado."}),e.abrupt("return",!1);case 27:s=new Ce.a,i.forEach((function(e){e.xml&&s.file(e.chave+".xml",e.xml),e.xmlcanc&&s.file(e.chavecanc+".xml",e.xmlcanc)})),c=s.generate({base64:!1,compression:"DEFLATE"}),u=(new Date).toISOString().substr(0,10)+".zip",l=Object($.m)(u,c),(d=new ke.a(this.Pool)).remetente(n),d.destinatario(t),d.titulo("SAT-Flex: XMLs de "+a+" at\xe9 "+o),d.anexo(l),d.corpo("Seguem os XMLs do per\xedodo de "+a+" at\xe9 "+o+" anexados ao e-mail."),d.enviar((function(){window.Loading.hide(),window.MessageBox.show({title:"Enviado com sucesso",text:"O e-mail contendo os XMLs no per\xedodo especificado foi enviado com sucesso para o e-mail do contador."})}),(function(e){window.Loading.hide(),window.MessageBox.show({title:"Houve uma falha",text:e.message})}));case 39:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=new Date,t=new Date(e.getFullYear(),e.getMonth()-1,1).toISOString().substr(0,10),a=new Date(e.getFullYear(),e.getMonth(),0).toISOString().substr(0,10);return Object(C.jsxs)(Y,{children:[Object(C.jsx)(pe,{children:"M\xf3dulo do contador"}),Object(C.jsx)(ye,{children:"Enviar arquivos fiscais por e-mail"}),Object(C.jsx)(q,{children:Object(C.jsxs)(R,{size:"6",offset:"3",children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(ue,{type:"email",id:"email",label:"E-mail do contador",className:"col-12",size:"lg"}),Object(C.jsx)(ue,{type:"date",id:"dtinicial",label:"Data inicial",className:"col-6",size:"lg",defaultValue:t}),Object(C.jsx)(ue,{type:"date",id:"dtfinal",label:"Data final",className:"col-6",size:"lg",defaultValue:a})]}),Object(C.jsx)("div",{className:"text-center mt-2",children:Object(C.jsx)(T,{text:"Enviar arquivos por e-mail",icon:"mail-read",size:"lg",onClick:this.enviarEmail})})]})})]})}}]),a}(d.a.Component),Se=a(189),Ee=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=["btn-group","btn-group-"+this.props.size];return this.props.className&&e.push(this.props.className),Object(C.jsx)("div",{className:e.join(" "),children:this.props.children})}}]),a}(d.a.Component);Ee.defaultProps={size:"md"};var Ne=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=[this.props.className];return e.push("text-center"),Object(C.jsx)("div",{className:e.join(" "),children:this.props.children})}}]),a}(d.a.Component),Pe=(a(398),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).carregarDados=o.carregarDados.bind(Object(x.a)(o)),o.carregarDadosCategoria=o.carregarDadosCategoria.bind(Object(x.a)(o)),o.carregarDadosFormaPagamento=o.carregarDadosFormaPagamento.bind(Object(x.a)(o)),o.carregarDadosGeral=o.carregarDadosGeral.bind(Object(x.a)(o)),o.carregarDadosProduto=o.carregarDadosProduto.bind(Object(x.a)(o)),o.state={tabela:null,dados:null},o.LineChart=Se.a,o.Pool=new G,o}return Object(s.a)(a,[{key:"carregarDados",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,window.Loading.show(),a=null,e.t0=t,e.next="categoria"===e.t0?6:"formapagamento"===e.t0?10:"produto"===e.t0?14:18;break;case 6:return e.next=8,this.carregarDadosCategoria();case 8:return a=e.sent,e.abrupt("break",22);case 10:return e.next=12,this.carregarDadosFormaPagamento();case 12:return a=e.sent,e.abrupt("break",22);case 14:return e.next=16,this.carregarDadosProduto();case 16:return a=e.sent,e.abrupt("break",22);case 18:return e.next=20,this.carregarDadosGeral();case 20:return a=e.sent,e.abrupt("break",22);case 22:console.log({tabela:t,dados:a}),this.setState({tabela:t,dados:a}),e.next=29;break;case 26:e.prev=26,e.t1=e.catch(0),Object($.e)(e.t1);case 29:return e.prev=29,window.Loading.hide(),e.finish(29);case 32:case"end":return e.stop()}}),e,this,[[0,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"carregarDadosCategoria",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,u,l,d,p,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["SELECT categoria.descricao AS a,","  v_vendaprodutodiario.dtvenda AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","LEFT JOIN categoria USING (idcategoria)","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '30 days'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=3,this.Pool.query(t);case 3:return a=e.sent,o=this.prepararDados(a.rows,"D"),n=["SELECT categoria.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","LEFT JOIN categoria USING (idcategoria)","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '6 months'::INTERVAL","  AND EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda) != 0","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=8,this.Pool.query(n);case 8:return i=e.sent,s=this.prepararDados(i.rows,"S"),c=["SELECT categoria.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(MONTH FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","LEFT JOIN categoria USING (idcategoria)","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '2 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=13,this.Pool.query(c);case 13:return u=e.sent,l=this.prepararDados(u.rows,"M"),d=["SELECT categoria.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda)) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","LEFT JOIN categoria USING (idcategoria)","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '10 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=18,this.Pool.query(d);case 18:return p=e.sent,h=this.prepararDados(p.rows,"Y"),e.abrupt("return",{diario:o,semanal:s,mensal:l,anual:h});case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"carregarDadosFormaPagamento",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,u,l,d,p,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["SELECT formapagamento.descricao AS a,","  v_vendapagamentodiario.dtvenda AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendapagamentodiario, formapagamento","WHERE (v_vendapagamentodiario.idformapagamento IS NULL OR v_vendapagamentodiario.idformapagamento = formapagamento.idformapagamento)","  AND (formapagamento.status IS NULL OR formapagamento.status = 'A')","  AND v_vendapagamentodiario.dtvenda >= CURRENT_DATE - '30 days'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=3,this.Pool.query(t);case 3:return a=e.sent,o=this.prepararDados(a.rows,"D"),n=["SELECT formapagamento.descricao AS a,","  (EXTRACT(YEAR FROM v_vendapagamentodiario.dtvenda) || '-' || LPAD(EXTRACT(WEEK FROM v_vendapagamentodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendapagamentodiario, formapagamento","WHERE (v_vendapagamentodiario.idformapagamento IS NULL OR v_vendapagamentodiario.idformapagamento = formapagamento.idformapagamento)","  AND (formapagamento.status IS NULL OR formapagamento.status = 'A')","  AND v_vendapagamentodiario.dtvenda >= CURRENT_DATE - '6 months'::INTERVAL","  AND EXTRACT(WEEK FROM v_vendapagamentodiario.dtvenda) != 0","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=8,this.Pool.query(n);case 8:return i=e.sent,s=this.prepararDados(i.rows,"S"),c=["SELECT formapagamento.descricao AS a,","  (EXTRACT(YEAR FROM v_vendapagamentodiario.dtvenda) || '-' || LPAD(EXTRACT(MONTH FROM v_vendapagamentodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendapagamentodiario, formapagamento","WHERE (v_vendapagamentodiario.idformapagamento IS NULL OR v_vendapagamentodiario.idformapagamento = formapagamento.idformapagamento)","  AND (formapagamento.status IS NULL OR formapagamento.status = 'A')","  AND v_vendapagamentodiario.dtvenda >= CURRENT_DATE - '2 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=13,this.Pool.query(c);case 13:return u=e.sent,l=this.prepararDados(u.rows,"M"),d=["SELECT formapagamento.descricao AS a,","  (EXTRACT(YEAR FROM v_vendapagamentodiario.dtvenda)) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendapagamentodiario, formapagamento","WHERE (v_vendapagamentodiario.idformapagamento IS NULL OR v_vendapagamentodiario.idformapagamento = formapagamento.idformapagamento)","  AND (formapagamento.status IS NULL OR formapagamento.status = 'A')","  AND v_vendapagamentodiario.dtvenda >= CURRENT_DATE - '10 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=18,this.Pool.query(d);case 18:return p=e.sent,h=this.prepararDados(p.rows,"Y"),e.abrupt("return",{diario:o,semanal:s,mensal:l,anual:h});case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"carregarDadosGeral",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,u,l,d,p,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["SELECT 'Venda' AS a,","  v_vendaprodutodiario.dtvenda AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario","WHERE v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '30 days'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=3,this.Pool.query(t);case 3:return a=e.sent,o=this.prepararDados(a.rows,"D"),n=["SELECT 'Venda' AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario","WHERE v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '6 months'::INTERVAL","  AND EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda) != 0","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=8,this.Pool.query(n);case 8:return i=e.sent,s=this.prepararDados(i.rows,"S"),c=["SELECT 'Venda' AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(MONTH FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario","WHERE v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '2 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=13,this.Pool.query(c);case 13:return u=e.sent,l=this.prepararDados(u.rows,"M"),d=["SELECT 'Venda' AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda)) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario","WHERE v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '10 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=18,this.Pool.query(d);case 18:return p=e.sent,h=this.prepararDados(p.rows,"Y"),e.abrupt("return",{diario:o,semanal:s,mensal:l,anual:h});case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"carregarDadosProduto",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,u,l,d,p,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["SELECT produto.descricao AS a,","  v_vendaprodutodiario.dtvenda AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '30 days'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=3,this.Pool.query(t);case 3:return a=e.sent,o=this.prepararDados(a.rows,"D"),n=["SELECT produto.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '6 months'::INTERVAL","  AND EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda) != 0","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=8,this.Pool.query(n);case 8:return i=e.sent,s=this.prepararDados(i.rows,"S"),c=["SELECT produto.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(MONTH FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '2 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=13,this.Pool.query(c);case 13:return u=e.sent,l=this.prepararDados(u.rows,"M"),d=["SELECT produto.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda)) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '10 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),e.next=18,this.Pool.query(d);case 18:return p=e.sent,h=this.prepararDados(p.rows,"Y"),e.abrupt("return",{diario:o,semanal:s,mensal:l,anual:h});case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.carregarDados("categoria")}},{key:"prepararDados",value:function(e,t){var a=[],o=[];for(var r in e){var n=e[r];switch(t){case"D":n.x=String(n.x.getDate()).lpad(2,"0")+"/"+String(n.x.getMonth()+1).lpad(2,"0")+"/"+n.x.getFullYear();break;case"S":case"M":n.x=n.x.split("-").reverse().join("/")}e[r].x=n.x,-1===o.indexOf(n.x)&&o.push(n.x),-1===a.indexOf(n.a)&&a.push(n.a)}for(var i={},s=0,c=o;s<c.length;s++){var u,l=c[s],d=Object(me.a)(a);try{for(d.s();!(u=d.n()).done;){var p=u.value;void 0===i[p]&&(i[p]=[]);var h,m=!1,b=Object(me.a)(e);try{for(b.s();!(h=b.n()).done;){var f=h.value;if(f.a===p&&f.x===l){i[p].push(f.y),m=!0;break}}}catch(x){b.e(x)}finally{b.f()}m||i[p].push(0)}}catch(x){d.e(x)}finally{d.f()}}var v=[];for(var j in i){void 0===this.cor&&(this.cor={}),"D"===t&&(this.cor[j]=Math.round(255*Math.random())+","+Math.round(255*Math.random())+","+Math.round(255*Math.random()));var O=this.cor[j];v.push({label:j,fillColor:"rgba("+O+",0.2)",strokeColor:"rgba("+O+",1)",pointColor:"rgba("+O+",1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba("+O+",1)",data:i[j]})}return{labels:o,datasets:v}}},{key:"render",value:function(){var e=this,t={legend:{display:!0}},a="300px",o="900px",r=null;null!==this.state.dados&&(r=Object(C.jsx)(this.LineChart,{data:this.state.dados.diario,options:t,height:a,width:o}));var n=null;null!==this.state.dados&&(n=Object(C.jsx)(this.LineChart,{data:this.state.dados.semanal,options:t,height:a,width:o}));var i=null;null!==this.state.dados&&(i=Object(C.jsx)(this.LineChart,{data:this.state.dados.mensal,options:t,height:a,width:o}));var s=null;return null!==this.state.dados&&(s=Object(C.jsx)(this.LineChart,{data:this.state.dados.anual,options:t,height:a,width:o})),Object(C.jsxs)(Y,{children:[Object(C.jsx)(pe,{children:"Estat\xedsticas"}),Object(C.jsxs)(Ne,{className:"mb-5",children:[Object(C.jsxs)(Ee,{children:[Object(C.jsx)(T,{text:"Geral",color:"green",size:"lg",active:null===this.state.tabela,onClick:function(){e.carregarDados(null)}}),Object(C.jsx)(T,{text:"Finalizadora",color:"green",size:"lg",active:"formapagamento"===this.state.tabela,onClick:function(){e.carregarDados("formapagamento")}}),Object(C.jsx)(T,{text:"Categoria",color:"green",size:"lg",active:"categoria"===this.state.tabela,onClick:function(){e.carregarDados("categoria")}}),Object(C.jsx)(T,{text:"Produto",color:"green",size:"lg",active:"produto"===this.state.tabela,onClick:function(){e.carregarDados("produto")}})]}),Object(C.jsx)(ye,{model:"2",children:"Venda di\xe1ria nos \xfaltimos 30 dias"}),r,Object(C.jsx)(ye,{model:"2",children:"Venda semanal nos \xfaltimos 6 meses"}),n,Object(C.jsx)(ye,{model:"2",children:"Venda mensal nos \xfaltimos 2 anos"}),i,Object(C.jsx)(ye,{model:"2",children:"Venda anual nos \xfaltimos 10 anos"}),s]})]})}}]),a}(d.a.Component)),De=a(184),Ae=a.n(De),Te=a(76),Re=a.n(Te),Ie=a(47),Me=a.n(Ie),qe="\x1b",Le=function(){function e(t){Object(i.a)(this,e),this.font=t,this.content=[]}return Object(s.a)(e,[{key:"barcode",value:function(e,t,a){t=void 0===t?50:t,a=void 0===a?1:a;var o=null;switch(e.length){case 7:case 8:o=68;break;case 12:case 13:o=67;break;default:o=70}this.content.push("\x1dh"+String.fromCharCode(t)),this.content.push("\x1dw"+String.fromCharCode(a)),this.content.push("\x1ba"+String.fromCharCode(1)),this.content.push("\x1dk"+String.fromCharCode(o)+String.fromCharCode(e.length)+e),this.content.push("\x1ba"+String.fromCharCode(0))}},{key:"bold",value:function(e){this.content.push("\x1bG"+String.fromCharCode(e?1:0))}},{key:"cut",value:function(){this.content.push("\x1dV"+String.fromCharCode(1))}},{key:"drawer",value:function(){this.content.push("\x1bp"+String.fromCharCode(0)+String.fromCharCode(13)+String.fromCharCode(10))}},{key:"feed",value:function(e){this.content.push("\x1bd"+String.fromCharCode(e))}},{key:"getContent",value:function(){return this.content.join("")}},{key:"reset",value:function(){this.content=[],this.content.push(qe+String.fromCharCode(0)),this.content.push("\x1b "+String.fromCharCode(0)),this.content.push("\x1bM"+String.fromCharCode(this.font)),this.content.push("\x1d!"+String.fromCharCode(0)),this.content.push("\x1bt"+String.fromCharCode(3)),this.content.push("\x1bR"+String.fromCharCode(12)),this.content.push("\x1dB"+String.fromCharCode(0)),this.content.push("\x1bG"+String.fromCharCode(0)),this.content.push("\x1ba"+String.fromCharCode(0))}},{key:"qrcode",value:function(e){var t=e.length+3,a=t%256,o=t/256;this.content.push("\x1ba"+String.fromCharCode(1)),this.content.push("\x1d(k"+String.fromCharCode(4)+String.fromCharCode(0)+String.fromCharCode(49)+String.fromCharCode(65)+String.fromCharCode(50)+String.fromCharCode(0)),this.content.push("\x1d(k"+String.fromCharCode(3)+String.fromCharCode(0)+String.fromCharCode(49)+String.fromCharCode(67)+String.fromCharCode(3)),this.content.push("\x1d(k"+String.fromCharCode(3)+String.fromCharCode(0)+String.fromCharCode(49)+String.fromCharCode(69)+String.fromCharCode(51)),this.content.push("\x1d(k"+String.fromCharCode(a)+String.fromCharCode(o)+String.fromCharCode(49)+String.fromCharCode(80)+String.fromCharCode(48)+e),this.content.push("\x1d(k"+String.fromCharCode(3)+String.fromCharCode(0)+String.fromCharCode(49)+String.fromCharCode(81)+String.fromCharCode(48)),this.content.push("\x1ba"+String.fromCharCode(0))}},{key:"text",value:function(e,t){e=(e=e.removeSpecial()).replaceAll("|",String.fromCharCode(179)),t&&this.bold(!0),this.content.push(e+"\n"),t&&this.bold(!1)}}]),e}(),Fe=function(){function e(t){Object(i.a)(this,e),this.Pool=t,this.os=Ae.a,this.childProcess=Me.a,this.escpos=null,this.colunas=null,this.nome=null,this.modelo=null,this.documento=null,this.documentoprodutos=null,this.documentopagamentos=null,this.parametroImpressoraGuilhotina=null,this.parametroImpressoraModeloImpressao=null}return Object(s.a)(e,[{key:"alimentar",value:function(){var e=Object(n.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0===t?1:t,e.next=3,this.carregarEscPos();case 3:e.sent.feed(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"barcode",value:function(){var e=Object(n.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarEscPos();case 2:e.sent.barcode(t);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"carregarEscPos",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===this.escpos&&(t=this.colunas>48?"1":"0",this.escpos=new Le(t)),e.abrupt("return",this.escpos);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"carregarDadosDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Pool.connect();case 2:return i=e.sent,e.prev=3,e.next=6,i.query("SELECT * FROM documento WHERE iddocumento = $1",[t]);case 6:if(0!==(s=e.sent).rows.length){e.next=9;break}throw new Error("Nenhum documento foi encontrado.");case 9:return a=s.rows[0],c=["SELECT documentoproduto.*, unidade.precisao, unidade.sigla","FROM documentoproduto","LEFT JOIN produto USING (idproduto)","LEFT JOIN unidade USING (idunidade)","WHERE documentoproduto.iddocumento = $1","ORDER BY documentoproduto.sequencial"].join(" "),e.next=13,i.query(c,[t]);case 13:return s=e.sent,o=s.rows,u=["SELECT documentopagamento.*, formapagamento.descricao AS formapagamento","FROM documentopagamento","LEFT JOIN formapagamento USING (idformapagamento)","WHERE documentopagamento.iddocumento = $1"].join(" "),e.next=18,i.query(u,[t]);case 18:s=e.sent,n=s.rows,e.next=25;break;case 22:throw e.prev=22,e.t0=e.catch(3),e.t0;case 25:return e.prev=25,i.release(),e.finish(25);case 28:this.documento=a,this.documentoprodutos=o,this.documentopagamentos=n;case 31:case"end":return e.stop()}}),e,this,[[3,22,25,28]])})));return function(t){return e.apply(this,arguments)}}()},{key:"conteudo",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarEscPos();case 2:return t=e.sent,e.abrupt("return",t.getContent());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"gaveta",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarEscPos();case 2:e.sent.drawer();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"guilhotina",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.parametroImpressoraGuilhotina){e.next=4;break}return e.next=3,Object($.l)(this.Pool,"IMPRESSORA","GUILHOTINA");case 3:this.parametroImpressoraGuilhotina=e.sent;case 4:if("S"!==this.parametroImpressoraGuilhotina){e.next=9;break}return e.next=7,this.carregarEscPos();case 7:e.sent.cut();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"imprimir",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a,o){var n,i,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t&&null!==t){e.next=4;break}return e.next=3,this.conteudo();case 3:t=e.sent;case 4:if(void 0!==o){e.next=12;break}if(null!==this.modelo){e.next=11;break}return e.next=8,Object($.l)(this.Pool,"IMPRESSORA","MODELO");case 8:o=e.sent,e.next=12;break;case 11:o=this.modelo;case 12:if("nenhum"!==o){e.next=14;break}return e.abrupt("return",!0);case 14:return n=Object($.m)("printer.txt",t),a=void 0===a?this.nome:a,i=this.childProcess.execSync||window.require("child_process").execSync,s=(s='copy "'+n+'" '+a.toUpperCase()).replaceAll("/","\\"),i(s),e.abrupt("return",!0);case 17:case"end":return e.stop()}}),e,this)})));return function(t,a,o){return e.apply(this,arguments)}}()},{key:"imprimirCabecalho",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,u,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object($.l)(this.Pool,"EMITENTE","NOMEFANTASIA");case 2:return t=e.sent,e.next=5,this.texto(t,"center",!0);case 5:return e.next=7,Object($.l)(this.Pool,"EMITENTE","RAZAOSOCIAL");case 7:if((a=e.sent)===t){e.next=11;break}return e.next=11,this.texto(a,"center",!0);case 11:return e.next=13,Object($.l)(this.Pool,"EMITENTE","ENDERECO");case 13:return o=e.sent,e.next=16,Object($.l)(this.Pool,"EMITENTE","NUMERO");case 16:return n=e.sent,e.next=19,this.texto(o+", "+n,"center");case 19:return e.next=21,Object($.l)(this.Pool,"EMITENTE","BAIRRO");case 21:return i=e.sent,e.next=24,Object($.l)(this.Pool,"EMITENTE","MUNICIPIO");case 24:return s=e.sent,e.next=27,Object($.l)(this.Pool,"EMITENTE","UF");case 27:return c=e.sent,e.next=30,this.texto(i+" - "+s+" - "+c,"center");case 30:return e.next=32,Object($.l)(this.Pool,"EMITENTE","CNPJ");case 32:return u=e.sent,e.next=35,Object($.l)(this.Pool,"EMITENTE","IE");case 35:return l=e.sent,e.next=38,this.texto("CNPJ "+u+" IE "+l,"center");case 38:return e.next=40,this.linha();case 40:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"imprimirDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a,o){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.reiniciar();case 2:return e.next=4,this.carregarDadosDocumento(t);case 4:n=!1,e.t0=this.documento.status,e.next="A"===e.t0?8:"C"===e.t0?12:16;break;case 8:return e.next=10,this.imprimirDocumentoAtivo();case 10:return n=e.sent,e.abrupt("break",17);case 12:return e.next=14,this.imprimirDocumentoCancelado();case 14:return n=e.sent,e.abrupt("break",17);case 16:return e.abrupt("break",17);case 17:n&&"function"===typeof a?a():n||"function"!==typeof o||o();case 18:case"end":return e.stop()}}),e,this)})));return function(t,a,o){return e.apply(this,arguments)}}()},{key:"imprimirDocumentoAtivo",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,i,s,c,u,l,d,p,h,m,b,f,v,j,O,x,g,C=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0===t?1:t,a=null,o=null,"CU"===this.documento.operacao&&this.documento.xml&&(i=Re.a.xml2json(this.documento.xml,{compact:!0}),i=JSON.parse(i),a=i.CFe.infCFe.infAdic.infCpl._text,i.CFe.infCFe.ide.assinaturaQRCODE&&(o=i.CFe.infCFe.ide.assinaturaQRCODE._text)),e.next=6,this.imprimirCabecalho();case 6:s=null,c=this.documento.dthrcriacao,u=c.toLocaleString().split(" ")[0],l=String(c.getHours()).lpad(2,"0")+":"+String(c.getMinutes()).lpad(2,"0")+":"+String(c.getSeconds()).lpad(2,"0"),e.t0=this.documento.operacao,e.next="CU"===e.t0?13:"NC"===e.t0?19:"OR"===e.t0?25:"RE"===e.t0?31:37;break;case 13:return s=String(this.documento.numero?this.documento.numero:this.documento.iddocumento).lpad(6,"0"),e.next=16,this.texto("CUPOM FISCAL ELETR\xd4NICO - SAT","center",!0);case 16:return e.next=18,this.texto("COO: "+s+"  Data: "+u+"  Hora: "+l,"center");case 18:return e.abrupt("break",38);case 19:return s=String(this.documento.numero?this.documento.numero:"").lpad(6,"0"),e.next=22,this.texto("NOTA FISCAL A PARTIR DE CUPOM","center",!0);case 22:return e.next=24,this.texto("N\xfam: "+s+"  Data: "+u+"  Hora: "+l,"center");case 24:return e.abrupt("break",38);case 25:return s=String(this.documento.iddocumento?this.documento.iddocumento:"").lpad(6,"0"),e.next=28,this.texto("OR\xc7AMENTO - SEM VALOR FISCAL","center",!0);case 28:return e.next=30,this.texto("N\xfam: "+s+"  Data: "+u+"  Hora: "+l,"center");case 30:return e.abrupt("break",38);case 31:return s=String(this.documento.numero?this.documento.numero:"").lpad(6,"0"),e.next=34,this.texto("NOTA FISCAL DE REMESSA","center",!0);case 34:return e.next=36,this.texto("N\xfam: "+s+"  Data: "+u+"  Hora: "+l,"center");case 36:case 37:return e.abrupt("break",38);case 38:return e.next=40,this.linha();case 40:d=null,e.t1=this.documento.operacao,e.next="CU"===e.t1?44:"OR"===e.t1?48:"NC"===e.t1||"RE"===e.t1?55:79;break;case 44:return d=this.documento.cpfcnpj?this.documento.cpfcnpj:"n\xe3o informado",e.next=47,this.texto("CPF/CNPJ do consumidor: "+d);case 47:return e.abrupt("break",80);case 48:return d=this.documento.cpfcnpj?this.documento.cpfcnpj:"n\xe3o informado",p=this.documento.nomeorcamento?this.documento.nomeorcamento:"n\xe3o informado",e.next=52,this.texto("Nome do cliente: "+p);case 52:return e.next=54,this.texto("CPF/CNPJ do cliente: "+d);case 54:return e.abrupt("break",80);case 55:return h=["SELECT parceiro.nome, parceiro.tipopessoa, parceiro.cpfcnpj,","  parceiro.inscricaoestadual, cidade.nome AS cidade, estado.sigla AS estado,","  parceiro.cep, parceiro.bairro, parceiro.endereco, parceiro.numero,","  parceiro.complemento","FROM parceiro","LEFT JOIN cidade USING (idcidade)","LEFT JOIN estado USING (idestado)","WHERE parceiro.idparceiro = $1"].join(" "),e.next=58,this.Pool.query(h,[this.documento.idparceiro]);case 58:return m=e.sent,b=m.rows[0],e.next=62,this.texto("DADOS DO DESTINATARIO","center",!0);case 62:return e.next=64,this.texto("Nome: "+b.nome);case 64:return e.next=66,this.texto(("F"===b.tipopessoa?"CPF":"CNPJ")+": "+b.cpfcnpj);case 66:if(!b.inscricaoestadual){e.next=69;break}return e.next=69,this.texto("Inscricao estadual: "+b.inscricaoestadual);case 69:return e.next=71,this.texto("Cidade: "+b.cidade+" - "+b.estado);case 71:return e.next=73,this.texto("CEP: "+b.cep+"   Bairro: "+b.bairro);case 73:return e.next=75,this.texto("Endere\xe7o: "+b.endereco+", "+b.numero);case 75:if(!b.complemento){e.next=78;break}return e.next=78,this.texto("Complemento: "+this.complemento);case 78:case 79:return e.abrupt("break",80);case 80:return e.next=82,this.linha();case 82:if(null!==this.parametroImpressoraModeloImpressao){e.next=86;break}return e.next=85,Object($.l)(this.Pool,"IMPRESSORA","MODELOIMPRESSAO");case 85:this.parametroImpressoraModeloImpressao=e.sent;case 86:e.t2=this.parametroImpressoraModeloImpressao,e.next="1"===e.t2?89:"2"===e.t2?92:95;break;case 89:return e.next=91,this.imprimirListaProdutosModelo01();case 91:return e.abrupt("break",98);case 92:return e.next=94,this.imprimirListaProdutosModelo02();case 94:return e.abrupt("break",98);case 95:return e.next=97,this.imprimirListaProdutosModelo01();case 97:return e.abrupt("break",98);case 98:return f=this.documento.totaldocumento.format(2,",","."),e.next=101,this.texto("TOTAL"+" ".repeat(this.colunas-(5+f.length))+f,"left",!0);case 101:return e.next=103,this.alimentar(1);case 103:return e.next=105,this.documentopagamentos.forEach(function(){var e=Object(n.a)(r.a.mark((function e(t,a){var o,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=0,n=t.formapagamento.removeSpecial(),o=(o=a+1===C.documentopagamentos.length?parseFloat(t.totalpagamento)+parseFloat(C.documento.totaltroco):t.totalpagamento).format(2,",","."),e.next=6,C.texto(n+" ".repeat(C.colunas-n.length-o.length)+o);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}());case 105:if(!(this.documento.totaltroco>0)){e.next=110;break}return v="Troco",j=this.documento.totaltroco.format(2,",","."),e.next=110,this.texto(v+" ".repeat(this.colunas-v.length-j.length)+j);case 110:if(!this.documento.chave){e.next=145;break}return e.next=113,this.linha();case 113:if("CU"!==this.documento.operacao){e.next=129;break}return e.next=116,this.texto("OBSERVA\xc7\xd5ES DO CONTRIBUINTE","center");case 116:return e.next=118,this.texto("ICMS recolhido conforme LC 123/2006 - Simples Nacional.");case 118:return e.next=120,this.texto(a);case 120:return e.next=122,this.linha();case 122:return e.next=124,Object($.l)(this.Pool,"SAT","SERIE");case 124:return O=e.sent,e.next=127,this.texto("SAT No. "+O,"center");case 127:return e.next=129,this.texto(u+" - "+l,"center");case 129:return x=this.documento.chave.substr(-44),e.next=132,this.alimentar(1);case 132:return e.next=134,this.texto(x,"center");case 134:return e.next=136,this.barcode(x.substr(0,22));case 136:return e.next=138,this.alimentar(1);case 138:return e.next=140,this.barcode(x.substr(22));case 140:if(!o){e.next=145;break}return e.next=143,this.alimentar(1);case 143:return e.next=145,this.qrcode(o);case 145:return e.next=147,this.alimentar(3);case 147:return e.next=149,this.guilhotina();case 149:g=0;case 150:if(!(g<t)){e.next=156;break}if(this.imprimir()){e.next=153;break}return e.abrupt("return",!1);case 153:g++,e.next=150;break;case 156:return e.abrupt("return",!0);case 157:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"imprimirDocumentoCancelado",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,u,l,d,p,h,m,b,f,v,j;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object($.l)(this.Pool,"SAT","SERIE");case 2:return a=e.sent,o=null,n=null,i=null,s=null,"CU"===this.documento.operacao&&this.documento.xml&&(o=Re.a.xml2json(this.documento.xml,{compact:!0}),(o=JSON.parse(o)).CFe.infCFe.ide.assinaturaQRCODE&&(n=o.CFe.infCFe.ide.assinaturaQRCODE._text),i=Re.a.xml2json(this.documento.xml,{compact:!0}),(i=JSON.parse(i)).CFe.infCFe.ide.assinaturaQRCODE&&(s=i.CFe.infCFe.ide.assinaturaQRCODE._text)),e.next=10,this.imprimirCabecalho();case 10:c=null,u=this.documento.dthrcriacao,l=u.toLocaleString().split(" ")[0],d=String(u.getHours()).lpad(2,"0")+":"+String(u.getMinutes()).lpad(2,"0")+":"+String(u.getSeconds()).lpad(2,"0"),e.t0=this.documento.operacao,e.next="CU"===e.t0?17:"NC"===e.t0?23:"OR"===e.t0?29:"RE"===e.t0?35:41;break;case 17:return c=String(this.documento.numero?this.documento.numero:this.documento.iddocumento).lpad(6,"0"),e.next=20,this.texto("CUPOM FISCAL ELETR\xd4NICO - SAT","center",!0);case 20:return e.next=22,this.texto("COO: "+c+"  Data: "+l+"  Hora: "+d,"center");case 22:return e.abrupt("break",42);case 23:return c=String(this.documento.numero?this.documento.numero:"").lpad(6,"0"),e.next=26,this.texto("NOTA FISCAL A PARTIR DE CUPOM","center",!0);case 26:return e.next=28,this.texto("N\xfamero: "+c+"  Data: "+l+"  Hora: "+d,"center");case 28:return e.abrupt("break",42);case 29:return c=String(this.documento.iddocumento?this.documento.iddocumento:"").lpad(6,"0"),e.next=32,this.texto("OR\xc7AMENTO - SEM VALOR FISCAL","center",!0);case 32:return e.next=34,this.texto("N\xfamero: "+c+"  Data: "+l+"  Hora: "+d,"center");case 34:return e.abrupt("break",42);case 35:return c=String(this.documento.numero?this.documento.numero:"").lpad(6,"0"),e.next=38,this.texto("NOTA FISCAL DE REMESSA","center",!0);case 38:return e.next=40,this.texto("N\xfamero: "+c+"  Data: "+l+"  Hora: "+d,"center");case 40:case 41:return e.abrupt("break",42);case 42:return e.next=44,this.texto("CANCELAMENTO","center",!0);case 44:return e.next=46,this.linha();case 46:e.t1=this.documento.operacao,e.next="CU"===e.t1?49:"OR"===e.t1?54:60;break;case 49:return e.next=51,this.texto("Dados do cupom fiscal eletronico cancelado","center",!0);case 51:return e.next=53,this.texto("SAT No. "+a,"center");case 53:return e.abrupt("break",66);case 54:return p=this.documento.iddocumento.lpad(6,"0"),e.next=57,this.texto("Dados do or\xe7amento cancelado","center",!0);case 57:return e.next=59,this.texto("Or\xe7amento No. "+p,"center");case 59:return e.abrupt("break",66);case 60:return h=this.documento.numero.lpad(6,"0"),e.next=63,this.texto("Dados do nota fiscal eletronica cancelada","center",!0);case 63:return e.next=65,this.texto("Nota Fiscal No. "+h,"center");case 65:return e.abrupt("break",66);case 66:return e.next=68,this.texto("TOTAL R$ "+this.documento.totaldocumento.format(2,",","."),"center");case 68:return e.next=70,this.texto(l+" "+d,"center");case 70:if(!this.documento.chave){e.next=87;break}return e.next=73,this.alimentar(1);case 73:return m=this.documento.chave.substr(-44),e.next=76,this.texto(m,"center");case 76:return e.next=78,this.barcode(m.substr(0,22));case 78:return e.next=80,this.alimentar(1);case 80:return e.next=82,this.barcode(m.substr(22));case 82:if(!n){e.next=87;break}return e.next=85,this.alimentar(1);case 85:return e.next=87,this.qrcode(n);case 87:return e.next=89,this.linha();case 89:if("CU"!==this.documento.operacao){e.next=116;break}return b=this.documento.dthrcancelamento,f=b.toLocaleString().split(" ")[0],v=String(b.getHours()).lpad(2,"0")+":"+String(b.getMinutes()).lpad(2,"0")+":"+String(b.getSeconds()).lpad(2,"0"),e.next=95,this.texto("Dados do cupom fiscal eletronico de cancelamento","center",!0);case 95:return e.next=97,this.texto("SAT No. "+a,"center");case 97:return e.next=99,this.texto(f+" "+v,"center");case 99:if(!this.documento.chavecanc){e.next=116;break}return e.next=102,this.alimentar(1);case 102:return j=this.documento.chavecanc.substr(-44),e.next=105,this.texto(j,"center");case 105:return e.next=107,this.barcode(j.substr(0,22));case 107:return e.next=109,this.alimentar(1);case 109:return e.next=111,this.barcode(j.substr(22));case 111:if(!s){e.next=116;break}return e.next=114,this.alimentar(1);case 114:return e.next=116,this.qrcode(s);case 116:return e.next=118,this.alimentar(6);case 118:return e.next=120,this.guilhotina();case 120:if(this.imprimir()){e.next=122;break}return e.abrupt("return",!1);case 122:return e.abrupt("return",!0);case 123:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"imprimirListaProdutosModelo01",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.texto("#   Descri\xe7\xe3o"+" ".repeat(this.colunas-40)+"   Qtde X Pre\xe7o       Total");case 2:return e.next=4,this.linha();case 4:return e.next=6,this.documentoprodutos.forEach(function(){var e=Object(n.a)(r.a.mark((function e(a){var o,n,i,s,c,u,l,d,p,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=String(a.sequencial).lpad(3,"0"),n=(a.quantidade*a.preco).format(2,",","."),i=a.quantidade.format(a.precisao,",",".")+" "+a.sigla,s=i.lpad(10," ")+" X "+a.preco.format(2,",",".").rpad(8," ")+" "+n.lpad(8," "),c=t.colunas-(o.length+s.length+2),u=a.descricao.removeSpecial().substr(0,c).rpad(c," "),e.next=8,t.texto(o+" "+u+" "+s);case 8:if(!(a.totaldesconto>0)){e.next=13;break}return l="-"+a.totaldesconto.format(2,",","."),d="    Desconto"+" ".repeat(t.colunas-(12+l.length))+l,e.next=13,t.texto(d);case 13:if(!(a.totalacrescimo>0)){e.next=18;break}return p="+"+a.totalacrescimo.format(2,",","."),h="    Acrescimo"+" ".repeat(t.colunas-(13+p.length))+p,e.next=18,t.texto(h);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"imprimirListaProdutosModelo02",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,u,l,d,p,h,m,b;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.texto("Descri\xe7\xe3o do produto");case 2:return e.next=4,this.texto("Quantidade X Pre\xe7o"+" ".repeat(this.colunas-23)+"Total");case 4:return e.next=6,this.linha();case 6:t=0;case 7:if(!(t<this.documentoprodutos.length)){e.next=34;break}return a=this.documentoprodutos[t],o=a.descricao.removeSpecial(),n=String(a.sequencial).lpad(3,"0"),i=a.quantidade.format(a.precisao,",",".")+" "+a.sigla,s=a.preco.format(2,",","."),c=(a.quantidade*a.preco).format(2,",","."),u=n+" "+o,e.next=17,this.texto(u);case 17:return d=(l="    "+i+" X "+s)+" ".repeat(this.colunas-l.length-c.length)+c,e.next=21,this.texto(d);case 21:if(!(a.totaldesconto>0)){e.next=26;break}return p="-"+a.totaldesconto.format(2,",","."),h="    Desconto"+" ".repeat(this.colunas-(12+p.length))+p,e.next=26,this.texto(h);case 26:if(!(a.totalacrescimo>0)){e.next=31;break}return m="+"+a.totalacrescimo.format(2,",","."),b="    Acrescimo"+" ".repeat(this.colunas-(13+m.length))+m,e.next=31,this.texto(b);case 31:t++,e.next=7;break;case 34:return e.next=36,this.linha();case 36:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"linha",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.texto("-".repeat(this.colunas));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"qrcode",value:function(){var e=Object(n.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarEscPos();case 2:e.sent.qrcode(t);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reiniciar",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.colunas){e.next=6;break}return e.t0=parseInt,e.next=4,Object($.l)(this.Pool,"IMPRESSORA","COLUNAS");case 4:e.t1=e.sent,this.colunas=(0,e.t0)(e.t1,10);case 6:if(null!==this.nome){e.next=10;break}return e.next=9,Object($.l)(this.Pool,"IMPRESSORA","NOME");case 9:this.nome=e.sent;case 10:if(null!==this.modelo){e.next=14;break}return e.next=13,Object($.l)(this.Pool,"IMPRESSORA","MODELO");case 13:this.modelo=e.sent;case 14:return e.next=16,this.carregarEscPos();case 16:e.sent.reset();case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"texto",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a,o){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=void 0===a?"left":a,o=void 0!==o&&o,null===t&&(t=""),e.next=5,this.carregarEscPos();case 5:n=e.sent,e.t0=a,e.next="center"===e.t0?9:"left"===e.t0?11:"right"===e.t0?13:15;break;case 9:return t=t.cpad(this.colunas," "),e.abrupt("break",16);case 11:return t=t.rpad(this.colunas," "),e.abrupt("break",16);case 13:return t=t.lpad(this.colunas," "),e.abrupt("break",16);case 15:return e.abrupt("break",16);case 16:t=t.substr(0,this.colunas),n.text(t,o);case 18:case"end":return e.stop()}}),e,this)})));return function(t,a,o){return e.apply(this,arguments)}}()}]),e}(),ze=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;Object(i.a)(this,a),(o=t.call(this,e)).state={tipo:null,dtinicial:null,dtfinal:null,ativarFechamentoRelatorio:!1,ativarFechamentoResumo:!1},o.gerar=o.gerar.bind(Object(x.a)(o)),o.imprimir=o.imprimir.bind(Object(x.a)(o)),o.Pool=new G,o.Printer=new Fe(o.Pool);var r=["CU"];for(var n in r)r[n]="'"+r[n]+"'";return o.operacaoQuery="("+r.join(", ")+")",o}return Object(s.a)(a,[{key:"gerar",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v()("#tipo").val()){e.next=3;break}return window.MessageBox.show({text:"Por favor, informe o tipo de fechamento antes de prosseguir."}),e.abrupt("return",!1);case 3:if(v()("#dtinicial").val()){e.next=6;break}return window.MessageBox.show({text:"Por favor, informe a data inicial do fechamento antes de prosseguir."}),e.abrupt("return",!1);case 6:if(v()("#dtfinal").val()){e.next=9;break}return window.MessageBox.show({text:"Por favor, informe a data final do fechamento antes de prosseguir."}),e.abrupt("return",!1);case 9:return e.next=11,this.prepararImpressao();case 11:this.setState({tipo:v()("#tipo").val(),dtinicial:v()("#dtinicial").val(),dtfinal:v()("#dtfinal").val(),ativarFechamentoRelatorio:!1,ativarFechamentoResumo:!1},(function(){t.setState({ativarFechamentoRelatorio:!0},(function(){t.setState({ativarFechamentoResumo:!0})}))}));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"imprimir",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Printer.alimentar(3);case 2:return e.next=4,this.Printer.guilhotina();case 4:return e.next=6,this.Printer.imprimir();case 6:window.FastMessage.show("Fechamento impresso com sucesso!");case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"prepararImpressao",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Printer.reiniciar();case 2:return t=v()("#dtinicial").val().split("-").reverse().join("/"),a=v()("#dtfinal").val().split("-").reverse().join("/"),e.t0=this.Printer,e.next=7,Object($.l)(this.Pool,"EMITENTE","NOMEFANTASIA");case 7:return e.t1=e.sent,e.next=10,e.t0.texto.call(e.t0,e.t1,"center",!0);case 10:return e.next=12,this.Printer.texto("FECHAMENTO: "+t+" a "+a,"center",!0);case 12:return e.next=14,this.Printer.alimentar();case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=!this.state.tipo;return Object(C.jsxs)(Y,{className:"Fechamento",children:[Object(C.jsx)(pe,{children:"Fechamento"}),Object(C.jsx)(q,{children:Object(C.jsxs)(R,{size:"6",offset:"3",children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(ue,{type:"select",id:"tipo",label:"Fechamento por",className:"col-12",options:{data:"Data",categoria:"Categoria",formapagamento:"Forma de pagamento",produto:"Produto"},defaultValue:"data"}),Object(C.jsx)(ue,{type:"date",id:"dtinicial",label:"Data inicial",className:"col-6",defaultValue:Object($.b)()}),Object(C.jsx)(ue,{type:"date",id:"dtfinal",label:"Data final",className:"col-6",defaultValue:Object($.b)()})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",className:"pr-0",children:Object(C.jsx)(T,{text:"Gerar",block:!0,color:"green",icon:"file-play",onClick:this.gerar})}),Object(C.jsx)(R,{size:"6",className:"pl-0",children:Object(C.jsx)(T,{text:"Imprimir",block:!0,color:"blue",icon:"printer",onClick:this.imprimir,disabled:e})})]})]})}),Object(C.jsx)(Ue,{Pool:this.Pool,Printer:this.Printer,tipo:this.state.tipo,dtinicial:this.state.dtinicial,dtfinal:this.state.dtfinal,operacaoQuery:this.operacaoQuery,ativar:this.state.ativarFechamentoRelatorio}),Object(C.jsx)(Ve,{Pool:this.Pool,Printer:this.Printer,dtinicial:this.state.dtinicial,dtfinal:this.state.dtfinal,operacaoQuery:this.operacaoQuery,ativar:this.state.ativarFechamentoResumo})]})}}]),a}(d.a.Component),Ue=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={dados:[]},o.tipoDescritivo=o.tipoDescritivo.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"carregarDados",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,u,l,d,p,h,m,b;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=void 0===t?this.props:t).ativar){e.next=3;break}return e.abrupt("return");case 3:a=null,e.t0=t.tipo,e.next="categoria"===e.t0?7:"data"===e.t0?9:"formapagamento"===e.t0?11:"produto"===e.t0?13:15;break;case 7:return a=["SELECT categoria.descricao,","  SUM(documentoproduto.quantidade) AS quantidade,","  SUM(documentoproduto.totalproduto) AS total","FROM documentoproduto","INNER JOIN documento USING (iddocumento)","INNER JOIN produto USING (idproduto)","INNER JOIN categoria USING (idcategoria)","WHERE documento.dthrcriacao::DATE BETWEEN $1 AND $2","  AND documento.status = 'A'","  AND documento.operacao IN "+t.operacaoQuery,"GROUP BY 1","ORDER BY 3 DESC"].join(" "),e.abrupt("break",16);case 9:return a=["SELECT TO_CHAR(documento.dthrcriacao, 'DD/MM/YYYY') AS descricao,","  SUM(documentoproduto.quantidade) AS quantidade,","  SUM(documentoproduto.totalproduto) AS total,","  documento.dthrcriacao::DATE AS dtcriacao","FROM documentoproduto","INNER JOIN documento USING (iddocumento)","WHERE documento.dthrcriacao::DATE BETWEEN $1 AND $2","  AND documento.status = 'A'","  AND documento.operacao IN "+t.operacaoQuery,"GROUP BY 1, 4","ORDER BY 4"].join(" "),e.abrupt("break",16);case 11:return a=["SELECT formapagamento.descricao,","  COUNT(documentopagamento.iddocumentopagamento) AS quantidade,","  SUM(documentopagamento.totalpagamento) AS total","FROM documentopagamento","INNER JOIN documento USING (iddocumento)","INNER JOIN formapagamento USING (idformapagamento)","WHERE documento.dthrcriacao::DATE BETWEEN $1 AND $2","  AND documento.status = 'A'","  AND documento.operacao IN "+t.operacaoQuery,"GROUP BY 1","ORDER BY 3 DESC"].join(" "),e.abrupt("break",16);case 13:return a=["SELECT produto.descricao,","  SUM(documentoproduto.quantidade) AS quantidade,","  SUM(documentoproduto.totalproduto) AS total","FROM documentoproduto","INNER JOIN documento USING (iddocumento)","INNER JOIN produto USING (idproduto)","WHERE documento.dthrcriacao::DATE BETWEEN $1 AND $2","  AND documento.status = 'A'","  AND documento.operacao IN "+t.operacaoQuery,"GROUP BY 1","ORDER BY 3 DESC"].join(" "),e.abrupt("break",16);case 15:return e.abrupt("break",16);case 16:return e.next=18,t.Pool.query(a,[t.dtinicial,t.dtfinal]);case 18:return o=e.sent,n=this.props.Printer.colunas,c=n-(i=6)-(s=10),u=this.tipoDescritivo().substr(0,c).rpad(c," "),u+="Qtde".substr(0,i).cpad(i," "),u+="Total".substr(0,s).lpad(s," "),e.next=28,this.props.Printer.texto(u,"left",!0);case 28:e.t1=r.a.keys(o.rows);case 29:if((e.t2=e.t1()).done){e.next=42;break}return l=e.t2.value,d=o.rows[l],p=d.descricao.removeSpecial(),h=d.quantidade.format(0,",","."),m=d.total.format(2,",","."),b=p.substr(0,c).rpad(c," "),b+=h.substr(0,i).cpad(i," "),b+=m.substr(0,s).lpad(s," "),e.next=40,this.props.Printer.texto(b);case 40:e.next=29;break;case 42:return e.next=44,this.props.Printer.alimentar(2);case 44:this.setState({dados:o.rows});case 45:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillUpdate",value:function(e){e!==this.props&&this.carregarDados(e)}},{key:"tipoDescritivo",value:function(){switch(this.props.tipo){case"categoria":return"Categoria";case"data":return"Data";case"formapagamento":return"Forma de pagamento";case"produto":return"Produto";default:return this.props.tipo}}},{key:"render",value:function(){if(!this.props.ativar||null===this.props.tipo)return null;var e=0,t=0;return Object(C.jsx)(q,{className:"mt-5",children:Object(C.jsx)(R,{size:"8",offset:"2",children:Object(C.jsxs)("table",{className:"table table-striped",children:[Object(C.jsx)("thead",{children:Object(C.jsxs)("tr",{children:[Object(C.jsx)("th",{children:this.tipoDescritivo()}),Object(C.jsx)("th",{className:"text-center",children:"Quantidade"}),Object(C.jsx)("th",{className:"text-right",children:"Total"})]})}),Object(C.jsx)("tbody",{children:this.state.dados.map((function(a,o){return e+=parseFloat(a.quantidade),t+=parseFloat(a.total),Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:a.descricao}),Object(C.jsx)("td",{className:"text-center",children:a.quantidade.format(0,",",".")}),Object(C.jsx)("td",{className:"text-right",children:"R$ "+a.total.format(2,",",".")})]},o)}))}),Object(C.jsx)("tfoot",{children:Object(C.jsxs)("tr",{children:[Object(C.jsx)("th",{}),Object(C.jsx)("th",{className:"text-center",children:e.format(0,",",".")}),Object(C.jsx)("th",{className:"text-right",children:"R$ "+t.format(2,",",".")})]})})]})})})}}]),a}(d.a.Component),Ve=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={totalbruto:0,totalcancelado:0,qtdecancelado:0,totalativo:0,qtdeativo:0,totalorcamento:0},o.carregarDados=o.carregarDados.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"carregarDados",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=void 0===t?this.props:t).ativar){e.next=3;break}return e.abrupt("return");case 3:return a=["SELECT COALESCE((SELECT SUM(totaldocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND operacao IN ("+t.operacaoQuery+")), 0) AS totalbruto,","  COALESCE((SELECT SUM(totaldocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND status = 'C' AND operacao IN ("+t.operacaoQuery+")), 0) AS totalcancelado,","  COALESCE((SELECT COUNT(iddocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND status = 'C' AND operacao IN ("+t.operacaoQuery+")), 0) AS qtdecancelado,","  COALESCE((SELECT SUM(totaldocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND status = 'A' AND operacao IN ("+t.operacaoQuery+")), 0) AS totalativo,","  COALESCE((SELECT COUNT(iddocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND status = 'A' AND operacao IN ("+t.operacaoQuery+")), 0) AS qtdeativo,","  COALESCE((SELECT SUM(totaldocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND status = 'A' AND operacao IN ('OR')), 0) AS totalorcamento"].join(" "),e.next=6,t.Pool.query(a,[t.dtinicial,t.dtfinal]);case 6:return o=e.sent,n=o.rows[0],i=15,s=this.props.Printer.colunas-i,e.next=12,this.props.Printer.texto("RESUMO","center",!0);case 12:return e.next=14,this.props.Printer.texto("Total bruto das vendas".rpad(s," ")+n.totalbruto.format(2,",",".").lpad(i," "));case 14:return e.next=16,this.props.Printer.texto("Total de vendas canceladas".rpad(s," ")+n.totalcancelado.format(2,",",".").lpad(i," "));case 16:return e.next=18,this.props.Printer.texto("Quantidade de vendas canceladas".rpad(s," ")+n.qtdecancelado.format(0,",",".").lpad(i," "));case 18:return e.next=20,this.props.Printer.texto("Total liquido das vendas".rpad(s," ")+n.totalativo.format(2,",",".").lpad(i," "));case 20:return e.next=22,this.props.Printer.texto("Quantidade de vendas".rpad(s," ")+n.qtdeativo.format(0,",",".").lpad(i," "));case 22:return e.next=24,this.props.Printer.texto("Total liquido das vendas".rpad(s," ")+(n.totalativo/n.qtdeativo).format(2,",",".").lpad(i," "));case 24:return e.next=26,this.props.Printer.texto("Total bruto dos orcamentos".rpad(s," ")+n.totalorcamento.format(2,",",".").lpad(i," "));case 26:return e.next=28,this.props.Printer.alimentar(2);case 28:this.setState({totalbruto:n.totalbruto,totalcancelado:n.totalcancelado,qtdecancelado:n.qtdecancelado,totalativo:n.totalativo,qtdeativo:n.qtdeativo,totalorcamento:n.totalorcamento});case 29:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillUpdate",value:function(e){e!==this.props&&this.carregarDados(e)}},{key:"render",value:function(){return this.props.ativar&&null!==this.props.dtinicial&&null!==this.props.dtfinal?Object(C.jsxs)("div",{className:"mb-5",children:[Object(C.jsx)(ye,{text:"Resumo"}),Object(C.jsx)(q,{children:Object(C.jsx)(R,{size:"8",offset:"2",children:Object(C.jsx)("table",{className:"table table-striped",children:Object(C.jsxs)("tbody",{children:[Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:"Total bruto das vendas"}),Object(C.jsx)("td",{className:"text-right",children:"R$ "+this.state.totalbruto.format(2,",",".")})]}),Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:"Total de vendas canceladas"}),Object(C.jsx)("td",{className:"text-right",children:"R$ "+this.state.totalcancelado.format(2,",",".")})]}),Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:"Quantidade de vendas canceladas"}),Object(C.jsx)("td",{className:"text-right",children:this.state.qtdecancelado})]}),Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:"Total liquido de vendas"}),Object(C.jsx)("td",{className:"text-right",children:"R$ "+this.state.totalativo.format(2,",",".")})]}),Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:"Quantidade de vendas"}),Object(C.jsx)("td",{className:"text-right",children:this.state.qtdeativo})]}),Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:"Ticket m\xe9dio das vendas"}),Object(C.jsx)("td",{className:"text-right",children:"R$ "+(this.state.totalativo/this.state.qtdeativo).format(2,",",".")})]}),Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:"Total dos or\xe7amentos"}),Object(C.jsx)("td",{className:"text-right",children:"R$ "+this.state.totalorcamento.format(2,",",".")})]})]})})})})]}):null}}]),a}(d.a.Component),Be=a(185),_e=a.n(Be),$e=(window.require("electron"),window.require("@electron/remote")),He=function(){function e(t){Object(i.a)(this,e),this.Pool=t}return Object(s.a)(e,[{key:"corAleatoria",value:function(){var e=["#b71c1c","#d32f2f","#f44336","#e57373","#ffcdd2","#880e4f","#c2185b","#e91e63","#f06292","#f8bbd0","#4a148c","#7b1fa2","#9c27b0","#ba68c8","#e1bee7","#311b92","#512da8","#673ab7","#9575cd","#d1c4e9","#1a237e","#303f9f","#3f51b5","#7986cb","#c5cae9","#0d47a1","#1976d2","#2196f3","#64b5f6","#bbdefb","#01579b","#0288d1","#03a9f4","#4fc3f7","#b3e5fc","#006064","#0097a7","#00bcd4","#4dd0e1","#b2ebf2","#004d40","#00796b","#009688","#4db6ac","#b2dfdb","#194D33","#388e3c","#4caf50","#81c784","#c8e6c9","#33691e","#689f38","#8bc34a","#aed581","#dcedc8","#827717","#afb42b","#cddc39","#dce775","#f0f4c3","#f57f17","#fbc02d","#ffeb3b","#fff176","#fff9c4","#ff6f00","#ffa000","#ffc107","#ffd54f","#ffecb3","#e65100","#f57c00","#ff9800","#ffb74d","#ffe0b2","#bf360c","#e64a19","#ff5722","#ff8a65","#ffccbc","#3e2723","#5d4037","#795548","#a1887f","#d7ccc8","#263238","#455a64","#607d8b","#90a4ae","#cfd8dc","#000000","#525252","#969696","#D9D9D9","#FFFFFF"];return e[Math.floor(Math.random()*e.length)]}},{key:"incluirCategoria",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a){var o,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.corAleatoria(),"INSERT INTO categoria (descricao, idncm, sinctributacao, cor) VALUES ($1, $2, $3, $4) RETURNING idcategoria",e.next=4,t.query("INSERT INTO categoria (descricao, idncm, sinctributacao, cor) VALUES ($1, $2, $3, $4) RETURNING idcategoria",[a.descricao,a.idncm,"S",o]);case 4:return n=e.sent,e.abrupt("return",n.rows[0].idcategoria);case 6:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"incluirProduto",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a){var o,n,i,s,c,u,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(a),a.balanca&&(a.balanca=a.balanca.substr(0,1).toUpperCase()),a.precovariavel&&(a.precovariavel=a.precovariavel.substr(0,1).toUpperCase()),a.preco&&(a.preco=a.preco.toFloat()),a.aliqicms&&(a.aliqicms=a.aliqicms.toFloat()),a.aliqpis&&(a.aliqpis=a.aliqpis.toFloat()),a.aliqcofins&&(a.aliqcofins=a.aliqcofins.toFloat()),a.idunidade="S"===a.balanca?2:1,delete a.balanca,a.preco||(a.preco=0),a.codigoncm&&(a.codigoncm=String(a.codigoncm).removeFormat(),a.codigoncm=a.codigoncm.substr(0,4)+"."+a.codigoncm.substr(4,2)+"."+a.codigoncm.substr(6,2)),a.cest&&(a.cest=a.cest.removeFormat(),a.cest=a.cest.substr(0,2)+"."+a.cest.substr(2,4)+"."+a.cest.substr(6,2)),a.cfop&&(a.cfop=a.cfop.removeFormat(),a.cfop=a.cfop.substr(0,1)+"."+a.cfop.substr(1,3)),console.log([a.csosn,a.cstpis,a.cstcofins,a.csosn||a.cstpis||a.cstcofins]),a.csosn||a.cstpis||a.cstcofins?a.sinctributacao="N":a.sinctributacao="S",!a.codigoncm||a.idncm){e.next=22;break}return e.next=18,t.query("SELECT idncm FROM ncm WHERE codigoncm = $1",[a.codigoncm]);case 18:if(0!==(o=e.sent).rows.length){e.next=21;break}throw new Error("O NCM "+a.codigoncm+" n\xe3o foi encontrado na base de NCMs do SAT-Flex.");case 21:a.idncm=o.rows[0].idncm;case 22:if(!a.categoria||a.idcateogria){e.next=33;break}return e.next=25,t.query("SELECT idcategoria FROM categoria WHERE descricao = $1",[a.categoria]);case 25:if(0!==(n=e.sent).rows.length){e.next=32;break}return e.next=29,this.incluirCategoria(t,{descricao:a.categoria,idncm:a.idncm});case 29:a.idcategoria=e.sent,e.next=33;break;case 32:a.idcategoria=n.rows[0].idcategoria;case 33:for(delete a.codigoncm,delete a.categoria,i=Object.keys(a),s=Object.values(a),c=[],u=1;u<=s.length;u++)c.push("$"+String(u));return l="INSERT INTO produto ("+i.join(", ")+") VALUES ("+c.join(", ")+")",e.next=42,t.query(l,s);case 42:this.importados++;case 43:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"processarPlanilha",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a){var o,n,i,s,c,u,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Pool.connect();case 2:if(o=e.sent,e.prev=3,o.query("BEGIN"),n=_e.a.parse(t),(i=n[0].data).shift(),"object"===typeof i&&0!==i.length&&0!==i[0].length){e.next=10;break}throw new Error("Nenhum produto foi encontrado na planilha.");case 10:s=Object(me.a)(i),e.prev=11,s.s();case 13:if((c=s.n()).done){e.next=22;break}if((u=c.value)[0]){e.next=17;break}return e.abrupt("continue",20);case 17:return l={descricao:u[0],categoria:u[1],codigoean:u[2],balanca:u[3],precovariavel:u[4],preco:u[5],codigoncm:u[6],origem:u[7],csosn:u[8],aliqicms:u[9],cstpis:u[10],aliqpis:u[11],cstcofins:u[12],aliqcofins:u[13],codcontribsocial:u[14],cest:u[15],cfop:u[16]},e.next=20,this.incluirProduto(o,l);case 20:e.next=13;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(11),s.e(e.t0);case 27:return e.prev=27,s.f(),e.finish(27);case 30:return e.next=32,o.query("COMMIT");case 32:a(),e.next=40;break;case 35:return e.prev=35,e.t1=e.catch(3),e.next=39,o.query("ROLLBACK");case 39:a(e.t1);case 40:return e.prev=40,o.release(),e.finish(40);case 43:case"end":return e.stop()}}),e,this,[[3,35,40,43],[11,24,27,30]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"selecionarPlanilha",value:function(){var e=this;$e.dialog.showOpenDialog({title:"Selecone a planilha de produtos",filters:[{name:"MS-Excel",extensions:["xls","xlsx"]}]},(function(t){t&&t.length>0&&(e.importados=0,window.Loading.show(),e.processarPlanilha(t[0],(function(t){if(window.Loading.hide(),t)return Object($.e)(t);window.MessageBox.show({title:"Planilha importada com sucesso!",text:"A planilha de produtos foi importada com sucesso.<br>Total de produtos: "+String(e.importados)})})))}))}}]),e}(),We=window.require("electron"),Ge=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={redirect:null},o.descobrirPortaImpressora=o.descobrirPortaImpressora.bind(Object(x.a)(o)),o.importarPlanilha=o.importarPlanilha.bind(Object(x.a)(o)),o.Pool=new G,o}return Object(s.a)(a,[{key:"consoleDesenvolvedor",value:function(){We.ipcRenderer.sendSync("open-dev-tools")}},{key:"descobrirPortaImpressora",value:function(){var e=this;window.Loading.show(),new Promise(function(){var t=Object(n.a)(r.a.mark((function t(a){var o,n,i,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=new Fe(e.Pool),n=1;case 2:if(!(n<=20)){t.next=16;break}return i="COM"+String(n),s="Porta configurada para impressora: "+i+" ".repeat(90),t.prev=5,t.next=8,o.imprimir(i,s,"escpos");case 8:t.next=13;break;case 10:return t.prev=10,t.t0=t.catch(5),t.abrupt("continue",13);case 13:n++,t.next=2;break;case 16:a();case 17:case"end":return t.stop()}}),t,null,[[5,10]])})));return function(e){return t.apply(this,arguments)}}()).then((function(){window.Loading.hide(),window.FastMessage.show("Texto enviado para as portas COM")}))}},{key:"importarPlanilha",value:function(){new He(this.Pool).selecionarPlanilha()}},{key:"render",value:function(){return Object(C.jsxs)(Y,{children:[Object(C.jsx)(pe,{children:"Ferramentas"}),Object(C.jsx)(q,{children:Object(C.jsx)(R,{size:"8",offset:"2",children:Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",className:"mb-4",children:Object(C.jsx)(T,{text:"Descobrir porta<br>COM da impressora",icon:"printer",size:"xxl",block:!0,onClick:this.descobrirPortaImpressora})}),Object(C.jsx)(R,{size:"6",className:"mb-4",children:Object(C.jsx)(T,{text:"Importar planilha<br>de produtos",icon:"download",size:"xxl",block:!0,onClick:this.importarPlanilha})}),Object(C.jsx)(R,{size:"6",className:"mb-4",children:Object(C.jsx)(T,{text:"Abrir console de<br>desenvolvedor",icon:"embed2",size:"xxl",block:!0,onClick:this.consoleDesenvolvedor})})]})})})]})}}]),a}(d.a.Component),Ye=(a(408),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=["list-group"];return this.props.className&&e.push(this.props.className),Object(C.jsx)("div",{className:e.join(" "),children:this.props.children})}}]),a}(d.a.Component)),Qe=(a(409),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=Object.assign({},this.props),t=["list-group-item"];return e.className&&t.push(e.className),e.active&&t.push("active"),delete e.active,delete e.className,Object(C.jsx)("div",Object(g.a)(Object(g.a)({className:t.join(" ")},e),{},{children:e.children}))}}]),a}(d.a.Component)),Je=(a(410),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={listaGrupo:[],listaParametro:[],grupoAtivo:null,parametroAtivo:null,idparametro:null,valor:null,observacao:null},o.ajustarAltura=o.ajustarAltura.bind(Object(x.a)(o)),o.carregarListaGrupo=o.carregarListaGrupo.bind(Object(x.a)(o)),o.carregarListaParametro=o.carregarListaParametro.bind(Object(x.a)(o)),o.carregarParametro=o.carregarParametro.bind(Object(x.a)(o)),o.gravar=o.gravar.bind(Object(x.a)(o)),o.onChangeValor=o.onChangeValor.bind(Object(x.a)(o)),o.Pool=new G,o}return Object(s.a)(a,[{key:"ajustarAltura",value:function(){v()("#content .list-group").each((function(){var e=window.innerHeight-v()(this).offset().top-30;v()(this).height(e)}))}},{key:"carregarListaGrupo",value:function(){var e=this;this.Pool.query("SELECT DISTINCT grupo FROM parametro WHERE visivel = 'S' ORDER BY grupo",[],(function(t,a){if(t)return Object($.e)(t.message),!1;e.setState({listaGrupo:a.rows})}))}},{key:"carregarListaParametro",value:function(e){var t=this;this.Pool.query("SELECT idparametro, nome FROM parametro WHERE visivel = 'S' AND grupo = $1 ORDER BY ordem, nome",[e],(function(a,o){if(a)return Object($.e)(a.message),!1;t.setState({listaParametro:o.rows,grupoAtivo:e,parametroAtivo:null,idparametro:null,valor:null,observacao:null})}))}},{key:"carregarParametro",value:function(e){var t=this;this.Pool.query("SELECT idparametro, valor, observacao FROM parametro WHERE idparametro = $1",[e],(function(a,o){if(a)return Object($.e)(a.message),!1;var r=o.rows.shift();t.setState({parametroAtivo:e,idparametro:r.idparametro,valor:r.valor,observacao:r.observacao})}))}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.ajustarAltura),this.ajustarAltura(),this.carregarListaGrupo()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.ajustarAltura)}},{key:"gravar",value:function(){this.Pool.query("UPDATE parametro SET valor = $1 WHERE idparametro = $2",[this.state.valor,this.state.idparametro],(function(e){if(e)return Object($.e)(e.message),!1;window.FastMessage.show("Par\xe2metro atualizado com sucesso!")}))}},{key:"onChangeValor",value:function(e){this.setState({valor:e.target.value})}},{key:"render",value:function(){var e=this,t=null;return this.state.observacao&&(t=this.state.observacao.replaceAll("\\n","<br>")),Object(C.jsxs)(Y,{className:"Parametro",children:[Object(C.jsx)(pe,{children:"Par\xe2metros do sistema"}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"3",offset:"1",children:Object(C.jsx)(Ye,{children:this.state.listaGrupo.map((function(t,a){return Object(C.jsx)(Qe,{active:e.state.grupoAtivo===t.grupo,onClick:function(){e.carregarListaParametro(t.grupo)},children:t.grupo},a)}))})}),Object(C.jsx)(R,{size:"3",children:Object(C.jsx)(Ye,{children:this.state.listaParametro.map((function(t,a){return Object(C.jsx)(Qe,{active:e.state.parametroAtivo===t.idparametro,onClick:function(){e.carregarParametro(t.idparametro)},children:t.nome},a)}))})}),Object(C.jsxs)(R,{size:"4",children:[Object(C.jsx)(ie,{type:"textarea",rows:"7",value:this.state.valor,onChange:this.onChangeValor,disabled:!this.state.idparametro}),Object(C.jsx)(T,{text:"Gravar altera\xe7\xf5es",icon:"floppy-disk",color:"green",size:"lg",block:!0,className:"mt-2 mb-2",disabled:!this.state.idparametro,onClick:this.gravar}),Object(C.jsx)("div",{className:"observacao"+(t?"":" d-none"),dangerouslySetInnerHTML:{__html:t}})]})]})]})}}]),a}(d.a.Component)),Ke=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={show:o.props.show,showDiv:null,title:null},o.cancelar=o.cancelar.bind(Object(x.a)(o)),o.changeDiv=o.changeDiv.bind(Object(x.a)(o)),o.changeTitle=o.changeTitle.bind(Object(x.a)(o)),o.excluir=o.excluir.bind(Object(x.a)(o)),o.gravar=o.gravar.bind(Object(x.a)(o)),o.limpar=o.limpar.bind(Object(x.a)(o)),o.onChangeCategoria=o.onChangeCategoria.bind(Object(x.a)(o)),o.onChangeInput=o.onChangeInput.bind(Object(x.a)(o)),o.onChangeSincTributacao=o.onChangeSincTributacao.bind(Object(x.a)(o)),o.sincronizarTributacao=o.sincronizarTributacao.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"cancelar",value:function(){this.setState({show:!1,showDiv:null})}},{key:"carregar",value:function(e,t){var a=this,o=["SELECT produto.descricao, produto.dthrcriacao,","  produto.idcategoria, produto.codigoean, produto.idunidade,","  produto.precovariavel, produto.preco, produto.status,","  produto.sinctributacao, ncm.codigoncm, produto.origem,","  produto.cfop, produto.csosn, produto.aliqicms, ","  produto.cstpis, produto.aliqpis, produto.cstcofins, ","  produto.aliqcofins, produto.codcontribsocial, produto.cest","FROM produto","LEFT JOIN ncm USING (idncm)","WHERE produto.idproduto = $1"].join(" ");this.props.Pool.query(o,[e],(function(e,o){if(e)return Object($.e)(e.message),!1;if(0===o.rows.length)return window.MessageBox.show({title:"Produto n\xe3o encontrado",text:"O produto selecionado n\xe3o p\xf4de ser encontrado."}),!1;var r={},n=o.rows[0];for(var i in n){var s=n[i];switch(i){case"dthrcriacao":s=s.toLocaleString();break;case"preco":case"aliqicms":case"aliqpis":case"aliqcofins":s=s.format(2,",",".")}r["input_"+i]=s}a.setState(r),"function"===typeof t&&t()}))}},{key:"changeDiv",value:function(e){this.setState({showDiv:e})}},{key:"changeTitle",value:function(e){var t=this;e.idproduto?e.Pool.query("SELECT descricao FROM produto WHERE idproduto = $1",[e.idproduto],(function(e,a){if(e)return Object($.e)(e.message),!1;t.setState({title:"Alterando produto: "+a.rows[0].descricao})})):this.setState({title:"Criando novo produto"})}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(!e.show)return!1;this.changeTitle(e);var a=function(){t.setState({show:e.show},(function(){setTimeout((function(){t.changeDiv("principal")}),1e3)}))};e.idproduto?this.carregar(e.idproduto,a):(this.limpar(),a())}},{key:"excluir",value:function(){var e=this;window.MessageBox.show({title:"Exclu\xedr produto",text:"Tem certeza que deseja exclu\xedr o produto <b>"+this.state.input_descricao+"</b>?",buttons:[{text:"Sim",icon:"thumbs-up",color:"green",onClick:function(){window.MessageBox.hide(),e.props.Pool.query("DELETE FROM produto WHERE idproduto = $1",[e.props.idproduto],(function(t,a){if(t)return Object($.e)(t.message),!1;e.setState({show:!1}),window.FastMessage.show("Produto exclu\xeddo com sucesso.")}))}},{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:function(){window.MessageBox.hide()}}]})}},{key:"gravar",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,u,l,d,p,h,m=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=null,a=[],o=[],e.t0=r.a.keys(this.state);case 4:if((e.t1=e.t0()).done){e.next=37;break}if("input_"!==(n=e.t1.value).substr(0,6)){e.next=35;break}if(i=n.replace("input_",""),s=this.state[n],"codigoncm"!==i||!s){e.next=25;break}return e.prev=10,e.next=13,this.props.Pool.query("SELECT idncm FROM ncm WHERE codigoncm = $1",[s]);case 13:if(0!==(c=e.sent).rows.length){e.next=17;break}return window.MessageBox.show({title:"NCM inexistente",text:"O c\xf3digo de NCM "+s+" n\xe3o p\xf4de ser encontrado.<br>Verifique se foi informado corretamente."}),e.abrupt("return",!1);case 17:i="idncm",s=c.rows[0].idncm,e.next=25;break;case 21:return e.prev=21,e.t2=e.catch(10),Object($.e)(e.t2.message),e.abrupt("return",!1);case 25:if(!(["idproduto","dthrcriacao"].indexOf(i)>-1)){e.next=27;break}return e.abrupt("continue",4);case 27:e.t3=i,e.next="preco"===e.t3||"aliqicms"===e.t3||"aliqpis"===e.t3||"aliqcofins"===e.t3?30:32;break;case 30:return s&&(s=s.toFloat()),e.abrupt("break",33);case 32:return e.abrupt("break",33);case 33:a.push(i),o.push(s);case 35:e.next=4;break;case 37:if(this.props.idproduto){for(d in u=1,l=[],a)l.push(a[d]+" = $"+u++);t="UPDATE produto SET "+l.join(", ")+" WHERE idproduto = "+this.props.idproduto}else{for(p=[],h=0;h<a.length;h++)p.push("$"+(h+1));t="INSERT INTO produto ("+a.join(", ")+") VALUES ("+p.join(", ")+")"}this.props.Pool.query(t,o,(function(e,t){if(e)return Object($.e)(e.message),!1;m.setState({show:!1}),window.FastMessage.show("Produto gravado com sucesso.")}));case 39:case"end":return e.stop()}}),e,this,[[10,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"limpar",value:function(){var e={};for(var t in this.state)"input_"===t.substr(0,6)&&(e[t]=null);this.setState(e)}},{key:"onChangeCategoria",value:function(e){var t=this;this.onChangeInput(e,(function(){t.sincronizarTributacao()}))}},{key:"onChangeInput",value:function(e,t){var a=e.target,o=a.id.replace("modalproduto-",""),r=a.value;"checkbox"===a.type&&(r=a.checked?"S":"N"),this.setState(Object(se.a)({},"input_"+o,r),t)}},{key:"onChangeSincTributacao",value:function(e){var t=this;this.onChangeInput(e,(function(){t.sincronizarTributacao()}))}},{key:"sincronizarTributacao",value:function(){var e=this;if("S"!==this.state.input_sinctributacao)return!0;var t=["SELECT ncm.codigoncm, categoria.origem,","  categoria.cfop, categoria.csosn, categoria.aliqicms, ","  categoria.cstpis, categoria.aliqpis, categoria.cstcofins, ","  categoria.aliqcofins, categoria.codcontribsocial, categoria.cest","FROM categoria","LEFT JOIN ncm USING (idncm)","WHERE categoria.idcategoria = $1"].join(" ");this.props.Pool.query(t,[this.state.input_idcategoria],(function(t,a){if(t)return Object($.e)(t.message),!1;if(0===a.rows.length)return window.MessageBox.show({title:"Categoria n\xe3o encontrada",text:"A categoria informada no produto n\xe3o p\xf4de ser encontrada."}),!1;var o={},r=a.rows[0];for(var n in r){var i=r[n];switch(n){case"aliqicms":case"aliqpis":case"aliqcofins":i=i.format(2,",",".")}o["input_"+n]=i}e.setState(o)}))}},{key:"shouldComponentUpdate",value:function(e){return e.show}},{key:"render",value:function(){var e=this;return Object(C.jsxs)(M,{title:this.state.title,size:"lg",show:this.state.show,beforeClose:this.props.beforeClose,afterClose:this.props.afterClose,closeOnOutClick:!1,children:[Object(C.jsxs)("div",{className:"principal"!==this.state.showDiv?"d-none":"",children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(ue,{type:"text",id:"modalproduto-descricao",className:"col-8",label:"Descri\xe7\xe3o",value:this.state.input_descricao,onChange:this.onChangeInput}),Object(C.jsx)(ue,{type:"text",id:"modalproduto-dthrcriacao",className:"col-4",label:"Criado em",readOnly:!0,value:this.state.input_dthrcriacao,onChange:this.onChangeInput,disabled:!0}),Object(C.jsx)(ue,{type:"select",id:"modalproduto-idcategoria",className:"col-5",label:"Categoria",dbtable:"categoria",dbcolumn:"descricao",Pool:this.props.Pool,value:this.state.input_idcategoria,onChange:this.onChangeCategoria}),Object(C.jsx)(ue,{type:"text",id:"modalproduto-codigoean",className:"col-4",label:"C\xf3digo EAN",value:this.state.input_codigoean,onChange:this.onChangeInput}),Object(C.jsx)(ue,{type:"select",id:"modalproduto-idunidade",className:"col-3",label:"Unidade de venda",dbtable:"unidade",dbcolumn:"descricao",Pool:this.props.Pool,value:this.state.input_idunidade,onChange:this.onChangeInput}),Object(C.jsx)(ue,{type:"select",id:"modalproduto-precovariavel",className:"col-3",label:"Pre\xe7o vari\xe1vel",options:{S:"Sim",N:"N\xe3o"},value:this.state.input_precovariavel,onChange:this.onChangeInput}),Object(C.jsx)(ue,{type:"text",id:"modalproduto-preco",className:"col-3",inputClassName:"text-center",label:"Pre\xe7o de venda",InformarValor:{money:!0,decimal:2},value:this.state.input_preco,onChange:this.onChangeInput,disabled:"S"===this.state.input_precovariavel}),Object(C.jsx)(ue,{type:"select",id:"modalproduto-status",className:"col-3",label:"Status",options:{A:"Ativo",I:"Inativo"},value:this.state.input_status,onChange:this.onChangeInput}),Object(C.jsx)(R,{size:"3",labelMargin:!0,children:Object(C.jsx)(T,{text:"Tributa\xe7\xf5es...",icon:"file-text",color:"blue",block:!0,onClick:function(){e.changeDiv("tributacao")}})})]}),Object(C.jsx)(le,{className:"mt-0"}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(T,{text:"Exclu\xedr",icon:"bin",color:"red",onClick:this.excluir,className:this.props.idproduto?"":"d-none"})}),Object(C.jsxs)(R,{size:"6",className:"text-right",children:[Object(C.jsx)(T,{text:"Cancelar",icon:"undo",color:"red",onClick:this.cancelar}),Object(C.jsx)(T,{text:"Gravar produto",icon:"thumbs-up",color:"green",className:"ml-2",onClick:this.gravar})]})]})]}),Object(C.jsx)("div",{className:"tributacao"!==this.state.showDiv?"d-none":"",children:Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"12",children:Object(C.jsx)(ie,{type:"checkbox",id:"modalproduto-sinctributacao",label:"Usar as mesmas tributa\xe7\xf5es da categoria",className:"col-12",value:this.state.input_sinctributacao,onChange:this.onChangeSincTributacao})}),Object(C.jsx)(ue,{type:"text",id:"modalproduto-codigoncm",label:"NCM do produto",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"9999.99.99"},value:this.state.input_codigoncm,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"select",id:"modalproduto-origem",className:"col-6",label:"Origem do produto",options:{0:"0 - Nacional, exceto as indicadas nos c\xf3digos 3, 4, 5 e 8",1:"1 - Estrangeira - Importa\xe7\xe3o direta, exceto a indicada no c\xf3digo 6",2:"2 - Estrangeira - Adquirida no mercado interno, exceto a indicada no c\xf3digo 7",3:"3 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o superior a 40% e inferior ou igual a 70%",4:"4 - Nacional, cuja produ\xe7\xe3o tenha sido feita em conformidade com os processos produtivos b\xe1sicos de que tratam o Decreto-Lei n\xba 288/67, e as Leis n\xbas 8.248/91, 8.387/91, 10.176/01 e 11.484/ 07",5:"5 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o inferior ou igual a 40%",6:"6 - Estrangeira - Importa\xe7\xe3o direta, sem similar nacional, constante em lista da Resolu\xe7\xe3o CAMEX n\xba 79/2012 e g\xe1s natural",7:"7 - Estrangeira - Adquirida no mercado interno, sem similar nacional, constante em lista da Resolu\xe7\xe3o CAMEX n\xba 79/2012 e g\xe1s natural",8:"8 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o superior a 70%"},value:this.state.input_origem,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalproduto-cfop",label:"CFOP",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"9.999"},value:this.state.input_cfop,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"select",id:"modalproduto-csosn",className:"col-3",inputClassName:"text-center",label:"CSOSN",options:{102:"102",300:"300",400:"400",500:"500"},value:this.state.input_csosn,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalproduto-aliqicms",label:"Al\xedquota de ICMS",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqicms,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalproduto-cstpis",label:"CST do PIS",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_cstpis,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalproduto-aliqpis",label:"Al\xedquota de PIS",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqpis,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalproduto-cstcofins",label:"CST do Cofins",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_cstcofins,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalproduto-aliqcofins",label:"Al\xedquota de Cofins",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqcofins,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalproduto-codcontribsocial",label:"Contribui\xe7\xe3o social",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_codcontribsocial,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(ue,{type:"text",id:"modalproduto-cest",label:"CEST",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99.999.99"},value:this.state.input_cest,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(R,{size:"12",className:"text-right",children:Object(C.jsx)(T,{text:"Voltar para o produto...",icon:"file-text",color:"blue",onClick:function(){e.changeDiv("principal")}})})]})})]})}}]),a}(d.a.Component),Xe=(a(411),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={dataGrid:[],pesquisa:"",idproduto:null,showModalProduto:!1,redirectToCategoria:!1},o.beforeCloseModal=o.beforeCloseModal.bind(Object(x.a)(o)),o.loadDataGrid=o.loadDataGrid.bind(Object(x.a)(o)),o.novoProduto=o.novoProduto.bind(Object(x.a)(o)),o.onChangePesquisa=o.onChangePesquisa.bind(Object(x.a)(o)),o.onClickBtnCategoria=o.onClickBtnCategoria.bind(Object(x.a)(o)),o.onKeyUpPesquisa=o.onKeyUpPesquisa.bind(Object(x.a)(o)),o.pesquisaLimpar=o.pesquisaLimpar.bind(Object(x.a)(o)),o.Pool=new G,o}return Object(s.a)(a,[{key:"beforeCloseModal",value:function(){var e=this;this.setState({showModalProduto:!1},(function(){e.loadDataGrid()}))}},{key:"carregarProduto",value:function(e){this.setState({showModalProduto:!0,idproduto:e})}},{key:"componentDidMount",value:function(){this.loadDataGrid()}},{key:"componentWillUnmount",value:function(){this.Pool.end()}},{key:"loadDataGrid",value:function(){var e=this,t=["SELECT produto.idproduto, produto.descricao, categoria.descricao AS categoria,","  produto.preco, produto.codigoean, produto.dthrcriacao","FROM produto","LEFT JOIN categoria USING (idcategoria)","WHERE produto.descricao ILIKE '%'||$1||'%'","  OR produto.codigoean ILIKE '%'||$1||'%'","ORDER BY produto.descricao"].join(" ");this.Pool.query(t,[this.state.pesquisa],(function(t,a){if(t)return Object($.e)(t.message),!1;var o=[],r=function(t){var r=a.rows[t];o.push({data:[{text:r.descricao,align:"left"},{text:r.categoria,align:"left"},{text:r.preco.format(2,",","."),align:"center"},{text:r.codigoean,align:"center"},{text:r.dthrcriacao.toLocaleString(),align:"center"}],onClick:function(){e.carregarProduto(r.idproduto)}})};for(var n in a.rows)r(n);e.setState({dataGrid:o})}))}},{key:"novoProduto",value:function(){this.setState({showModalProduto:!0,idproduto:null})}},{key:"onChangePesquisa",value:function(e){this.setState({pesquisa:e.target.value})}},{key:"onClickBtnCategoria",value:function(){this.setState({redirectToCategoria:!0})}},{key:"onKeyUpPesquisa",value:function(e){13===e.keyCode&&this.loadDataGrid()}},{key:"pesquisaLimpar",value:function(){var e=this;this.setState({pesquisa:""},(function(){e.loadDataGrid()}))}},{key:"render",value:function(){if(this.state.redirectToCategoria)return Object(C.jsx)(b.a,{to:"/categoria"});return Object(C.jsxs)(Y,{children:[Object(C.jsxs)(pe,{model:"2",children:["Cadastro de ",Object(C.jsx)("b",{children:"Produtos"})]}),Object(C.jsxs)(q,{className:"mb-4",children:[Object(C.jsxs)(R,{size:"4",children:[Object(C.jsx)(ie,{type:"search",id:"pesquisa",value:this.state.pesquisa,placeholder:"Pesquise um produto...",onKeyUp:this.onKeyUpPesquisa,onChange:this.onChangePesquisa}),Object(C.jsx)(k,{name:"cross",id:"pesquisa-limpar",onClick:this.pesquisaLimpar,className:this.state.pesquisa.length>0?null:"d-none"})]}),Object(C.jsx)(R,{size:"2",className:"pl-0",children:Object(C.jsx)(T,{text:"Buscar",icon:"search",color:"green",onClick:this.loadDataGrid})}),Object(C.jsxs)(R,{size:"6",className:"text-right",children:[Object(C.jsx)(T,{text:"Categorias",icon:"layers",color:"blue",className:"mr-3",onClick:this.onClickBtnCategoria}),Object(C.jsx)(T,{text:"Novo produto",icon:"plus",color:"green",onClick:this.novoProduto})]})]}),Object(C.jsx)(Q,{header:[{text:"Descri\xe7\xe3o",align:"left"},{text:"Categoria",align:"left"},{text:"Pre\xe7o",align:"center"},{text:"EAN",align:"left"},{text:"Criado em",align:"center"}],data:this.state.dataGrid}),Object(C.jsx)(Ke,{Pool:this.Pool,show:this.state.showModalProduto,idproduto:this.state.idproduto,beforeClose:this.beforeCloseModal})]})}}]),a}(d.a.Component)),Ze=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={redirect:null},o}return Object(s.a)(a,[{key:"render",value:function(){var e=this;return this.state.redirect?Object(C.jsx)(b.a,{to:this.state.redirect}):Object(C.jsxs)(Y,{children:[Object(C.jsx)(pe,{children:"Relat\xf3rios"}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"3",offset:"3",children:Object(C.jsx)(T,{text:"Fechamento",icon:"calendar",size:"xxl",block:!0,onClick:function(){e.setState({redirect:"/fechamento"})}})}),Object(C.jsx)(R,{size:"3",children:Object(C.jsx)(T,{text:"Estat\xedsticas",icon:"chart-dots",size:"xxl",block:!0,onClick:function(){e.setState({redirect:"/estatistica"})}})})]}),Object(C.jsx)(q,{className:"mt-4",children:Object(C.jsx)(R,{size:"3",offset:"3",children:Object(C.jsx)(T,{text:"Or\xe7amentos",icon:"files-empty",size:"xxl",block:!0,onClick:function(){e.setState({redirect:"/relorcamento"})}})})})]})}}]),a}(d.a.Component),et=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={dtinicial:null,dtfinal:null,redirect:null},o.acaoOrcamento=o.acaoOrcamento.bind(Object(x.a)(o)),o.gerar=o.gerar.bind(Object(x.a)(o)),o.imprimir=o.imprimir.bind(Object(x.a)(o)),o.Pool=new G,o.Printer=new Fe(o.Pool),o}return Object(s.a)(a,[{key:"acaoOrcamento",value:function(e){var t=this,a=["N\xfamero: "+String(e.iddocumento).lpad(6,"0"),"Cliente: "+(e.nomeorcamento?e.nomeorcamento:""),"Quantidade: "+e.totalquantidade.format(Object($.d)(e.totalquantidade),",","."),"Total: R$ "+e.totaldocumento.format(2,",",".")].join("<br>");window.MessageBox.show({title:"O que voc\xea deseja fazer com o or\xe7amento?",text:a,size:"lg",buttons:[{text:"Efetivar or\xe7amento",color:"green",icon:"thumbs-up",onClick:function(){window.MessageBox.hide(),t.setState({redirect:"venda/"+e.iddocumento})}},{text:"Excluir",color:"red",icon:"bin",className:"btn-sm",onClick:function(){window.MessageBox.show({title:"Exclus\xe3o de or\xe7amento",text:"Tem certeza que deseja exclu\xedr o or\xe7amento?<br>Essa a\xe7\xe3o n\xe3o poder\xe1 ser desfeita.",buttons:[{text:"Sim",color:"green",icon:"thumbs-up",onClick:function(){var a=Object(n.a)(r.a.mark((function a(){return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return window.MessageBox.hide(),window.Loading.show(),a.prev=2,a.next=5,t.Pool.query("DELETE FROM documento WHERE iddocumento = $1",[e.iddocumento]);case 5:return a.next=7,t.gerar();case 7:a.next=12;break;case 9:a.prev=9,a.t0=a.catch(2),Object($.e)(a.t0);case 12:return a.prev=12,window.Loading.hide(),a.finish(12);case 15:case"end":return a.stop()}}),a,null,[[2,9,12,15]])})));return function(){return a.apply(this,arguments)}}()},{text:"N\xe3o",color:"red",icon:"thumbs-down",onClick:function(){window.MessageBox.hide()}}]})}},{text:"Voltar",color:"blue",icon:"undo",onClick:function(){window.MessageBox.hide()}}]})}},{key:"gerar",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v()("#dtinicial").val()){e.next=3;break}return window.MessageBox.show({text:"Por favor, informe a data inicial do fechamento antes de prosseguir."}),e.abrupt("return",!1);case 3:if(v()("#dtfinal").val()){e.next=6;break}return window.MessageBox.show({text:"Por favor, informe a data final do fechamento antes de prosseguir."}),e.abrupt("return",!1);case 6:return e.next=8,this.prepararImpressao();case 8:this.setState({dtinicial:v()("#dtinicial").val(),dtfinal:v()("#dtfinal").val()});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"imprimir",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.Printer.alimentar(3);case 3:return e.next=5,this.Printer.guilhotina();case 5:return e.next=7,this.Printer.imprimir();case 7:window.FastMessage.show("Relat\xf3rio impresso com sucesso!"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),Object($.e)(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"prepararImpressao",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Printer.reiniciar();case 2:return t=v()("#dtinicial").val().split("-").reverse().join("/"),a=v()("#dtfinal").val().split("-").reverse().join("/"),e.t0=this.Printer,e.next=7,Object($.l)(this.Pool,"EMITENTE","NOMEFANTASIA");case 7:return e.t1=e.sent,e.next=10,e.t0.texto.call(e.t0,e.t1,"center",!0);case 10:return e.next=12,this.Printer.texto("OR\xc7AMENTOS: "+(t===a?t:t+" \xe0 "+a),"center",!0);case 12:return e.next=14,this.Printer.alimentar();case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){if(this.state.redirect)return Object(C.jsx)(b.a,{to:this.state.redirect});var e=!this.state.dtinicial||!this.state.dtfinal;return Object(C.jsxs)(Y,{className:"RelOrcamento",children:[Object(C.jsx)(pe,{children:"Relat\xf3rio de Or\xe7amento"}),Object(C.jsx)(q,{children:Object(C.jsxs)(R,{size:"6",offset:"3",children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(ue,{type:"date",id:"dtinicial",label:"Data inicial",className:"col-6",defaultValue:Object($.b)()}),Object(C.jsx)(ue,{type:"date",id:"dtfinal",label:"Data final",className:"col-6",defaultValue:Object($.b)()})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",className:"pr-0",children:Object(C.jsx)(T,{text:"Gerar",block:!0,color:"green",icon:"file-play",onClick:this.gerar})}),Object(C.jsx)(R,{size:"6",className:"pl-0",children:Object(C.jsx)(T,{text:"Imprimir",block:!0,color:"blue",icon:"printer",onClick:this.imprimir,disabled:e})})]})]})}),Object(C.jsx)(tt,{Pool:this.Pool,Printer:this.Printer,dtinicial:this.state.dtinicial,dtfinal:this.state.dtfinal,acaoOrcamento:this.acaoOrcamento})]})}}]),a}(d.a.Component),tt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={dados:[]},o}return Object(s.a)(a,[{key:"carregarDados",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,u,l,d,p,h,m,b,f,v,j;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0===t?this.props:t,a=["SELECT iddocumento, totalquantidade, totaldocumento, nomeorcamento,","  dthrcriacao::DATE as dtcriacao, dthrcriacao::TIME as hrcriacao","FROM documento","WHERE operacao = $1","  AND dthrcriacao::DATE BETWEEN $2 AND $3","ORDER BY dthrcriacao"].join(" "),e.next=4,t.Pool.query(a,["OR",t.dtinicial,t.dtfinal]);case 4:return o=e.sent,n=this.props.Printer.colunas,u=n-(i=7)-(s=6)-(c=10),l="N\xfamero".substr(0,i).rpad(i," "),l+="Cliente".substr(0,u).cpad(u," "),l+="Qtde".substr(0,s).cpad(s," "),l+="Total".substr(0,c).lpad(c," "),e.next=16,this.props.Printer.texto(l,"left",!0);case 16:d=0,p=0,e.t0=r.a.keys(o.rows);case 19:if((e.t1=e.t0()).done){e.next=36;break}return h=e.t1.value,m=o.rows[h],b=String(m.iddocumento).lpad(6,"0"),f=null===m.nomeorcamento?"":String(m.nomeorcamento),v=m.totalquantidade.format(Object($.d)(m.totalquantidade),",","."),j=m.totaldocumento.format(2,",","."),l=b.substr(0,i).rpad(i," "),l+=f.substr(0,u).rpad(u," "),l+=v.substr(0,s).cpad(s," "),l+=j.substr(0,c).lpad(c," "),e.next=32,this.props.Printer.texto(l);case 32:d+=parseFloat(m.totalquantidade),p+=parseFloat(m.totaldocumento),e.next=19;break;case 36:return d=d.format(Object($.d)(d),",","."),p=p.format(2,",","."),l="Total".substr(0,i+u).rpad(i+u," "),l+=String(d).substr(0,s).cpad(s," "),l+=String(p).substr(0,c).lpad(c," "),e.next=43,this.props.Printer.texto(l,"left",!0);case 43:return e.next=45,this.props.Printer.alimentar(2);case 45:this.setState({dados:o.rows});case 46:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillUpdate",value:function(e){e!==this.props&&this.carregarDados(e)}},{key:"render",value:function(){var e=this;if(!this.props.dtinicial||!this.props.dtfinal)return null;var t=0,a=0;return Object(C.jsx)(q,{className:"mt-5",children:Object(C.jsx)(R,{size:"8",offset:"2",children:Object(C.jsxs)("table",{className:"table table-striped mb-5",children:[Object(C.jsx)("thead",{children:Object(C.jsxs)("tr",{children:[Object(C.jsx)("th",{className:"text-center",children:"N\xfamero"}),Object(C.jsx)("th",{className:"text-left",children:"Cliente"}),Object(C.jsx)("th",{className:"text-center",children:"Quantidade"}),Object(C.jsx)("th",{className:"text-center",children:"Total"})]})}),Object(C.jsx)("tbody",{children:this.state.dados.map((function(o,r){return t+=parseFloat(o.totalquantidade),a+=parseFloat(o.totaldocumento),Object(C.jsxs)("tr",{onClick:function(){e.props.acaoOrcamento(o)},children:[Object(C.jsx)("td",{className:"text-center",children:String(o.iddocumento).lpad(6,"0")}),Object(C.jsx)("td",{className:"text-left",children:o.nomeorcamento}),Object(C.jsx)("td",{className:"text-center",children:o.totalquantidade.format(Object($.d)(o.totalquantidade),",",".")}),Object(C.jsx)("td",{className:"text-right",children:"R$ "+o.totaldocumento.format(2,",",".")})]},r)}))}),Object(C.jsx)("tfoot",{children:Object(C.jsxs)("tr",{children:[Object(C.jsx)("th",{}),Object(C.jsx)("th",{}),Object(C.jsx)("th",{className:"text-center",children:t.format(Object($.d)(t),",",".")}),Object(C.jsx)("th",{className:"text-right",children:"R$ "+a.format(2,",",".")})]})})]})})})}}]),a}(d.a.Component),at=window.require("fs"),ot=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=Object.assign({},this.props);if(e.src)if(at.existsSync(e.src)){var t=e.src.split(".").reverse()[0],a=at.readFileSync(e.src,"base64");e.src="data:image/"+t+";base64,"+a}else e.src=null;return Object(C.jsx)("img",Object(g.a)(Object(g.a)({},e),{},{alt:""}))}}]),a}(d.a.Component),rt=(a(412),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={logotipo:null,informativo:null,telefone:null,email:null,endereco:null},o.carregarDados=o.carregarDados.bind(Object(x.a)(o)),o.Pool=new G,o}return Object(s.a)(a,[{key:"carregarDados",value:function(){var e=this;this.Pool.query("SELECT nome, valor FROM parametro WHERE grupo = $1",["REVENDA"],(function(t,a){if(t)return Object($.e)(t),!1;var o,r={},n=Object(me.a)(a.rows);try{for(n.s();!(o=n.n()).done;){var i=o.value;r[i.nome.toLowerCase()]=i.valor.replaceAll("\n","</br>")}}catch(t){n.e(t)}finally{n.f()}e.setState(r)}))}},{key:"componentDidMount",value:function(){this.carregarDados()}},{key:"render",value:function(){return Object(C.jsxs)(Y,{children:[Object(C.jsx)(pe,{children:"Suporte"}),Object(C.jsx)(q,{children:Object(C.jsx)(R,{size:"5",offset:"1",children:Object(C.jsx)(ot,{className:"logotipo",src:this.state.logotipo})})}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"5",offset:"1",children:Object(C.jsx)("p",{className:"informativo",dangerouslySetInnerHTML:{__html:this.state.informativo}})}),Object(C.jsxs)(R,{className:"contatos",size:"4",offset:"1",children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"1",children:Object(C.jsx)(k,{name:"phone"})}),Object(C.jsx)(R,{size:"11",children:Object(C.jsx)("p",{dangerouslySetInnerHTML:{__html:this.state.telefone}})})]}),Object(C.jsx)(le,{}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"1",children:Object(C.jsx)(k,{name:"mail"})}),Object(C.jsx)(R,{size:"11",children:Object(C.jsx)("p",{dangerouslySetInnerHTML:{__html:this.state.email}})})]}),Object(C.jsx)(le,{}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"1",children:Object(C.jsx)(k,{name:"location"})}),Object(C.jsx)(R,{size:"11",children:Object(C.jsx)("p",{dangerouslySetInnerHTML:{__html:this.state.endereco}})})]})]})]})]})}}]),a}(d.a.Component)),nt=a(74),it=a.n(nt),st=(a(413),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={pesquisa:e.pesquisa,produtos:[],totalproduto:null},o.carregarProdutos=o.carregarProdutos.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"carregarProdutos",value:function(e){var t=this;if("string"===typeof(e=e||this.props.pesquisa)&&0!==e.length){var a=null,o=null,r=[];13===e.length&&"2"===e.substr(0,1)?(a=parseInt(e.substr(1,6),10),o=parseInt(e.substr(7,5),10)/100,e=a,r.push("produto.codigoean = $1")):(r.push("produto.descricao ILIKE '%'||$1||'%'"),r.push("produto.codigoean = $1")),this.totalproduto=o;var n=["SELECT produto.idproduto, produto.descricao, produto.precovariavel,","  produto.preco, categoria.cor, unidade.precisao, unidade.descricao AS unidade","FROM produto","INNER JOIN categoria USING (idcategoria)","INNER JOIN unidade USING (idunidade)","WHERE "+r.join(" OR "),"ORDER BY descricao"].join(" ");this.props.Pool.query(n,[e],(function(e,a){if(e)return Object($.e)(e),!1;t.setState({produtos:a.rows})}))}else this.setState({produtos:[]})}},{key:"componentDidMount",value:function(){this.carregarProdutos()}},{key:"componentWillReceiveProps",value:function(e){this.carregarProdutos(e.pesquisa)}},{key:"render",value:function(){var e=this,t=["painelrapido","painelrapido-pesquisa"];"0"===this.props.layoutVendas&&t.push("painelrapido-poucosprodutos");var a=!isNaN(this.props.pesquisa)&&1===this.state.produtos.length;return Object(C.jsx)("div",{className:t.join(" "),children:Object(C.jsx)(q,{className:"painelrapido-produto",children:this.state.produtos.map((function(t,o){return Object(C.jsx)(ct,Object(g.a)(Object(g.a)({},t),{},{onSelectProduto:e.props.onSelectProduto,layoutVendas:e.props.layoutVendas,selecionarProduto:a,totalproduto:e.totalproduto}),o)}))})})}}]),a}(d.a.Component)),ct=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).onClick=o.onClick.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.props.selecionarProduto&&this.props.onSelectProduto(this.props,null,this.props.totalproduto)}},{key:"onClick",value:function(e){this.props.onSelectProduto&&this.props.onSelectProduto(this.props,e,this.props.totalproduto)}},{key:"render",value:function(){var e="0"===this.props.layoutVendas?3:2;return Object(C.jsx)(R,{size:e,children:Object(C.jsx)("div",{className:"painelrapido-produto-item",style:{borderColor:this.props.cor},onClick:this.onClick,children:Object(C.jsx)("span",{children:this.props.descricao})})})}}]),a}(d.a.Component),ut=(a(414),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={categorias:[],produtos:[],categoria:null},o.carregarCategorias=o.carregarCategorias.bind(Object(x.a)(o)),o.carregarProdutos=o.carregarProdutos.bind(Object(x.a)(o)),o.trocarCategoria=o.trocarCategoria.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"carregarCategorias",value:function(){var e=this;this.props.Pool.query("SELECT idcategoria, descricao, cor FROM categoria ORDER BY descricao",(function(t,a){if(t)return Object($.e)(t),!1;e.setState({categorias:a.rows,categoria:a.rows.length>0?a.rows[0]:null},(function(){e.carregarProdutos()}))}))}},{key:"carregarProdutos",value:function(){var e=this;if(null===this.state.categoria)return!1;var t=["SELECT produto.idproduto, produto.descricao, produto.precovariavel,","  produto.preco, unidade.precisao, unidade.descricao AS unidade","FROM produto","INNER JOIN unidade USING (idunidade)","WHERE produto.status = $1","  AND produto.idcategoria = $2","ORDER BY produto.descricao"].join(" ");this.props.Pool.query(t,["A",this.state.categoria.idcategoria],(function(t,a){if(t)return Object($.e)(t),!1;e.setState({produtos:a.rows})}))}},{key:"componentDidMount",value:function(){this.carregarCategorias()}},{key:"trocarCategoria",value:function(e){var t=this;this.setState({categoria:e},(function(){t.carregarProdutos()}))}},{key:"render",value:function(){var e=this;return Object(C.jsxs)("div",{className:"painelrapido painelrapido-poucosprodutos",children:[Object(C.jsx)(q,{className:"painelrapido-categoria",children:this.state.categorias.map((function(t,a){return Object(C.jsx)(lt,Object(g.a)(Object(g.a)({},t),{},{trocarCategoria:e.trocarCategoria}),a)}))}),Object(C.jsx)(q,{className:"painelrapido-produto",children:this.state.produtos.map((function(t,a){return Object(C.jsx)(dt,Object(g.a)(Object(g.a)({},t),{},{cor:e.state.categoria.cor,onSelectProduto:e.props.onSelectProduto}),a)}))})]})}}]),a}(d.a.Component)),lt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).onClick=o.onClick.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"onClick",value:function(){this.props.trocarCategoria(this.props)}},{key:"render",value:function(){return Object(C.jsx)(R,{size:"3",children:Object(C.jsx)("div",{className:"painelrapido-categoria-item",style:{backgroundColor:this.props.cor},onClick:this.onClick,children:Object(C.jsx)("span",{children:this.props.descricao})})})}}]),a}(d.a.Component),dt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).onClick=o.onClick.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"onClick",value:function(e){this.props.onSelectProduto&&this.props.onSelectProduto(this.props,e)}},{key:"render",value:function(){return Object(C.jsx)(R,{size:"3",children:Object(C.jsx)("div",{className:"painelrapido-produto-item",style:{borderColor:this.props.cor},onClick:this.onClick,children:Object(C.jsx)("span",{children:this.props.descricao})})})}}]),a}(d.a.Component),pt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={categorias:[],produtos:[],categoria:null},o.carregarCategorias=o.carregarCategorias.bind(Object(x.a)(o)),o.carregarProdutos=o.carregarProdutos.bind(Object(x.a)(o)),o.trocarCategoria=o.trocarCategoria.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"carregarCategorias",value:function(){var e=this;this.props.Pool.query("SELECT idcategoria, descricao, cor FROM categoria ORDER BY descricao",(function(t,a){if(t)return Object($.e)(t),!1;e.setState({categorias:a.rows,categoria:a.rows.length>0?a.rows[0]:null},(function(){e.carregarProdutos()}))}))}},{key:"carregarProdutos",value:function(){var e=this;if(null!==this.state.categoria){var t=["SELECT produto.idproduto, produto.descricao, produto.precovariavel,","  produto.preco, unidade.precisao, unidade.descricao AS unidade","FROM produto","INNER JOIN unidade USING (idunidade)","WHERE produto.status = $1","  AND produto.idcategoria = $2","ORDER BY produto.descricao"].join(" ");this.props.Pool.query(t,["A",this.state.categoria.idcategoria],(function(t,a){if(t)return Object($.e)(t),!1;e.setState({produtos:a.rows})}))}}},{key:"componentDidMount",value:function(){this.carregarCategorias()}},{key:"trocarCategoria",value:function(e){var t=this;this.setState({categoria:e},(function(){t.carregarProdutos()}))}},{key:"render",value:function(){var e=this;return Object(C.jsxs)("div",{className:"painelrapido painelrapido-mediosprodutos",children:[Object(C.jsx)(q,{className:"painelrapido-categoria",children:this.state.categorias.map((function(t,a){return Object(C.jsx)(ht,Object(g.a)(Object(g.a)({},t),{},{trocarCategoria:e.trocarCategoria}),a)}))}),Object(C.jsx)(q,{className:"painelrapido-produto",children:this.state.produtos.map((function(t,a){return Object(C.jsx)(mt,Object(g.a)(Object(g.a)({},t),{},{cor:e.state.categoria.cor,onSelectProduto:e.props.onSelectProduto}),a)}))})]})}}]),a}(d.a.Component),ht=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).onClick=o.onClick.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"onClick",value:function(){this.props.trocarCategoria(this.props)}},{key:"render",value:function(){return Object(C.jsx)(R,{size:"2",children:Object(C.jsx)("div",{className:"painelrapido-categoria-item",style:{backgroundColor:this.props.cor},onClick:this.onClick,children:Object(C.jsx)("span",{children:this.props.descricao})})})}}]),a}(d.a.Component),mt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).onClick=o.onClick.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"onClick",value:function(e){this.props.onSelectProduto&&this.props.onSelectProduto(this.props,e)}},{key:"render",value:function(){return Object(C.jsx)(R,{size:"2",children:Object(C.jsx)("div",{className:"painelrapido-produto-item",style:{borderColor:this.props.cor},onClick:this.onClick,children:Object(C.jsx)("span",{children:this.props.descricao})})})}}]),a}(d.a.Component),bt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={categorias:[],produtos:[],categoria:null},o.carregarCategorias=o.carregarCategorias.bind(Object(x.a)(o)),o.carregarProdutos=o.carregarProdutos.bind(Object(x.a)(o)),o.trocarCategoria=o.trocarCategoria.bind(Object(x.a)(o)),o.voltarCategoria=o.voltarCategoria.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"carregarCategorias",value:function(){var e=this;this.props.Pool.query("SELECT idcategoria, descricao, cor FROM categoria ORDER BY descricao",(function(t,a){if(t)return Object($.e)(t),!1;e.setState({categorias:a.rows,categoria:null},(function(){e.carregarProdutos()}))}))}},{key:"carregarProdutos",value:function(){var e=this;if(null!==this.state.categoria){var t=["SELECT produto.idproduto, produto.descricao, produto.precovariavel,","  produto.preco, unidade.precisao, unidade.descricao AS unidade","FROM produto","INNER JOIN unidade USING (idunidade)","WHERE produto.status = $1","  AND produto.idcategoria = $2","ORDER BY produto.descricao"].join(" ");this.props.Pool.query(t,["A",this.state.categoria.idcategoria],(function(t,a){if(t)return Object($.e)(t),!1;e.setState({produtos:a.rows})}))}}},{key:"componentDidMount",value:function(){this.carregarCategorias()}},{key:"trocarCategoria",value:function(e){var t=this;this.setState({categoria:e},(function(){t.carregarProdutos()}))}},{key:"voltarCategoria",value:function(){this.setState({categoria:null,produtos:[]})}},{key:"render",value:function(){var e=this,t=null;null===this.state.categoria&&(t=Object(C.jsx)(q,{className:"painelrapido-categoria",children:this.state.categorias.map((function(t,a){return Object(C.jsx)(ft,{idcategoria:t.idcategoria,descricao:t.descricao,cor:t.cor,trocarCategoria:e.trocarCategoria},a)}))}));var a=null;return null!==this.state.categoria&&(a=Object(C.jsxs)(q,{className:"painelrapido-produto",children:[Object(C.jsx)(R,{size:"2",children:Object(C.jsx)("div",{className:"painelrapido-categoria-item",style:{backgroundColor:this.state.categoria.cor},onClick:this.voltarCategoria,children:Object(C.jsx)(k,{name:"chevron-left"})})}),this.state.produtos.map((function(t,a){return Object(C.jsx)(vt,Object(g.a)(Object(g.a)({},t),{},{cor:e.state.categoria.cor,onSelectProduto:e.props.onSelectProduto}),a)}))]})),Object(C.jsxs)("div",{className:"painelrapido painelrapido-muitosprodutos",children:[t,a]})}}]),a}(d.a.Component),ft=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).onClick=o.onClick.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"onClick",value:function(){this.props.trocarCategoria(this.props)}},{key:"render",value:function(){return Object(C.jsx)(R,{size:"2",children:Object(C.jsx)("div",{className:"painelrapido-categoria-item",style:{backgroundColor:this.props.cor},onClick:this.onClick,children:Object(C.jsx)("span",{children:this.props.descricao})})})}}]),a}(d.a.Component),vt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).onClick=o.onClick.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"onClick",value:function(e){this.props.onSelectProduto&&this.props.onSelectProduto(this.props,e)}},{key:"render",value:function(){return Object(C.jsx)(R,{size:"2",children:Object(C.jsx)("div",{className:"painelrapido-produto-item",style:{borderColor:this.props.cor},onClick:this.onClick,children:Object(C.jsx)("span",{children:this.props.descricao})})})}}]),a}(d.a.Component),jt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={layoutVendas:null},o}return Object(s.a)(a,[{key:"ajustarAltura",value:function(){if(v()(".painelrapido").length>0){var e=window.innerHeight-v()(".painelrapido").offset().top;v()(".painelrapido").height(e)}}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.ajustarAltura),Object($.l)(this.props.Pool,"DIVERSOS","LAYOUTVENDAS",(function(t){e.setState({layoutVendas:t})}),(function(e){Object($.e)(e)})),this.ajustarAltura()}},{key:"componentDidUpdate",value:function(){this.ajustarAltura()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.ajustarAltura)}},{key:"render",value:function(){if(this.props.pesquisa.length>0)return Object(C.jsx)(st,Object(g.a)(Object(g.a)({},this.props),{},{layoutVendas:this.state.layoutVendas}));switch(this.state.layoutVendas){case"0":return Object(C.jsx)(ut,Object(g.a)({},this.props));case"1":return Object(C.jsx)(pt,Object(g.a)({},this.props));case"2":return Object(C.jsx)(bt,Object(g.a)({},this.props));default:return null}}}]),a}(d.a.Component),Ot=(a(415),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={acrescimovalor:0,acrescimopercentual:0,totaldocumento:e.totalbruto,show:e.show},o.cancelar=o.cancelar.bind(Object(x.a)(o)),o.confirmar=o.confirmar.bind(Object(x.a)(o)),o.onChangeAcrescimoPercentual=o.onChangeAcrescimoPercentual.bind(Object(x.a)(o)),o.onChangeAcrescimoValor=o.onChangeAcrescimoValor.bind(Object(x.a)(o)),o.onChangeTotalLiquido=o.onChangeTotalLiquido.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"componentWillReceiveProps",value:function(e){this.setState({acrescimovalor:0,acrescimopercentual:0,totaldocumento:e.totalbruto,show:e.show})}},{key:"confirmar",value:function(){this.props.aplicarAcrescimo(this.props.totalbruto,this.state.acrescimovalor)}},{key:"onChangeAcrescimoPercentual",value:function(e){var t=e.target.value.toFloat(),a=this.props.totalbruto*t/100,o=this.props.totalbruto-this.props.totaldesconto+a;this.setState({acrescimopercentual:t,acrescimovalor:a,totaldocumento:o})}},{key:"onChangeAcrescimoValor",value:function(e){var t=e.target.value.toFloat(),a=t/this.props.totalbruto*100,o=this.props.totalbruto-this.props.totaldesconto+t;this.setState({acrescimopercentual:a,acrescimovalor:t,totaldocumento:o})}},{key:"onChangeTotalLiquido",value:function(e){var t=e.target.value.toFloat();t<this.props.totalbruto&&(t=this.props.totalbruto);var a=t-this.props.totalbruto+this.props.totaldesconto,o=a/this.props.totalbruto*100;this.setState({acrescimopercentual:o,acrescimovalor:a,totaldocumento:t})}},{key:"render",value:function(){return Object(C.jsxs)(M,{id:"VendaAplicarAcrescimo",title:"Aplicando acr\xe9scimo...",show:this.state.show,size:"md",beforeClose:this.props.beforeClose,children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ce,{children:"Total dos itens"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ie,{type:"text",className:"text-center",disabled:!0,value:this.props.totalbruto.format(2,",",".")})})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ce,{children:"Total de desconto"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ie,{type:"text",className:"text-center",disabled:!0,value:this.props.totaldesconto.format(2,",",".")})})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ce,{children:"Acr\xe9scimo em percentual"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ie,{type:"text",className:"text-center",value:this.state.acrescimopercentual.format(0,",","."),InformarValor:{decimal:0},onChange:this.onChangeAcrescimoPercentual})})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ce,{children:"Acr\xe9scimo em valor"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ie,{type:"text",className:"text-center",value:this.state.acrescimovalor.format(2,",","."),InformarValor:{decimal:2,money:!0},onChange:this.onChangeAcrescimoValor})})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ce,{children:"Total final"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ie,{type:"text",className:"text-center",value:this.state.totaldocumento.format(2,",","."),InformarValor:{decimal:2,money:!0},onChange:this.onChangeTotalLiquido})})]}),Object(C.jsxs)("div",{className:"text-right mt-2",children:[Object(C.jsx)(T,{icon:"undo",color:"red",className:"float-left",onClick:this.cancelar}),Object(C.jsx)(T,{text:"Confirmar",icon:"thumbs-up",color:"green",onClick:this.confirmar})]})]})}}]),a}(d.a.Component)),xt=(a(416),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={descontovalor:0,descontopercentual:0,totaldocumento:e.totalbruto,show:e.show},o.cancelar=o.cancelar.bind(Object(x.a)(o)),o.confirmar=o.confirmar.bind(Object(x.a)(o)),o.onChangeDescontoPercentual=o.onChangeDescontoPercentual.bind(Object(x.a)(o)),o.onChangeDescontoValor=o.onChangeDescontoValor.bind(Object(x.a)(o)),o.onChangeTotalLiquido=o.onChangeTotalLiquido.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"componentWillReceiveProps",value:function(e){this.setState({descontovalor:0,descontopercentual:0,totaldocumento:e.totalbruto,show:e.show})}},{key:"confirmar",value:function(){this.props.aplicarDesconto(this.props.totalbruto,this.state.descontovalor)}},{key:"onChangeDescontoPercentual",value:function(e){var t=e.target.value.toFloat(),a=this.props.totalbruto*t/100,o=this.props.totalbruto-a;this.setState({descontopercentual:t,descontovalor:a,totaldocumento:o})}},{key:"onChangeDescontoValor",value:function(e){var t=e.target.value.toFloat(),a=t/this.props.totalbruto*100,o=this.props.totalbruto-t;this.setState({descontopercentual:a,descontovalor:t,totaldocumento:o})}},{key:"onChangeTotalLiquido",value:function(e){var t=e.target.value.toFloat();t>this.props.totalbruto&&(t=this.props.totalbruto);var a=this.props.totalbruto-t,o=a/this.props.totalbruto*100;this.setState({descontopercentual:o,descontovalor:a,totaldocumento:t})}},{key:"render",value:function(){return Object(C.jsxs)(M,{id:"VendaAplicarDesconto",title:"Aplicando desconto...",show:this.state.show,size:"md",beforeClose:this.props.beforeClose,children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ce,{children:"Total dos itens"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ie,{type:"text",className:"text-center",disabled:!0,value:this.props.totalbruto.format(2,",",".")})})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ce,{children:"Desconto em percentual"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ie,{type:"text",className:"text-center",value:this.state.descontopercentual.format(0,",","."),InformarValor:{decimal:0},onChange:this.onChangeDescontoPercentual})})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ce,{children:"Desconto em valor"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ie,{type:"text",className:"text-center",value:this.state.descontovalor.format(2,",","."),InformarValor:{decimal:2,money:!0},onChange:this.onChangeDescontoValor})})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ce,{children:"Total final"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ie,{type:"text",className:"text-center",value:this.state.totaldocumento.format(2,",","."),InformarValor:{decimal:2,money:!0},onChange:this.onChangeTotalLiquido})})]}),Object(C.jsxs)("div",{className:"text-right mt-2",children:[Object(C.jsx)(T,{icon:"undo",color:"red",className:"float-left",onClick:this.cancelar}),Object(C.jsx)(T,{text:"Confirmar",icon:"thumbs-up",color:"green",onClick:this.confirmar})]})]})}}]),a}(d.a.Component)),gt=a(186),Ct=a.n(gt),kt=window.require("fs"),yt=window.require("child_process"),wt=function(){function e(){Object(i.a)(this,e),this.appPath=Object($.a)(),this.childProcess=yt,this.fs=kt,this.srcPath=this.appPath+"/src",this.comDLLPath=this.srcPath+"/lib/comdll-1.0.0"}return Object(s.a)(e,[{key:"execute",value:function(e,t,a,o){try{var r=this.comDLLPath+"/ComDLL.exe",n=[this.srcPath+"/"+e,t].concat(a),i=this.comDLLPath+"/entrada.xml",s=this.comDLLPath+"/retorno.txt";return this.fs.existsSync(i)&&this.fs.unlinkSync(i),this.fs.existsSync(s)&&this.fs.unlinkSync(s),void 0!==o&&this.fs.writeFileSync(i,o,"utf8"),this.childProcess.execFileSync(r,n,{timeout:6e4}),this.fs.readFileSync(s).toString().trim()}catch(c){if("ETIMEDOUT"===c.code)throw new Error("O tempo m\xe1ximo de comunica\xe7\xe3o com o equipamento fiscal SAT foi excedido.<br>Desconecte todos os cabos conectados ao SAT, espere 5 segundos, conecte-os de volta e tente efetuar a opera\xe7\xe3o novamente.<br><br>Caso o problema persista, entre em contato com o suporte.");throw c}}}]),e}(),St=window.require("fs"),Et=window.require("os"),Nt=function(){function e(t){Object(i.a)(this,e),this.Pool=t,this.ComDLL=new wt,this.jsontoxml=Ct.a,this.os=Et,this.fs=St,this.error=null}return Object(s.a)(e,[{key:"cancelarDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,u,l,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object($.l)(this.Pool,"SAT","MODELO");case 2:return a=e.sent,e.next=5,Object($.l)(this.Pool,"SAT","ATIVACAO");case 5:return o=e.sent,e.next=8,this.carregarDadosDocumento(t);case 8:if(n=e.sent,i=n.documento,s=null,"sweda"!==a){e.next=17;break}return e.next=14,this.gerarXMLCancelamento(t);case 14:s=e.sent,e.next=18;break;case 17:s=i.xml;case 18:if(Object($.m)("cancelamento.xml",s),"nenhum"!==a){e.next=21;break}return e.abrupt("return",{xmlcanc:null,chavecanc:null});case 21:c="lib/comdll-1.0.0/SAT-"+a+".dll",u=null,l=null;case 24:if(null!==u&&"06098"!==l[1]){e.next=34;break}if(null===u){e.next=28;break}return e.next=28,Object($.h)(500);case 28:if(!1!==(u=this.ComDLL.execute(c,"CancelarUltimaVenda",[o,i.chave],s))){e.next=31;break}return e.abrupt("return",!1);case 31:l=u.split("|"),e.next=24;break;case 34:if(this.validarRetorno(u)){e.next=36;break}return e.abrupt("return",!1);case 36:return d=atob(l[6]),p=l[8].trim(),"string"===typeof d&&0===d.length&&"sweda"===a&&(l=this.fs.readFileSync("C:/Sweda/Retorno.txt").toString(),d=atob(l[6])),e.abrupt("return",{xmlcanc:d,chavecanc:p});case 40:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"carregarDadosDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,u,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.Pool.constructor.name,s=null,"Pool"!==i){e.next=8;break}return e.next=5,this.Pool.connect();case 5:s=e.sent,e.next=9;break;case 8:s=this.Pool;case 9:return e.prev=9,e.next=12,s.query("SELECT * FROM documento WHERE iddocumento = $1",[t]);case 12:if(0!==(c=e.sent).rows.length){e.next=15;break}throw new Error("Nenhum documento foi encontrado.");case 15:return a=c.rows[0],u=["SELECT documentoproduto.*, unidade.sigla","FROM documentoproduto","LEFT JOIN produto USING (idproduto)","LEFT JOIN unidade USING (idunidade)","WHERE documentoproduto.iddocumento = $1","ORDER BY documentoproduto.sequencial"].join(" "),e.next=19,s.query(u,[t]);case 19:return c=e.sent,o=c.rows,l=["SELECT documentopagamento.*, formapagamento.especie","FROM documentopagamento","LEFT JOIN formapagamento USING (idformapagamento)","WHERE documentopagamento.iddocumento = $1"].join(" "),e.next=24,s.query(l,[t]);case 24:c=e.sent,n=c.rows,e.next=31;break;case 28:throw e.prev=28,e.t0=e.catch(9),e.t0;case 31:return e.prev=31,"Pool"===i&&s.release(),e.finish(31);case 34:return e.abrupt("return",{documento:a,documentoprodutos:o,documentopagamentos:n});case 35:case"end":return e.stop()}}),e,this,[[9,28,31,34]])})));return function(t){return e.apply(this,arguments)}}()},{key:"consultarUltimaSessaoFiscal",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"gerarXMLCancelamento",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a,o){var n,i,s,c,u,l,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarDadosDocumento(t);case 2:return n=e.sent,i=n.documento,e.next=6,Object($.l)(this.Pool,"DESENVOLVEDORA","CNPJ");case 6:return s=e.sent,e.next=9,Object($.l)(this.Pool,"DESENVOLVEDORA","ASSINATURA");case 9:return c=e.sent,e.next=12,Object($.l)(this.Pool,"SAT","CAIXA");case 12:return u=e.sent,l=[{name:"infCFe",attrs:{chCanc:i.chave},children:[{name:"ide",children:{CNPJ:s.removeFormat(),signAC:c,numeroCaixa:u.lpad(3,"0")}},{name:"emit",children:[]},{name:"dest",children:[]},{name:"total",children:[]},{name:"infAdic",children:[]}]}],d=[{name:"CFeCanc",children:[l]}],p=this.jsontoxml(d),"function"===typeof a&&a(p),e.abrupt("return",p);case 18:case"end":return e.stop()}}),e,this)})));return function(t,a,o){return e.apply(this,arguments)}}()},{key:"gerarXMLDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t,a,o){var n,i,s,c,u,l,d,p,h,m,b,f,v,j,O,x,g,C,k,y,w,S,E,N,P,D;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.carregarDadosDocumento(t);case 2:return n=e.sent,i=n.documento,s=n.documentoprodutos,c=n.documentopagamentos,e.next=8,Object($.l)(this.Pool,"DESENVOLVEDORA","CNPJ");case 8:return u=e.sent,e.next=11,Object($.l)(this.Pool,"DESENVOLVEDORA","ASSINATURA");case 11:return l=e.sent,e.next=14,Object($.l)(this.Pool,"SAT","CAIXA");case 14:return d=e.sent,e.next=17,Object($.l)(this.Pool,"EMITENTE","CNPJ");case 17:return p=e.sent,e.next=20,Object($.l)(this.Pool,"EMITENTE","IE");case 20:return h=e.sent,e.next=23,Object($.l)(this.Pool,"EMITENTE","IMPOSTOFEDERAL");case 23:return m=e.sent,e.next=26,Object($.l)(this.Pool,"EMITENTE","IMPOSTOESTADUAL");case 26:return b=e.sent,m||(m=0),b||(b=0),f={name:"ide",children:{CNPJ:u.removeFormat(),signAC:l,numeroCaixa:d.lpad(3,"0")}},v={name:"emit",children:{CNPJ:p.removeFormat(),IE:h.removeFormat(),cRegTribISSQN:1,indRatISSQN:"N"}},j={},(O=i.cpfcnpj?i.cpfcnpj.removeFormat():"").length>11?j={CNPJ:O}:O.length>9&&(j={CPF:O}),x={name:"dest",children:j},g=s.map((function(e){var t=[{name:"cProd",text:e.idproduto},{name:"xProd",text:e.descricao.replaceAll("&","&amp;")},{name:"NCM",text:e.codigoncm.removeFormat()},{name:"CFOP",text:e.cfop.removeFormat()},{name:"uCom",text:e.sigla},{name:"qCom",text:e.quantidade.format(4,".","")},{name:"vUnCom",text:e.preco},{name:"indRegra",text:"T"},{name:"vDesc",text:e.totaldesconto},{name:"vOutro",text:e.totalacrescimo}];null!==e.cest&&e.cest.length>0&&t.push({name:"obsFiscoDet",attrs:{xCampoDet:"Cod. CEST"},children:{xTextoDet:e.cest.removeFormat()}});var a={};["102","300","400","500"].indexOf(e.csosn)>-1&&(a={ICMSSN102:{Orig:e.origem,CSOSN:e.csosn}});var o={};["01","02"].indexOf(e.cstpis)>-1?o={PISAliq:{CST:e.cstpis,vBC:e.basepis,pPIS:e.aliqpis.format(4,".","")}}:["03"].indexOf(e.cstpis)>-1?o={PISQtde:{CST:e.cstpis,qBCProd:e.quantidade,vAliqProd:e.aliqpis.format(4,".","")}}:["04","06","07","08","09"].indexOf(e.cstpis)>-1?o={PISNT:{CST:e.cstpis}}:["49"].indexOf(e.cstpis)>-1?o={PISSN:{CST:e.cstpis}}:["99"].indexOf(e.cstpis)>-1&&(o={PISOutr:{CST:e.cstpis,vBC:e.basepis,pPIS:e.aliqpis.format(4,".","")}});var r={};return["01","02"].indexOf(e.cstcofins)>-1?r={COFINSAliq:{CST:e.cstcofins,vBC:e.basecofins,pCOFINS:e.aliqcofins.format(4,".","")}}:["03"].indexOf(e.cstcofins)>-1?r={COFINSQtde:{CST:e.cstcofins,qBCProd:e.quantidade,vAliqProd:e.aliqcofins.format(4,".","")}}:["04","06","07","08","09"].indexOf(e.cstcofins)>-1?r={COFINSNT:{CST:e.cstcofins}}:["49"].indexOf(e.cstcofins)>-1?r={COFINSSN:{CST:e.cstcofins}}:["99"].indexOf(e.cstcofins)>-1&&(r={COFINSOutr:{CST:e.cstcofins,vBC:e.basecofins,pCOFINS:e.aliqcofins.format(4,".","")}}),{name:"det",attrs:{nItem:e.sequencial},children:{prod:t,imposto:{ICMS:a,PIS:o,COFINS:r}}}})),C={name:"total"},k=c.map((function(e){return{name:"MP",children:{cMP:e.especie,vMP:e.totalpagamento}}})),y={name:"pgto",children:k},w=(i.totaldocumento*m.toFloat()/100).format(2,",","."),S=(i.totaldocumento*b.toFloat()/100).format(2,",","."),E={name:"infAdic",children:{infCpl:"Valor aprox. imposto: R$ "+w+" Fed / R$ "+S+" Est / Fonte SEBRAE"}},N=[f,v,x].concat(g).concat([C,y,E]),P=[{name:"CFe",children:[[{name:"infCFe",attrs:{versaoDadosEnt:"0.07"},children:N}]]}],D=this.jsontoxml(P),"function"===typeof a&&a(D),e.abrupt("return",D);case 49:case"end":return e.stop()}}),e,this)})));return function(t,a,o){return e.apply(this,arguments)}}()},{key:"novoNumSessao",value:function(){return String(Math.round(Math.random()*Math.pow(10,6))).lpad(6,"0")}},{key:"transmitirDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,u,l,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object($.l)(this.Pool,"SAT","MODELO");case 2:return a=e.sent,e.next=5,Object($.l)(this.Pool,"SAT","ATIVACAO");case 5:return o=e.sent,e.next=8,this.gerarXMLDocumento(t);case 8:if(n=e.sent,Object($.m)("venda.xml",n),"nenhum"!==a){e.next=12;break}return e.abrupt("return",{xml:null,chave:null,numero:null});case 12:i="lib/comdll-1.0.0/SAT-"+a+".dll",s=null,c=null;case 15:if(null!==s&&"06098"!==c[1]){e.next=25;break}if(null===s){e.next=19;break}return e.next=19,Object($.h)(500);case 19:if(!1!==(s=this.ComDLL.execute(i,"EnviarDadosVenda",[o],n))){e.next=22;break}return e.abrupt("return",!1);case 22:c=s.split("|"),e.next=15;break;case 25:if(this.validarRetorno(s)){e.next=27;break}return e.abrupt("return",!1);case 27:return u=atob(c[6]),l=c[8].trim(),d=l.substr(-13,6),"string"===typeof u&&0===u.length&&"sweda"===a&&(c=this.fs.readFileSync("C:/Sweda/Retorno.txt").toString(),u=atob(c[6])),e.abrupt("return",{xml:u,chave:l,numero:d});case 32:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"validarRetorno",value:function(e){var t=e.split("|");this.error=null;var a=!1;switch(t[1]){case"04000":case"04006":case"06000":case"07000":case"08000":case"09000":case"10000":a=!0;break;default:this.error=t[3],void 0===this.error||null===this.error||0===this.error.length?this.error="Erro desconhecido. (C\xf3digo "+t[1]+")":["98","99"].indexOf(t[1].substr(-2))>-1&&(this.error="N\xe3o foi poss\xedvel comunicar com o equipamento fiscal SAT.<br><br>Reinicie o equipamento da seguinte maneira:<br>1. Desconecte todos os cabos ligados ao SAT.<br>2. Aguarde 5 segundos.<br>3. Conecte os cabos de volta ao SAT.<br>4. Tente efetuar a venda novamente.<br><br>Caso o problema persista, entre em contato com nosso suporte."),a=!1}return a}}]),e}(),Pt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={iddocumento:null,numero:null,totaldocumento:null,cpfcnpj:null,show:!1},o.atualizarState=o.atualizarState.bind(Object(x.a)(o)),o.cancelar=o.cancelar.bind(Object(x.a)(o)),o.carregarUltimoDocumento=o.carregarUltimoDocumento.bind(Object(x.a)(o)),o.confirmar=o.confirmar.bind(Object(x.a)(o)),o.outroCupom=o.outroCupom.bind(Object(x.a)(o)),o.Printer=new Fe(o.props.Pool),o.SAT=new Nt(o.props.Pool),o}return Object(s.a)(a,[{key:"atualizarState",value:function(e){var t=e.numero?e.numero:"",a=e.cpfcnpj?e.cpfcnpj:"n\xe3o informado";this.setState({iddocumento:e.iddocumento,numero:String(t).lpad(6,"0"),totaldocumento:"R$ "+e.totaldocumento.format(2,",","."),cpfcnpj:a})}},{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"carregarDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=["SELECT iddocumento, numero, totaldocumento, cpfcnpj","FROM documento","WHERE operacao = $1","  AND numero = $2","ORDER BY iddocumento DESC","LIMIT 1"].join(" "),e.next=3,this.props.Pool.query(a,["CU",t]);case 3:if(0!==(o=e.sent).rowCount){e.next=8;break}return this.setState({show:!1}),window.MessageBox.show({title:"Houve uma falha",text:"Nenhum documento foi encontrado com o n\xfamero "+t+"."}),e.abrupt("return",!1);case 8:n=o.rows[0],this.atualizarState(n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"carregarUltimoDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["SELECT iddocumento, numero, totaldocumento, cpfcnpj","FROM documento","WHERE operacao = $1","ORDER BY iddocumento DESC","LIMIT 1"].join(" "),e.next=3,this.props.Pool.query(t,["CU"]);case 3:if(0!==(a=e.sent).rowCount){e.next=8;break}return this.setState({show:!1}),window.MessageBox.show({title:"Houve uma falha",text:"Nenhum documento foi encontrado."}),e.abrupt("return",!1);case 8:o=a.rows[0],this.atualizarState(o);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(e){this.setState({show:e.show}),!this.state.show&&e.show&&this.carregarUltimoDocumento()}},{key:"confirmar",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,window.Loading.show(),e.next=4,Object($.l)(this.props.Pool,"SAT","MODELO");case 4:if(t=e.sent,a={xmlcanc:null,chavecanc:null},"nenhum"===t){e.next=12;break}return e.next=9,this.SAT.cancelarDocumento(this.state.iddocumento);case 9:if(!1!==(a=e.sent)){e.next=12;break}throw new Error(this.SAT.error);case 12:return o=["UPDATE documento SET","  status = $2, dthrcancelamento = $3,","  xmlcanc = $4, chavecanc = $5","WHERE iddocumento = $1"].join(" "),n=[this.state.iddocumento,"C",Object($.c)(),a.xmlcanc,a.chavecanc],e.next=16,this.props.Pool.query(o,n);case 16:return e.t0=it.a,e.next=19,Object($.l)(this.props.Pool,"IMPRESSORA","NUMEROVIAS");case 19:for(e.t1=e.sent,i=e.t0.parse.call(e.t0,e.t1),s=1;s<=i.cancelamento;s++)this.Printer.imprimirDocumento(this.state.iddocumento);window.FastMessage.show("Venda cancelada com sucesso!"),this.setState({show:!1}),e.next=30;break;case 26:e.prev=26,e.t2=e.catch(0),console.error(e.t2.stack),Object($.e)(e.t2.message);case 30:return e.prev=30,window.Loading.hide(),e.finish(30);case 33:case"end":return e.stop()}}),e,this,[[0,26,30,33]])})));return function(){return e.apply(this,arguments)}}()},{key:"outroCupom",value:function(){var e=this;window.InformarValor.show({title:"Informe o n\xfamero do cupom",mask:"999999",success:function(t){e.carregarDocumento(t)}})}},{key:"render",value:function(){return Object(C.jsxs)(M,{id:"VendaCancelarCupom",title:"Cancelamento de venda",show:this.state.show,size:"md",beforeClose:this.props.beforeClose,children:[Object(C.jsx)(q,{children:Object(C.jsxs)(R,{size:"12",className:"text-left",children:["Tem certeza que deseja cancelar a venda?",Object(C.jsx)("br",{}),Object(C.jsx)("br",{}),"Cupom: ",this.state.numero,Object(C.jsx)("br",{}),"Total: ",this.state.totaldocumento,Object(C.jsx)("br",{}),"CPF: ",this.state.cpfcnpj]})}),Object(C.jsx)(le,{}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"5",children:Object(C.jsx)(T,{text:"Outro cupom",color:"blue",onClick:this.outroCupom})}),Object(C.jsxs)(R,{size:"7",className:"text-right",children:[Object(C.jsx)(T,{text:"Sim",icon:"thumbs-up",color:"green",className:"mr-2",onClick:this.confirmar}),Object(C.jsx)(T,{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:this.cancelar})]})]})]})}}]),a}(d.a.Component),Dt=(a(417),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={height:"0px"},o.ajustarAltura=o.ajustarAltura.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"ajustarAltura",value:function(){this.setState({height:window.innerHeight})}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.ajustarAltura),this.ajustarAltura()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.ajustarAltura)}},{key:"render",value:function(){return Object(C.jsxs)("div",{className:"vendadetalhe",style:{height:this.state.height},children:[Object(C.jsx)(At,{cancelarUltimaVenda:this.props.cancelarUltimaVenda,cancelarVendaAtual:this.props.cancelarVendaAtual,carregarOrcamento:this.props.carregarOrcamento,listaDocumentoProduto:this.props.listaDocumentoProduto,operacao:this.props.operacao,reimprimirCupom:this.props.reimprimirCupom,trocarOperacao:this.props.trocarOperacao}),Object(C.jsx)(Tt,{aumentarQuantidade:this.props.aumentarQuantidade,diminuirQuantidade:this.props.diminuirQuantidade,editarProduto:this.props.editarProduto,listaDocumentoProduto:this.props.listaDocumentoProduto,removerProduto:this.props.removerProduto}),Object(C.jsx)(It,{abrirFinalizacao:this.props.abrirFinalizacao,cpfcnpj:this.props.cpfcnpj,informarCPF:this.props.informarCPF,listaDocumentoProduto:this.props.listaDocumentoProduto,operacao:this.props.operacao})]})}}]),a}(d.a.Component)),At=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).alternarOrcamento=o.alternarOrcamento.bind(Object(x.a)(o)),o.alternarVenda=o.alternarVenda.bind(Object(x.a)(o)),o.efetivarOrcamento=o.efetivarOrcamento.bind(Object(x.a)(o)),o.onClickDocument=o.onClickDocument.bind(Object(x.a)(o)),o.onClickIcon=o.onClickIcon.bind(Object(x.a)(o)),o.exibindoOpcoes=!1,o}return Object(s.a)(a,[{key:"abrirOpcoes",value:function(){var e=h.a.findDOMNode(this.opcoes);v()(e).stop().animate({height:"show"},350),this.exibindoOpcoes=!0}},{key:"alternarOrcamento",value:function(){this.props.trocarOperacao("OR")}},{key:"alternarVenda",value:function(){this.props.trocarOperacao("CU")}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.onClickDocument)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onClickDocument)}},{key:"efetivarOrcamento",value:function(){var e=this;window.InformarValor.show({title:"N\xfamero do or\xe7amento",mask:"999999",success:function(t){t.length>0&&e.props.carregarOrcamento(t)}})}},{key:"fecharOpcoes",value:function(){var e=h.a.findDOMNode(this.opcoes);v()(e).stop().animate({height:"hide"},350),this.exibindoOpcoes=!1}},{key:"onClickDocument",value:function(e){var t=h.a.findDOMNode(this.icon);!this.iconClicked&&t.contains(e.target)?this.iconClicked=!0:this.exibindoOpcoes&&(this.iconClicked=!1,this.fecharOpcoes())}},{key:"onClickIcon",value:function(){this.abrirOpcoes()}},{key:"render",value:function(){var e=this,t=this.props.listaDocumentoProduto.length,a=this.props.operacao,o=null;if("OR"===a)o="Or\xe7amento";else o="Detalhe da venda";return Object(C.jsx)("div",{className:"vendadetalhe-cabecalho",children:Object(C.jsxs)("div",{children:[Object(C.jsx)("h4",{children:o}),Object(C.jsx)(k,{name:"menu",onClick:this.onClickIcon,ref:function(t){e.icon=t}}),Object(C.jsx)("div",{className:"vendadetalhe-cabecalho-opcoes",ref:function(t){e.opcoes=t},children:Object(C.jsxs)(Ye,{children:[Object(C.jsx)(Qe,{className:0===t?" d-none":"",onClick:this.props.cancelarVendaAtual,children:"Cancelar venda atual"}),Object(C.jsx)(Qe,{className:0===t?"":" d-none",onClick:this.props.cancelarUltimaVenda,children:"Cancelar \xfaltima venda"}),Object(C.jsx)(Qe,{onClick:this.props.reimprimirCupom,children:"Reimprimir cupom"}),Object(C.jsx)(Qe,{className:"CU"!==a?"":" d-none",onClick:this.alternarVenda,children:"Alternar para venda"}),Object(C.jsx)(Qe,{className:"OR"!==a?"":" d-none",onClick:this.alternarOrcamento,children:"Alternar para or\xe7amento"}),Object(C.jsx)(Qe,{onClick:this.efetivarOrcamento,children:"Efetivar um or\xe7amento"})]})})]})})}}]),a}(d.a.Component),Tt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).countLista=e.listaDocumentoProduto.length,o}return Object(s.a)(a,[{key:"componentDidUpdate",value:function(){this.props.listaDocumentoProduto.length>this.countLista&&this.scrollToBottom(),this.countLista=this.props.listaDocumentoProduto.length}},{key:"scrollToBottom",value:function(){v()("#vendadetalhe-corpo-conteudo").stop().animate({scrollTop:v()("#vendadetalhe-corpo-conteudo").get(0).scrollHeight},1e3)}},{key:"render",value:function(){var e=this;return Object(C.jsx)("div",{className:"vendadetalhe-corpo",children:Object(C.jsx)("div",{children:Object(C.jsx)("div",{id:"vendadetalhe-corpo-conteudo",children:this.props.listaDocumentoProduto.map((function(t,a){return t.i=a,Object(C.jsx)(Rt,{documentoproduto:t,aumentarQuantidade:e.props.aumentarQuantidade,diminuirQuantidade:e.props.diminuirQuantidade,editarProduto:e.props.editarProduto,removerProduto:e.props.removerProduto},a)}))})})})}}]),a}(d.a.Component),Rt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(e){var t=this,a="   ",o="R$ "+this.props.documentoproduto.preco.format(2,",","."),r=this.props.documentoproduto.quantidade.format(this.props.documentoproduto.precisao,",","."),n="R$ "+this.props.documentoproduto.totaldesconto.format(2,",","."),i="R$ "+this.props.documentoproduto.totalacrescimo.format(2,",","."),s="R$ "+this.props.documentoproduto.totalproduto.format(2,",","."),c=null;return c=this.props.documentoproduto.descontounitario>0&&this.props.documentoproduto.acrescimounitario>0?o+a+"x"+a+r+"   -"+a+n+"   +"+a+i+"   ="+"   <b>"+s+"</b>":this.props.documentoproduto.descontounitario>0?o+a+"x"+a+r+"   -"+a+n+"   ="+"   <b>"+s+"</b>":this.props.documentoproduto.acrescimounitario>0?o+a+"x"+a+r+"   +"+a+i+"   ="+"   <b>"+s+"</b>":o+a+"x"+a+r+"   ="+"   <b>"+s+"</b>",Object(C.jsxs)("div",{children:[Object(C.jsxs)(q,{className:"vendadetalhe-produto",onClick:function(){t.props.editarProduto(t.props.documentoproduto)},children:[Object(C.jsxs)(R,{size:"8",children:[Object(C.jsx)("div",{className:"vendadetalhe-produto-descricao",children:this.props.documentoproduto.descricao}),Object(C.jsx)("div",{className:"vendadetalhe-produto-calculo",dangerouslySetInnerHTML:{__html:c}})]}),Object(C.jsxs)(R,{size:"4",className:"vendadetalhe-produto-botao text-right",children:[Object(C.jsxs)("div",{children:[Object(C.jsx)(T,{icon:"plus",color:"green",onClick:function(e){t.props.aumentarQuantidade(t.props.documentoproduto),e.stopPropagation()}}),Object(C.jsx)(T,{icon:"minus",color:"red",onClick:function(e){t.props.diminuirQuantidade(t.props.documentoproduto),e.stopPropagation()}})]}),Object(C.jsx)(T,{icon:"bin",color:"red",onClick:function(e){t.props.removerProduto(t.props.documentoproduto),e.stopPropagation()}})]})]}),Object(C.jsx)(le,{})]})}}]),a}(d.a.Component),It=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={cpfcnpj:e.cpfcnpj},o}return Object(s.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState({cpfcnpj:e.cpfcnpj})}},{key:"render",value:function(){var e=0,t=0,a=0,o=0;return this.props.listaDocumentoProduto.forEach((function(r){e+=parseFloat(r.quantidade),t+=parseFloat(r.preco*r.quantidade),a+=parseFloat(r.totaldesconto),o+=parseFloat(r.totalproduto)})),Object(C.jsx)("div",{className:"vendadetalhe-rodape",children:Object(C.jsx)("div",{children:Object(C.jsxs)(q,{children:[Object(C.jsxs)(R,{size:"6",children:[Object(C.jsxs)("div",{className:"vendadetalhe-rodape-informacao mb-3 mt-1",children:[Object(C.jsxs)("div",{children:["Quantidade de itens ",Object(C.jsx)("strong",{children:e})]}),Object(C.jsxs)("div",{children:["Total dos itens ",Object(C.jsxs)("strong",{children:[Object(C.jsx)("small",{children:"R$"}),t.format(2,",",".")]})]}),Object(C.jsxs)("div",{children:["Total de desconto ",Object(C.jsxs)("strong",{children:[Object(C.jsx)("small",{children:"R$"}),a.format(2,",",".")]})]})]}),Object(C.jsxs)("div",{className:"CU"===this.props.operacao?"":"d-none",children:[Object(C.jsxs)("div",{className:"vendadetalhe-rodape-cpfcnpj"+(this.state.cpfcnpj?"":" d-none"),style:{position:"absolute",bottom:"0px"},children:[Object(C.jsxs)("span",{children:["CPF: ",Object(C.jsx)("strong",{children:this.state.cpfcnpj})]}),Object(C.jsx)(T,{text:"alterar",color:"green",size:"xs",className:"ml-2",onClick:this.props.informarCPF})]}),Object(C.jsx)("div",{className:this.state.cpfcnpj?" d-none":"",style:{position:"absolute",bottom:"0px"},children:Object(C.jsx)(T,{text:"Informar CPF",color:"green",size:"sm",onClick:this.props.informarCPF})})]})]}),Object(C.jsxs)(R,{size:"6",children:[Object(C.jsx)("div",{className:"vendadetalhe-rodape-totaldocumento",children:o.format(2,",",".")}),Object(C.jsx)(T,{text:"F I N A L I Z A R",icon:"dollar2",size:"lg",block:"true",color:"green",disabled:0===o,onClick:this.props.abrirFinalizacao})]})]})})})}}]),a}(d.a.Component),Mt=(a(418),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={quantidade:o.props.documentoproduto.quantidade,preco:o.props.documentoproduto.preco,descontounitario:o.props.documentoproduto.descontounitario,acrescimounitario:o.props.documentoproduto.acrescimounitario,totaldesconto:o.props.documentoproduto.totaldesconto,totalacrescimo:o.props.documentoproduto.totalacrescimo,totalproduto:o.props.documentoproduto.totalproduto,show:o.props.show},o.calcularTotais=o.calcularTotais.bind(Object(x.a)(o)),o.cancelar=o.cancelar.bind(Object(x.a)(o)),o.confirmar=o.confirmar.bind(Object(x.a)(o)),o.onChangeAcrescimoPercentual=o.onChangeAcrescimoPercentual.bind(Object(x.a)(o)),o.onChangeAcrescimoUnitario=o.onChangeAcrescimoUnitario.bind(Object(x.a)(o)),o.onChangeDescontoPercentual=o.onChangeDescontoPercentual.bind(Object(x.a)(o)),o.onChangeDescontoUnitario=o.onChangeDescontoUnitario.bind(Object(x.a)(o)),o.onChangePreco=o.onChangePreco.bind(Object(x.a)(o)),o.onChangeQuantidade=o.onChangeQuantidade.bind(Object(x.a)(o)),o.onChangeTotalAcrescimo=o.onChangeTotalAcrescimo.bind(Object(x.a)(o)),o.onChangeTotalDesconto=o.onChangeTotalDesconto.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"calcularTotais",value:function(){var e=this.state.preco*this.state.quantidade,t=this.state.acrescimounitario*this.state.quantidade,a=this.state.descontounitario*this.state.quantidade,o=e-a+t;this.setState({totalbruto:e,totalacrescimo:t,totaldesconto:a,totalproduto:o})}},{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"componentWillReceiveProps",value:function(e){this.setState({quantidade:e.documentoproduto.quantidade,preco:e.documentoproduto.preco,descontounitario:e.documentoproduto.descontounitario,acrescimounitario:e.documentoproduto.acrescimounitario,show:e.show},this.calcularTotais)}},{key:"confirmar",value:function(){var e=this,t=Object.assign({},this.props.documentoproduto);t.quantidade=this.state.quantidade,t.preco=this.state.preco,t.descontounitario=this.state.descontounitario,t.acrescimounitario=this.state.acrescimounitario,t.totaldesconto=this.state.totaldesconto,t.totalacrescimo=this.state.totalacrescimo,t.totalproduto=this.state.totalproduto,this.setState({show:!1},(function(){e.props.atualizarDocumentoProduto(t)}))}},{key:"onChangeAcrescimoPercentual",value:function(e){var t=e.target.value.toFloat(),a=this.state.preco*t/100;this.setState({acrescimounitario:a},this.calcularTotais)}},{key:"onChangeAcrescimoUnitario",value:function(e){var t=e.target.value.toFloat();this.setState({acrescimounitario:t},this.calcularTotais)}},{key:"onChangeDescontoPercentual",value:function(e){var t=e.target.value.toFloat(),a=this.state.preco*t/100;this.setState({descontounitario:a},this.calcularTotais)}},{key:"onChangeDescontoUnitario",value:function(e){var t=e.target.value.toFloat();this.setState({descontounitario:t},this.calcularTotais)}},{key:"onChangePreco",value:function(e){var t=e.target.value.toFloat();this.setState({preco:t},this.calcularTotais)}},{key:"onChangeQuantidade",value:function(e){var t=e.target.value.toFloat();this.setState({quantidade:t},this.calcularTotais)}},{key:"onChangeTotalAcrescimo",value:function(e){var t=e.target.value.toFloat()/this.state.quantidade;this.setState({acrescimounitario:t},this.calcularTotais)}},{key:"onChangeTotalDesconto",value:function(e){var t=e.target.value.toFloat()/this.state.quantidade;this.setState({descontounitario:t},this.calcularTotais)}},{key:"render",value:function(){var e=this.state.preco*this.state.quantidade,t=e>0?this.state.totalacrescimo/e*100:0,a=e>0?this.state.totaldesconto/e*100:0,o=this.props.documentoproduto.precisao;return Object(C.jsxs)(M,{id:"VendaEditarProduto",title:this.props.documentoproduto.descricao,show:this.state.show,size:"md",beforeClose:this.props.beforeClose,children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(ue,{type:"text",label:"Quantidade",className:"col-4",inputClassName:"text-center",value:this.state.quantidade.format(o,",","."),onChange:this.onChangeQuantidade,InformarValor:{decimal:o}}),Object(C.jsx)(ue,{type:"text",label:"Pre\xe7o unit\xe1rio",className:"col-4",inputClassName:"text-center",value:this.state.preco.format(2,",","."),onChange:this.onChangePreco,InformarValor:{decimal:2,money:!0}}),Object(C.jsx)(ue,{type:"text",label:"Valor do item",className:"col-4",inputClassName:"text-center",value:e.format(2,",","."),disabled:!0,readOnly:!0}),Object(C.jsx)(ue,{type:"text",label:"Desconto unit\xe1rio",className:"col-4",inputClassName:"text-center",value:this.state.descontounitario.format(2,",","."),onChange:this.onChangeDescontoUnitario,InformarValor:{decimal:2,money:!0}}),Object(C.jsx)(ue,{type:"text",label:"Desconto percentual",className:"col-4",inputClassName:"text-center",value:a.format(2,",","."),onChange:this.onChangeDescontoPercentual,InformarValor:{decimal:0}}),Object(C.jsx)(ue,{type:"text",label:"Total de desconto",className:"col-4",inputClassName:"text-center",value:this.state.totaldesconto.format(2,",","."),onChange:this.onChangeTotalDesconto,InformarValor:{decimal:2,money:!0}}),Object(C.jsx)(ue,{type:"text",label:"Acr\xe9scimo unit\xe1rio",className:"col-4",inputClassName:"text-center",value:this.state.acrescimounitario.format(2,",","."),onChange:this.onChangeAcrescimoUnitario,InformarValor:{decimal:2,money:!0}}),Object(C.jsx)(ue,{type:"text",label:"Acr\xe9sc percentual",className:"col-4",inputClassName:"text-center",value:t.format(2,",","."),onChange:this.onChangeAcrescimoPercentual,InformarValor:{decimal:0}}),Object(C.jsx)(ue,{type:"text",label:"Total de acr\xe9scimo",className:"col-4",inputClassName:"text-center",value:this.state.totalacrescimo.format(2,",","."),onChange:this.onChangeTotalAcrescimo,InformarValor:{decimal:2,money:!0}}),Object(C.jsx)(ue,{type:"text",label:"Total final",className:"col-4 offset-8",inputClassName:"text-center",value:this.state.totalproduto.format(2,",","."),disabled:!0,readOnly:!0})]}),Object(C.jsx)(le,{}),Object(C.jsxs)("div",{className:"text-right",children:[Object(C.jsx)(T,{text:"Confirmar",icon:"thumbs-up",color:"green",className:"mr-2",onClick:this.confirmar}),Object(C.jsx)(T,{text:"Voltar",icon:"thumbs-down",color:"red",onClick:this.cancelar})]})]})}}]),a}(d.a.Component)),qt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=[this.props.className];return e.push("card"),Object(C.jsx)("div",{className:e.join(" "),children:this.props.children})}}]),a}(d.a.Component),Lt=(a(419),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={documentopagamentos:e.listaDocumentoPagamento,formaspagamento:[],show:!1},o.finalizarVenda=o.finalizarVenda.bind(Object(x.a)(o)),o.removerPagamento=o.removerPagamento.bind(Object(x.a)(o)),o.totalpago=0,o.totalrestante=0,o.totaltroco=0,o}return Object(s.a)(a,[{key:"carregarFormasPagamento",value:function(){var e=this;this.props.Pool.query("SELECT idformapagamento, descricao, especie FROM formapagamento WHERE status = $1 ORDER BY especie",["A"],(function(t,a){if(t)return Object($.e)(t),!1;e.setState({formaspagamento:a.rows})}))}},{key:"componentDidMount",value:function(){this.carregarFormasPagamento()}},{key:"componentWillReceiveProps",value:function(e){this.setState({documentopagamentos:e.listaDocumentoPagamento,show:e.show})}},{key:"finalizarVenda",value:function(){this.props.finalizarVenda(this.state.documentopagamentos,this.totaltroco)}},{key:"iconEspecie",value:function(e){switch(e){case"01":return"dollar";case"02":return"keyboard";case"03":case"04":return"credit-card";case"10":case"11":case"12":case"13":return"discout";default:return"money"}}},{key:"incluirPagamento",value:function(e){var t=this;window.InformarValor.show({title:e.descricao,decimal:2,money:!0,value:this.totalrestante.format(2,",","."),success:function(a){if((a=a.toFloat())>0){var o=t.state.documentopagamentos;o.push({idformapagamento:e.idformapagamento,descricao:e.descricao,totalpagamento:a}),t.setState({documentopagamentos:o},(function(){"01"===e.especie&&0===t.totalrestante&&t.finalizarVenda()}))}}})}},{key:"removerPagamento",value:function(e){var t=this.state.documentopagamentos;t.splice(e,1),this.setState({documentopagamentos:t})}},{key:"render",value:function(){var e=this;this.totalpago=0;var t,a=Object(me.a)(this.state.documentopagamentos);try{for(a.s();!(t=a.n()).done;){var o=t.value;this.totalpago+=o.totalpagamento}}catch(r){a.e(r)}finally{a.f()}return this.totalpago>this.props.totaldocumento?(this.totalrestante=0,this.totaltroco=Math.round(100*(this.totalpago-this.props.totaldocumento))/100):(this.totalrestante=Math.round(100*(this.props.totaldocumento-this.totalpago))/100,this.totaltroco=0),Object(C.jsxs)("div",{className:"vendafinalizacao"+(this.state.show?"":" d-none"),children:[Object(C.jsxs)(M,{title:"Finaliza\xe7\xe3o da venda",size:"lg",show:this.state.show,beforeClose:this.props.beforeClose,children:[Object(C.jsx)("div",{className:"vendafinalizacao-totaldocumento",children:this.props.totaldocumento.format(2,",",".")}),Object(C.jsx)(q,{className:"vendafinalizacao-formapagamento",children:this.state.formaspagamento.map((function(t,a){return Object(C.jsx)(R,{size:"4",children:Object(C.jsx)(T,{text:t.descricao,block:!0,size:"lg",icon:e.iconEspecie(t.especie),disabled:0===e.totalrestante,onClick:function(){e.incluirPagamento(t)}})},a)}))}),Object(C.jsx)(le,{}),Object(C.jsxs)(q,{children:[Object(C.jsx)(ue,{label:"Total pago",className:"col-3",inputClassName:"text-center",size:"lg",value:this.totalpago.format(2,",","."),disabled:!0}),Object(C.jsx)(ue,{label:"Total restante",className:"col-3",inputClassName:"text-center",size:"lg",value:this.totalrestante.format(2,",","."),disabled:!0,warning:this.totalrestante}),Object(C.jsx)(ue,{label:"Total de troco",className:"col-3",inputClassName:"text-center",size:"lg",value:this.totaltroco.format(2,",","."),disabled:!0,warning:this.totaltroco}),Object(C.jsx)(R,{size:"3",labelMargin:!0,children:Object(C.jsx)(T,{text:"Finalizar!",icon:"thumbs-up",block:!0,size:"lg",color:"green",disabled:this.totalrestante>0,onClick:this.finalizarVenda})})]}),Object(C.jsx)(Ft,{documentopagamentos:this.state.documentopagamentos,removerPagamento:this.removerPagamento})]}),Object(C.jsx)("div",{className:"vendafinalizacao-botoesextras",children:Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"4",children:Object(C.jsx)(T,{text:"Desconto",icon:"folder-minus",size:"sm",block:!0,disabled:this.totalpago>0,onClick:this.props.aplicarDesconto})}),Object(C.jsx)(R,{size:"4",children:Object(C.jsx)(T,{text:"Acr\xe9scimo",icon:"folder-plus",size:"sm",block:!0,disabled:this.totalpago>0,onClick:this.props.aplicarAcrescimo})}),Object(C.jsx)(R,{size:"4",children:Object(C.jsx)(T,{text:"Incluir 10%",icon:"user-plus",size:"sm",block:!0,onClick:this.props.incluirDezPorcento})})]})})]})}}]),a}(d.a.Component)),Ft=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this;return 0===this.props.documentopagamentos.length?null:Object(C.jsxs)("div",{children:[Object(C.jsx)(le,{className:"mt-0"}),Object(C.jsx)(q,{className:"justify-content-center",children:this.props.documentopagamentos.map((function(t,a){return Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(qt,{children:Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"5",children:Object(C.jsx)("span",{children:t.descricao})}),Object(C.jsx)(R,{size:"4",children:Object(C.jsx)("span",{children:t.totalpagamento.format(2,",",".")})}),Object(C.jsx)(R,{size:"3",children:Object(C.jsx)(T,{icon:"bin",color:"red",size:"sm",block:!0,onClick:function(){e.props.removerPagamento(a)}})})]})})},a)}))})]})}}]),a}(d.a.Component),zt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={nomeorcamento:o.props.nomeorcamento,cpfcnpj:o.props.cpfcnpj,show:o.props.show},o.cancelar=o.cancelar.bind(Object(x.a)(o)),o.confirmar=o.confirmar.bind(Object(x.a)(o)),o.onChangeCpfCnpj=o.onChangeCpfCnpj.bind(Object(x.a)(o)),o.onChangeNomeOrcamento=o.onChangeNomeOrcamento.bind(Object(x.a)(o)),o.onFocusCpfCnpj=o.onFocusCpfCnpj.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"componentWillReceiveProps",value:function(e){this.setState({nomeorcamento:e.nomeorcamento,cpfcnpj:e.cpfcnpj,show:e.show})}},{key:"confirmar",value:function(){this.props.finalizarOrcamento(this.state.nomeorcamento,this.state.cpfcnpj)}},{key:"onChangeCpfCnpj",value:function(e){this.setState({cpfcnpj:e.target.value})}},{key:"onChangeNomeOrcamento",value:function(e){this.setState({nomeorcamento:e.target.value})}},{key:"onFocusCpfCnpj",value:function(e){var t=this;window.InformarValor.show({title:"Informe o CPF ou CNPJ",mask:"99999999999999",success:function(e){var a=null;if(11===e.length&&Object($.k)(e))a=e.substr(0,3)+"."+e.substr(3,3)+"."+e.substr(6,3)+"-"+e.substr(9,2);else if(14===e.length&&Object($.j)(e))a=e.substr(0,2)+"."+e.substr(2,3)+"."+e.substr(5,3)+"/"+e.substr(8,4)+"-"+e.substr(12,2);else if(e.length>0)return window.MessageBox.show({title:"CPF ou CNPJ inv\xe1lido",text:"O CPF ou CNPJ informado \xe9 inv\xe1lido."}),!1;t.setState({cpfcnpj:a})},fail:function(){t.setState({cpfcnpj:null})}})}},{key:"render",value:function(){return Object(C.jsxs)(M,{id:"VendaFinalizacaoOrcamento",show:this.state.show,size:"sm",beforeClose:this.props.beforeClose,children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(ue,{type:"text",className:"col-12",label:"Nome do cliente",value:this.state.nomeorcamento,onChange:this.onChangeNomeOrcamento}),Object(C.jsx)(ue,{type:"text",className:"col-12",label:"CPF/CNPJ",value:this.state.cpfcnpj,onChange:this.onChangeCpfCnpj,onFocus:this.onFocusCpfCnpj})]}),Object(C.jsx)(le,{className:"mt-0"}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(T,{text:"Cancelar",color:"red",block:!0,onClick:this.cancelar})}),Object(C.jsx)(R,{size:"6",className:"pl-0",children:Object(C.jsx)(T,{text:"Confirmar",color:"green",block:!0,onClick:this.confirmar})})]})]})}}]),a}(d.a.Component),Ut=(a(420),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),(o=t.call(this,e)).state={listaUltimosDocumentos:[],show:!1},o.carregarUltimosDocumentos=o.carregarUltimosDocumentos.bind(Object(x.a)(o)),o.imprimir=o.imprimir.bind(Object(x.a)(o)),o}return Object(s.a)(a,[{key:"atualizarState",value:function(e){var t=e.numero?e.numero:"",a=e.cpfcnpj?e.cpfcnpj:"n\xe3o informado";this.setState({iddocumento:e.iddocumento,numero:String(t).lpad(6,"0"),totaldocumento:"R$ "+e.totaldocumento.format(2,",","."),cpfcnpj:a})}},{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"carregarDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=["SELECT iddocumento, numero, totaldocumento, cpfcnpj","FROM documento","WHERE operacao = $1","  AND numero = $2","ORDER BY iddocumento DESC","LIMIT 1"].join(" "),e.next=3,this.props.Pool.query(a,["CU",t]);case 3:if(0!==(o=e.sent).rowCount){e.next=8;break}return this.setState({show:!1}),window.MessageBox.show({title:"Houve uma falha",text:"Nenhum documento foi encontrado com o n\xfamero "+t+"."}),e.abrupt("return",!1);case 8:n=o.rows[0],this.atualizarState(n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"carregarUltimosDocumentos",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["SELECT iddocumento, dthrcriacao, totaldocumento, totalquantidade, cpfcnpj","FROM documento","WHERE operacao = $1","ORDER BY dthrcriacao DESC","LIMIT 3"].join(" "),e.next=3,this.props.Pool.query(t,["CU"]);case 3:a=e.sent,o=[],n=Object(me.a)(a.rows);try{for(n.s();!(i=n.n()).done;)s=i.value,o.push(s)}catch(r){n.e(r)}finally{n.f()}this.setState({listaUltimosDocumentos:o});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(e){this.setState({show:e.show}),!this.state.show&&e.show&&this.carregarUltimosDocumentos()}},{key:"imprimir",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Fe(this.props.Pool),e.next=3,a.imprimirDocumento(t,(function(){o.setState({show:!1}),window.FastMessage.show("Cupom enviado para impressora com sucesso!")}),(function(e){e&&Object($.e)(e)}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(C.jsx)(M,{id:"VendaReimprimirCupom",title:"Reimpress\xe3o de cupom",show:this.state.show,size:"md",beforeClose:this.props.beforeClose,children:Object(C.jsx)(Ye,{children:this.state.listaUltimosDocumentos.map((function(t,a){var o=t.dthrcriacao.toLocaleString(),r="R$ "+t.totaldocumento.format(2,",","."),n=Math.round(t.totalquantidade),i=t.cpfcnpj;return Object(C.jsx)(Qe,{onClick:function(){e.imprimir(t.iddocumento)},children:Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"12",children:Object(C.jsx)("h3",{className:"text-center",children:o})}),Object(C.jsxs)(R,{size:"4",className:"text-center",children:[Object(C.jsx)("span",{children:"Total documento"}),Object(C.jsx)("h4",{children:r})]}),Object(C.jsxs)(R,{size:"4",className:"text-center",children:[Object(C.jsx)("span",{children:"Qtde de itens"}),Object(C.jsx)("h4",{children:n})]}),Object(C.jsxs)(R,{size:"4",className:"text-center",children:[Object(C.jsx)("span",{children:"CPF/CNPJ"}),Object(C.jsx)("h4",{children:i})]})]})},a)}))})})}}]),a}(d.a.Component)),Vt=(a(421),a(422),window.require("fs")),Bt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;Object(i.a)(this,a);var r=(o=t.call(this,e)).criarObjetoDocumentoProduto();return o.state={documentoproduto:r,listaDocumentoProduto:[],listaDocumentoPagamento:[],operacao:"CU",cpfcnpj:null,nomeorcamento:null,iddocumentoorcamento:null,pesquisa:"",pesquisaEfetiva:"",showEditarProduto:!1,showVendaAplicarDesconto:!1,showVendaAplicarAcrescimo:!1,showVendaCancelarCupom:!1,showVendaFinalizacao:!1,showVendaFinalizacaoOrcamento:!1,showVendaReimprimirCupom:!1},o.abrirFinalizacao=o.abrirFinalizacao.bind(Object(x.a)(o)),o.aplicarAcrescimo=o.aplicarAcrescimo.bind(Object(x.a)(o)),o.aplicarDesconto=o.aplicarDesconto.bind(Object(x.a)(o)),o.atualizarDocumentoProduto=o.atualizarDocumentoProduto.bind(Object(x.a)(o)),o.aumentarQuantidade=o.aumentarQuantidade.bind(Object(x.a)(o)),o.cancelarUltimaVenda=o.cancelarUltimaVenda.bind(Object(x.a)(o)),o.cancelarVendaAtual=o.cancelarVendaAtual.bind(Object(x.a)(o)),o.carregarOrcamento=o.carregarOrcamento.bind(Object(x.a)(o)),o.carregarTemporario=o.carregarTemporario.bind(Object(x.a)(o)),o.diminuirQuantidade=o.diminuirQuantidade.bind(Object(x.a)(o)),o.editarProduto=o.editarProduto.bind(Object(x.a)(o)),o.finalizarDocumento=o.finalizarDocumento.bind(Object(x.a)(o)),o.finalizarOrcamento=o.finalizarOrcamento.bind(Object(x.a)(o)),o.finalizarVenda=o.finalizarVenda.bind(Object(x.a)(o)),o.gravarTemporario=o.gravarTemporario.bind(Object(x.a)(o)),o.incluirDezPorcento=o.incluirDezPorcento.bind(Object(x.a)(o)),o.incluirProduto=o.incluirProduto.bind(Object(x.a)(o)),o.informarCPF=o.informarCPF.bind(Object(x.a)(o)),o.onChangePesquisa=o.onChangePesquisa.bind(Object(x.a)(o)),o.onClickBuscar=o.onClickBuscar.bind(Object(x.a)(o)),o.onKeyUpPesquisa=o.onKeyUpPesquisa.bind(Object(x.a)(o)),o.pesquisaLimpar=o.pesquisaLimpar.bind(Object(x.a)(o)),o.reimprimirCupom=o.reimprimirCupom.bind(Object(x.a)(o)),o.reiniciar=o.reiniciar.bind(Object(x.a)(o)),o.removerProduto=o.removerProduto.bind(Object(x.a)(o)),o.trocarOperacao=o.trocarOperacao.bind(Object(x.a)(o)),o.Pool=new G,o.temporaryFileName="venda.tmp",o}return Object(s.a)(a,[{key:"abrirFinalizacao",value:function(){switch(this.state.operacao){case"CU":this.setState({showVendaFinalizacao:!0});break;case"OR":this.setState({showVendaFinalizacaoOrcamento:!0})}}},{key:"aplicarAcrescimo",value:function(e,t){var a=this;if(isNaN(e)||isNaN(t))this.setState({showVendaAplicarAcrescimo:!0});else{var o=this.state.listaDocumentoProduto;o.forEach((function(o){var r=o.preco*o.quantidade,n=t*(r/e)/o.quantidade;o.acrescimounitario=n,a.calcularDocumentoProduto(o)})),this.setState({listaDocumentoProduto:o,showVendaAplicarAcrescimo:!1})}}},{key:"aplicarDesconto",value:function(e,t){var a=this;if(isNaN(e)||isNaN(t))this.setState({showVendaAplicarDesconto:!0});else{var o=this.state.listaDocumentoProduto;o.forEach((function(o){var r=o.preco*o.quantidade,n=Math.round(t*(r/e)*100)/100,i=Math.round(n/o.quantidade*100)/100;o.descontounitario=i,a.calcularDocumentoProduto(o)}));for(var r=function(){var e=0;o.forEach((function(t){e+=t.descontounitario*t.quantidade}));var a=t-e;return a=Math.round(100*a)/100},n=0,i=r();0!==i&&n++<20;){var s=Math.round(Math.random()*(o.length-1)),c=o[s],u=c.descontounitario,l=u*c.quantidade+i;u=Math.round(l/c.quantidade*100)/100,c.descontounitario=u,this.calcularDocumentoProduto(c),i=r()}this.setState({listaDocumentoProduto:o,showVendaAplicarDesconto:!1})}}},{key:"atualizarDocumentoProduto",value:function(e){var t=e.i,a=this.state.listaDocumentoProduto;a[t]=e,this.setState({listaDocumentoProduto:a})}},{key:"aumentarQuantidade",value:function(e){var t=e.i,a=this.state.listaDocumentoProduto;(e=a[t]).quantidade++,this.calcularDocumentoProduto(e),a[t]=e,this.setState({listaDocumentoProduto:a})}},{key:"calcularDocumentoProduto",value:function(e){e.totaldesconto=e.descontounitario*e.quantidade,e.totalacrescimo=e.acrescimounitario*e.quantidade,e.totalproduto=e.preco*e.quantidade-e.totaldesconto+e.totalacrescimo}},{key:"cancelarUltimaVenda",value:function(){this.setState({showVendaCancelarCupom:!0})}},{key:"cancelarVendaAtual",value:function(){var e=this;window.MessageBox.show({title:"Cancelamento de venda",text:"Tem certeza que deseja cancelar a venda atual?",buttons:[{text:"Sim",icon:"thumbs-up",color:"green",onClick:function(){window.MessageBox.hide(),e.setState({cpfcnpj:null,listaDocumentoProduto:[],listaDocumentoPagamento:[]})}},{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:function(){window.MessageBox.hide()}}]})}},{key:"carregarOrcamento",value:function(){var e=Object(n.a)(r.a.mark((function e(t){var a,o,n,i,s,c,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,window.Loading.show(),"SELECT iddocumento, cpfcnpj, nomeorcamento FROM documento WHERE operacao = $1 AND iddocumento = $2",e.next=5,this.Pool.query("SELECT iddocumento, cpfcnpj, nomeorcamento FROM documento WHERE operacao = $1 AND iddocumento = $2",["OR",t]);case 5:if(0!==(a=e.sent).rows.length){e.next=8;break}throw new Error("Or\xe7amento de n\xfamero <b>"+t+"</b> n\xe3o p\xf4de ser encontrado.");case 8:return o=a.rows[0],n=[],"SELECT * FROM documentoproduto WHERE iddocumento = $1",e.next=13,this.Pool.query("SELECT * FROM documentoproduto WHERE iddocumento = $1",[o.iddocumento]);case 13:i=e.sent,s=Object(me.a)(i.rows);try{for(s.s();!(c=s.n()).done;)u=c.value,n.push(this.criarObjetoDocumentoProduto({idproduto:u.idproduto,descricao:u.descricao,unidade:u.unidade,precisao:u.precisao,precovariavel:u.precovariavel,quantidade:u.quantidade,preco:u.preco,descontounitario:u.descontounitario,totaldesconto:u.totaldesconto,acrescimounitario:u.acrescimounitario,totalacrescimo:u.totalacrescimo,totalproduto:u.totalproduto}))}catch(r){s.e(r)}finally{s.f()}this.setState({operacao:"CU",cpfcnpj:o.cpfcnpj,nomeorcamento:o.nomeorcamento,listaDocumentoProduto:n,iddocumentoorcamento:t}),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),Object($.e)(e.t0);case 22:return e.prev=22,window.Loading.hide(),e.finish(22);case 25:case"end":return e.stop()}}),e,this,[[0,19,22,25]])})));return function(t){return e.apply(this,arguments)}}()},{key:"carregarTemporario",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object($.i)()+"/"+this.temporaryFileName,Vt.existsSync(t)&&(a=Vt.readFileSync(t),"object"===typeof(o=JSON.parse(a))&&this.setState(o));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.props.match.params.id?this.carregarOrcamento(this.props.match.params.id):this.carregarTemporario()}},{key:"componentWillUnmount",value:function(){this.Pool.end()}},{key:"componentWillUpdate",value:function(e,t){this.gravarTemporario(t)}},{key:"criarObjetoDocumentoProduto",value:function(e){return v.a.extend({idproduto:null,descricao:null,unidade:"Unidade",precisao:0,precovariavel:"N",quantidade:0,preco:0,descontounitario:0,totaldesconto:0,acrescimounitario:0,totalacrescimo:0,totalproduto:0},e)}},{key:"diminuirQuantidade",value:function(e){var t=e.i,a=this.state.listaDocumentoProduto;if((e=a[t]).quantidade-1<=0)return!0;e.quantidade--,this.calcularDocumentoProduto(e),a[t]=e,this.setState({listaDocumentoProduto:a})}},{key:"editarProduto",value:function(e){this.setState({documentoproduto:e,showEditarProduto:!0})}},{key:"finalizarDocumento",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,i,s,c,u,l,d,p,h,m,b,f,v,j,O,x,g,C,k,y,w,S,E,N,P,D,A,T,R,I,M=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.Loading.show(),e.next=3,this.Pool.connect();case 3:return t=e.sent,e.prev=4,e.next=7,t.query("BEGIN");case 7:return a=["INSERT INTO documento (operacao, modelo, cpfcnpj, nomeorcamento, totaltroco)","VALUES ($1, $2, $3, $4, $5)","RETURNING iddocumento"].join(" "),e.next=10,t.query(a,[this.state.operacao,"65",this.state.cpfcnpj,this.state.nomeorcamento,this.state.totaltroco]);case 10:o=e.sent,i=o.rows[0].iddocumento,s=[],c=Object(me.a)(this.state.listaDocumentoProduto);try{for(c.s();!(u=c.n()).done;)l=u.value,s.push(l.idproduto)}catch(q){c.e(q)}finally{c.f()}return d=["SELECT produto.idproduto, ncm.codigoncm, produto.origem,","  produto.csosn, produto.aliqicms, produto.cstpis, produto.aliqpis,","  produto.cstcofins, produto.aliqcofins, produto.codcontribsocial,","  produto.cest, produto.cfop","FROM produto","LEFT JOIN ncm USING (idncm)","WHERE idproduto IN ("+s.join(", ")+")"].join(" "),e.next=18,t.query(d);case 18:p=e.sent,h={},m=Object(me.a)(p.rows);try{for(m.s();!(b=m.n()).done;)f=b.value,v=f.idproduto,delete f.idproduto,h[v]=f}catch(q){m.e(q)}finally{m.f()}j=1,O=Object(me.a)(this.state.listaDocumentoProduto),e.prev=24,O.s();case 26:if((x=O.n()).done){e.next=34;break}return g=x.value,C=h[g.idproduto],k=["INSERT INTO documentoproduto (","  iddocumento, sequencial, idproduto,","  descricao, preco, quantidade,","  descontounitario, acrescimounitario, codigoncm,","  origem, csosn, aliqicms,","  cstpis, aliqpis, cstcofins,","  aliqcofins, codcontribsocial, cest,","  cfop",") VALUES (","  $1, $2, $3,","  $4, $5, $6,","  $7, $8, $9,","  $10, $11, $12,","  $13, $14, $15,","  $16, $17, $18,","  $19",")"].join(" "),e.next=32,t.query(k,[i,j++,g.idproduto,g.descricao,g.preco,g.quantidade,g.descontounitario,g.acrescimounitario,C.codigoncm,C.origem,C.csosn,C.aliqicms,C.cstpis,C.aliqpis,C.cstcofins,C.aliqcofins,C.codcontribsocial,C.cest,C.cfop]);case 32:e.next=26;break;case 34:e.next=39;break;case 36:e.prev=36,e.t0=e.catch(24),O.e(e.t0);case 39:return e.prev=39,O.f(),e.finish(39);case 42:if("CU"!==this.state.operacao){e.next=71;break}y=this.state.listaDocumentoPagamento,this.state.totaltroco>0&&(w=y.length-1,y[w].totalpagamento-=this.state.totaltroco),S=Object(me.a)(y),e.prev=46,S.s();case 48:if((E=S.n()).done){e.next=55;break}return N=E.value,P=["INSERT INTO documentopagamento (iddocumento, idformapagamento, totalpagamento)","VALUES ($1, $2, $3)"].join(" "),e.next=53,t.query(P,[i,N.idformapagamento,N.totalpagamento]);case 53:e.next=48;break;case 55:e.next=60;break;case 57:e.prev=57,e.t1=e.catch(46),S.e(e.t1);case 60:return e.prev=60,S.f(),e.finish(60);case 63:return D=new Nt(t),e.next=66,D.transmitirDocumento(i);case 66:if(!1!==(A=e.sent)){e.next=69;break}throw new Error(D.error);case 69:return e.next=71,t.query("UPDATE documento SET xml = $1, chave = $2, numero = $3 WHERE iddocumento = $4",[A.xml,A.chave,A.numero,i]);case 71:if(!this.state.iddocumentoorcamento){e.next=74;break}return e.next=74,t.query("DELETE FROM documento WHERE iddocumento = $1",[this.state.iddocumentoorcamento]);case 74:return e.next=76,t.query("COMMIT");case 76:if(!(this.state.totaltroco>0)){e.next=80;break}window.MessageBox.show({text:"<div class='text-center'><h5>Venda finalizada com sucesso!</h5><h3>Total de troco</h3><h1><small>R$</small>"+this.state.totaltroco.format(2,",",".")+"</h1></div>"}),e.next=87;break;case 80:e.t2=this.state.operacao,e.next="CU"===e.t2?83:"OR"===e.t2?85:83;break;case 83:return window.FastMessage.show("Venda finalizada com sucesso!"),e.abrupt("break",87);case 85:return window.FastMessage.show("Or\xe7amento finalizado com sucesso!"),e.abrupt("break",87);case 87:return e.t3=it.a,e.next=90,Object($.l)(this.Pool,"IMPRESSORA","NUMEROVIAS");case 90:return e.t4=e.sent,T=e.t3.parse.call(e.t3,e.t4),T="OR"===this.state.operacao?T.orcamento:T.venda,e.next=95,Object($.l)(this.Pool,"IMPRESSORA","CONFIRMACAO");case 95:if(e.t5=e.sent,"S"!==e.t5){e.next=100;break}window.MessageBox.show({title:"Imprimir cupom",text:"Deseja imprimir o cupom da venda realizada?",buttons:[{text:"Sim",color:"green",icon:"thumbs-up",onClick:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.MessageBox.hide(),t=1;case 2:if(!(t<=T)){e.next=9;break}return a=new Fe(M.Pool),e.next=6,a.imprimirDocumento(i);case 6:t++,e.next=2;break;case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{text:"N\xe3o",color:"red",icon:"thumbs-down",onClick:function(){window.MessageBox.hide()}}]}),e.next=108;break;case 100:R=1;case 101:if(!(R<=T)){e.next=108;break}return I=new Fe(this.Pool),e.next=105,I.imprimirDocumento(i);case 105:R++,e.next=101;break;case 108:this.reiniciar(),e.next=116;break;case 111:return e.prev=111,e.t6=e.catch(4),e.next=115,t.query("ROLLBACK");case 115:Object($.e)(e.t6);case 116:return e.prev=116,t.release(),window.Loading.hide(),e.finish(116);case 120:case"end":return e.stop()}}),e,this,[[4,111,116,120],[24,36,39,42],[46,57,60,63]])})));return function(){return e.apply(this,arguments)}}()},{key:"finalizarOrcamento",value:function(e,t){var a=this;this.setState({nomeorcamento:e,cpfcnpj:t,listaDocumentoPagamento:[],totaltroco:0,showVendaFinalizacaoOrcamento:!1},(function(){a.finalizarDocumento()}))}},{key:"finalizarVenda",value:function(e,t){var a=this;this.setState({listaDocumentoPagamento:e,totaltroco:t},(function(){a.finalizarDocumento()}))}},{key:"gravarTemporario",value:function(){var e=Object(n.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=void 0===t?this.state:t,Object($.m)(this.temporaryFileName,JSON.stringify(t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"incluirDezPorcento",value:function(){var e=this,t=this.state.listaDocumentoProduto;t.forEach((function(t){t.acrescimounitario=.1*t.preco,e.calcularDocumentoProduto(t)})),this.setState({listaDocumentoProduto:t})}},{key:"incluirProduto",value:function(e,t,a){var o=this;e=Object.assign({},e);var r=function(e){window.InformarValor.show({title:"Quantidade em "+e.unidade.toLowerCase()+"s",decimal:e.precisao,success:function(t){e.quantidade=t.toFloat(),o.incluirProdutoDefinitivo(e)}})};"S"===e.precovariavel?window.InformarValor.show({title:"Pre\xe7o do produto",money:!0,decimal:2,success:function(t){e.preco=t.toFloat(),e.precisao>0&&!a?r(e):o.incluirProdutoDefinitivo(e,a)}}):e.precisao>0&&!a?r(e):this.incluirProdutoDefinitivo(e,a)}},{key:"incluirProdutoDefinitivo",value:function(e,t){var a=this,o=this.state.listaDocumentoProduto;t?e.quantidade=t/e.preco:e.quantidade||(e.quantidade=1);var r=this.criarObjetoDocumentoProduto({idproduto:e.idproduto,descricao:e.descricao,unidade:e.unidade,precisao:e.precisao,precovariavel:e.precovariavel,quantidade:e.quantidade,preco:e.preco});this.calcularDocumentoProduto(r);var n=!1;if(o.forEach((function(e){if(n)return!1;var t=Object.assign({},r),o=Object.assign({},e);delete t.quantidade,delete o.quantidade,delete t.totalproduto,delete o.totalproduto,delete o.i,JSON.stringify(t)===JSON.stringify(o)&&(e.quantidade+=r.quantidade,a.calcularDocumentoProduto(e),n=!0)})),0===parseFloat(r.preco))return window.MessageBox.show({title:"Produto sem pre\xe7o",text:"O pre\xe7o do produto precisa ser maior que zero."}),!1;n||o.push(r),this.setState({listaDocumentoProduto:o,pesquisa:"",pesquisaEfetiva:""})}},{key:"informarCPF",value:function(){var e=this;window.InformarValor.show({title:"Informe o CPF ou CNPJ",mask:"99999999999999",success:function(t){var a=null;if(11===t.length&&Object($.k)(t))a=t.substr(0,3)+"."+t.substr(3,3)+"."+t.substr(6,3)+"-"+t.substr(9,2);else if(14===t.length&&Object($.j)(t))a=t.substr(0,2)+"."+t.substr(2,3)+"."+t.substr(5,3)+"/"+t.substr(8,4)+"-"+t.substr(12,2);else if(t.length>0)return window.MessageBox.show({title:"CPF ou CNPJ inv\xe1lido",text:"O CPF ou CNPJ informado \xe9 inv\xe1lido.<br>Por favor, digite novamente.",buttons:[{text:"Ok",icon:"thumbs-up",color:"blue",onClick:function(){window.MessageBox.hide(),e.informarCPF()}}]}),!1;e.setState({cpfcnpj:a})},fail:function(){e.setState({cpfcnpj:null})}})}},{key:"onChangePesquisa",value:function(e){this.setState({pesquisa:e.target.value})}},{key:"onClickBuscar",value:function(){this.setState({pesquisaEfetiva:this.state.pesquisa})}},{key:"onKeyUpPesquisa",value:function(e){13===e.keyCode&&this.onClickBuscar()}},{key:"pesquisaLimpar",value:function(){this.setState({pesquisa:"",pesquisaEfetiva:""})}},{key:"reimprimirCupom",value:function(){this.setState({showVendaReimprimirCupom:!0})}},{key:"reiniciar",value:function(){var e=this.criarObjetoDocumentoProduto();this.setState({documentoproduto:e,listaDocumentoProduto:[],listaDocumentoPagamento:[],cpfcnpj:null,nomeorcamento:null,iddocumentoorcamento:null,pesquisa:"",pesquisaEfetiva:"",showEditarProduto:!1,showVendaFinalizacao:!1,showVendaFinalizacaoOrcamento:!1,showVendaAplicarDesconto:!1,showVendaAplicarAcrescimo:!1})}},{key:"removerProduto",value:function(e){var t=this,a="R$ "+e.totalproduto.format(2,",",".");window.MessageBox.show({text:"Tem certeza que deseja remover o produto?<br><br>"+e.descricao+"<span class='float-right'>"+a+"</span>",buttons:[{text:"Sim",icon:"thumbs-up",color:"green",onClick:function(){window.MessageBox.hide();var a=t.state.listaDocumentoProduto;a.splice(e.i,1),t.setState({listaDocumentoProduto:a})}},{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:function(){window.MessageBox.hide()}}]})}},{key:"trocarOperacao",value:function(e){this.setState({operacao:e})}},{key:"render",value:function(){var e=this,t=0,a=0,o=0;this.state.listaDocumentoProduto.forEach((function(e){t+=parseFloat(e.preco*e.quantidade),a+=parseFloat(e.totaldesconto),o+=parseFloat(e.totalproduto)}));var r="operacao-"+this.state.operacao;return Object(C.jsxs)(Y,{className:r,children:[Object(C.jsxs)(q,{children:[Object(C.jsxs)(R,{size:"7",children:[Object(C.jsxs)(q,{className:"mb-4 mt-4",children:[Object(C.jsxs)(R,{size:"9",children:[Object(C.jsx)(ie,{type:"search",id:"pesquisa",value:this.state.pesquisa,placeholder:"Pesquise um produto...",onKeyUp:this.onKeyUpPesquisa,onChange:this.onChangePesquisa}),Object(C.jsx)(k,{name:"cross",id:"pesquisa-limpar",onClick:this.pesquisaLimpar,className:this.state.pesquisa.length>0?null:"d-none"})]}),Object(C.jsx)(R,{size:"3",className:"pl-0",children:Object(C.jsx)(T,{text:"Buscar",icon:"search",color:"green",block:!0,onClick:this.onClickBuscar})})]}),Object(C.jsx)(jt,{Pool:this.Pool,pesquisa:this.state.pesquisaEfetiva,onSelectProduto:this.incluirProduto})]}),Object(C.jsx)(R,{size:"5",className:"pr-0",children:Object(C.jsx)(Dt,{abrirFinalizacao:this.abrirFinalizacao,aumentarQuantidade:this.aumentarQuantidade,cancelarUltimaVenda:this.cancelarUltimaVenda,cancelarVendaAtual:this.cancelarVendaAtual,carregarOrcamento:this.carregarOrcamento,reimprimirCupom:this.reimprimirCupom,cpfcnpj:this.state.cpfcnpj,diminuirQuantidade:this.diminuirQuantidade,editarProduto:this.editarProduto,informarCPF:this.informarCPF,listaDocumentoProduto:this.state.listaDocumentoProduto,operacao:this.state.operacao,removerProduto:this.removerProduto,trocarOperacao:this.trocarOperacao})})]}),Object(C.jsx)(Mt,{show:this.state.showEditarProduto,documentoproduto:this.state.documentoproduto,atualizarDocumentoProduto:this.atualizarDocumentoProduto,beforeClose:function(){e.setState({showEditarProduto:!1})}}),Object(C.jsx)(Lt,{Pool:this.Pool,show:this.state.showVendaFinalizacao,totaldocumento:o,aplicarAcrescimo:this.aplicarAcrescimo,aplicarDesconto:this.aplicarDesconto,incluirDezPorcento:this.incluirDezPorcento,finalizarVenda:this.finalizarVenda,listaDocumentoPagamento:this.state.listaDocumentoPagamento,beforeClose:function(){e.setState({showVendaFinalizacao:!1})}}),Object(C.jsx)(zt,{nomeorcamento:this.state.nomeorcamento,cpfcnpj:this.state.cpfcnpj,finalizarOrcamento:this.finalizarOrcamento,show:this.state.showVendaFinalizacaoOrcamento,beforeClose:function(){e.setState({showVendaFinalizacaoOrcamento:!1})}}),Object(C.jsx)(xt,{totalbruto:t,show:this.state.showVendaAplicarDesconto,aplicarDesconto:this.aplicarDesconto,beforeClose:function(){e.setState({showVendaAplicarDesconto:!1})}}),Object(C.jsx)(Ot,{totalbruto:t,totaldesconto:a,show:this.state.showVendaAplicarAcrescimo,aplicarAcrescimo:this.aplicarAcrescimo,beforeClose:function(){e.setState({showVendaAplicarAcrescimo:!1})}}),Object(C.jsx)(Pt,{Pool:this.Pool,show:this.state.showVendaCancelarCupom,beforeClose:function(){e.setState({showVendaCancelarCupom:!1})}}),Object(C.jsx)(Ut,{Pool:this.Pool,show:this.state.showVendaReimprimirCupom,beforeClose:function(){e.setState({showVendaReimprimirCupom:!1})}})]})}}]),a}(d.a.Component),_t=function(){function e(t,a){Object(i.a)(this,e),this.Pool=t,this.referencia=a,this.dthrinicial=Object($.c)()}return Object(s.a)(e,[{key:"atualizarProcesso",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"UPDATE processo SET dthrinicial = $2, dthrfinal = $3 WHERE referencia = $1",t=[this.referencia,this.dthrinicial,Object($.c)()],e.next=4,this.Pool.query("UPDATE processo SET dthrinicial = $2, dthrfinal = $3 WHERE referencia = $1",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"verificarIntervalo",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dthrinicial=Object($.c)(),e.next=3,this.Pool.query("SELECT status, dthrinicial, intervalo FROM processo WHERE referencia = $1",[this.referencia]);case 3:if(t=e.sent,"A"===(a=t.rows[0]).status){e.next=7;break}return e.abrupt("return",!1);case 7:if(null!==a.dthrinicial){e.next=9;break}return e.abrupt("return",!0);case 9:if(!(Date.now()>=a.dthrinicial.getTime()+6e4*a.intervalo)){e.next=13;break}return e.abrupt("return",!0);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),$t=window.require("fs"),Ht=window.require("os"),Wt=window.require("ftp"),Gt=window.require("child_process"),Yt=function(){function e(t){Object(i.a)(this,e),this.Pool=t,this.interval=null,this.running=!1,window.ProcessoAutomatico=this,this.executandoBackup=!1}return Object(s.a)(e,[{key:"iniciar",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.interval=setInterval(Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.executar();case 1:case"end":return e.stop()}}),e)}))),6e4),setTimeout(Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.executar();case 1:case"end":return e.stop()}}),e)}))),1e4);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pausar",value:function(){clearInterval(this.interval)}},{key:"executar",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.running){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,this.running=!0,e.next=6,this.executarRefreshView();case 6:return e.next=8,this.executarVerificarDtVerificacao();case 8:return e.next=10,this.executarVerificarTerminal();case 10:if(Object($.f)()){e.next=13;break}return e.next=13,this.executarBackup();case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(2),e.t0;case 18:return e.prev=18,this.running=!1,e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"executarBackup",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n,i,s,c,u,l,d,p,h,m,b,f,v=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.executandoBackup){e.next=2;break}return e.abrupt("return");case 2:return t=new _t(this.Pool,"BACKUP"),e.next=5,t.verificarIntervalo();case 5:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:if(void 0===this.fs&&(this.fs=$t),void 0===this.os&&(this.os=Ht),void 0===this.ftp&&(this.ftp=Wt),void 0===this.childProcess&&(this.childProcess=Gt),"darwin"!==this.os.platform()){e.next=13;break}return e.abrupt("return");case 13:return a=null,e.prev=14,e.next=17,Object($.l)(this.Pool,"BACKUP","HOST");case 17:return e.t0=e.sent,e.next=20,Object($.l)(this.Pool,"BACKUP","PORTA");case 20:return e.t1=e.sent,e.next=23,Object($.l)(this.Pool,"BACKUP","USUARIO");case 23:return e.t2=e.sent,e.next=26,Object($.l)(this.Pool,"BACKUP","SENHA");case 26:e.t3=e.sent,a={host:e.t0,port:e.t1,user:e.t2,password:e.t3},e.next=34;break;case 30:return e.prev=30,e.t4=e.catch(14),console.log("Erro ao efetuar backup: n\xe3o foi poss\xedvel carregar os par\xe2metros do FTP."),e.abrupt("return",!1);case 34:this.executandoBackup=!0,o=null,e.t5=this.os.platform(),e.next="win32"===e.t5?39:47;break;case 39:return o="C:/Program Files/PostgreSQL/14/bin/pg_dump.exe",this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/13/bin/pg_dump.exe"),this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/12/bin/pg_dump.exe"),this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/11/bin/pg_dump.exe"),this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/10/bin/pg_dump.exe"),this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/9.6/bin/pg_dump.exe"),this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/9.3/bin/pg_dump.exe"),e.abrupt("break",48);case 47:return e.abrupt("break",48);case 48:n=Object($.i)(),this.fs.existsSync(n)||this.fs.mkdirSync(n),i=this.fs.readdirSync(n),s=Object(me.a)(i);try{for(s.s();!(c=s.n()).done;)".backup"===(u=c.value).substr(-7)&&this.fs.unlinkSync(n+"/"+u)}catch(r){s.e(r)}finally{s.f()}if(l=new Date,d=l.getFullYear()+"-"+String(l.getMonth()+1).lpad(2,"0")+"-"+String(l.getDate()).lpad(2,"0")+"-"+String(l.getHours()).lpad(2,"0")+"-"+String(l.getMinutes()).lpad(2,"0")+"-"+String(l.getSeconds()).lpad(2,"0"),h='"'+o+'" -F c -b -w -U postgres -f "'+(p=n+"/"+d+".backup")+'" satflex',this.childProcess.execSync(h),void 0!==this.serialNumber){e.next=62;break}return e.next=61,Object($.g)();case 61:this.serialNumber=e.sent;case 62:m=p,b="/"+this.serialNumber+"/"+d+".backup",(f=new this.ftp).on("ready",(function(){f.cwd("/",(function(){f.mkdir(v.serialNumber,!0,(function(e){if(e)throw v.executandoBackup=!1,e;f.put(m,b,!1,(function(e){if(e)throw e;f.end(),t.atualizarProcesso(),v.executandoBackup=!1}))}))}))})).connect(a);case 66:case"end":return e.stop()}}),e,this,[[14,30]])})));return function(){return e.apply(this,arguments)}}()},{key:"executarRefreshView",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new _t(this.Pool,"REFRESH_VIEW"),e.next=3,t.verificarIntervalo();case 3:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:a=0,o=["v_vendaprodutodiario","v_vendapagamentodiario"];case 7:if(!(a<o.length)){e.next=14;break}return n=o[a],e.next=11,this.Pool.query("REFRESH MATERIALIZED VIEW "+n);case 11:a++,e.next=7;break;case 14:return e.next=16,t.atualizarProcesso();case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executarVerificarDtVerificacao",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new _t(this.Pool,"VERIFICAR_DTVERIFICACAO"),e.next=3,t.verificarIntervalo();case 3:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,Object($.l)(this.Pool,"SISTEMA","DTVERIFICACAO");case 7:return a=e.sent,o=new Date,(null===(a=null!==a&&a.length>0?new Date(a):null)||(o.getTime()-a.getTime())/864e5>10)&&("UPDATE parametro SET valor = $3 WHERE grupo = $1 AND nome = $2",this.Pool.query("UPDATE parametro SET valor = $3 WHERE grupo = $1 AND nome = $2",["SISTEMA","STATUS","0002"])),e.next=13,t.atualizarProcesso();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executarVerificarTerminal",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new _t(this.Pool,"VERIFICAR_TERMINAL"),e.next=3,t.verificarIntervalo();case 3:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:return this.servidor||(this.servidor=new H(this.Pool)),e.next=8,this.servidor.verificarTerminal();case 8:return!1===(a=e.sent)?console.log("Houve uma falha ao verificar o terminal no servidor."):(this.Pool.query("UPDATE parametro SET valor = $3 WHERE grupo = $1 AND nome = $2",["SISTEMA","STATUS",a]),o=(new Date).toISOString().substr(0,10),this.Pool.query("UPDATE parametro SET valor = $3 WHERE grupo = $1 AND nome = $2",["SISTEMA","DTVERIFICACAO",o])),e.next=12,t.atualizarProcesso();case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Qt=(a(423),a(424),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;return Object(i.a)(this,a),o=t.call(this,e),window.FastMessage=new N,window.InformarValor=new L,window.Loading=new U,window.MessageBox=new B,o.state={FastMessage:window.FastMessage,InformarValor:window.InformarValor,Loading:window.Loading,MessageBox:window.MessageBox},o.Pool=new G,o.processoAutomatico=new Yt(o.Pool),window.processoAutomatico=o.processoAutomatico,window.servidor=new H(o.Pool),o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.processoAutomatico.iniciar(),window.addEventListener("keydown",this.onKeyDown),this.verificarTerminal()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.onKeyDown)}},{key:"onKeyDown",value:function(e){e.ctrlKey&&73===e.keyCode&&window.require("electron").ipcRenderer.sendSync("open-dev-tools")}},{key:"verificarTerminal",value:function(){var e=Object(n.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object($.l)(this.Pool,"SISTEMA","STATUS");case 2:return t=e.sent,e.next=5,Object($.l)(this.Pool,"REVENDA","TELEFONE");case 5:a=e.sent,e.t0=t,e.next="0000"===e.t0?9:"0001"===e.t0?10:"0002"===e.t0?12:14;break;case 9:return e.abrupt("break",15);case 10:return window.MessageBox.show({title:"Terminal bloqueado",text:"Seu terminal foi bloqueado, para mais informa\xe7\xf5es, entre em contato com o suporte pelo n\xfamero <b>"+a+"</b>.",buttons:[{text:"Sair do SAT-Flex",color:"primary",onClick:function(){window.close()}}]}),e.abrupt("break",15);case 12:return window.MessageBox.show({title:"Terminal bloqueado",text:"Seu terminal foi bloqueado por falta de comunica\xe7\xe3o com a Internet. Verifique sua conex\xe3o com a Internet e tente novamente.<br> Caso o problema persista, entre em contato com o suporte pelo n\xfamero <b>"+a+"</b>.",buttons:[{text:"Sair do SAT-Flex",color:"primary",onClick:function(){window.close()}}]}),e.abrupt("break",15);case 14:return e.abrupt("break",15);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(C.jsxs)("div",{children:[Object(C.jsx)(m.a,{children:Object(C.jsx)(b.b,{path:"/",children:Object(C.jsxs)("div",{children:[Object(C.jsx)(y,{}),Object(C.jsxs)("div",{id:"viewContainer",children:[Object(C.jsx)(b.b,{exact:!0,path:"/",component:Bt}),Object(C.jsx)(b.b,{exact:!0,path:"/venda",component:Bt}),Object(C.jsx)(b.b,{exact:!0,path:"/venda/:id",component:Bt}),Object(C.jsx)(b.b,{path:"/categoria",component:he}),Object(C.jsx)(b.b,{path:"/configuracao",component:xe}),Object(C.jsx)(b.b,{path:"/contador",component:we}),Object(C.jsx)(b.b,{path:"/estatistica",component:Pe}),Object(C.jsx)(b.b,{path:"/fechamento",component:ze}),Object(C.jsx)(b.b,{path:"/ferramentas",component:Ge}),Object(C.jsx)(b.b,{path:"/parametro",component:Je}),Object(C.jsx)(b.b,{path:"/produto",component:Xe}),Object(C.jsx)(b.b,{path:"/relatorio",component:Ze}),Object(C.jsx)(b.b,{path:"/relorcamento",component:et}),Object(C.jsx)(b.b,{path:"/suporte",component:rt})]})]})})}),Object(C.jsx)(P,{FastMessageEmitter:this.state.FastMessage}),Object(C.jsx)(F,{InformarValorEmitter:this.state.InformarValor}),Object(C.jsx)(V,{LoadingEmitter:this.state.Loading}),Object(C.jsx)(_,{MessageBoxEmitter:this.state.MessageBox})]})}}]),a}(d.a.Component));h.a.render(Object(C.jsx)(Qt,{}),document.getElementById("root"))},9:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return d})),a.d(t,"c",(function(){return p})),a.d(t,"d",(function(){return h})),a.d(t,"e",(function(){return m})),a.d(t,"f",(function(){return b})),a.d(t,"g",(function(){return f})),a.d(t,"h",(function(){return j})),a.d(t,"i",(function(){return O})),a.d(t,"j",(function(){return x})),a.d(t,"k",(function(){return g})),a.d(t,"l",(function(){return C})),a.d(t,"m",(function(){return y}));var o=a(3),r=a.n(o),n=a(10),i=window.require("fs"),s=window.require("os"),c=(window.require("path"),window.require("child_process")),u=window.require("serial-number");function l(){return"C:/SAT-Flex/resources/app/"}function d(){return p().split("T")[0]}function p(){var e=6e4*(new Date).getTimezoneOffset();return new Date(Date.now()-e).toISOString()}function h(e){var t=String(e).split(".")[1];return void 0===t||0===t.length||0===parseInt(t,10)?0:3}function m(e){var t=null;void 0===e||null===e?t="Erro n\xe3o identificado.":"string"===typeof e?t=e:(t=e.message,console.log(e.stack)),window.MessageBox.show({title:"Houve uma falha",text:t})}function b(){return!1}function f(){return v.apply(this,arguments)}function v(){return(v=Object(n.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("win32"!==s.platform()){e.next=7;break}return"wmic diskdrive get SerialNumber",t=(t=c.execSync("wmic diskdrive get SerialNumber").toString()).trim().split(" ").splice(-1)[0].trim(),e.abrupt("return",t);case 7:return e.abrupt("return",new Promise((function(e){u((function(t,a){e(a)}))})));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return new Promise((function(t){return setTimeout(t,e)}))}function O(){return s.homedir()+"/SAT-Flex/"}function x(e){if(""===(e=e.replace(/[^\d]+/g,"")))return!1;if(14!==e.length)return!1;if("00000000000000"===e||"11111111111111"===e||"22222222222222"===e||"33333333333333"===e||"44444444444444"===e||"55555555555555"===e||"66666666666666"===e||"77777777777777"===e||"88888888888888"===e||"99999999999999"===e)return!1;for(var t=e.length-2,a=e.substring(0,t),o=e.substring(t),r=0,n=t-7,i=t;i>=1;i--)r+=a.charAt(t-i)*n--,n<2&&(n=9);var s=r%11<2?0:11-r%11;if(parseInt(s,10)!==parseInt(o.charAt(0),10))return!1;t+=1,a=e.substring(0,t),r=0,n=t-7;for(var c=t;c>=1;c--)r+=a.charAt(t-c)*n--,n<2&&(n=9);return s=r%11<2?0:11-r%11,parseInt(s,10)===parseInt(o.charAt(1),10)}function g(e){if(""===(e=e.replace(/[^\d]+/g,"")))return!1;if(11!==e.length||"00000000000"===e||"11111111111"===e||"22222222222"===e||"33333333333"===e||"44444444444"===e||"55555555555"===e||"66666666666"===e||"77777777777"===e||"88888888888"===e||"99999999999"===e)return!1;for(var t=0,a=0;a<9;a++)t+=parseInt(e.charAt(a),10)*(10-a);var o=11-t%11;if(10!==o&&11!==o||(o=0),parseInt(o,10)!==parseInt(e.charAt(9),10))return!1;t=0;for(var r=0;r<10;r++)t+=parseInt(e.charAt(r),10)*(11-r);return 10!==(o=11-t%11)&&11!==o||(o=0),parseInt(o,10)===parseInt(e.charAt(10),10)}function C(e,t,a,o){return k.apply(this,arguments)}function k(){return(k=Object(n.a)(r.a.mark((function e(t,a,o,n){var i,s,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.query("SELECT valor FROM parametro WHERE grupo = $1 AND nome = $2",[a,o]);case 2:if(i=e.sent,0!==(s=i.rows).length){e.next=7;break}return window.MessageBox.show({title:"Banco de dados desatualizado",text:"Seu banco de dados est\xe1 desatualizado para trabalhar com o aplicativo atual.<br>Atualize o banco de dados para continuar.<br>(Par\xe2metro n\xe3o encontrado: ".concat(a,", ").concat(o,")")}),e.abrupt("return",!1);case 7:return c=s[0].valor,"function"===typeof n&&n(c),e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e,t){var a=O();i.existsSync(a)||i.mkdirSync(a);var o=a+e,r=void 0;return".zip"===e.substr(-4)&&(r="binary"),i.writeFileSync(o,t,r),o}}},[[425,1,2]]]);
//# sourceMappingURL=main.cbcb8fc6.chunk.js.map