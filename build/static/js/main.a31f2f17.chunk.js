(this.webpackJsonpsatflex=this.webpackJsonpsatflex||[]).push([[0],{159:function(t,e){},182:function(t,e,a){},184:function(t,e,a){},188:function(t,e,a){},189:function(t,e,a){},190:function(t,e,a){},191:function(t,e,a){},192:function(t,e,a){},193:function(t,e,a){},195:function(t,e,a){},302:function(t,e,a){},312:function(t,e,a){},313:function(t,e,a){},314:function(t,e,a){},315:function(t,e,a){},316:function(t,e,a){},322:function(t,e){},324:function(t,e){},347:function(t,e){},349:function(t,e,a){},370:function(t,e,a){},379:function(t,e,a){},384:function(t,e){},385:function(t,e){},389:function(t,e,a){},390:function(t,e,a){},391:function(t,e,a){},392:function(t,e,a){},393:function(t,e,a){},394:function(t,e,a){},395:function(t,e,a){},396:function(t,e,a){},397:function(t,e,a){},398:function(t,e,a){},399:function(t,e,a){},400:function(t,e,a){},401:function(t,e,a){},402:function(t,e){Number.prototype.format=function(t,e,a){var o=this;t=isNaN(t=Math.abs(t))?2:t,e=void 0===e?",":e,a=void 0===a?".":a;var r=o<0?"-":"",n=String(parseInt(o=Math.abs(+o||0).toFixed(t),10)),i=n.length>3?n.length%3:0;return r+(i?n.substr(0,i)+a:"")+n.substr(i).replace(/(\d{3})(?=\d)/g,"$1"+a)+(t?e+Math.abs(o-n).toFixed(t).slice(2):"")},Number.prototype.toFloat=function(){return this},String.prototype.byteList=function(t){return t.split("").map((function(t){return t.charCodeAt(0)}))},String.prototype.cpad=function(t,e){for(var a=this,o=0;a.length<t;)o++%2===0?a+=e:a=e+a;return String(a)},String.prototype.format=function(t,e,a){return this.toFloat().format(t,e,a)},String.prototype.lpad=function(t,e){for(var a=this;a.length<t;)a=e+a;return String(a)},String.prototype.removeFormat=function(){var t=this;return[" ",".",",","-","/","\\","(",")"].forEach((function(e){t=t.replaceAll(e,"")})),t},String.prototype.removeSpecial=function(){for(var t=["\xe1","\xe0","\xe3","\xe2","\xe9","\xe8","\xea","\xed","\xec","\xee","\xf3","\xf2","\xf5","\xf4","\xfa","\xf9","\xfb","\xfc","\xe7","\xc1","\xc0","\xc3","\xc2","\xc9","\xc8","\xca","\xcd","\xcc","\xce","\xd3","\xd2","\xd5","\xd4","\xda","\xd9","\xdb","\xdc","\xc7","\xaa","\xba"],e=["a","a","a","a","e","e","e","i","i","i","o","o","o","o","u","u","u","u","c","A","A","A","A","E","E","E","I","I","I","O","O","O","O","U","U","U","U","C","a","o"],a=this,o=0;o<t.length;o++)a=a.replaceAll(t[o],e[o]);return a},String.prototype.replaceAll=function(t,e){return this.split(t).join(e)},String.prototype.rpad=function(t,e){for(var a=this;a.length<t;)a+=e;return String(a)},String.prototype.toFloat=function(){var t=this;return-1===t.indexOf(".")&&t.indexOf(",")>-1?t=t.replace(",","."):t.indexOf(".")>-1&&t.indexOf(",")>-1&&(t.indexOf(".")<t.indexOf(",")?t=t.replace(".","").replace(",","."):t.indexOf(".")>t.indexOf(",")&&(t=t.replace(",",""))),parseFloat(t)}},403:function(t,e,a){},404:function(t,e,a){},405:function(t,e,a){},406:function(t,e,a){"use strict";a.r(e);var o=a(3),r=a.n(o),n=a(9),i=a(4),s=a(5),c=a(7),u=a(6),l=a(1),d=a.n(l),p=a(17),h=a.n(p),m=a(64),b=a(15),f=a(8),v=a.n(f);window.jQuery=window.$=f;var j=a(160);window.Tether=j.a;var x=a(100);window.Popper=x.default;a(180),a(181);var O=a(2),g=a(13),C=(a(182),a(0)),k=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=["icon","mif-"+this.props.name];this.props.className&&t.push(this.props.className);var e={};return this.props.onClick&&(e.cursor="pointer"),Object(C.jsx)("span",Object(g.a)(Object(g.a)({},this.props),{},{className:t.join(" "),style:e}))}}]),a}(d.a.Component),y=(a(184),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsx)("div",{id:"menu",children:Object(C.jsx)(w,{})})}}]),a}(d.a.Component)),w=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={activeItem:"Vender"},o.changeActiveItem=o.changeActiveItem.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"changeActiveItem",value:function(t){this.setState({activeItem:t})}},{key:"listItem",value:function(){return[{text:"Vender",icon:"shop",link:"/"},{text:"Cadastros",icon:"stack",link:"/produto",active:!1},{text:"Relat\xf3rios",icon:"chart-line",link:"/relatorio",active:!1},{text:"Contador",icon:"suitcase",link:"/contador",active:!1},{text:"Configura\xe7\xf5es",icon:"cogs",link:"/configuracao",active:!1},{text:"Suporte",icon:"help",link:"/suporte",active:!1},{text:"Sair",icon:"exit",active:!1,action:function(){window.MessageBox.show({title:"Sair do SAT-Flex",text:"Voc\xea tem certeza que deseja encerrar o SAT-Flex agora?",buttons:[{text:"Sim",color:"green",icon:"thumbs-up",onClick:function(){window.close()}},{text:"N\xe3o",color:"red",icon:"thumbs-down",onClick:function(){window.MessageBox.hide()}}]})}}]}},{key:"render",value:function(){var t=this;return Object(C.jsx)("div",{className:"menu-list",children:Object(C.jsx)("ul",{children:this.listItem().map((function(e,a){return Object(C.jsx)(S,{pKey:a,item:e,activeItem:t.state.activeItem,changeActiveItem:t.changeActiveItem},a)}))})})}}]),a}(d.a.Component),S=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).onClick=o.onClick.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"onClick",value:function(){this.props.item.link&&this.props.changeActiveItem(this.props.item.text),this.props.item.action&&this.props.item.action()}},{key:"render",value:function(){var t=null;return this.props.activeItem===this.props.item.text&&(t="active"),this.props.item.link?Object(C.jsxs)(m.b,{to:this.props.item.link,onClick:this.onClick,className:t,children:[Object(C.jsx)(k,{name:this.props.item.icon}),Object(C.jsx)("span",{children:this.props.item.text})]}):Object(C.jsxs)("a",{onClick:this.onClick,className:t,children:[Object(C.jsx)(k,{name:this.props.item.icon}),Object(C.jsx)("span",{children:this.props.item.text})]})}}]),a}(d.a.Component),E=a(24),N=(a(188),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){var t;return Object(i.a)(this,a),(t=e.call(this)).data={icon:null,text:null,visible:!1},t}return Object(s.a)(a,[{key:"addChangeListener",value:function(t){this.on("change",t)}},{key:"commitChange",value:function(){this.emit("change")}},{key:"getData",value:function(){return Object.assign({},this.data)}},{key:"getElement",value:function(){return void 0===this.element&&(this.element=v()("#FastMessage").get(0)),this.element}},{key:"removeChangeListener",value:function(t){this.removeListener("change",t)}},{key:"hide",value:function(){this.data.visible=!1,this.commitChange()}},{key:"show",value:function(t){"string"===typeof t&&(t={text:t}),t=v.a.extend({icon:null,text:null,visible:!0},t),this.data=v.a.extend(this.data,t),this.commitChange()}}]),a}(E.EventEmitter)),P=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).animateHide=o.animateHide.bind(Object(O.a)(o)),o.animateShow=o.animateShow.bind(Object(O.a)(o)),o.onChangeData=o.onChangeData.bind(Object(O.a)(o)),o.onDocumentClick=o.onDocumentClick.bind(Object(O.a)(o)),o.state=t.FastMessageEmitter.getData(),o}return Object(s.a)(a,[{key:"animateHide",value:function(){var t=this;if(!this.state.visible)return!0;v()(this.element).stop().animate({opacity:0,top:window.innerHeight},180,(function(){t.setState({visible:!1})}))}},{key:"animateShow",value:function(){var t=this;v()(this.element).show();var e=0,a=[{progress:0,opacity:0,top:0},{progress:.05,opacity:1,top:.3},{progress:.95,opacity:1,top:.35},{progress:1,opacity:0,top:1}];!function o(){var r=a.shift(),n=3e3*r.progress-e;e+=n,v()(t.element).stop().animate({opacity:r.opacity,top:window.innerHeight*r.top},n,(function(){a.length>0?o():t.setState({visible:!1})}))}()}},{key:"componentDidMount",value:function(){this.element=this.props.FastMessageEmitter.getElement(),this.props.FastMessageEmitter.addChangeListener(this.onChangeData),document.addEventListener("click",this.onDocumentClick)}},{key:"componentWillUnmount",value:function(){this.props.FastMessageEmitter.removeChangeListener(this.onChangeData),document.removeEventListener("click",this.onDocumentClick)}},{key:"onChangeData",value:function(){var t=this.props.FastMessageEmitter.getData();t.visible!==this.state.visible&&(t.visible?this.animateShow():this.animateHide()),this.setState(t)}},{key:"onDocumentClick",value:function(){this.state.visible&&this.animateHide()}},{key:"render",value:function(){return Object(C.jsxs)("div",{id:"FastMessage",children:[this.state.icon?Object(C.jsx)(k,{name:this.state.icon}):null,Object(C.jsx)("span",{children:this.state.text})]})}}]),a}(d.a.Component),D=a(162),A=a.n(D),T=(a(189),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=null;if(this.props.icon)if(this.props.text){var e="lg"===this.props.size?"3":"2";if("right"===this.props.iconPosition)t=[Object(C.jsx)("span",{className:"mr-2",dangerouslySetInnerHTML:{__html:this.props.text}},"0"),Object(C.jsx)(k,{name:this.props.icon},"1")];else t=[Object(C.jsx)(k,{name:this.props.icon},"0"),Object(C.jsx)("span",{className:"ml-"+e,dangerouslySetInnerHTML:{__html:this.props.text}},"1")]}else t=Object(C.jsx)(k,{name:this.props.icon});else t=Object(C.jsx)("span",{dangerouslySetInnerHTML:{__html:this.props.text}});var a=["btn","btn-primary","btn-"+this.props.size,"btn-color-"+this.props.color];return this.props.className&&a.push(this.props.className),this.props.active&&a.push("active"),this.props.block&&a.push("btn-block"),Object(C.jsx)("button",{className:a.join(" "),onClick:this.props.onClick,disabled:this.props.disabled,children:t})}}]),a}(d.a.Component));T.defaultProps={active:!1,block:!1,disabled:!1,iconPosition:"left",size:"md",color:"blue"};var R=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=["col-"+(void 0===this.props.size?1:this.props.size)];this.props.className&&t.push(this.props.className),this.props.offset&&t.push("offset-"+this.props.offset);var e=null;return this.props.labelMargin&&(e=Object(C.jsx)("label",{children:"\xa0"})),Object(C.jsxs)("div",{className:t.join(" "),children:[e,this.props.children]})}}]),a}(d.a.Component),I=(a(190),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var t=this;this.element=h.a.findDOMNode(this),v()(this.element).on("show.bs.modal",this.props.beforeOpen),v()(this.element).on("shown.bs.modal",this.props.afterOpen),v()(this.element).on("hide.bs.modal",this.props.beforeClose),v()(this.element).on("hidden.bs.modal",this.props.afterClose),v()(this.element).on("show.bs.modal",(function(){var e=1040+10*v()(".modal:visible").length;v()(t.element).css("z-index",e),setTimeout((function(){v()(".modal-backdrop").not(".modal-stack").css("z-index",e-1).addClass("modal-stack")}),0)}))}},{key:"componentWillReceiveProps",value:function(t){t.show!==this.props.show&&(t.show?v()(this.element).modal("show"):v()(this.element).modal("hide"))}},{key:"shouldComponentUpdate",value:function(t){return t.size!==this.props.size||t.title!==this.props.title||t.children!==this.props.children}},{key:"render",value:function(){return Object(C.jsx)("div",{id:this.props.id,className:"modal fade","data-backdrop":!!this.props.closeOnOutClick||"static",children:Object(C.jsx)("div",{className:"modal-dialog modal-"+this.props.size,children:Object(C.jsxs)("div",{className:"modal-content",children:[Object(C.jsx)("div",{className:"modal-header",children:this.props.title}),Object(C.jsx)("div",{className:"modal-body",children:this.props.children})]})})})}}]),a}(d.a.Component));I.defaultProps={closeOnOutClick:!0,id:null,size:"md",title:null};var M=I,q=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=["row"];this.props.className&&t.push(this.props.className);var e=Object.assign({},this.props);return delete e.className,Object(C.jsx)("div",Object(g.a)(Object(g.a)({},e),{},{className:t.join(" "),children:this.props.children}))}}]),a}(d.a.Component),L=(a(191),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){var t;return Object(i.a)(this,a),(t=e.call(this)).data={decimal:0,mask:null,money:!1,title:null,value:"",visible:!1,success:function(){},fail:function(){}},t.lastHide=(new Date).getTime(),t}return Object(s.a)(a,[{key:"addChangeListener",value:function(t){this.on("change",t)}},{key:"commitChange",value:function(){this.emit("change")}},{key:"getData",value:function(){return Object.assign({},this.data)}},{key:"getElement",value:function(){return void 0===this.element&&(this.element=v()("#informarvalor").get(0)),this.element}},{key:"removeChangeListener",value:function(t){this.removeListener("change",t)}},{key:"hide",value:function(){this.lastHide=(new Date).getTime(),this.data.visible=!1,this.commitChange()}},{key:"show",value:function(t){var e=this;t=v.a.extend({decimal:0,mask:null,money:!1,title:"Informe o valor",value:"",visible:!0,success:function(){},fail:function(){}},t);var a=0,o=(new Date).getTime()-this.lastHide;o<750&&(a=750-o),setTimeout((function(){e.data=v.a.extend(e.data,t),e.commitChange()}),a)}}]),a}(E.EventEmitter)),F=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={decimal:0,mask:null,money:!1,title:null,value:"",visible:!1,success:function(){},fail:function(){}},o.backspace=o.backspace.bind(Object(O.a)(o)),o.beforeClose=o.beforeClose.bind(Object(O.a)(o)),o.beforeOpen=o.beforeOpen.bind(Object(O.a)(o)),o.cancelar=o.cancelar.bind(Object(O.a)(o)),o.confirmar=o.confirmar.bind(Object(O.a)(o)),o.drawButton=o.drawButton.bind(Object(O.a)(o)),o.onChangeData=o.onChangeData.bind(Object(O.a)(o)),o.pressNumber=o.pressNumber.bind(Object(O.a)(o)),o.valorKeyDown=o.valorKeyDown.bind(Object(O.a)(o)),o.valorKeyUp=o.valorKeyUp.bind(Object(O.a)(o)),o.pristine=!0,o.visible=!1,o.StringMask=A.a,o}return Object(s.a)(a,[{key:"afterOpen",value:function(){v()("#informarvalor-valor").focus()}},{key:"backspace",value:function(){var t=v()("#informarvalor-valor").val();v()("#informarvalor-valor").val(t.substr(0,t.length-1)),this.valorKeyUp()}},{key:"beforeClose",value:function(){this.visible=!1}},{key:"beforeOpen",value:function(){this.visible=!0}},{key:"cancelar",value:function(){window.InformarValor.hide(),this.state.fail()}},{key:"confirmar",value:function(){window.InformarValor.hide();var t=v()("#informarvalor-valor").val();t="string"===typeof this.state.mask?this.maskedValue(t):(t/=Math.pow(10,this.state.decimal)).format(this.state.decimal,",","."),this.state.success(t)}},{key:"componentDidMount",value:function(){var t=this;this.props.InformarValorEmitter.addChangeListener(this.onChangeData),this.element=this.props.InformarValorEmitter.getElement(),document.addEventListener("keyup",(function(e){if(t.visible)switch(e.keyCode){case 8:return void t.backspace();case 48:return void t.pressNumber(0);case 49:return void t.pressNumber(1);case 50:return void t.pressNumber(2);case 51:return void t.pressNumber(3);case 52:return void t.pressNumber(4);case 53:return void t.pressNumber(5);case 54:return void t.pressNumber(6);case 55:return void t.pressNumber(7);case 56:return void t.pressNumber(8);case 57:return void t.pressNumber(9);case 96:return void t.pressNumber(0);case 97:return void t.pressNumber(1);case 98:return void t.pressNumber(2);case 99:return void t.pressNumber(3);case 100:return void t.pressNumber(4);case 101:return void t.pressNumber(5);case 102:return void t.pressNumber(6);case 103:return void t.pressNumber(7);case 104:return void t.pressNumber(8);case 105:return void t.pressNumber(9);default:return}}))}},{key:"componentWillUnmount",value:function(){this.props.InformarValorEmitter.removeChangeListener(this.onChangeData)}},{key:"drawButton",value:function(t,e){var a=this;return Object(C.jsx)(R,{size:"4",children:Object(C.jsx)(T,{text:t,block:!0,color:"blue",onClick:function(){a.pressNumber(t)}})},e)}},{key:"maskedValue",value:function(t){return new this.StringMask(this.state.mask).apply(t)}},{key:"onChangeData",value:function(){var t=this,e=this.props.InformarValorEmitter.getData();e.visible?v()(this.element).modal("show"):v()(this.element).modal("hide"),void 0!==e.value&&e.value.length>0&&(e.value=e.value.toFloat().format(e.decimal,"","")),this.setState(e,(function(){t.pristine=!1,v()("#informarvalor-valor").val(e.value),t.valorKeyUp(),t.pristine=!0}))}},{key:"pressNumber",value:function(t){v()("#informarvalor-valor").val(v()("#informarvalor-valor").val()+t),this.valorKeyUp()}},{key:"valorKeyDown",value:function(t){if(-1===[8,13,27,48,49,50,51,52,53,54,55,56,57].indexOf(t.keyCode))return!1;13===t.keyCode&&this.confirmar()}},{key:"valorKeyUp",value:function(){this.pristine&&(this.pristine=!1,v()("#informarvalor-valor").val(v()("#informarvalor-valor").val().substr(-1)));var t=v()("#informarvalor-valor").val();"string"===typeof this.state.mask?t=this.maskedValue(t):(0===t.length&&v()("#informarvalor-valor").val(0),t=(t/=Math.pow(10,this.state.decimal)).format(this.state.decimal,",",".")),v()("#informarvalor-display").html(t),this.verificarTamanho(),t.length>0?v()("#informarvalor-backspace").show():v()("#informarvalor-backspace").hide(),v()("#informarvalor-valor").focus()}},{key:"verificarTamanho",value:function(){v()("#informarvalor-display").text().length<10?v()("#informarvalor-display").removeClass("informarvalor-display-sm"):v()("#informarvalor-display").addClass("informarvalor-display-sm")}},{key:"render",value:function(){var t=this.state.money?"informarvalor-display-money":"";return Object(C.jsxs)(M,{id:"informarvalor",size:"sm",title:this.state.title,afterOpen:this.afterOpen,beforeOpen:this.beforeOpen,beforeClose:this.beforeClose,children:[Object(C.jsx)("input",{type:"text",id:"informarvalor-valor",readOnly:!0,onKeyDown:this.valorKeyDown,onKeyUp:this.valorKeyUp}),Object(C.jsxs)("div",{id:"informarvalor-display-parent",children:[Object(C.jsx)("div",{id:"informarvalor-display",className:t}),Object(C.jsx)(k,{id:"informarvalor-backspace",name:"chevron-left",onClick:this.backspace})]}),Object(C.jsxs)(q,{id:"informarvalor-keyboard",children:[[7,8,9,4,5,6,1,2,3].map(this.drawButton),Object(C.jsx)(R,{size:"4",children:Object(C.jsx)(T,{icon:"cross",block:!0,color:"red",onClick:this.cancelar})}),this.drawButton(0),Object(C.jsx)(R,{size:"4",children:Object(C.jsx)(T,{icon:"checkmark",block:!0,color:"green",onClick:this.confirmar})})]})]})}}]),a}(d.a.Component),z=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=Math.round(this.props.value)+"%",e=null;switch(this.props.color){case"green":e="bg-success";break;case"yellow":e="bg-warning";break;case"red":e="bg-danger";break;default:e="bg-primary"}var a="progress";return this.props.className&&(a+=" "+this.props.className),Object(C.jsx)("div",{className:a,children:Object(C.jsx)("div",{className:"progress-bar progress-bar-striped progress-bar-animated "+e,style:{width:t},children:t})})}}]),a}(d.a.Component),U=(a(192),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){var t;return Object(i.a)(this,a),(t=e.call(this)).data={visible:!1,progress:null},t}return Object(s.a)(a,[{key:"addChangeListener",value:function(t){this.on("change",t)}},{key:"commitChange",value:function(){this.emit("change")}},{key:"getData",value:function(){return Object.assign({},this.data)}},{key:"getElement",value:function(){return void 0===this.element&&(this.element=v()("#Loading").get(0)),this.element}},{key:"removeChangeListener",value:function(t){this.removeListener("change",t)}},{key:"hide",value:function(){var t=Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.data.visible=!1,this.commitChange();case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"show",value:function(){var t=Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.data.visible=!0,this.data.progress=null,this.commitChange();case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"progress",value:function(){var t=Object(n.a)(r.a.mark((function t(e){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.data.progress=e,this.commitChange();case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),a}(E.EventEmitter)),V=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).onChangeData=o.onChangeData.bind(Object(O.a)(o)),o.state=t.LoadingEmitter.getData(),o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.element=this.props.LoadingEmitter.getElement(),this.props.LoadingEmitter.addChangeListener(this.onChangeData)}},{key:"componentWillUnmount",value:function(){this.props.LoadingEmitter.removeChangeListener(this.onChangeData)}},{key:"onChangeData",value:function(){var t=this.props.LoadingEmitter.getData();this.setState(t)}},{key:"render",value:function(){return this.state.visible?Object(C.jsxs)("div",{className:"Loading",children:[Object(C.jsx)("div",{className:"Loading-Spinner"}),Object(C.jsx)(z,{value:this.state.progress,color:"green",className:null===this.state.progress?"d-none":null})]}):null}}]),a}(d.a.Component),B=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){var t;return Object(i.a)(this,a),(t=e.call(this)).data={buttons:[],focusOnClose:null,size:"md",text:null,title:null,visible:!1},t.lastHide=(new Date).getTime(),t}return Object(s.a)(a,[{key:"addChangeListener",value:function(t){this.on("change",t)}},{key:"commitChange",value:function(){this.emit("change")}},{key:"getData",value:function(){return Object.assign({},this.data)}},{key:"getElement",value:function(){return void 0===this.element&&(this.element=v()("#__messagebox").get(0)),this.element}},{key:"removeChangeListener",value:function(t){this.removeListener("change",t)}},{key:"hide",value:function(){this.lastHide=(new Date).getTime(),this.data.visible=!1,this.commitChange()}},{key:"show",value:function(t){var e=this;t=v.a.extend({title:null,text:null,focusOnClose:null,size:"md",visible:!0,buttons:[{text:"Ok",color:"blue",icon:"thumbs-up",onClick:function(){e.hide()}}]},t);var a=0,o=(new Date).getTime()-this.lastHide;o<750&&(a=750-o),setTimeout((function(){e.data=v.a.extend(e.data,t),e.commitChange()}),a)}}]),a}(E.EventEmitter),_=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).onChangeData=o.onChangeData.bind(Object(O.a)(o)),o.state=t.MessageBoxEmitter.getData(),o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.props.MessageBoxEmitter.addChangeListener(this.onChangeData);var t=this.props.MessageBoxEmitter.getElement();v()(t).on("shown.bs.modal",(function(){v()(t).find(".btn").first().focus()}))}},{key:"componentWillUnmount",value:function(){this.props.MessageBoxEmitter.removeChangeListener(this.onChangeData)}},{key:"onChangeData",value:function(){var t=this.props.MessageBoxEmitter.getData();if(t.visible!==this.state.visible){var e=this.props.MessageBoxEmitter.getElement();t.visible?v()(e).modal("show"):v()(e).modal("hide")}this.setState(t)}},{key:"render",value:function(){return Object(C.jsx)("div",{id:"__messagebox",className:"messagebox modal fade","data-backdrop":"static",children:Object(C.jsx)("div",{className:"modal-dialog modal-"+this.state.size,children:Object(C.jsxs)("div",{className:"modal-content",children:[Object(C.jsx)("div",{className:"modal-header",children:Object(C.jsx)("h4",{className:"modal-title",children:this.state.title})}),Object(C.jsx)("div",{className:"modal-body",dangerouslySetInnerHTML:{__html:this.state.text}}),Object(C.jsx)("div",{className:"modal-footer",children:this.state.buttons.map((function(t,e){return Object(C.jsx)(T,{color:t.color,text:t.text,icon:t.icon,onClick:t.onClick},e)}))})]})})})}}]),a}(d.a.Component),$=window.require("fs"),H=window.require("os"),W=(window.require("path"),window.require("child_process")),G=window.require("serial-number");function Y(){return Q().split("T")[0]}function Q(){var t=6e4*(new Date).getTimezoneOffset();return new Date(Date.now()-t).toISOString()}function J(t){var e=String(t).split(".")[1];return void 0===e||0===e.length||0===parseInt(e,10)?0:3}function K(t){var e=null;void 0===t||null===t?e="Erro n\xe3o identificado.":"string"===typeof t?e=t:(e=t.message,console.log(t.stack)),window.MessageBox.show({title:"Houve uma falha",text:e})}function X(){return Z.apply(this,arguments)}function Z(){return(Z=Object(n.a)(r.a.mark((function t(){var e;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("win32"!==H.platform()){t.next=7;break}return"wmic diskdrive get SerialNumber",e=(e=W.execSync("wmic diskdrive get SerialNumber").toString()).trim().split(" ").splice(-1)[0].trim(),t.abrupt("return",e);case 7:return t.abrupt("return",new Promise((function(t){G((function(e,a){t(a)}))})));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function tt(t){return new Promise((function(e){return setTimeout(e,t)}))}function et(){return H.homedir()+"/SAT-Flex/"}function at(t){if(""===(t=t.replace(/[^\d]+/g,"")))return!1;if(14!==t.length)return!1;if("00000000000000"===t||"11111111111111"===t||"22222222222222"===t||"33333333333333"===t||"44444444444444"===t||"55555555555555"===t||"66666666666666"===t||"77777777777777"===t||"88888888888888"===t||"99999999999999"===t)return!1;for(var e=t.length-2,a=t.substring(0,e),o=t.substring(e),r=0,n=e-7,i=e;i>=1;i--)r+=a.charAt(e-i)*n--,n<2&&(n=9);var s=r%11<2?0:11-r%11;if(parseInt(s,10)!==parseInt(o.charAt(0),10))return!1;e+=1,a=t.substring(0,e),r=0,n=e-7;for(var c=e;c>=1;c--)r+=a.charAt(e-c)*n--,n<2&&(n=9);return s=r%11<2?0:11-r%11,parseInt(s,10)===parseInt(o.charAt(1),10)}function ot(t){if(""===(t=t.replace(/[^\d]+/g,"")))return!1;if(11!==t.length||"00000000000"===t||"11111111111"===t||"22222222222"===t||"33333333333"===t||"44444444444"===t||"55555555555"===t||"66666666666"===t||"77777777777"===t||"88888888888"===t||"99999999999"===t)return!1;for(var e=0,a=0;a<9;a++)e+=parseInt(t.charAt(a),10)*(10-a);var o=11-e%11;if(10!==o&&11!==o||(o=0),parseInt(o,10)!==parseInt(t.charAt(9),10))return!1;e=0;for(var r=0;r<10;r++)e+=parseInt(t.charAt(r),10)*(11-r);return 10!==(o=11-e%11)&&11!==o||(o=0),parseInt(o,10)===parseInt(t.charAt(10),10)}function rt(t,e,a,o){return nt.apply(this,arguments)}function nt(){return(nt=Object(n.a)(r.a.mark((function t(e,a,o,n){var i,s,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.query("SELECT valor FROM parametro WHERE grupo = $1 AND nome = $2",[a,o]);case 2:if(i=t.sent,0!==(s=i.rows).length){t.next=7;break}return window.MessageBox.show({title:"Banco de dados desatualizado",text:"Seu banco de dados est\xe1 desatualizado para trabalhar com o aplicativo atual.<br>Atualize o banco de dados para continuar."}),t.abrupt("return",!1);case 7:return c=s[0].valor,"function"===typeof n&&n(c),t.abrupt("return",c);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function it(t,e){var a=et();$.existsSync(a)||$.mkdirSync(a);var o=a+t,r=void 0;return".zip"===t.substr(-4)&&(r="binary"),$.writeFileSync(o,e,r),o}var st=function(){function t(e){Object(i.a)(this,t),this.Pool=e,this.cnpj=null,this.serialNumber=null}return Object(s.a)(t,[{key:"api",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a,o,n,i,s=arguments;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=s.length>1&&void 0!==s[1]?s[1]:{},o=s.length>2&&void 0!==s[2]?s[2]:function(){},n=s.length>3&&void 0!==s[3]?s[3]:function(){},i="http://server.satflex.com.br/serv/terminal/"+e+".php",v.a.ajax({url:i,type:"POST",data:JSON.stringify(a),success:function(t){o(JSON.parse(t))},error:n});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"atualizarRequisicao",value:function(){var t=Object(n.a)(r.a.mark((function t(e,a,o){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.carregarDados();case 2:n=null,t.t0=e.status,t.next="0"===t.t0?6:"1"===t.t0||"2"===t.t0?8:10;break;case 6:return n="1",t.abrupt("break",11);case 8:return n="2",t.abrupt("break",11);case 10:return t.abrupt("break",11);case 11:this.api("atualizar_requisicao",{numeroserie:this.serialNumber,cnpj:this.cnpj,requisicao:{idrequisicao:e.referencia,status:n,resposta:e.resposta}},(function(t){switch(t.status){case"0":a();break;case"2":o(t.message)}}),(function(){o("Houve uma falha na conex\xe3o com o servidor.")}));case 12:case"end":return t.stop()}}),t,this)})));return function(e,a,o){return t.apply(this,arguments)}}()},{key:"carregarDados",value:function(){var t=Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.cnpj&&this.serialnumber){t.next=7;break}return t.next=3,rt(this.Pool,"EMITENTE","CNPJ");case 3:return this.cnpj=t.sent,t.next=6,X();case 6:this.serialNumber=t.sent;case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"verificarRequisicao",value:function(){var t=Object(n.a)(r.a.mark((function t(e,a){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.carregarDados();case 2:this.api("verificar_requisicao",{numeroserie:this.serialNumber,cnpj:this.cnpj},(function(t){switch(t.status){case"0":e(t.requisicao);break;case"2":a(t.message)}}),(function(){a("Houve uma falha na conex\xe3o com o servidor.")}));case 3:case"end":return t.stop()}}),t,this)})));return function(e,a){return t.apply(this,arguments)}}()},{key:"verificarTerminal",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e=this;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise(function(){var t=Object(n.a)(r.a.mark((function t(a){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.carregarDados();case 2:e.api("verificar_terminal",{numeroserie:e.serialNumber,cnpj:e.cnpj},(function(t){switch(t.status){case"0":a(t.terminal.status);break;case"2":a(!1)}}),(function(){a(!1)}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),t}(),ct=window.require("pg");function ut(){return new ct.Pool({user:"postgres",host:"127.0.0.1",database:"satflex",password:"postgres",port:5432})}a(193);var lt=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsx)("div",Object(g.a)(Object(g.a)({id:"content"},this.props),{},{children:this.props.children}))}}]),a}(d.a.Component),dt=(a(194),a(195),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;Object(i.a)(this,a),(o=e.call(this,t)).calcBlankSpace=o.calcBlankSpace.bind(Object(O.a)(o)),o.elementScroll=o.elementScroll.bind(Object(O.a)(o)),o.onClickHeadCell=o.onClickHeadCell.bind(Object(O.a)(o)),o.onScroll=o.onScroll.bind(Object(O.a)(o)),o.updateBlankSpace=o.updateBlankSpace.bind(Object(O.a)(o)),o.updateReceivedProps=o.updateReceivedProps.bind(Object(O.a)(o));var r=o.updateReceivedProps(t.header,t.data);return o.state={data:r.data,header:r.header,limit:100,offset:0,blankSpace:{bottom:0,top:0}},o.scrollActive=!0,o.longScroll=!1,o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.elementScroll().addEventListener("scroll",this.onScroll),this.element=h.a.findDOMNode(this),window.grid=this.element}},{key:"componentWillUnmount",value:function(){this.elementScroll().removeEventListener("scroll",this.onScroll)}},{key:"componentDidUpdate",value:function(){if(this.referenceElement&&!this.longScroll){var t=this.elementScroll(),e=v()(this.referenceElement.element).position().top;this.scrollActive=!1;var a=v()(t).scrollTop()-(e-this.referenceElement.top);a>this.element.scrollHeight&&(a=this.element.scrollHeight),v()(t).scrollTop(a),this.scrollActive=!0}!0!==this.firstUpdateBlankSpace&&(this.firstUpdateBlankSpace=!0,this.updateBlankSpace()),v()(this.element).children("table").floatThead(),v()(this.element).children("table").floatThead("reflow")}},{key:"componentWillUpdate",value:function(){var t=v()(this.element).children("table"),e=v()(t).children("tbody").children(),a=v()(e).eq(Math.floor(.5*this.state.limit));v()(a).length>0&&(this.referenceElement={element:a,top:v()(a).position().top})}},{key:"componentWillReceiveProps",value:function(t){t=this.updateReceivedProps(t.header,t.data),this.setState({header:t.header,data:t.data}),this.firstUpdateBlankSpace=!1}},{key:"elementIsVisibleByScroll",value:function(t,e){if(!v()(this.element).is(":visible"))return!1;e=void 0===e?window:e;var a=v()(e).scrollTop(),o=a+v()(e).height(),r=e===window?v()(t).offset().top:v()(t).position().top,n=r+v()(t).height();return r<a&&n>a||(r>a&&n<o||r<o&&n>o)}},{key:"elementScroll",value:function(){return void 0===this.props.height?window:h.a.findDOMNode(this)}},{key:"onClickHeadCell",value:function(t){var e=v()(t.target).attr("cellkey"),a=null,o=null,r=null,n=this.state.header;for(var i in n)(a=n[i]).key===e?(o=i,r=1===a.order?-1:1,a.order=r):a.order=0,n[i]=a;var s=this.state.data;s.sort((function(t,e){return t.data[o].text<e.data[o].text?1===r?-1:1:t.data[o].text>e.data[o].text?1===r?1:-1:0})),this.setState({header:n,data:s})}},{key:"onScroll",value:function(){if(!this.scrollActive)return!0;if(!v()(this.element).is(":visible"))return!0;var t=this.elementScroll();if(!(void 0===this.currentScroll||Math.abs(this.currentScroll-v()(t).scrollTop())>50))return!0;this.currentScroll=v()(t).scrollTop();var e=this.element,a=v()(e).children("table"),o=v()(a).children("thead"),r=v()(a).children("tbody").children(),n=v()(r).first(),i=v()(r).last(),s=v()(n).next(),c=v()(i).prev(),u=v()(r).eq(Math.floor(.2*this.state.limit)),l=v()(r).eq(Math.floor(.8*this.state.limit)),d=-1*(v()(o).position().top-v()(t).scrollTop());d<0&&(d=0);var p=this.state.limit,h=this.state.offset,m=this.state.data.length;if(this.longScroll=!1,h>0&&(this.elementIsVisibleByScroll(s,t)||this.elementIsVisibleByScroll(u,t)))(h-=Math.floor(p/2))<0&&(h=0);else if(h+p<m&&(this.elementIsVisibleByScroll(c,t)||this.elementIsVisibleByScroll(l,t)))h+=Math.floor(p/2);else if((this.elementIsVisibleByScroll(n,t)||this.elementIsVisibleByScroll(i,t))&&!this.elementIsVisibleByScroll(s,t)&&!this.elementIsVisibleByScroll(c,t)){var b=null;b=t===window?(v()(t).scrollTop()-v()(e).offset().top)/v()(e).height():v()(t).scrollTop()/v()(a).height(),h=Math.round(this.state.data.length*b),this.longScroll=!0}if(h>m-p&&(h=m-p),h<0&&(h=0),h!==this.state.offset){var f=this.calcBlankSpace(h);void 0===this.initialBlankSpace&&(this.initialBlankSpace=f,this.initialBlankSpace.height=f.top+f.bottom),this.setState({offset:h,blankSpace:f})}}},{key:"calcBlankSpace",value:function(t){t=void 0===t?this.state.offset:t;var e=this.state.data,a=this.state.limit,o=v()(this.element).children(".table"),r=v()(o).children("tbody").children(),n=v()(r).first(),i=v()(n).next(),s=v()(i).height()-5,c=t*s,u=(e.length-t-a)*s;if(this.longScroll&&void 0!==this.initialBlankSpace){var l=this.elementScroll(),d=v()(r).not(":first, :last").map((function(){return v()(this).height()})).get().reduce((function(t,e){return t+e}),0);c=v()(l).scrollTop()-10*s,u=v()(o).height()-d-c,c>this.initialBlankSpace.height&&(c=this.initialBlankSpace.height),u>this.initialBlankSpace.height&&(u=this.initialBlankSpace.height)}return c<0&&(c=0),u<0&&(u=0),{top:c,bottom:u}}},{key:"updateBlankSpace",value:function(){this.setState({blankSpace:this.calcBlankSpace()})}},{key:"updateReceivedProps",value:function(t,e){for(var a in t=void 0===t?this.state.header:t,e=void 0===e?this.state.data:e,t){var o=t[a];"string"===typeof o&&(o={text:o}),o=v.a.extend({align:"left",key:a,order:0,text:""},o),t[a]=o}var r=0;for(var n in e){var i=e[n];for(var s in v.a.isArray(i)&&(i={data:i}),e[n]=i,e[n].data){var c=e[n].data[s];"string"===typeof c&&(c={text:c}),c=v.a.extend({align:"left",key:r++,text:"",width:null},c),e[n].data[s]=c}}return{header:t,data:e}}},{key:"render",value:function(){var t=this.state.data.slice(this.state.offset,this.state.offset+this.state.limit);return Object(C.jsx)("div",{className:"DataGrid",style:{height:this.props.height},children:Object(C.jsxs)("table",{className:"DataGridTable table table-striped table-hover "+this.props.className,children:[Object(C.jsx)(bt,{header:this.state.header,onClickHeadCell:this.onClickHeadCell}),Object(C.jsx)(pt,{data:t,blankSpace:this.state.blankSpace})]})})}}]),a}(d.a.Component)),pt=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsxs)("tbody",{children:[Object(C.jsx)(vt,{height:this.props.blankSpace.top}),this.props.data.map((function(t,e){return Object(C.jsx)(mt,{row:t},e)})),Object(C.jsx)(vt,{height:this.props.blankSpace.bottom})]})}}]),a}(d.a.Component),ht=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsx)("td",{className:"text-"+this.props.cell.align,onClick:this.props.cell.onClick,style:{width:this.props.cell.width},children:this.props.cell.text})}}]),a}(d.a.Component),mt=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsx)("tr",{onClick:this.props.row.onClick,children:this.props.row.data.map((function(t,e){return Object(C.jsx)(ht,{cell:t},e)}))})}}]),a}(d.a.Component),bt=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=this;return Object(C.jsx)("thead",{children:Object(C.jsx)("tr",{children:this.props.header.map((function(e,a){return Object(C.jsx)(ft,{cell:e,onClick:t.props.onClickHeadCell},a)}))})})}}]),a}(d.a.Component),ft=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsx)("th",{className:"text-"+this.props.cell.align+" DataGridHeadCellOrder-"+this.props.cell.order,onClick:this.props.onClick,cellkey:this.props.cell.key,children:this.props.cell.text})}}]),a}(d.a.Component),vt=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=void 0===this.props.height?0:this.props.height;return Object(C.jsx)("tr",{children:Object(C.jsx)("td",{style:{border:0,height:t,padding:0}})})}}]),a}(d.a.Component),jt=a(173),xt=(a(302),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={picker:!1,value:t.value},o.onChange=o.onChange.bind(Object(O.a)(o)),o.onClick=o.onClick.bind(Object(O.a)(o)),o.onDocumentClick=o.onDocumentClick.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"componentWillReceiveProps",value:function(t){this.setState({value:t.value})}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.onDocumentClick),this.element=h.a.findDOMNode(this)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onDocumentClick)}},{key:"onChange",value:function(t,e){var a=this;e.persist(),this.setState({picker:!1,value:t.hex},(function(){if(a.props.onChange){var t=v()(e.target).parents("[class*='-picker']").first().prev().get(0);e.target=t,a.props.onChange(e)}}))}},{key:"onClick",value:function(t){this.setState({picker:!0}),t.preventDefault()}},{key:"onDocumentClick",value:function(t){if(this.state.picker){var e=!1;v()(this.element).find("*").each((function(a,o){t.target===o&&(e=!0)})),e||this.setState({picker:!1})}}},{key:"render",value:function(){var t=Object.assign({},this.props);return delete t.value,Object(C.jsxs)("div",{children:[Object(C.jsx)("input",Object(g.a)(Object(g.a)({},t),{},{value:this.state.value,onClick:this.onClick})),Object(C.jsx)(jt.a,{value:this.state.value,onChange:this.onChange,className:this.state.picker?null:"d-none"})]})}}]),a}(d.a.Component)),Ot=a(174),gt=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={options:void 0===t.options?[]:t.options,value:void 0===t.value?"":t.value},o.getDBOptions=o.getDBOptions.bind(Object(O.a)(o)),o.onChange=o.onChange.bind(Object(O.a)(o)),o.verifyComponentId=o.verifyComponentId.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.element=h.a.findDOMNode(this),this.verifyComponentId(),this.getDBOptions()}},{key:"componentWillReceiveProps",value:function(t){this.getDBOptions(t),t.value!==this.props.value&&this.setState({value:t.value})}},{key:"getDBOptions",value:function(t){var e=this;if(void 0===(t=void 0===t?this.props:t).dbtable)return!0;var a=t.dbtable,o=t.dbcolumn,r=t.dbfilter,n=t.dbparent;if(void 0===o&&(o="descricao"),void 0===r&&void 0!==n){var i=document.getElementById(n);r="id"+v()(i).attr("dbtable")+"="+v()(i).val()}null!==this.ajaxDBOptions&&void 0!==this.ajaxDBOptions&&(this.ajaxDBOptions.abort(),this.ajaxDBOptions=null);var s="SELECT id"+a+", "+o+" FROM "+a+" ORDER BY 2";this.props.Pool.query({text:s,rowMode:"array"},(function(t,a){if(t)return K(t.message),!1;var o=[];for(var r in a.rows){var n=a.rows[r];o.push({value:n[0],label:n[1]})}e.state.options!==o&&e.setState({options:o})}))}},{key:"onChange",value:function(t){var e=t?t.value:null;if(this.setState({value:e}),this.props.onChange){var a={target:{id:this.props.id,value:e}};this.props.onChange(a)}}},{key:"verifyComponentId",value:function(){if(this.props.id){var t=v()("[name='"+this.props.id+"']");t.length>0&&t.attr("id",v()(t).attr("name"))}}},{key:"render",value:function(){var t=this.state.options;if(!Array.isArray(t)){var e=[];for(var a in t)e.push({value:a,label:t[a]});t=e}return Array.isArray(t)||(t=[]),Object(C.jsx)(Ot.a,{clearable:!1,disabled:this.props.disabled,id:this.props.id,name:this.props.id,onChange:this.onChange,onInputChange:this.verifyComponentId,options:t,placeholder:"",searchable:!1,value:this.state.value?this.state.value:this.props.defaultValue})}}]),a}(d.a.Component),Ct=(a(312),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).onFocus=o.onFocus.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.element=h.a.findDOMNode(this)}},{key:"onFocus",value:function(){var t=this;if(this.props.InformarValor){var e=this.props.InformarValor;void 0===e.success&&(e.success=function(e){if(v()(t.element).val(e),t.props.onChange){var a={target:{id:t.props.id,value:e}};t.props.onChange(a)}}),window.InformarValor.show(e)}}},{key:"render",value:function(){var t=Object.assign({},this.props);delete t.InformarValor;var e=t.value;null===e&&(e=""),void 0===e&&t.id&&"modal"===t.id.substr(0,5)&&(e="");var a=t.className?t.className.split(" "):[];switch(a.push("form-control"),t.size&&a.push("form-control-"+t.size),"date"===t.type&&a.push("text-center"),t.className=a.join(" "),t.value=e,void 0===this.props.onFocus&&(t.onFocus=this.onFocus),t.type){case"checkbox":return Object(C.jsxs)("div",{className:"form-check",children:[Object(C.jsx)("input",{type:"checkbox",id:this.props.id,className:"form-check-input",checked:"S"===e,defaultValue:this.props.defaultValue,disabled:this.props.disabled,onChange:this.props.onChange,onClick:this.props.onClick}),Object(C.jsx)("label",{className:"form-check-label",htmlFor:this.props.id,children:this.props.label})]});case"color":return Object(C.jsx)(xt,Object(g.a)({},t));case"select":return delete t.type,Object(C.jsx)(gt,Object(g.a)({},t));case"textarea":return delete t.type,Object(C.jsx)("textarea",Object(g.a)({},t));default:return Object(C.jsx)("input",Object(g.a)({},t))}}}]),a}(d.a.Component)),kt=a(18),yt=(a(313),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsx)("label",Object(g.a)(Object(g.a)({},this.props),{},{children:this.props.children}))}}]),a}(d.a.Component)),wt=(a(314),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=Object.assign({},this.props),e=["form-group"];return t.className&&e.push(t.className),t.warning&&(e.push("form-group-warning"),delete t.warning),t.InformarValor&&void 0===t.InformarValor.title&&(t.InformarValor.title=this.props.label),t.className=t.inputClassName,delete t.inputClassName,Object(C.jsxs)("div",{className:e.join(" "),children:[["checkbox"].indexOf(this.props.type)>-1?null:Object(C.jsx)(yt,{htmlFor:this.props.id,children:this.props.label}),Object(C.jsx)(Ct,Object(g.a)({},t))]})}}]),a}(d.a.Component)),St=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(C.jsx)("hr",Object(g.a)({},this.props))}}]),a}(d.a.Component),Et=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={show:o.props.show,showDiv:"principal",title:null},o.cancelar=o.cancelar.bind(Object(O.a)(o)),o.changeDiv=o.changeDiv.bind(Object(O.a)(o)),o.changeTitle=o.changeTitle.bind(Object(O.a)(o)),o.excluir=o.excluir.bind(Object(O.a)(o)),o.gravar=o.gravar.bind(Object(O.a)(o)),o.limpar=o.limpar.bind(Object(O.a)(o)),o.onChangeNcm=o.onChangeNcm.bind(Object(O.a)(o)),o.onChangeInput=o.onChangeInput.bind(Object(O.a)(o)),o.onChangeSincTributacao=o.onChangeSincTributacao.bind(Object(O.a)(o)),o.sincronizarTributacao=o.sincronizarTributacao.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"carregar",value:function(t,e){var a=this,o=["SELECT categoria.descricao, categoria.dthrcriacao, categoria.cor,","  categoria.sinctributacao, ncm.codigoncm, categoria.origem,","  categoria.cfop, categoria.csosn, categoria.aliqicms, ","  categoria.cstpis, categoria.aliqpis, categoria.cstcofins, ","  categoria.aliqcofins, categoria.codcontribsocial, categoria.cest","FROM categoria","LEFT JOIN ncm USING (idncm)","WHERE categoria.idcategoria = $1"].join(" ");this.props.Pool.query(o,[t],(function(t,o){if(t)return K(t.message),!1;if(0===o.rows.length)return window.MessageBox.show({title:"Categoria n\xe3o encontrada",text:"A categoria selecionada n\xe3o p\xf4de ser encontrada."}),!1;var r={},n=o.rows[0];for(var i in n){var s=n[i];switch(i){case"dthrcriacao":s=s.toLocaleString();break;case"aliqicms":case"aliqpis":case"aliqcofins":s=s.format(2,",",".")}r["input_"+i]=s}a.setState(r),"function"===typeof e&&e()}))}},{key:"changeDiv",value:function(t){this.setState({showDiv:t})}},{key:"changeTitle",value:function(t){var e=this;t.idcategoria?t.Pool.query("SELECT descricao FROM categoria WHERE idcategoria = $1",[t.idcategoria],(function(t,a){if(t)return K(t.message),!1;e.setState({title:"Alterando categoria: "+a.rows[0].descricao})})):this.setState({title:"Criando nova categoria"})}},{key:"componentWillReceiveProps",value:function(t){var e=this;if(!t.show)return!1;this.changeTitle(t);var a=function(){e.setState({show:t.show})};t.idcategoria?this.carregar(t.idcategoria,a):(this.limpar(),a())}},{key:"excluir",value:function(){var t=this;window.MessageBox.show({title:"Exclu\xedr categoria",text:"Tem certeza que deseja exclu\xedr a categoria <b>"+this.state.input_descricao+"</b>?",buttons:[{text:"Sim",icon:"thumbs-up",color:"green",onClick:function(){window.MessageBox.hide(),t.props.Pool.query("DELETE FROM categoria WHERE idcategoria = $1",[t.props.idcategoria],(function(e,a){if(e)return K(e.message),!1;t.setState({show:!1}),window.FastMessage.show("Categoria exclu\xedda com sucesso.")}))}},{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:function(){window.MessageBox.hide()}}]})}},{key:"gravar",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o,n,i,s,c,u,l,d,p,h,m=this;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=null,a=[],o=[],t.t0=r.a.keys(this.state);case 4:if((t.t1=t.t0()).done){t.next=37;break}if("input_"!==(n=t.t1.value).substr(0,6)){t.next=35;break}if(i=n.replace("input_",""),s=this.state[n],"codigoncm"!==i||!s){t.next=25;break}return t.prev=10,t.next=13,this.props.Pool.query("SELECT idncm FROM ncm WHERE codigoncm = $1",[s]);case 13:if(0!==(c=t.sent).rows.length){t.next=17;break}return window.MessageBox.show({title:"NCM inexistente",text:"O c\xf3digo de NCM "+s+" n\xe3o p\xf4de ser encontrado.<br>Verifique se foi informado corretamente."}),t.abrupt("return",!1);case 17:i="idncm",s=c.rows[0].idncm,t.next=25;break;case 21:return t.prev=21,t.t2=t.catch(10),K(t.t2.message),t.abrupt("return",!1);case 25:if(!(["idcategoria","dthrcriacao"].indexOf(i)>-1)){t.next=27;break}return t.abrupt("continue",4);case 27:t.t3=i,t.next="aliqicms"===t.t3||"aliqpis"===t.t3||"aliqcofins"===t.t3?30:32;break;case 30:return s&&(s=s.toFloat()),t.abrupt("break",33);case 32:return t.abrupt("break",33);case 33:a.push(i),o.push(s);case 35:t.next=4;break;case 37:if(this.props.idcategoria){for(d in u=1,l=[],a)l.push(a[d]+" = $"+u++);e="UPDATE categoria SET "+l.join(", ")+" WHERE idcategoria = "+this.props.idcategoria}else{for(p=[],h=0;h<a.length;h++)p.push("$"+(h+1));e="INSERT INTO categoria ("+a.join(", ")+") VALUES ("+p.join(", ")+")"}this.props.Pool.query(e,o,(function(t,e){if(t)return K(t.message),!1;m.setState({show:!1}),window.FastMessage.show("Categoria gravada com sucesso.")}));case 39:case"end":return t.stop()}}),t,this,[[10,21]])})));return function(){return t.apply(this,arguments)}}()},{key:"limpar",value:function(){var t={};for(var e in this.state)"input_"===e.substr(0,6)&&(t[e]=null);this.setState(t)}},{key:"onChangeInput",value:function(t,e){var a=t.target,o=a.id.replace("modalcategoria-",""),r=a.value;"checkbox"===a.type&&(r=a.checked?"S":"N"),this.setState(Object(kt.a)({},"input_"+o,r),e)}},{key:"onChangeNcm",value:function(t){var e=this;this.onChangeInput(t,(function(){e.sincronizarTributacao()}))}},{key:"onChangeSincTributacao",value:function(t){var e=this;this.onChangeInput(t,(function(){e.sincronizarTributacao()}))}},{key:"sincronizarTributacao",value:function(){var t=this;if("S"!==this.state.input_sinctributacao)return!0;var e=["SELECT origem, cfop, csosn, aliqicms, cstpis, aliqpis, ","  cstcofins, aliqcofins, codcontribsocial, cest","FROM ncm","WHERE codigoncm = $1"].join(" ");this.props.Pool.query(e,[this.state.input_codigoncm],(function(e,a){if(e)return K(e.message),!1;if(0===a.rows.length)return window.MessageBox.show({title:"NCM n\xe3o encontrado",text:"O NCM informado na categoria n\xe3o p\xf4de ser encontrado."}),!1;var o={},r=a.rows[0];for(var n in r){var i=r[n];switch(n){case"aliqicms":case"aliqpis":case"aliqcofins":i=i.format(2,",",".")}o["input_"+n]=i}t.setState(o)}))}},{key:"shouldComponentUpdate",value:function(t){return t.show}},{key:"render",value:function(){return Object(C.jsxs)(M,{title:this.state.title,size:"lg",show:this.state.show,beforeClose:this.props.beforeClose,afterClose:this.props.afterClose,closeOnOutClick:!1,children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(wt,{type:"text",id:"modalcategoria-descricao",className:"col-5",label:"Descri\xe7\xe3o",value:this.state.input_descricao,onChange:this.onChangeInput}),Object(C.jsx)(wt,{type:"color",id:"modalcategoria-cor",className:"col-3",label:"Cor representativa",value:this.state.input_cor,onChange:this.onChangeInput}),Object(C.jsx)(wt,{type:"text",id:"modalcategoria-dthrcriacao",className:"col-4",label:"Criado em",readOnly:!0,value:this.state.input_dthrcriacao,onChange:this.onChangeInput,disabled:!0}),Object(C.jsx)(wt,{type:"text",id:"modalcategoria-codigoncm",label:"NCM da categoria",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"9999.99.99"},value:this.state.input_codigoncm,onChange:this.onChangeNcm}),Object(C.jsx)(wt,{type:"checkbox",id:"modalcategoria-sinctributacao",label:"Usar as mesmas tributa\xe7\xf5es da categoria",className:"col-9",value:this.state.input_sinctributacao,onChange:this.onChangeSincTributacao}),Object(C.jsx)(wt,{type:"select",id:"modalcategoria-origem",className:"col-6",label:"Origem do categoria",options:{0:"0 - Nacional, exceto as indicadas nos c\xf3digos 3, 4, 5 e 8",1:"1 - Estrangeira - Importa\xe7\xe3o direta, exceto a indicada no c\xf3digo 6",2:"2 - Estrangeira - Adquirida no mercado interno, exceto a indicada no c\xf3digo 7",3:"3 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o superior a 40% e inferior ou igual a 70%",4:"4 - Nacional, cuja produ\xe7\xe3o tenha sido feita em conformidade com os processos produtivos b\xe1sicos de que tratam o Decreto-Lei n\xba 288/67, e as Leis n\xbas 8.248/91, 8.387/91, 10.176/01 e 11.484/ 07",5:"5 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o inferior ou igual a 40%",6:"6 - Estrangeira - Importa\xe7\xe3o direta, sem similar nacional, constante em lista da Resolu\xe7\xe3o CAMEX n\xba 79/2012 e g\xe1s natural",7:"7 - Estrangeira - Adquirida no mercado interno, sem similar nacional, constante em lista da Resolu\xe7\xe3o CAMEX n\xba 79/2012 e g\xe1s natural",8:"8 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o superior a 70%"},value:this.state.input_origem,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalcategoria-cfop",label:"CFOP",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"9.999"},value:this.state.input_cfop,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"select",id:"modalcategoria-csosn",className:"col-3",inputClassName:"text-center",label:"CSOSN",options:{102:"102",300:"300",400:"400",500:"500"},value:this.state.input_csosn,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalcategoria-aliqicms",label:"Al\xedquota de ICMS",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqicms,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalcategoria-cstpis",label:"CST do PIS",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_cstpis,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalcategoria-aliqpis",label:"Al\xedquota de PIS",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqpis,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalcategoria-cstcofins",label:"CST do Cofins",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_cstcofins,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalcategoria-aliqcofins",label:"Al\xedquota de Cofins",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqcofins,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalcategoria-codcontribsocial",label:"Contribui\xe7\xe3o social",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_codcontribsocial,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalcategoria-cest",label:"CEST",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99.999.99"},value:this.state.input_cest,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao})]}),Object(C.jsx)(St,{className:"mt-0"}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(T,{text:"Exclu\xedr",icon:"bin",color:"red",onClick:this.excluir,className:this.props.idcategoria?"":"d-none"})}),Object(C.jsxs)(R,{size:"6",className:"text-right",children:[Object(C.jsx)(T,{text:"Cancelar",icon:"undo",color:"red",onClick:this.cancelar}),Object(C.jsx)(T,{text:"Gravar categoria",icon:"thumbs-up",color:"green",className:"ml-2",onClick:this.gravar})]})]})]})}}]),a}(d.a.Component),Nt=(a(315),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=void 0!==this.props.text?this.props.text:this.props.children,e=void 0!==this.props.model?this.props.model:1;return Object(C.jsx)("h1",{className:"title-model-"+e,children:t})}}]),a}(d.a.Component)),Pt=(a(316),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={dataGrid:[],pesquisa:"",idcategoria:null,showModalCategoria:!1,redirectToProduto:!1},o.beforeCloseModal=o.beforeCloseModal.bind(Object(O.a)(o)),o.loadDataGrid=o.loadDataGrid.bind(Object(O.a)(o)),o.novaCategoria=o.novaCategoria.bind(Object(O.a)(o)),o.onChangePesquisa=o.onChangePesquisa.bind(Object(O.a)(o)),o.onClickBtnProduto=o.onClickBtnProduto.bind(Object(O.a)(o)),o.onKeyUpPesquisa=o.onKeyUpPesquisa.bind(Object(O.a)(o)),o.pesquisaLimpar=o.pesquisaLimpar.bind(Object(O.a)(o)),o.Pool=new ut,o}return Object(s.a)(a,[{key:"beforeCloseModal",value:function(){var t=this;this.setState({showModalCategoria:!1},(function(){t.loadDataGrid()}))}},{key:"carregarCategoria",value:function(t){this.setState({showModalCategoria:!0,idcategoria:t})}},{key:"componentDidMount",value:function(){this.loadDataGrid()}},{key:"componentWillUnmount",value:function(){this.Pool.end()}},{key:"loadDataGrid",value:function(){var t=this,e=["SELECT categoria.idcategoria, categoria.descricao, ","  ncm.codigoncm AS codigoncm, categoria.dthrcriacao,","  (SELECT COUNT(idproduto) FROM produto WHERE idcategoria = categoria.idcategoria) AS produtos","FROM categoria","LEFT JOIN ncm USING (idncm)","WHERE categoria.descricao ILIKE '%'||$1||'%'","ORDER BY categoria.descricao"].join(" ");this.Pool.query(e,[this.state.pesquisa],(function(e,a){if(e)return K(e.message),!1;var o=[],r=function(e){var r=a.rows[e];o.push({data:[{text:r.descricao,align:"left"},{text:r.codigoncm,align:"center"},{text:r.produtos,align:"center"},{text:r.dthrcriacao.toLocaleString(),align:"center"}],onClick:function(){t.carregarCategoria(r.idcategoria)}})};for(var n in a.rows)r(n);t.setState({dataGrid:o})}))}},{key:"novaCategoria",value:function(){this.setState({showModalCategoria:!0,idcategoria:null})}},{key:"onChangePesquisa",value:function(t){this.setState({pesquisa:t.target.value})}},{key:"onClickBtnProduto",value:function(){this.setState({redirectToProduto:!0})}},{key:"onKeyUpPesquisa",value:function(t){13===t.keyCode&&this.loadDataGrid()}},{key:"pesquisaLimpar",value:function(){var t=this;this.setState({pesquisa:""},(function(){t.loadDataGrid()}))}},{key:"render",value:function(){if(this.state.redirectToProduto)return Object(C.jsx)(b.a,{to:"/produto"});return Object(C.jsxs)(lt,{children:[Object(C.jsxs)(Nt,{model:"2",children:["Cadastro de ",Object(C.jsx)("b",{children:"Categorias"})]}),Object(C.jsxs)(q,{className:"mb-4",children:[Object(C.jsxs)(R,{size:"4",children:[Object(C.jsx)(Ct,{type:"search",id:"pesquisa",value:this.state.pesquisa,placeholder:"Pesquise uma categoria...",onKeyUp:this.onKeyUpPesquisa,onChange:this.onChangePesquisa}),Object(C.jsx)(k,{name:"cross",id:"pesquisa-limpar",onClick:this.pesquisaLimpar,className:this.state.pesquisa.length>0?null:"d-none"})]}),Object(C.jsx)(R,{size:"2",className:"pl-0",children:Object(C.jsx)(T,{text:"Buscar",icon:"search",color:"green",onClick:this.loadDataGrid})}),Object(C.jsxs)(R,{size:"6",className:"text-right",children:[Object(C.jsx)(T,{text:"Produtos",icon:"layers",color:"blue",className:"mr-3",onClick:this.onClickBtnProduto}),Object(C.jsx)(T,{text:"Nova categoria",icon:"plus",color:"green",onClick:this.novaCategoria})]})]}),Object(C.jsx)(dt,{header:[{text:"Descri\xe7\xe3o",align:"left"},{text:"NCM",align:"center"},{text:"Produtos",align:"center"},{text:"Criado em",align:"center"}],data:this.state.dataGrid}),Object(C.jsx)(Et,{Pool:this.Pool,show:this.state.showModalCategoria,idcategoria:this.state.idcategoria,beforeClose:this.beforeCloseModal})]})}}]),a}(d.a.Component)),Dt=a(14),At=a(167),Tt=a.n(At),Rt=a(35),It=a.n(Rt),Mt=window.require("fs"),qt=window.require("electron"),Lt=function(){function t(e){Object(i.a)(this,t),this.Pool=e,this.atualizarAplicativoParcial=this.atualizarAplicativoParcial.bind(this),this.atualizarBancoDeDados=this.atualizarBancoDeDados.bind(this),this.baixarAplicativoParcial=this.baixarAplicativoParcial.bind(this),this.verificarAtualizacao=this.verificarAtualizacao.bind(this),this.fs=Mt}return Object(s.a)(t,[{key:"atualizarAplicativoParcial",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a=this;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.baixarAplicativoParcial(function(){var t=Object(n.a)(r.a.mark((function t(o){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o){t.next=2;break}return t.abrupt("return",e(o));case 2:return t.next=4,a.atualizarBancoDeDados((function(t){if(t)return e(t);e()}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"atualizarBancoDeDados",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a,o,i,s=this;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===this.ftp&&(this.ftp=Tt.a),a=function(){var t=Object(n.a)(r.a.mark((function t(e,a){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){e.get(a,!1,(function(e,a){if(e)throw new Error(e);var o=[];a.on("data",(function(t){o.push(t.toString())})).on("end",(function(){t(o.join(""))}))}))})));case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),t.t0=parseInt,t.next=5,rt(this.Pool,"ATUALIZACAO","INSTRUCAOSQL");case 5:t.t1=t.sent,o=(0,t.t0)(t.t1,10);try{(i=new this.ftp).on("ready",(function(){i.list("/sql",!1,function(){var t=Object(n.a)(r.a.mark((function t(n,c){var u,l,d,p,h,m,b;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=2;break}return t.abrupt("return",e(n));case 2:u=[],l=Object(Dt.a)(c);try{for(l.s();!(d=l.n()).done;)p=d.value,parseInt(p.name.replace(".sql",""),10)>o&&u.push(p.name)}catch(n){l.e(n)}finally{l.f()}u.sort(),t.prev=6,t.t0=r.a.keys(u);case 8:if((t.t1=t.t0()).done){t.next=20;break}return h=t.t1.value,m=u[h],t.next=13,a(i,"/sql/"+m);case 13:return b=t.sent,console.log("Executar SQL: \n"+b),t.next=17,s.Pool.query(b);case 17:console.log("SQL Finalizada"),t.next=8;break;case 20:e(),t.next=27;break;case 23:t.prev=23,t.t2=t.catch(6),console.log("Erro ao atualizar BD: "+t.t2.message),e(t.t2);case 27:case"end":return t.stop()}}),t,null,[[6,23]])})));return function(e,a){return t.apply(this,arguments)}}())})).connect({host:"websac.net",port:"21",user:"satflex-update",password:"automacao"})}catch(c){e(c)}case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"baixarAplicativoParcial",value:function(t){var e=this;if(!0===window.__ignoreAppUpdate)return t();void 0===this.childProcess&&(this.childProcess=It.a),this.childProcess.exec("git --version",[],(function(a){if(a)return t(new Error("git-not-found"));console.log("Diret\xf3rio .git: C:/SAT-Flex/resources/app//.git");try{e.childProcess.execSync('git config --global git.user "satflex@controlware.com.br"')}catch(a){return t(a)}var o=e.childProcess.spawn('cd "C:/SAT-Flex/resources/app/" && git pull',{shell:!0});o.stdout.on("data",(function(t){console.log("stdout: "+t.toString())})),o.stderr.on("data",(function(t){console.log("stderr: "+t.toString())})),o.on("close",(function(e){console.log("exit: "+e.toString()),t()}))}))}},{key:"baixarGit",value:function(){window.MessageBox.show({title:"Git n\xe3o est\xe1 instalado",text:"Para atualizar o SAT-Flex, \xe9 necess\xe1rio que o Git esteja instalado.",buttons:[{text:"Baixar o Git",color:"green",icon:"github",onClick:function(){window.MessageBox.hide(),qt.shell.openExternal("ftp://instalacao:123@websac.net/SATFlex/Git-2.18.0-32-bit.exe")}},{text:"Mais tarde...",color:"blue",icon:"undo",onClick:function(){window.MessageBox.hide()}}]})}},{key:"versaoAtual",value:function(){return window.require("C:/SAT-Flex/resources/app//package.json").version}},{key:"verificarAtualizacao",value:function(){var t=this;window.MessageBox.show({title:"Atualiza\xe7\xe3o do SAT-Flex",text:"Deseja iniciar a atualiza\xe7\xe3o do SAT-Flex agora?<br>Isso pode levar alguns minutos.",buttons:[{text:"Sim",icon:"thumbs-up",color:"green",onClick:function(){window.MessageBox.hide(),window.Loading.show(),console.log("Inicio da atualiza\xe7\xe3o: "+(new Date).toLocaleString()),t.atualizarAplicativoParcial((function(e){if(console.log("Fim da atualiza\xe7\xe3o: "+(new Date).toLocaleString()),window.Loading.hide(),e)return"git-not-found"===e.message?t.baixarGit():K(e),!1;window.MessageBox.show({title:"Atualizado com sucesso!",text:"O seu SAT-Flex foi atualizado com sucesso!<br>A aplica\xe7\xe3o ser\xe1 reinciada.",buttons:[{text:"Ok",icon:"thumbs-up",onClick:function(){window.require("electron").ipcRenderer.sendSync("restart")}}]})}))}},{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:function(){window.MessageBox.hide()}}]})}}]),t}(),Ft=(a(349),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={redirect:null,serialnumber:null,versaoAtual:null},o.verificarAtualizacao=o.verificarAtualizacao.bind(Object(O.a)(o)),o.Pool=new ut,o.Atualizacao=new Lt(o.Pool),o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var t=this;Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,X();case 3:e.t1=e.sent,e.t2={serialnumber:e.t1},e.t0.setState.call(e.t0,e.t2);case 6:case"end":return e.stop()}}),e)})))()}},{key:"verificarAtualizacao",value:function(){this.Atualizacao.verificarAtualizacao()}},{key:"render",value:function(){var t=this;if(this.state.redirect)return Object(C.jsx)(b.a,{to:this.state.redirect});var e=this.Atualizacao.versaoAtual(),a=null;return a=this.state.serialnumber?Object(C.jsx)("b",{children:this.state.serialnumber}):Object(C.jsx)(k,{name:"spinner3",className:"ani-spin"}),Object(C.jsxs)(lt,{children:[Object(C.jsx)(Nt,{children:"Configura\xe7\xf5es"}),Object(C.jsx)(q,{children:Object(C.jsx)(R,{size:"8",offset:"2",children:Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",className:"mb-4",children:Object(C.jsx)(T,{text:"Verificar atualiza\xe7\xe3o<br><small>vers\xe3o atual: "+e+"</small>",icon:"safari",size:"xxl",block:!0,onClick:this.verificarAtualizacao})}),Object(C.jsx)(R,{size:"6",className:"mb-4",children:Object(C.jsx)(T,{text:"Par\xe2metros<br>do sistema",icon:"widgets",size:"xxl",block:!0,onClick:function(){t.setState({redirect:"/parametro"})}})}),Object(C.jsx)(R,{size:"6",className:"mb-4",children:Object(C.jsx)(T,{text:"Ferramentas",icon:"tools",size:"xxl",block:!0,onClick:function(){t.setState({redirect:"/ferramentas"})}})})]})})}),Object(C.jsxs)("div",{className:"serialnumber",children:[Object(C.jsx)("small",{children:"N\xfamero de s\xe9rie"}),Object(C.jsx)("br",{}),a]})]})}}]),a}(d.a.Component)),zt=a(168),Ut=a.n(zt),Vt=window.require("nodemailer"),Bt=function(){function t(){Object(i.a)(this,t),this.nodemailer=Vt,this._anexos=[],this._destinatario=null,this._titulo=null,this._remetente=null}return Object(s.a)(t,[{key:"anexo",value:function(t){this._anexos.push({filename:t.split("/").reverse()[0],path:t,cid:String(Math.random())})}},{key:"corpo",value:function(t){this._corpo=t}},{key:"destinatario",value:function(t){Array.isArray(t)&&(t=t.join(", ")),this._destinatario=t}},{key:"enviar",value:function(t,e){var a=this.nodemailer.createTransport({host:"smtp-relay.sendinblue.com",port:587,secure:!1,auth:{user:"murilo@controlware.com.br",pass:"2xhH64OnTwBPYvKF"},tls:{rejectUnauthorized:!1}}),o={from:'"'+this._remetente+'" <satflex@controlware.com.br>',to:this._destinatario,subject:this._titulo,html:this._corpo,attachments:this._anexos};a.sendMail(o,(function(a,o){return a?(e(a),a):(t(),!0)}))}},{key:"remetente",value:function(t){this._remetente=t}},{key:"titulo",value:function(t){this._titulo=t}}]),t}(),_t=(a(370),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=void 0!==this.props.text?this.props.text:this.props.children,e=void 0!==this.props.model?this.props.model:1;return Object(C.jsx)("h3",{className:"subtitle-model-"+e,children:t})}}]),a}(d.a.Component)),$t=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).atualizarEmailContador=o.atualizarEmailContador.bind(Object(O.a)(o)),o.carregarDocumentos=o.carregarDocumentos.bind(Object(O.a)(o)),o.enviarEmail=o.enviarEmail.bind(Object(O.a)(o)),o.Pool=new ut,o}return Object(s.a)(a,[{key:"atualizarEmailContador",value:function(){var t=Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.Pool.query("UPDATE parametro SET valor = $1 WHERE grupo = $2 AND nome = $3",[v()("#email").val(),"CONTADOR","EMAIL"]);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"carregarDocumentos",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=["SELECT chave, xml, chavecanc, xmlcanc","FROM documento","WHERE xml IS NOT NULL","  AND chave IS NOT NULL","  AND dthrcriacao::DATE BETWEEN $1 AND $2","ORDER BY dthrcriacao"].join(" "),t.next=3,this.Pool.query(e,[v()("#dtinicial").val(),v()("#dtfinal").val()]);case 3:return a=t.sent,t.abrupt("return",a.rows);case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"carregarEmailContador",value:function(){rt(this.Pool,"CONTADOR","EMAIL",(function(t){v()("#email").val(t)}))}},{key:"componentDidMount",value:function(){this.carregarEmailContador()}},{key:"enviarEmail",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o,n,i,s,c,u,l,d;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=v()("#email").val(),a=v()("#dtinicial").val(),o=v()("#dtfinal").val(),0!==e.length){t.next=6;break}return window.MessageBox.show({text:"Informe o e-mail do contador antes de prosseguir."}),t.abrupt("return",!1);case 6:if(0!==a.length){t.next=9;break}return window.MessageBox.show({text:"Informe a data inicial antes de prosseguir."}),t.abrupt("return",!1);case 9:if(0!==o.length){t.next=12;break}return window.MessageBox.show({text:"Informe a data final antes de prosseguir."}),t.abrupt("return",!1);case 12:return window.Loading.show(),t.next=15,rt(this.Pool,"EMITENTE","NOMEFANTASIA");case 15:return n=t.sent,a=a.split("-").reverse().join("/"),o=o.split("-").reverse().join("/"),t.next=20,this.atualizarEmailContador();case 20:return t.next=22,this.carregarDocumentos();case 22:if(0!==(i=t.sent).length){t.next=27;break}return window.Loading.hide(),window.MessageBox.show({text:"Nenhum documento fiscal foi encontrado no per\xedodo especificado."}),t.abrupt("return",!1);case 27:s=new Ut.a,i.forEach((function(t){t.xml&&s.file(t.chave+".xml",t.xml),t.xmlcanc&&s.file(t.chavecanc+".xml",t.xmlcanc)})),c=s.generate({base64:!1,compression:"DEFLATE"}),u=(new Date).toISOString().substr(0,10)+".zip",l=it(u,c),(d=new Bt).remetente(n),d.destinatario(e),d.titulo("SAT-Flex: XMLs de "+a+" at\xe9 "+o),d.anexo(l),d.corpo("Seguem os XMLs do per\xedodo de "+a+" at\xe9 "+o+" anexados ao e-mail."),d.enviar((function(){window.Loading.hide(),window.MessageBox.show({title:"Enviado com sucesso",text:"O e-mail contendo os XMLs no per\xedodo especificado foi enviado com sucesso para o e-mail do contador."})}),(function(t){window.Loading.hide(),window.MessageBox.show({title:"Houve uma falha",text:t.message})}));case 39:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=new Date,e=new Date(t.getFullYear(),t.getMonth()-1,1).toISOString().substr(0,10),a=new Date(t.getFullYear(),t.getMonth(),0).toISOString().substr(0,10);return Object(C.jsxs)(lt,{children:[Object(C.jsx)(Nt,{children:"M\xf3dulo do contador"}),Object(C.jsx)(_t,{children:"Enviar arquivos fiscais por e-mail"}),Object(C.jsx)(q,{children:Object(C.jsxs)(R,{size:"6",offset:"3",children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(wt,{type:"email",id:"email",label:"E-mail do contador",className:"col-12",size:"lg"}),Object(C.jsx)(wt,{type:"date",id:"dtinicial",label:"Data inicial",className:"col-6",size:"lg",defaultValue:e}),Object(C.jsx)(wt,{type:"date",id:"dtfinal",label:"Data final",className:"col-6",size:"lg",defaultValue:a})]}),Object(C.jsx)("div",{className:"text-center mt-2",children:Object(C.jsx)(T,{text:"Enviar arquivos por e-mail",icon:"mail-read",size:"lg",onClick:this.enviarEmail})})]})})]})}}]),a}(d.a.Component),Ht=a(169),Wt=a.n(Ht),Gt=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=["btn-group","btn-group-"+this.props.size];return this.props.className&&t.push(this.props.className),Object(C.jsx)("div",{className:t.join(" "),children:this.props.children})}}]),a}(d.a.Component);Gt.defaultProps={size:"md"};var Yt=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=[this.props.className];return t.push("text-center"),Object(C.jsx)("div",{className:t.join(" "),children:this.props.children})}}]),a}(d.a.Component),Qt=(a(379),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).carregarDados=o.carregarDados.bind(Object(O.a)(o)),o.carregarDadosCategoria=o.carregarDadosCategoria.bind(Object(O.a)(o)),o.carregarDadosFormaPagamento=o.carregarDadosFormaPagamento.bind(Object(O.a)(o)),o.carregarDadosGeral=o.carregarDadosGeral.bind(Object(O.a)(o)),o.carregarDadosProduto=o.carregarDadosProduto.bind(Object(O.a)(o)),o.state={tabela:null,dados:null},o.LineChart=Wt.a.Line,o.Pool=new ut,o}return Object(s.a)(a,[{key:"carregarDados",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,window.Loading.show(),a=null,t.t0=e,t.next="categoria"===t.t0?6:"formapagamento"===t.t0?10:"produto"===t.t0?14:18;break;case 6:return t.next=8,this.carregarDadosCategoria();case 8:return a=t.sent,t.abrupt("break",22);case 10:return t.next=12,this.carregarDadosFormaPagamento();case 12:return a=t.sent,t.abrupt("break",22);case 14:return t.next=16,this.carregarDadosProduto();case 16:return a=t.sent,t.abrupt("break",22);case 18:return t.next=20,this.carregarDadosGeral();case 20:return a=t.sent,t.abrupt("break",22);case 22:this.setState({tabela:e,dados:a}),t.next=28;break;case 25:t.prev=25,t.t1=t.catch(0),K(t.t1);case 28:return t.prev=28,window.Loading.hide(),t.finish(28);case 31:case"end":return t.stop()}}),t,this,[[0,25,28,31]])})));return function(e){return t.apply(this,arguments)}}()},{key:"carregarDadosCategoria",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o,n,i,s,c,u,l,d,p,h;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=["SELECT categoria.descricao AS a,","  v_vendaprodutodiario.dtvenda AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","LEFT JOIN categoria USING (idcategoria)","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '30 days'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=3,this.Pool.query(e);case 3:return a=t.sent,o=this.prepararDados(a.rows,"D"),n=["SELECT categoria.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","LEFT JOIN categoria USING (idcategoria)","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '6 months'::INTERVAL","  AND EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda) != 0","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=8,this.Pool.query(n);case 8:return i=t.sent,s=this.prepararDados(i.rows,"S"),c=["SELECT categoria.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(MONTH FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","LEFT JOIN categoria USING (idcategoria)","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '2 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=13,this.Pool.query(c);case 13:return u=t.sent,l=this.prepararDados(u.rows,"M"),d=["SELECT categoria.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda)) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","LEFT JOIN categoria USING (idcategoria)","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '10 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=18,this.Pool.query(d);case 18:return p=t.sent,h=this.prepararDados(p.rows,"Y"),t.abrupt("return",{diario:o,semanal:s,mensal:l,anual:h});case 21:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"carregarDadosFormaPagamento",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o,n,i,s,c,u,l,d,p,h;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=["SELECT formapagamento.descricao AS a,","  v_vendapagamentodiario.dtvenda AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendapagamentodiario, formapagamento","WHERE (v_vendapagamentodiario.idformapagamento IS NULL OR v_vendapagamentodiario.idformapagamento = formapagamento.idformapagamento)","  AND (formapagamento.status IS NULL OR formapagamento.status = 'A')","  AND v_vendapagamentodiario.dtvenda >= CURRENT_DATE - '30 days'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=3,this.Pool.query(e);case 3:return a=t.sent,o=this.prepararDados(a.rows,"D"),n=["SELECT formapagamento.descricao AS a,","  (EXTRACT(YEAR FROM v_vendapagamentodiario.dtvenda) || '-' || LPAD(EXTRACT(WEEK FROM v_vendapagamentodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendapagamentodiario, formapagamento","WHERE (v_vendapagamentodiario.idformapagamento IS NULL OR v_vendapagamentodiario.idformapagamento = formapagamento.idformapagamento)","  AND (formapagamento.status IS NULL OR formapagamento.status = 'A')","  AND v_vendapagamentodiario.dtvenda >= CURRENT_DATE - '6 months'::INTERVAL","  AND EXTRACT(WEEK FROM v_vendapagamentodiario.dtvenda) != 0","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=8,this.Pool.query(n);case 8:return i=t.sent,s=this.prepararDados(i.rows,"S"),c=["SELECT formapagamento.descricao AS a,","  (EXTRACT(YEAR FROM v_vendapagamentodiario.dtvenda) || '-' || LPAD(EXTRACT(MONTH FROM v_vendapagamentodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendapagamentodiario, formapagamento","WHERE (v_vendapagamentodiario.idformapagamento IS NULL OR v_vendapagamentodiario.idformapagamento = formapagamento.idformapagamento)","  AND (formapagamento.status IS NULL OR formapagamento.status = 'A')","  AND v_vendapagamentodiario.dtvenda >= CURRENT_DATE - '2 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=13,this.Pool.query(c);case 13:return u=t.sent,l=this.prepararDados(u.rows,"M"),d=["SELECT formapagamento.descricao AS a,","  (EXTRACT(YEAR FROM v_vendapagamentodiario.dtvenda)) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendapagamentodiario, formapagamento","WHERE (v_vendapagamentodiario.idformapagamento IS NULL OR v_vendapagamentodiario.idformapagamento = formapagamento.idformapagamento)","  AND (formapagamento.status IS NULL OR formapagamento.status = 'A')","  AND v_vendapagamentodiario.dtvenda >= CURRENT_DATE - '10 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=18,this.Pool.query(d);case 18:return p=t.sent,h=this.prepararDados(p.rows,"Y"),t.abrupt("return",{diario:o,semanal:s,mensal:l,anual:h});case 21:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"carregarDadosGeral",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o,n,i,s,c,u,l,d,p,h;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=["SELECT 'Venda' AS a,","  v_vendaprodutodiario.dtvenda AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario","WHERE v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '30 days'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=3,this.Pool.query(e);case 3:return a=t.sent,o=this.prepararDados(a.rows,"D"),n=["SELECT 'Venda' AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario","WHERE v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '6 months'::INTERVAL","  AND EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda) != 0","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=8,this.Pool.query(n);case 8:return i=t.sent,s=this.prepararDados(i.rows,"S"),c=["SELECT 'Venda' AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(MONTH FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario","WHERE v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '2 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=13,this.Pool.query(c);case 13:return u=t.sent,l=this.prepararDados(u.rows,"M"),d=["SELECT 'Venda' AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda)) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario","WHERE v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '10 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=18,this.Pool.query(d);case 18:return p=t.sent,h=this.prepararDados(p.rows,"Y"),t.abrupt("return",{diario:o,semanal:s,mensal:l,anual:h});case 21:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"carregarDadosProduto",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o,n,i,s,c,u,l,d,p,h;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=["SELECT produto.descricao AS a,","  v_vendaprodutodiario.dtvenda AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '30 days'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=3,this.Pool.query(e);case 3:return a=t.sent,o=this.prepararDados(a.rows,"D"),n=["SELECT produto.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '6 months'::INTERVAL","  AND EXTRACT(WEEK FROM v_vendaprodutodiario.dtvenda) != 0","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=8,this.Pool.query(n);case 8:return i=t.sent,s=this.prepararDados(i.rows,"S"),c=["SELECT produto.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda) || '-' || LPAD(EXTRACT(MONTH FROM v_vendaprodutodiario.dtvenda)::TEXT, 2, '0')) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '2 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=13,this.Pool.query(c);case 13:return u=t.sent,l=this.prepararDados(u.rows,"M"),d=["SELECT produto.descricao AS a,","  (EXTRACT(YEAR FROM v_vendaprodutodiario.dtvenda)) AS x,","  SUM(COALESCE(valor, 0)) AS y","FROM v_vendaprodutodiario, produto","WHERE (v_vendaprodutodiario.idproduto IS NULL OR v_vendaprodutodiario.idproduto = produto.idproduto)","  AND v_vendaprodutodiario.dtvenda >= CURRENT_DATE - '10 years'::INTERVAL","GROUP BY a, x","ORDER BY x, a"].join(" "),t.next=18,this.Pool.query(d);case 18:return p=t.sent,h=this.prepararDados(p.rows,"Y"),t.abrupt("return",{diario:o,semanal:s,mensal:l,anual:h});case 21:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.carregarDados("categoria")}},{key:"prepararDados",value:function(t,e){var a=[],o=[];for(var r in t){var n=t[r];switch(e){case"D":n.x=String(n.x.getDate()).lpad(2,"0")+"/"+String(n.x.getMonth()+1).lpad(2,"0")+"/"+n.x.getFullYear();break;case"S":case"M":n.x=n.x.split("-").reverse().join("/")}t[r].x=n.x,-1===o.indexOf(n.x)&&o.push(n.x),-1===a.indexOf(n.a)&&a.push(n.a)}for(var i={},s=0,c=o;s<c.length;s++){var u,l=c[s],d=Object(Dt.a)(a);try{for(d.s();!(u=d.n()).done;){var p=u.value;void 0===i[p]&&(i[p]=[]);var h,m=!1,b=Object(Dt.a)(t);try{for(b.s();!(h=b.n()).done;){var f=h.value;if(f.a===p&&f.x===l){i[p].push(f.y),m=!0;break}}}catch(O){b.e(O)}finally{b.f()}m||i[p].push(0)}}catch(O){d.e(O)}finally{d.f()}}var v=[];for(var j in i){void 0===this.cor&&(this.cor={}),"D"===e&&(this.cor[j]=Math.round(255*Math.random())+","+Math.round(255*Math.random())+","+Math.round(255*Math.random()));var x=this.cor[j];v.push({label:j,fillColor:"rgba("+x+",0.2)",strokeColor:"rgba("+x+",1)",pointColor:"rgba("+x+",1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba("+x+",1)",data:i[j]})}return{labels:o,datasets:v}}},{key:"render",value:function(){var t=this,e={legend:{display:!0}},a="300px",o="900px",r=null;null!==this.state.dados&&(r=Object(C.jsx)(this.LineChart,{data:this.state.dados.diario,options:e,height:a,width:o,redraw:!0}));var n=null;null!==this.state.dados&&(n=Object(C.jsx)(this.LineChart,{data:this.state.dados.semanal,options:e,height:a,width:o,redraw:!0}));var i=null;null!==this.state.dados&&(i=Object(C.jsx)(this.LineChart,{data:this.state.dados.mensal,options:e,height:a,width:o,redraw:!0}));var s=null;return null!==this.state.dados&&(s=Object(C.jsx)(this.LineChart,{data:this.state.dados.anual,options:e,height:a,width:o,redraw:!0})),Object(C.jsxs)(lt,{children:[Object(C.jsx)(Nt,{children:"Estat\xedsticas"}),Object(C.jsxs)(Yt,{className:"mb-5",children:[Object(C.jsxs)(Gt,{children:[Object(C.jsx)(T,{text:"Geral",color:"green",size:"lg",active:null===this.state.tabela,onClick:function(){t.carregarDados(null)}}),Object(C.jsx)(T,{text:"Finalizadora",color:"green",size:"lg",active:"formapagamento"===this.state.tabela,onClick:function(){t.carregarDados("formapagamento")}}),Object(C.jsx)(T,{text:"Categoria",color:"green",size:"lg",active:"categoria"===this.state.tabela,onClick:function(){t.carregarDados("categoria")}}),Object(C.jsx)(T,{text:"Produto",color:"green",size:"lg",active:"produto"===this.state.tabela,onClick:function(){t.carregarDados("produto")}})]}),Object(C.jsx)(_t,{model:"2",children:"Venda di\xe1ria nos \xfaltimos 30 dias"}),r,Object(C.jsx)(_t,{model:"2",children:"Venda semanal nos \xfaltimos 6 meses"}),n,Object(C.jsx)(_t,{model:"2",children:"Venda mensal nos \xfaltimos 2 anos"}),i,Object(C.jsx)(_t,{model:"2",children:"Venda anual nos \xfaltimos 10 anos"}),s]})]})}}]),a}(d.a.Component)),Jt=a(170),Kt=a.n(Jt),Xt=a(68),Zt=a.n(Xt),te="\x1b",ee=function(){function t(e){Object(i.a)(this,t),this.font=e,this.content=[]}return Object(s.a)(t,[{key:"barcode",value:function(t,e,a){e=void 0===e?50:e,a=void 0===a?1:a;var o=null;switch(t.length){case 7:case 8:o=68;break;case 12:case 13:o=67;break;default:o=70}this.content.push("\x1dh"+String.fromCharCode(e)),this.content.push("\x1dw"+String.fromCharCode(a)),this.content.push("\x1ba"+String.fromCharCode(1)),this.content.push("\x1dk"+String.fromCharCode(o)+String.fromCharCode(t.length)+t),this.content.push("\x1ba"+String.fromCharCode(0))}},{key:"bold",value:function(t){this.content.push("\x1bG"+String.fromCharCode(t?1:0))}},{key:"cut",value:function(){this.content.push("\x1dV"+String.fromCharCode(1))}},{key:"drawer",value:function(){this.content.push("\x1bp"+String.fromCharCode(0)+String.fromCharCode(13)+String.fromCharCode(10))}},{key:"feed",value:function(t){this.content.push("\x1bd"+String.fromCharCode(t))}},{key:"getContent",value:function(){return this.content.join("")}},{key:"reset",value:function(){this.content=[],this.content.push(te+String.fromCharCode(0)),this.content.push("\x1b "+String.fromCharCode(0)),this.content.push("\x1bM"+String.fromCharCode(this.font)),this.content.push("\x1d!"+String.fromCharCode(0)),this.content.push("\x1bt"+String.fromCharCode(3)),this.content.push("\x1bR"+String.fromCharCode(12)),this.content.push("\x1dB"+String.fromCharCode(0)),this.content.push("\x1bG"+String.fromCharCode(0)),this.content.push("\x1ba"+String.fromCharCode(0))}},{key:"qrcode",value:function(t){var e=t.length+3,a=e%256,o=e/256;this.content.push("\x1ba"+String.fromCharCode(1)),this.content.push("\x1d(k"+String.fromCharCode(4)+String.fromCharCode(0)+String.fromCharCode(49)+String.fromCharCode(65)+String.fromCharCode(50)+String.fromCharCode(0)),this.content.push("\x1d(k"+String.fromCharCode(3)+String.fromCharCode(0)+String.fromCharCode(49)+String.fromCharCode(67)+String.fromCharCode(3)),this.content.push("\x1d(k"+String.fromCharCode(3)+String.fromCharCode(0)+String.fromCharCode(49)+String.fromCharCode(69)+String.fromCharCode(51)),this.content.push("\x1d(k"+String.fromCharCode(a)+String.fromCharCode(o)+String.fromCharCode(49)+String.fromCharCode(80)+String.fromCharCode(48)+t),this.content.push("\x1d(k"+String.fromCharCode(3)+String.fromCharCode(0)+String.fromCharCode(49)+String.fromCharCode(81)+String.fromCharCode(48)),this.content.push("\x1ba"+String.fromCharCode(0))}},{key:"text",value:function(t,e){t=(t=t.removeSpecial()).replaceAll("|",String.fromCharCode(179)),e&&this.bold(!0),this.content.push(t+"\n"),e&&this.bold(!1)}}]),t}(),ae=function(){function t(e){Object(i.a)(this,t),this.Pool=e,this.os=Kt.a,this.childProcess=It.a,this.escpos=null,this.colunas=null,this.nome=null,this.modelo=null,this.documento=null,this.documentoprodutos=null,this.documentopagamentos=null,this.parametroImpressoraGuilhotina=null,this.parametroImpressoraModeloImpressao=null}return Object(s.a)(t,[{key:"alimentar",value:function(){var t=Object(n.a)(r.a.mark((function t(e){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=void 0===e?1:e,t.next=3,this.carregarEscPos();case 3:t.sent.feed(e);case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"barcode",value:function(){var t=Object(n.a)(r.a.mark((function t(e){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.carregarEscPos();case 2:t.sent.barcode(e);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"carregarEscPos",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null===this.escpos&&(e=this.colunas>48?"1":"0",this.escpos=new ee(e)),t.abrupt("return",this.escpos);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"carregarDadosDocumento",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a,o,n,i,s,c,u;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.Pool.connect();case 2:return i=t.sent,t.prev=3,t.next=6,i.query("SELECT * FROM documento WHERE iddocumento = $1",[e]);case 6:if(0!==(s=t.sent).rows.length){t.next=9;break}throw new Error("Nenhum documento foi encontrado.");case 9:return a=s.rows[0],c=["SELECT documentoproduto.*, unidade.precisao, unidade.sigla","FROM documentoproduto","LEFT JOIN produto USING (idproduto)","LEFT JOIN unidade USING (idunidade)","WHERE documentoproduto.iddocumento = $1","ORDER BY documentoproduto.sequencial"].join(" "),t.next=13,i.query(c,[e]);case 13:return s=t.sent,o=s.rows,u=["SELECT documentopagamento.*, formapagamento.descricao AS formapagamento","FROM documentopagamento","LEFT JOIN formapagamento USING (idformapagamento)","WHERE documentopagamento.iddocumento = $1"].join(" "),t.next=18,i.query(u,[e]);case 18:s=t.sent,n=s.rows,t.next=25;break;case 22:throw t.prev=22,t.t0=t.catch(3),t.t0;case 25:return t.prev=25,i.release(),t.finish(25);case 28:this.documento=a,this.documentoprodutos=o,this.documentopagamentos=n;case 31:case"end":return t.stop()}}),t,this,[[3,22,25,28]])})));return function(e){return t.apply(this,arguments)}}()},{key:"conteudo",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.carregarEscPos();case 2:return e=t.sent,t.abrupt("return",e.getContent());case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"gaveta",value:function(){var t=Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.carregarEscPos();case 2:t.sent.drawer();case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"guilhotina",value:function(){var t=Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==this.parametroImpressoraGuilhotina){t.next=4;break}return t.next=3,rt(this.Pool,"IMPRESSORA","GUILHOTINA");case 3:this.parametroImpressoraGuilhotina=t.sent;case 4:if("S"!==this.parametroImpressoraGuilhotina){t.next=9;break}return t.next=7,this.carregarEscPos();case 7:t.sent.cut();case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"imprimir",value:function(){var t=Object(n.a)(r.a.mark((function t(e,a,o){var n,i,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==e&&null!==e){t.next=4;break}return t.next=3,this.conteudo();case 3:e=t.sent;case 4:if(void 0!==o){t.next=12;break}if(null!==this.modelo){t.next=11;break}return t.next=8,rt(this.Pool,"IMPRESSORA","MODELO");case 8:o=t.sent,t.next=12;break;case 11:o=this.modelo;case 12:if("nenhum"!==o){t.next=14;break}return t.abrupt("return",!0);case 14:return n=it("printer.txt",e),a=void 0===a?this.nome:a,i=this.childProcess.execSync||window.require("child_process").execSync,s=(s='copy "'+n+'" '+a.toUpperCase()).replaceAll("/","\\"),i(s),t.abrupt("return",!0);case 17:case"end":return t.stop()}}),t,this)})));return function(e,a,o){return t.apply(this,arguments)}}()},{key:"imprimirCabecalho",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o,n,i,s,c,u,l;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,rt(this.Pool,"EMITENTE","NOMEFANTASIA");case 2:return e=t.sent,t.next=5,this.texto(e,"center",!0);case 5:return t.next=7,rt(this.Pool,"EMITENTE","RAZAOSOCIAL");case 7:if((a=t.sent)===e){t.next=11;break}return t.next=11,this.texto(a,"center",!0);case 11:return t.next=13,rt(this.Pool,"EMITENTE","ENDERECO");case 13:return o=t.sent,t.next=16,rt(this.Pool,"EMITENTE","NUMERO");case 16:return n=t.sent,t.next=19,this.texto(o+", "+n,"center");case 19:return t.next=21,rt(this.Pool,"EMITENTE","BAIRRO");case 21:return i=t.sent,t.next=24,rt(this.Pool,"EMITENTE","MUNICIPIO");case 24:return s=t.sent,t.next=27,rt(this.Pool,"EMITENTE","UF");case 27:return c=t.sent,t.next=30,this.texto(i+" - "+s+" - "+c,"center");case 30:return t.next=32,rt(this.Pool,"EMITENTE","CNPJ");case 32:return u=t.sent,t.next=35,rt(this.Pool,"EMITENTE","IE");case 35:return l=t.sent,t.next=38,this.texto("CNPJ "+u+" IE "+l,"center");case 38:return t.next=40,this.linha();case 40:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"imprimirDocumento",value:function(){var t=Object(n.a)(r.a.mark((function t(e,a,o){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.reiniciar();case 2:return t.next=4,this.carregarDadosDocumento(e);case 4:n=!1,t.t0=this.documento.status,t.next="A"===t.t0?8:"C"===t.t0?12:16;break;case 8:return t.next=10,this.imprimirDocumentoAtivo();case 10:return n=t.sent,t.abrupt("break",17);case 12:return t.next=14,this.imprimirDocumentoCancelado();case 14:return n=t.sent,t.abrupt("break",17);case 16:return t.abrupt("break",17);case 17:n&&"function"===typeof a?a():n||"function"!==typeof o||o();case 18:case"end":return t.stop()}}),t,this)})));return function(e,a,o){return t.apply(this,arguments)}}()},{key:"imprimirDocumentoAtivo",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a,o,i,s,c,u,l,d,p,h,m,b,f,v,j,x,O,g,C=this;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=void 0===e?1:e,a=null,o=null,"CU"===this.documento.operacao&&this.documento.xml&&(i=Zt.a.xml2json(this.documento.xml,{compact:!0}),i=JSON.parse(i),a=i.CFe.infCFe.infAdic.infCpl._text,i.CFe.infCFe.ide.assinaturaQRCODE&&(o=i.CFe.infCFe.ide.assinaturaQRCODE._text)),t.next=6,this.imprimirCabecalho();case 6:s=null,c=this.documento.dthrcriacao,u=c.toLocaleString().split(" ")[0],l=String(c.getHours()).lpad(2,"0")+":"+String(c.getMinutes()).lpad(2,"0")+":"+String(c.getSeconds()).lpad(2,"0"),t.t0=this.documento.operacao,t.next="CU"===t.t0?13:"NC"===t.t0?19:"OR"===t.t0?25:"RE"===t.t0?31:37;break;case 13:return s=String(this.documento.numero?this.documento.numero:this.documento.iddocumento).lpad(6,"0"),t.next=16,this.texto("CUPOM FISCAL ELETR\xd4NICO - SAT","center",!0);case 16:return t.next=18,this.texto("COO: "+s+"  Data: "+u+"  Hora: "+l,"center");case 18:return t.abrupt("break",38);case 19:return s=String(this.documento.numero?this.documento.numero:"").lpad(6,"0"),t.next=22,this.texto("NOTA FISCAL A PARTIR DE CUPOM","center",!0);case 22:return t.next=24,this.texto("N\xfam: "+s+"  Data: "+u+"  Hora: "+l,"center");case 24:return t.abrupt("break",38);case 25:return s=String(this.documento.iddocumento?this.documento.iddocumento:"").lpad(6,"0"),t.next=28,this.texto("OR\xc7AMENTO - SEM VALOR FISCAL","center",!0);case 28:return t.next=30,this.texto("N\xfam: "+s+"  Data: "+u+"  Hora: "+l,"center");case 30:return t.abrupt("break",38);case 31:return s=String(this.documento.numero?this.documento.numero:"").lpad(6,"0"),t.next=34,this.texto("NOTA FISCAL DE REMESSA","center",!0);case 34:return t.next=36,this.texto("N\xfam: "+s+"  Data: "+u+"  Hora: "+l,"center");case 36:case 37:return t.abrupt("break",38);case 38:return t.next=40,this.linha();case 40:d=null,t.t1=this.documento.operacao,t.next="CU"===t.t1?44:"OR"===t.t1?48:"NC"===t.t1||"RE"===t.t1?55:79;break;case 44:return d=this.documento.cpfcnpj?this.documento.cpfcnpj:"n\xe3o informado",t.next=47,this.texto("CPF/CNPJ do consumidor: "+d);case 47:return t.abrupt("break",80);case 48:return d=this.documento.cpfcnpj?this.documento.cpfcnpj:"n\xe3o informado",p=this.documento.nomeorcamento?this.documento.nomeorcamento:"n\xe3o informado",t.next=52,this.texto("Nome do cliente: "+p);case 52:return t.next=54,this.texto("CPF/CNPJ do cliente: "+d);case 54:return t.abrupt("break",80);case 55:return h=["SELECT parceiro.nome, parceiro.tipopessoa, parceiro.cpfcnpj,","  parceiro.inscricaoestadual, cidade.nome AS cidade, estado.sigla AS estado,","  parceiro.cep, parceiro.bairro, parceiro.endereco, parceiro.numero,","  parceiro.complemento","FROM parceiro","LEFT JOIN cidade USING (idcidade)","LEFT JOIN estado USING (idestado)","WHERE parceiro.idparceiro = $1"].join(" "),t.next=58,this.Pool.query(h,[this.documento.idparceiro]);case 58:return m=t.sent,b=m.rows[0],t.next=62,this.texto("DADOS DO DESTINATARIO","center",!0);case 62:return t.next=64,this.texto("Nome: "+b.nome);case 64:return t.next=66,this.texto(("F"===b.tipopessoa?"CPF":"CNPJ")+": "+b.cpfcnpj);case 66:if(!b.inscricaoestadual){t.next=69;break}return t.next=69,this.texto("Inscricao estadual: "+b.inscricaoestadual);case 69:return t.next=71,this.texto("Cidade: "+b.cidade+" - "+b.estado);case 71:return t.next=73,this.texto("CEP: "+b.cep+"   Bairro: "+b.bairro);case 73:return t.next=75,this.texto("Endere\xe7o: "+b.endereco+", "+b.numero);case 75:if(!b.complemento){t.next=78;break}return t.next=78,this.texto("Complemento: "+this.complemento);case 78:case 79:return t.abrupt("break",80);case 80:return t.next=82,this.linha();case 82:if(null!==this.parametroImpressoraModeloImpressao){t.next=86;break}return t.next=85,rt(this.Pool,"IMPRESSORA","MODELOIMPRESSAO");case 85:this.parametroImpressoraModeloImpressao=t.sent;case 86:t.t2=this.parametroImpressoraModeloImpressao,t.next="1"===t.t2?89:"2"===t.t2?92:95;break;case 89:return t.next=91,this.imprimirListaProdutosModelo01();case 91:return t.abrupt("break",98);case 92:return t.next=94,this.imprimirListaProdutosModelo02();case 94:return t.abrupt("break",98);case 95:return t.next=97,this.imprimirListaProdutosModelo01();case 97:return t.abrupt("break",98);case 98:return f=this.documento.totaldocumento.format(2,",","."),t.next=101,this.texto("TOTAL"+" ".repeat(this.colunas-(5+f.length))+f,"left",!0);case 101:return t.next=103,this.alimentar(1);case 103:return t.next=105,this.documentopagamentos.forEach(function(){var t=Object(n.a)(r.a.mark((function t(e,a){var o,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=0,n=e.formapagamento.removeSpecial(),o=(o=a+1===C.documentopagamentos.length?parseFloat(e.totalpagamento)+parseFloat(C.documento.totaltroco):e.totalpagamento).format(2,",","."),t.next=6,C.texto(n+" ".repeat(C.colunas-n.length-o.length)+o);case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}());case 105:if(!(this.documento.totaltroco>0)){t.next=110;break}return v="Troco",j=this.documento.totaltroco.format(2,",","."),t.next=110,this.texto(v+" ".repeat(this.colunas-v.length-j.length)+j);case 110:if(!this.documento.chave){t.next=145;break}return t.next=113,this.linha();case 113:if("CU"!==this.documento.operacao){t.next=129;break}return t.next=116,this.texto("OBSERVA\xc7\xd5ES DO CONTRIBUINTE","center");case 116:return t.next=118,this.texto("ICMS recolhido conforme LC 123/2006 - Simples Nacional.");case 118:return t.next=120,this.texto(a);case 120:return t.next=122,this.linha();case 122:return t.next=124,rt(this.Pool,"SAT","SERIE");case 124:return x=t.sent,t.next=127,this.texto("SAT No. "+x,"center");case 127:return t.next=129,this.texto(u+" - "+l,"center");case 129:return O=this.documento.chave.substr(-44),t.next=132,this.alimentar(1);case 132:return t.next=134,this.texto(O,"center");case 134:return t.next=136,this.barcode(O.substr(0,22));case 136:return t.next=138,this.alimentar(1);case 138:return t.next=140,this.barcode(O.substr(22));case 140:if(!o){t.next=145;break}return t.next=143,this.alimentar(1);case 143:return t.next=145,this.qrcode(o);case 145:return t.next=147,this.alimentar(3);case 147:return t.next=149,this.guilhotina();case 149:g=0;case 150:if(!(g<e)){t.next=156;break}if(this.imprimir()){t.next=153;break}return t.abrupt("return",!1);case 153:g++,t.next=150;break;case 156:return t.abrupt("return",!0);case 157:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"imprimirDocumentoCancelado",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a,o,n,i,s,c,u,l,d,p,h,m,b,f,v,j;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,rt(this.Pool,"SAT","SERIE");case 2:return a=t.sent,o=null,n=null,i=null,s=null,"CU"===this.documento.operacao&&this.documento.xml&&(o=Zt.a.xml2json(this.documento.xml,{compact:!0}),(o=JSON.parse(o)).CFe.infCFe.ide.assinaturaQRCODE&&(n=o.CFe.infCFe.ide.assinaturaQRCODE._text),i=Zt.a.xml2json(this.documento.xml,{compact:!0}),(i=JSON.parse(i)).CFe.infCFe.ide.assinaturaQRCODE&&(s=i.CFe.infCFe.ide.assinaturaQRCODE._text)),t.next=10,this.imprimirCabecalho();case 10:c=null,u=this.documento.dthrcriacao,l=u.toLocaleString().split(" ")[0],d=String(u.getHours()).lpad(2,"0")+":"+String(u.getMinutes()).lpad(2,"0")+":"+String(u.getSeconds()).lpad(2,"0"),t.t0=this.documento.operacao,t.next="CU"===t.t0?17:"NC"===t.t0?23:"OR"===t.t0?29:"RE"===t.t0?35:41;break;case 17:return c=String(this.documento.numero?this.documento.numero:this.documento.iddocumento).lpad(6,"0"),t.next=20,this.texto("CUPOM FISCAL ELETR\xd4NICO - SAT","center",!0);case 20:return t.next=22,this.texto("COO: "+c+"  Data: "+l+"  Hora: "+d,"center");case 22:return t.abrupt("break",42);case 23:return c=String(this.documento.numero?this.documento.numero:"").lpad(6,"0"),t.next=26,this.texto("NOTA FISCAL A PARTIR DE CUPOM","center",!0);case 26:return t.next=28,this.texto("N\xfamero: "+c+"  Data: "+l+"  Hora: "+d,"center");case 28:return t.abrupt("break",42);case 29:return c=String(this.documento.iddocumento?this.documento.iddocumento:"").lpad(6,"0"),t.next=32,this.texto("OR\xc7AMENTO - SEM VALOR FISCAL","center",!0);case 32:return t.next=34,this.texto("N\xfamero: "+c+"  Data: "+l+"  Hora: "+d,"center");case 34:return t.abrupt("break",42);case 35:return c=String(this.documento.numero?this.documento.numero:"").lpad(6,"0"),t.next=38,this.texto("NOTA FISCAL DE REMESSA","center",!0);case 38:return t.next=40,this.texto("N\xfamero: "+c+"  Data: "+l+"  Hora: "+d,"center");case 40:case 41:return t.abrupt("break",42);case 42:return t.next=44,this.texto("CANCELAMENTO","center",!0);case 44:return t.next=46,this.linha();case 46:t.t1=this.documento.operacao,t.next="CU"===t.t1?49:"OR"===t.t1?54:60;break;case 49:return t.next=51,this.texto("Dados do cupom fiscal eletronico cancelado","center",!0);case 51:return t.next=53,this.texto("SAT No. "+a,"center");case 53:return t.abrupt("break",66);case 54:return p=this.documento.iddocumento.lpad(6,"0"),t.next=57,this.texto("Dados do or\xe7amento cancelado","center",!0);case 57:return t.next=59,this.texto("Or\xe7amento No. "+p,"center");case 59:return t.abrupt("break",66);case 60:return h=this.documento.numero.lpad(6,"0"),t.next=63,this.texto("Dados do nota fiscal eletronica cancelada","center",!0);case 63:return t.next=65,this.texto("Nota Fiscal No. "+h,"center");case 65:return t.abrupt("break",66);case 66:return t.next=68,this.texto("TOTAL R$ "+this.documento.totaldocumento.format(2,",","."),"center");case 68:return t.next=70,this.texto(l+" "+d,"center");case 70:if(!this.documento.chave){t.next=87;break}return t.next=73,this.alimentar(1);case 73:return m=this.documento.chave.substr(-44),t.next=76,this.texto(m,"center");case 76:return t.next=78,this.barcode(m.substr(0,22));case 78:return t.next=80,this.alimentar(1);case 80:return t.next=82,this.barcode(m.substr(22));case 82:if(!n){t.next=87;break}return t.next=85,this.alimentar(1);case 85:return t.next=87,this.qrcode(n);case 87:return t.next=89,this.linha();case 89:if("CU"!==this.documento.operacao){t.next=116;break}return b=this.documento.dthrcancelamento,f=b.toLocaleString().split(" ")[0],v=String(b.getHours()).lpad(2,"0")+":"+String(b.getMinutes()).lpad(2,"0")+":"+String(b.getSeconds()).lpad(2,"0"),t.next=95,this.texto("Dados do cupom fiscal eletronico de cancelamento","center",!0);case 95:return t.next=97,this.texto("SAT No. "+a,"center");case 97:return t.next=99,this.texto(f+" "+v,"center");case 99:if(!this.documento.chavecanc){t.next=116;break}return t.next=102,this.alimentar(1);case 102:return j=this.documento.chavecanc.substr(-44),t.next=105,this.texto(j,"center");case 105:return t.next=107,this.barcode(j.substr(0,22));case 107:return t.next=109,this.alimentar(1);case 109:return t.next=111,this.barcode(j.substr(22));case 111:if(!s){t.next=116;break}return t.next=114,this.alimentar(1);case 114:return t.next=116,this.qrcode(s);case 116:return t.next=118,this.alimentar(6);case 118:return t.next=120,this.guilhotina();case 120:if(this.imprimir()){t.next=122;break}return t.abrupt("return",!1);case 122:return t.abrupt("return",!0);case 123:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"imprimirListaProdutosModelo01",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e=this;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.texto("#   Descri\xe7\xe3o"+" ".repeat(this.colunas-40)+"   Qtde X Pre\xe7o       Total");case 2:return t.next=4,this.linha();case 4:return t.next=6,this.documentoprodutos.forEach(function(){var t=Object(n.a)(r.a.mark((function t(a){var o,n,i,s,c,u,l,d,p,h;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=String(a.sequencial).lpad(3,"0"),n=(a.quantidade*a.preco).format(2,",","."),i=a.quantidade.format(a.precisao,",",".")+" "+a.sigla,s=i.lpad(10," ")+" X "+a.preco.format(2,",",".").rpad(8," ")+" "+n.lpad(8," "),c=e.colunas-(o.length+s.length+2),u=a.descricao.removeSpecial().substr(0,c).rpad(c," "),t.next=8,e.texto(o+" "+u+" "+s);case 8:if(!(a.totaldesconto>0)){t.next=13;break}return l="-"+a.totaldesconto.format(2,",","."),d="    Desconto"+" ".repeat(e.colunas-(12+l.length))+l,t.next=13,e.texto(d);case 13:if(!(a.totalacrescimo>0)){t.next=18;break}return p="+"+a.totalacrescimo.format(2,",","."),h="    Acrescimo"+" ".repeat(e.colunas-(13+p.length))+p,t.next=18,e.texto(h);case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"imprimirListaProdutosModelo02",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o,n,i,s,c,u,l,d,p,h,m,b;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.texto("Descri\xe7\xe3o do produto");case 2:return t.next=4,this.texto("Quantidade X Pre\xe7o"+" ".repeat(this.colunas-23)+"Total");case 4:return t.next=6,this.linha();case 6:e=0;case 7:if(!(e<this.documentoprodutos.length)){t.next=34;break}return a=this.documentoprodutos[e],o=a.descricao.removeSpecial(),n=String(a.sequencial).lpad(3,"0"),i=a.quantidade.format(a.precisao,",",".")+" "+a.sigla,s=a.preco.format(2,",","."),c=(a.quantidade*a.preco).format(2,",","."),u=n+" "+o,t.next=17,this.texto(u);case 17:return d=(l="    "+i+" X "+s)+" ".repeat(this.colunas-l.length-c.length)+c,t.next=21,this.texto(d);case 21:if(!(a.totaldesconto>0)){t.next=26;break}return p="-"+a.totaldesconto.format(2,",","."),h="    Desconto"+" ".repeat(this.colunas-(12+p.length))+p,t.next=26,this.texto(h);case 26:if(!(a.totalacrescimo>0)){t.next=31;break}return m="+"+a.totalacrescimo.format(2,",","."),b="    Acrescimo"+" ".repeat(this.colunas-(13+m.length))+m,t.next=31,this.texto(b);case 31:e++,t.next=7;break;case 34:return t.next=36,this.linha();case 36:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"linha",value:function(){var t=Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.texto("-".repeat(this.colunas));case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"qrcode",value:function(){var t=Object(n.a)(r.a.mark((function t(e){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.carregarEscPos();case 2:t.sent.qrcode(e);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"reiniciar",value:function(){var t=Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==this.colunas){t.next=6;break}return t.t0=parseInt,t.next=4,rt(this.Pool,"IMPRESSORA","COLUNAS");case 4:t.t1=t.sent,this.colunas=(0,t.t0)(t.t1,10);case 6:if(null!==this.nome){t.next=10;break}return t.next=9,rt(this.Pool,"IMPRESSORA","NOME");case 9:this.nome=t.sent;case 10:if(null!==this.modelo){t.next=14;break}return t.next=13,rt(this.Pool,"IMPRESSORA","MODELO");case 13:this.modelo=t.sent;case 14:return t.next=16,this.carregarEscPos();case 16:t.sent.reset();case 18:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"texto",value:function(){var t=Object(n.a)(r.a.mark((function t(e,a,o){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=void 0===a?"left":a,o=void 0!==o&&o,null===e&&(e=""),t.next=5,this.carregarEscPos();case 5:n=t.sent,t.t0=a,t.next="center"===t.t0?9:"left"===t.t0?11:"right"===t.t0?13:15;break;case 9:return e=e.cpad(this.colunas," "),t.abrupt("break",16);case 11:return e=e.rpad(this.colunas," "),t.abrupt("break",16);case 13:return e=e.lpad(this.colunas," "),t.abrupt("break",16);case 15:return t.abrupt("break",16);case 16:e=e.substr(0,this.colunas),n.text(e,o);case 18:case"end":return t.stop()}}),t,this)})));return function(e,a,o){return t.apply(this,arguments)}}()}]),t}(),oe=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;Object(i.a)(this,a),(o=e.call(this,t)).state={tipo:null,dtinicial:null,dtfinal:null,ativarFechamentoRelatorio:!1,ativarFechamentoResumo:!1},o.gerar=o.gerar.bind(Object(O.a)(o)),o.imprimir=o.imprimir.bind(Object(O.a)(o)),o.Pool=new ut,o.Printer=new ae(o.Pool);var r=["CU"];for(var n in r)r[n]="'"+r[n]+"'";return o.operacaoQuery="("+r.join(", ")+")",o}return Object(s.a)(a,[{key:"gerar",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e=this;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(v()("#tipo").val()){t.next=3;break}return window.MessageBox.show({text:"Por favor, informe o tipo de fechamento antes de prosseguir."}),t.abrupt("return",!1);case 3:if(v()("#dtinicial").val()){t.next=6;break}return window.MessageBox.show({text:"Por favor, informe a data inicial do fechamento antes de prosseguir."}),t.abrupt("return",!1);case 6:if(v()("#dtfinal").val()){t.next=9;break}return window.MessageBox.show({text:"Por favor, informe a data final do fechamento antes de prosseguir."}),t.abrupt("return",!1);case 9:return t.next=11,this.prepararImpressao();case 11:this.setState({tipo:v()("#tipo").val(),dtinicial:v()("#dtinicial").val(),dtfinal:v()("#dtfinal").val(),ativarFechamentoRelatorio:!1,ativarFechamentoResumo:!1},(function(){e.setState({ativarFechamentoRelatorio:!0},(function(){e.setState({ativarFechamentoResumo:!0})}))}));case 12:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"imprimir",value:function(){var t=Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.Printer.alimentar(3);case 2:return t.next=4,this.Printer.guilhotina();case 4:return t.next=6,this.Printer.imprimir();case 6:window.FastMessage.show("Fechamento impresso com sucesso!");case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"prepararImpressao",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.Printer.reiniciar();case 2:return e=v()("#dtinicial").val().split("-").reverse().join("/"),a=v()("#dtfinal").val().split("-").reverse().join("/"),t.t0=this.Printer,t.next=7,rt(this.Pool,"EMITENTE","NOMEFANTASIA");case 7:return t.t1=t.sent,t.next=10,t.t0.texto.call(t.t0,t.t1,"center",!0);case 10:return t.next=12,this.Printer.texto("FECHAMENTO: "+e+" a "+a,"center",!0);case 12:return t.next=14,this.Printer.alimentar();case 14:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=!this.state.tipo;return Object(C.jsxs)(lt,{className:"Fechamento",children:[Object(C.jsx)(Nt,{children:"Fechamento"}),Object(C.jsx)(q,{children:Object(C.jsxs)(R,{size:"6",offset:"3",children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(wt,{type:"select",id:"tipo",label:"Fechamento por",className:"col-12",options:{data:"Data",categoria:"Categoria",formapagamento:"Forma de pagamento",produto:"Produto"},defaultValue:"data"}),Object(C.jsx)(wt,{type:"date",id:"dtinicial",label:"Data inicial",className:"col-6",defaultValue:Y()}),Object(C.jsx)(wt,{type:"date",id:"dtfinal",label:"Data final",className:"col-6",defaultValue:Y()})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",className:"pr-0",children:Object(C.jsx)(T,{text:"Gerar",block:!0,color:"green",icon:"file-play",onClick:this.gerar})}),Object(C.jsx)(R,{size:"6",className:"pl-0",children:Object(C.jsx)(T,{text:"Imprimir",block:!0,color:"blue",icon:"printer",onClick:this.imprimir,disabled:t})})]})]})}),Object(C.jsx)(re,{Pool:this.Pool,Printer:this.Printer,tipo:this.state.tipo,dtinicial:this.state.dtinicial,dtfinal:this.state.dtfinal,operacaoQuery:this.operacaoQuery,ativar:this.state.ativarFechamentoRelatorio}),Object(C.jsx)(ne,{Pool:this.Pool,Printer:this.Printer,dtinicial:this.state.dtinicial,dtfinal:this.state.dtfinal,operacaoQuery:this.operacaoQuery,ativar:this.state.ativarFechamentoResumo})]})}}]),a}(d.a.Component),re=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={dados:[]},o.tipoDescritivo=o.tipoDescritivo.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"carregarDados",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a,o,n,i,s,c,u,l,d,p,h,m,b;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((e=void 0===e?this.props:e).ativar){t.next=3;break}return t.abrupt("return");case 3:a=null,t.t0=e.tipo,t.next="categoria"===t.t0?7:"data"===t.t0?9:"formapagamento"===t.t0?11:"produto"===t.t0?13:15;break;case 7:return a=["SELECT categoria.descricao,","  SUM(documentoproduto.quantidade) AS quantidade,","  SUM(documentoproduto.totalproduto) AS total","FROM documentoproduto","INNER JOIN documento USING (iddocumento)","INNER JOIN produto USING (idproduto)","INNER JOIN categoria USING (idcategoria)","WHERE documento.dthrcriacao::DATE BETWEEN $1 AND $2","  AND documento.status = 'A'","  AND documento.operacao IN "+e.operacaoQuery,"GROUP BY 1","ORDER BY 3 DESC"].join(" "),t.abrupt("break",16);case 9:return a=["SELECT TO_CHAR(documento.dthrcriacao, 'DD/MM/YYYY') AS descricao,","  SUM(documentoproduto.quantidade) AS quantidade,","  SUM(documentoproduto.totalproduto) AS total,","  documento.dthrcriacao::DATE AS dtcriacao","FROM documentoproduto","INNER JOIN documento USING (iddocumento)","WHERE documento.dthrcriacao::DATE BETWEEN $1 AND $2","  AND documento.status = 'A'","  AND documento.operacao IN "+e.operacaoQuery,"GROUP BY 1, 4","ORDER BY 4"].join(" "),t.abrupt("break",16);case 11:return a=["SELECT formapagamento.descricao,","  COUNT(documentopagamento.iddocumentopagamento) AS quantidade,","  SUM(documentopagamento.totalpagamento) AS total","FROM documentopagamento","INNER JOIN documento USING (iddocumento)","INNER JOIN formapagamento USING (idformapagamento)","WHERE documento.dthrcriacao::DATE BETWEEN $1 AND $2","  AND documento.status = 'A'","  AND documento.operacao IN "+e.operacaoQuery,"GROUP BY 1","ORDER BY 3 DESC"].join(" "),t.abrupt("break",16);case 13:return a=["SELECT produto.descricao,","  SUM(documentoproduto.quantidade) AS quantidade,","  SUM(documentoproduto.totalproduto) AS total","FROM documentoproduto","INNER JOIN documento USING (iddocumento)","INNER JOIN produto USING (idproduto)","WHERE documento.dthrcriacao::DATE BETWEEN $1 AND $2","  AND documento.status = 'A'","  AND documento.operacao IN "+e.operacaoQuery,"GROUP BY 1","ORDER BY 3 DESC"].join(" "),t.abrupt("break",16);case 15:return t.abrupt("break",16);case 16:return t.next=18,e.Pool.query(a,[e.dtinicial,e.dtfinal]);case 18:return o=t.sent,n=this.props.Printer.colunas,c=n-(i=6)-(s=10),u=this.tipoDescritivo().substr(0,c).rpad(c," "),u+="Qtde".substr(0,i).cpad(i," "),u+="Total".substr(0,s).lpad(s," "),t.next=28,this.props.Printer.texto(u,"left",!0);case 28:t.t1=r.a.keys(o.rows);case 29:if((t.t2=t.t1()).done){t.next=42;break}return l=t.t2.value,d=o.rows[l],p=d.descricao.removeSpecial(),h=d.quantidade.format(0,",","."),m=d.total.format(2,",","."),b=p.substr(0,c).rpad(c," "),b+=h.substr(0,i).cpad(i," "),b+=m.substr(0,s).lpad(s," "),t.next=40,this.props.Printer.texto(b);case 40:t.next=29;break;case 42:return t.next=44,this.props.Printer.alimentar(2);case 44:this.setState({dados:o.rows});case 45:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"componentWillUpdate",value:function(t){t!==this.props&&this.carregarDados(t)}},{key:"tipoDescritivo",value:function(){switch(this.props.tipo){case"categoria":return"Categoria";case"data":return"Data";case"formapagamento":return"Forma de pagamento";case"produto":return"Produto";default:return this.props.tipo}}},{key:"render",value:function(){if(!this.props.ativar||null===this.props.tipo)return null;var t=0,e=0;return Object(C.jsx)(q,{className:"mt-5",children:Object(C.jsx)(R,{size:"8",offset:"2",children:Object(C.jsxs)("table",{className:"table table-striped",children:[Object(C.jsx)("thead",{children:Object(C.jsxs)("tr",{children:[Object(C.jsx)("th",{children:this.tipoDescritivo()}),Object(C.jsx)("th",{className:"text-center",children:"Quantidade"}),Object(C.jsx)("th",{className:"text-right",children:"Total"})]})}),Object(C.jsx)("tbody",{children:this.state.dados.map((function(a,o){return t+=parseFloat(a.quantidade),e+=parseFloat(a.total),Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:a.descricao}),Object(C.jsx)("td",{className:"text-center",children:a.quantidade.format(0,",",".")}),Object(C.jsx)("td",{className:"text-right",children:"R$ "+a.total.format(2,",",".")})]},o)}))}),Object(C.jsx)("tfoot",{children:Object(C.jsxs)("tr",{children:[Object(C.jsx)("th",{}),Object(C.jsx)("th",{className:"text-center",children:t.format(0,",",".")}),Object(C.jsx)("th",{className:"text-right",children:"R$ "+e.format(2,",",".")})]})})]})})})}}]),a}(d.a.Component),ne=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={totalbruto:0,totalcancelado:0,qtdecancelado:0,totalativo:0,qtdeativo:0,totalorcamento:0},o.carregarDados=o.carregarDados.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"carregarDados",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a,o,n,i,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((e=void 0===e?this.props:e).ativar){t.next=3;break}return t.abrupt("return");case 3:return a=["SELECT COALESCE((SELECT SUM(totaldocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND operacao IN ("+e.operacaoQuery+")), 0) AS totalbruto,","  COALESCE((SELECT SUM(totaldocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND status = 'C' AND operacao IN ("+e.operacaoQuery+")), 0) AS totalcancelado,","  COALESCE((SELECT COUNT(iddocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND status = 'C' AND operacao IN ("+e.operacaoQuery+")), 0) AS qtdecancelado,","  COALESCE((SELECT SUM(totaldocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND status = 'A' AND operacao IN ("+e.operacaoQuery+")), 0) AS totalativo,","  COALESCE((SELECT COUNT(iddocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND status = 'A' AND operacao IN ("+e.operacaoQuery+")), 0) AS qtdeativo,","  COALESCE((SELECT SUM(totaldocumento) FROM documento WHERE dthrcriacao::DATE BETWEEN $1 AND $2 AND status = 'A' AND operacao IN ('OR')), 0) AS totalorcamento"].join(" "),t.next=6,e.Pool.query(a,[e.dtinicial,e.dtfinal]);case 6:return o=t.sent,n=o.rows[0],i=15,s=this.props.Printer.colunas-i,t.next=12,this.props.Printer.texto("RESUMO","center",!0);case 12:return t.next=14,this.props.Printer.texto("Total bruto das vendas".rpad(s," ")+n.totalbruto.format(2,",",".").lpad(i," "));case 14:return t.next=16,this.props.Printer.texto("Total de vendas canceladas".rpad(s," ")+n.totalcancelado.format(2,",",".").lpad(i," "));case 16:return t.next=18,this.props.Printer.texto("Quantidade de vendas canceladas".rpad(s," ")+n.qtdecancelado.format(0,",",".").lpad(i," "));case 18:return t.next=20,this.props.Printer.texto("Total liquido das vendas".rpad(s," ")+n.totalativo.format(2,",",".").lpad(i," "));case 20:return t.next=22,this.props.Printer.texto("Quantidade de vendas".rpad(s," ")+n.qtdeativo.format(0,",",".").lpad(i," "));case 22:return t.next=24,this.props.Printer.texto("Total liquido das vendas".rpad(s," ")+(n.totalativo/n.qtdeativo).format(2,",",".").lpad(i," "));case 24:return t.next=26,this.props.Printer.texto("Total bruto dos orcamentos".rpad(s," ")+n.totalorcamento.format(2,",",".").lpad(i," "));case 26:return t.next=28,this.props.Printer.alimentar(2);case 28:this.setState({totalbruto:n.totalbruto,totalcancelado:n.totalcancelado,qtdecancelado:n.qtdecancelado,totalativo:n.totalativo,qtdeativo:n.qtdeativo,totalorcamento:n.totalorcamento});case 29:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"componentWillUpdate",value:function(t){t!==this.props&&this.carregarDados(t)}},{key:"render",value:function(){return this.props.ativar&&null!==this.props.dtinicial&&null!==this.props.dtfinal?Object(C.jsxs)("div",{className:"mb-5",children:[Object(C.jsx)(_t,{text:"Resumo"}),Object(C.jsx)(q,{children:Object(C.jsx)(R,{size:"8",offset:"2",children:Object(C.jsx)("table",{className:"table table-striped",children:Object(C.jsxs)("tbody",{children:[Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:"Total bruto das vendas"}),Object(C.jsx)("td",{className:"text-right",children:"R$ "+this.state.totalbruto.format(2,",",".")})]}),Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:"Total de vendas canceladas"}),Object(C.jsx)("td",{className:"text-right",children:"R$ "+this.state.totalcancelado.format(2,",",".")})]}),Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:"Quantidade de vendas canceladas"}),Object(C.jsx)("td",{className:"text-right",children:this.state.qtdecancelado})]}),Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:"Total liquido de vendas"}),Object(C.jsx)("td",{className:"text-right",children:"R$ "+this.state.totalativo.format(2,",",".")})]}),Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:"Quantidade de vendas"}),Object(C.jsx)("td",{className:"text-right",children:this.state.qtdeativo})]}),Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:"Ticket m\xe9dio das vendas"}),Object(C.jsx)("td",{className:"text-right",children:"R$ "+(this.state.totalativo/this.state.qtdeativo).format(2,",",".")})]}),Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:"Total dos or\xe7amentos"}),Object(C.jsx)("td",{className:"text-right",children:"R$ "+this.state.totalorcamento.format(2,",",".")})]})]})})})})]}):null}}]),a}(d.a.Component),ie=a(171),se=a.n(ie),ce=(window.require("electron"),window.require("@electron/remote")),ue=function(){function t(e){Object(i.a)(this,t),this.Pool=e}return Object(s.a)(t,[{key:"corAleatoria",value:function(){var t=["#b71c1c","#d32f2f","#f44336","#e57373","#ffcdd2","#880e4f","#c2185b","#e91e63","#f06292","#f8bbd0","#4a148c","#7b1fa2","#9c27b0","#ba68c8","#e1bee7","#311b92","#512da8","#673ab7","#9575cd","#d1c4e9","#1a237e","#303f9f","#3f51b5","#7986cb","#c5cae9","#0d47a1","#1976d2","#2196f3","#64b5f6","#bbdefb","#01579b","#0288d1","#03a9f4","#4fc3f7","#b3e5fc","#006064","#0097a7","#00bcd4","#4dd0e1","#b2ebf2","#004d40","#00796b","#009688","#4db6ac","#b2dfdb","#194D33","#388e3c","#4caf50","#81c784","#c8e6c9","#33691e","#689f38","#8bc34a","#aed581","#dcedc8","#827717","#afb42b","#cddc39","#dce775","#f0f4c3","#f57f17","#fbc02d","#ffeb3b","#fff176","#fff9c4","#ff6f00","#ffa000","#ffc107","#ffd54f","#ffecb3","#e65100","#f57c00","#ff9800","#ffb74d","#ffe0b2","#bf360c","#e64a19","#ff5722","#ff8a65","#ffccbc","#3e2723","#5d4037","#795548","#a1887f","#d7ccc8","#263238","#455a64","#607d8b","#90a4ae","#cfd8dc","#000000","#525252","#969696","#D9D9D9","#FFFFFF"];return t[Math.floor(Math.random()*t.length)]}},{key:"incluirCategoria",value:function(){var t=Object(n.a)(r.a.mark((function t(e,a){var o,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=this.corAleatoria(),"INSERT INTO categoria (descricao, idncm, sinctributacao, cor) VALUES ($1, $2, $3, $4) RETURNING idcategoria",t.next=4,e.query("INSERT INTO categoria (descricao, idncm, sinctributacao, cor) VALUES ($1, $2, $3, $4) RETURNING idcategoria",[a.descricao,a.idncm,"S",o]);case 4:return n=t.sent,t.abrupt("return",n.rows[0].idcategoria);case 6:case"end":return t.stop()}}),t,this)})));return function(e,a){return t.apply(this,arguments)}}()},{key:"incluirProduto",value:function(){var t=Object(n.a)(r.a.mark((function t(e,a){var o,n,i,s,c,u,l;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(a),a.balanca&&(a.balanca=a.balanca.substr(0,1).toUpperCase()),a.precovariavel&&(a.precovariavel=a.precovariavel.substr(0,1).toUpperCase()),a.preco&&(a.preco=a.preco.toFloat()),a.aliqicms&&(a.aliqicms=a.aliqicms.toFloat()),a.aliqpis&&(a.aliqpis=a.aliqpis.toFloat()),a.aliqcofins&&(a.aliqcofins=a.aliqcofins.toFloat()),a.idunidade="S"===a.balanca?2:1,delete a.balanca,a.preco||(a.preco=0),a.codigoncm&&(a.codigoncm=String(a.codigoncm).removeFormat(),a.codigoncm=a.codigoncm.substr(0,4)+"."+a.codigoncm.substr(4,2)+"."+a.codigoncm.substr(6,2)),a.cest&&(a.cest=a.cest.removeFormat(),a.cest=a.cest.substr(0,2)+"."+a.cest.substr(2,4)+"."+a.cest.substr(6,2)),a.cfop&&(a.cfop=a.cfop.removeFormat(),a.cfop=a.cfop.substr(0,1)+"."+a.cfop.substr(1,3)),console.log([a.csosn,a.cstpis,a.cstcofins,a.csosn||a.cstpis||a.cstcofins]),a.csosn||a.cstpis||a.cstcofins?a.sinctributacao="N":a.sinctributacao="S",!a.codigoncm||a.idncm){t.next=22;break}return t.next=18,e.query("SELECT idncm FROM ncm WHERE codigoncm = $1",[a.codigoncm]);case 18:if(0!==(o=t.sent).rows.length){t.next=21;break}throw new Error("O NCM "+a.codigoncm+" n\xe3o foi encontrado na base de NCMs do SAT-Flex.");case 21:a.idncm=o.rows[0].idncm;case 22:if(!a.categoria||a.idcateogria){t.next=33;break}return t.next=25,e.query("SELECT idcategoria FROM categoria WHERE descricao = $1",[a.categoria]);case 25:if(0!==(n=t.sent).rows.length){t.next=32;break}return t.next=29,this.incluirCategoria(e,{descricao:a.categoria,idncm:a.idncm});case 29:a.idcategoria=t.sent,t.next=33;break;case 32:a.idcategoria=n.rows[0].idcategoria;case 33:for(delete a.codigoncm,delete a.categoria,i=Object.keys(a),s=Object.values(a),c=[],u=1;u<=s.length;u++)c.push("$"+String(u));return l="INSERT INTO produto ("+i.join(", ")+") VALUES ("+c.join(", ")+")",t.next=42,e.query(l,s);case 42:this.importados++;case 43:case"end":return t.stop()}}),t,this)})));return function(e,a){return t.apply(this,arguments)}}()},{key:"processarPlanilha",value:function(){var t=Object(n.a)(r.a.mark((function t(e,a){var o,n,i,s,c,u,l;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.Pool.connect();case 2:if(o=t.sent,t.prev=3,o.query("BEGIN"),n=se.a.parse(e),(i=n[0].data).shift(),"object"===typeof i&&0!==i.length&&0!==i[0].length){t.next=10;break}throw new Error("Nenhum produto foi encontrado na planilha.");case 10:s=Object(Dt.a)(i),t.prev=11,s.s();case 13:if((c=s.n()).done){t.next=22;break}if((u=c.value)[0]){t.next=17;break}return t.abrupt("continue",20);case 17:return l={descricao:u[0],categoria:u[1],codigoean:u[2],balanca:u[3],precovariavel:u[4],preco:u[5],codigoncm:u[6],origem:u[7],csosn:u[8],aliqicms:u[9],cstpis:u[10],aliqpis:u[11],cstcofins:u[12],aliqcofins:u[13],codcontribsocial:u[14],cest:u[15],cfop:u[16]},t.next=20,this.incluirProduto(o,l);case 20:t.next=13;break;case 22:t.next=27;break;case 24:t.prev=24,t.t0=t.catch(11),s.e(t.t0);case 27:return t.prev=27,s.f(),t.finish(27);case 30:return t.next=32,o.query("COMMIT");case 32:a(),t.next=40;break;case 35:return t.prev=35,t.t1=t.catch(3),t.next=39,o.query("ROLLBACK");case 39:a(t.t1);case 40:return t.prev=40,o.release(),t.finish(40);case 43:case"end":return t.stop()}}),t,this,[[3,35,40,43],[11,24,27,30]])})));return function(e,a){return t.apply(this,arguments)}}()},{key:"selecionarPlanilha",value:function(){var t=this;ce.dialog.showOpenDialog({title:"Selecone a planilha de produtos",filters:[{name:"MS-Excel",extensions:["xls","xlsx"]}]},(function(e){e&&e.length>0&&(t.importados=0,window.Loading.show(),t.processarPlanilha(e[0],(function(e){if(window.Loading.hide(),e)return K(e);window.MessageBox.show({title:"Planilha importada com sucesso!",text:"A planilha de produtos foi importada com sucesso.<br>Total de produtos: "+String(t.importados)})})))}))}}]),t}(),le=window.require("electron"),de=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={redirect:null},o.descobrirPortaImpressora=o.descobrirPortaImpressora.bind(Object(O.a)(o)),o.importarPlanilha=o.importarPlanilha.bind(Object(O.a)(o)),o.Pool=new ut,o}return Object(s.a)(a,[{key:"consoleDesenvolvedor",value:function(){le.ipcRenderer.sendSync("open-dev-tools")}},{key:"descobrirPortaImpressora",value:function(){var t=this;window.Loading.show(),new Promise(function(){var e=Object(n.a)(r.a.mark((function e(a){var o,n,i,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=new ae(t.Pool),n=1;case 2:if(!(n<=20)){e.next=16;break}return i="COM"+String(n),s="Porta configurada para impressora: "+i+" ".repeat(90),e.prev=5,e.next=8,o.imprimir(i,s,"escpos");case 8:e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(5),e.abrupt("continue",13);case 13:n++,e.next=2;break;case 16:a();case 17:case"end":return e.stop()}}),e,null,[[5,10]])})));return function(t){return e.apply(this,arguments)}}()).then((function(){window.Loading.hide(),window.FastMessage.show("Texto enviado para as portas COM")}))}},{key:"importarPlanilha",value:function(){new ue(this.Pool).selecionarPlanilha()}},{key:"render",value:function(){return Object(C.jsxs)(lt,{children:[Object(C.jsx)(Nt,{children:"Ferramentas"}),Object(C.jsx)(q,{children:Object(C.jsx)(R,{size:"8",offset:"2",children:Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",className:"mb-4",children:Object(C.jsx)(T,{text:"Descobrir porta<br>COM da impressora",icon:"printer",size:"xxl",block:!0,onClick:this.descobrirPortaImpressora})}),Object(C.jsx)(R,{size:"6",className:"mb-4",children:Object(C.jsx)(T,{text:"Importar planilha<br>de produtos",icon:"download",size:"xxl",block:!0,onClick:this.importarPlanilha})}),Object(C.jsx)(R,{size:"6",className:"mb-4",children:Object(C.jsx)(T,{text:"Abrir console de<br>desenvolvedor",icon:"embed2",size:"xxl",block:!0,onClick:this.consoleDesenvolvedor})})]})})})]})}}]),a}(d.a.Component),pe=(a(389),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=["list-group"];return this.props.className&&t.push(this.props.className),Object(C.jsx)("div",{className:t.join(" "),children:this.props.children})}}]),a}(d.a.Component)),he=(a(390),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=Object.assign({},this.props),e=["list-group-item"];return t.className&&e.push(t.className),t.active&&e.push("active"),delete t.active,delete t.className,Object(C.jsx)("div",Object(g.a)(Object(g.a)({className:e.join(" ")},t),{},{children:t.children}))}}]),a}(d.a.Component)),me=(a(391),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={listaGrupo:[],listaParametro:[],grupoAtivo:null,parametroAtivo:null,idparametro:null,valor:null,observacao:null},o.ajustarAltura=o.ajustarAltura.bind(Object(O.a)(o)),o.carregarListaGrupo=o.carregarListaGrupo.bind(Object(O.a)(o)),o.carregarListaParametro=o.carregarListaParametro.bind(Object(O.a)(o)),o.carregarParametro=o.carregarParametro.bind(Object(O.a)(o)),o.gravar=o.gravar.bind(Object(O.a)(o)),o.onChangeValor=o.onChangeValor.bind(Object(O.a)(o)),o.Pool=new ut,o}return Object(s.a)(a,[{key:"ajustarAltura",value:function(){v()("#content .list-group").each((function(){var t=window.innerHeight-v()(this).offset().top-30;v()(this).height(t)}))}},{key:"carregarListaGrupo",value:function(){var t=this;this.Pool.query("SELECT DISTINCT grupo FROM parametro WHERE visivel = 'S' ORDER BY grupo",[],(function(e,a){if(e)return K(e.message),!1;t.setState({listaGrupo:a.rows})}))}},{key:"carregarListaParametro",value:function(t){var e=this;this.Pool.query("SELECT idparametro, nome FROM parametro WHERE visivel = 'S' AND grupo = $1 ORDER BY ordem, nome",[t],(function(a,o){if(a)return K(a.message),!1;e.setState({listaParametro:o.rows,grupoAtivo:t,parametroAtivo:null,idparametro:null,valor:null,observacao:null})}))}},{key:"carregarParametro",value:function(t){var e=this;this.Pool.query("SELECT idparametro, valor, observacao FROM parametro WHERE idparametro = $1",[t],(function(a,o){if(a)return K(a.message),!1;var r=o.rows.shift();e.setState({parametroAtivo:t,idparametro:r.idparametro,valor:r.valor,observacao:r.observacao})}))}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.ajustarAltura),this.ajustarAltura(),this.carregarListaGrupo()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.ajustarAltura)}},{key:"gravar",value:function(){this.Pool.query("UPDATE parametro SET valor = $1 WHERE idparametro = $2",[this.state.valor,this.state.idparametro],(function(t){if(t)return K(t.message),!1;window.FastMessage.show("Par\xe2metro atualizado com sucesso!")}))}},{key:"onChangeValor",value:function(t){this.setState({valor:t.target.value})}},{key:"render",value:function(){var t=this,e=null;return this.state.observacao&&(e=this.state.observacao.replaceAll("\\n","<br>")),Object(C.jsxs)(lt,{className:"Parametro",children:[Object(C.jsx)(Nt,{children:"Par\xe2metros do sistema"}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"3",offset:"1",children:Object(C.jsx)(pe,{children:this.state.listaGrupo.map((function(e,a){return Object(C.jsx)(he,{active:t.state.grupoAtivo===e.grupo,onClick:function(){t.carregarListaParametro(e.grupo)},children:e.grupo},a)}))})}),Object(C.jsx)(R,{size:"3",children:Object(C.jsx)(pe,{children:this.state.listaParametro.map((function(e,a){return Object(C.jsx)(he,{active:t.state.parametroAtivo===e.idparametro,onClick:function(){t.carregarParametro(e.idparametro)},children:e.nome},a)}))})}),Object(C.jsxs)(R,{size:"4",children:[Object(C.jsx)(Ct,{type:"textarea",rows:"7",value:this.state.valor,onChange:this.onChangeValor,disabled:!this.state.idparametro}),Object(C.jsx)(T,{text:"Gravar altera\xe7\xf5es",icon:"floppy-disk",color:"green",size:"lg",block:!0,className:"mt-2 mb-2",disabled:!this.state.idparametro,onClick:this.gravar}),Object(C.jsx)("div",{className:"observacao"+(e?"":" d-none"),dangerouslySetInnerHTML:{__html:e}})]})]})]})}}]),a}(d.a.Component)),be=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={show:o.props.show,showDiv:null,title:null},o.cancelar=o.cancelar.bind(Object(O.a)(o)),o.changeDiv=o.changeDiv.bind(Object(O.a)(o)),o.changeTitle=o.changeTitle.bind(Object(O.a)(o)),o.excluir=o.excluir.bind(Object(O.a)(o)),o.gravar=o.gravar.bind(Object(O.a)(o)),o.limpar=o.limpar.bind(Object(O.a)(o)),o.onChangeCategoria=o.onChangeCategoria.bind(Object(O.a)(o)),o.onChangeInput=o.onChangeInput.bind(Object(O.a)(o)),o.onChangeSincTributacao=o.onChangeSincTributacao.bind(Object(O.a)(o)),o.sincronizarTributacao=o.sincronizarTributacao.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"cancelar",value:function(){this.setState({show:!1,showDiv:null})}},{key:"carregar",value:function(t,e){var a=this,o=["SELECT produto.descricao, produto.dthrcriacao,","  produto.idcategoria, produto.codigoean, produto.idunidade,","  produto.precovariavel, produto.preco, produto.status,","  produto.sinctributacao, ncm.codigoncm, produto.origem,","  produto.cfop, produto.csosn, produto.aliqicms, ","  produto.cstpis, produto.aliqpis, produto.cstcofins, ","  produto.aliqcofins, produto.codcontribsocial, produto.cest","FROM produto","LEFT JOIN ncm USING (idncm)","WHERE produto.idproduto = $1"].join(" ");this.props.Pool.query(o,[t],(function(t,o){if(t)return K(t.message),!1;if(0===o.rows.length)return window.MessageBox.show({title:"Produto n\xe3o encontrado",text:"O produto selecionado n\xe3o p\xf4de ser encontrado."}),!1;var r={},n=o.rows[0];for(var i in n){var s=n[i];switch(i){case"dthrcriacao":s=s.toLocaleString();break;case"preco":case"aliqicms":case"aliqpis":case"aliqcofins":s=s.format(2,",",".")}r["input_"+i]=s}a.setState(r),"function"===typeof e&&e()}))}},{key:"changeDiv",value:function(t){this.setState({showDiv:t})}},{key:"changeTitle",value:function(t){var e=this;t.idproduto?t.Pool.query("SELECT descricao FROM produto WHERE idproduto = $1",[t.idproduto],(function(t,a){if(t)return K(t.message),!1;e.setState({title:"Alterando produto: "+a.rows[0].descricao})})):this.setState({title:"Criando novo produto"})}},{key:"componentWillReceiveProps",value:function(t){var e=this;if(!t.show)return!1;this.changeTitle(t);var a=function(){e.setState({show:t.show},(function(){setTimeout((function(){e.changeDiv("principal")}),1e3)}))};t.idproduto?this.carregar(t.idproduto,a):(this.limpar(),a())}},{key:"excluir",value:function(){var t=this;window.MessageBox.show({title:"Exclu\xedr produto",text:"Tem certeza que deseja exclu\xedr o produto <b>"+this.state.input_descricao+"</b>?",buttons:[{text:"Sim",icon:"thumbs-up",color:"green",onClick:function(){window.MessageBox.hide(),t.props.Pool.query("DELETE FROM produto WHERE idproduto = $1",[t.props.idproduto],(function(e,a){if(e)return K(e.message),!1;t.setState({show:!1}),window.FastMessage.show("Produto exclu\xeddo com sucesso.")}))}},{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:function(){window.MessageBox.hide()}}]})}},{key:"gravar",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o,n,i,s,c,u,l,d,p,h,m=this;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=null,a=[],o=[],t.t0=r.a.keys(this.state);case 4:if((t.t1=t.t0()).done){t.next=37;break}if("input_"!==(n=t.t1.value).substr(0,6)){t.next=35;break}if(i=n.replace("input_",""),s=this.state[n],"codigoncm"!==i||!s){t.next=25;break}return t.prev=10,t.next=13,this.props.Pool.query("SELECT idncm FROM ncm WHERE codigoncm = $1",[s]);case 13:if(0!==(c=t.sent).rows.length){t.next=17;break}return window.MessageBox.show({title:"NCM inexistente",text:"O c\xf3digo de NCM "+s+" n\xe3o p\xf4de ser encontrado.<br>Verifique se foi informado corretamente."}),t.abrupt("return",!1);case 17:i="idncm",s=c.rows[0].idncm,t.next=25;break;case 21:return t.prev=21,t.t2=t.catch(10),K(t.t2.message),t.abrupt("return",!1);case 25:if(!(["idproduto","dthrcriacao"].indexOf(i)>-1)){t.next=27;break}return t.abrupt("continue",4);case 27:t.t3=i,t.next="preco"===t.t3||"aliqicms"===t.t3||"aliqpis"===t.t3||"aliqcofins"===t.t3?30:32;break;case 30:return s&&(s=s.toFloat()),t.abrupt("break",33);case 32:return t.abrupt("break",33);case 33:a.push(i),o.push(s);case 35:t.next=4;break;case 37:if(this.props.idproduto){for(d in u=1,l=[],a)l.push(a[d]+" = $"+u++);e="UPDATE produto SET "+l.join(", ")+" WHERE idproduto = "+this.props.idproduto}else{for(p=[],h=0;h<a.length;h++)p.push("$"+(h+1));e="INSERT INTO produto ("+a.join(", ")+") VALUES ("+p.join(", ")+")"}this.props.Pool.query(e,o,(function(t,e){if(t)return K(t.message),!1;m.setState({show:!1}),window.FastMessage.show("Produto gravado com sucesso.")}));case 39:case"end":return t.stop()}}),t,this,[[10,21]])})));return function(){return t.apply(this,arguments)}}()},{key:"limpar",value:function(){var t={};for(var e in this.state)"input_"===e.substr(0,6)&&(t[e]=null);this.setState(t)}},{key:"onChangeCategoria",value:function(t){var e=this;this.onChangeInput(t,(function(){e.sincronizarTributacao()}))}},{key:"onChangeInput",value:function(t,e){var a=t.target,o=a.id.replace("modalproduto-",""),r=a.value;"checkbox"===a.type&&(r=a.checked?"S":"N"),this.setState(Object(kt.a)({},"input_"+o,r),e)}},{key:"onChangeSincTributacao",value:function(t){var e=this;this.onChangeInput(t,(function(){e.sincronizarTributacao()}))}},{key:"sincronizarTributacao",value:function(){var t=this;if("S"!==this.state.input_sinctributacao)return!0;var e=["SELECT ncm.codigoncm, categoria.origem,","  categoria.cfop, categoria.csosn, categoria.aliqicms, ","  categoria.cstpis, categoria.aliqpis, categoria.cstcofins, ","  categoria.aliqcofins, categoria.codcontribsocial, categoria.cest","FROM categoria","LEFT JOIN ncm USING (idncm)","WHERE categoria.idcategoria = $1"].join(" ");this.props.Pool.query(e,[this.state.input_idcategoria],(function(e,a){if(e)return K(e.message),!1;if(0===a.rows.length)return window.MessageBox.show({title:"Categoria n\xe3o encontrada",text:"A categoria informada no produto n\xe3o p\xf4de ser encontrada."}),!1;var o={},r=a.rows[0];for(var n in r){var i=r[n];switch(n){case"aliqicms":case"aliqpis":case"aliqcofins":i=i.format(2,",",".")}o["input_"+n]=i}t.setState(o)}))}},{key:"shouldComponentUpdate",value:function(t){return t.show}},{key:"render",value:function(){var t=this;return Object(C.jsxs)(M,{title:this.state.title,size:"lg",show:this.state.show,beforeClose:this.props.beforeClose,afterClose:this.props.afterClose,closeOnOutClick:!1,children:[Object(C.jsxs)("div",{className:"principal"!==this.state.showDiv?"d-none":"",children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(wt,{type:"text",id:"modalproduto-descricao",className:"col-8",label:"Descri\xe7\xe3o",value:this.state.input_descricao,onChange:this.onChangeInput}),Object(C.jsx)(wt,{type:"text",id:"modalproduto-dthrcriacao",className:"col-4",label:"Criado em",readOnly:!0,value:this.state.input_dthrcriacao,onChange:this.onChangeInput,disabled:!0}),Object(C.jsx)(wt,{type:"select",id:"modalproduto-idcategoria",className:"col-5",label:"Categoria",dbtable:"categoria",dbcolumn:"descricao",Pool:this.props.Pool,value:this.state.input_idcategoria,onChange:this.onChangeCategoria}),Object(C.jsx)(wt,{type:"text",id:"modalproduto-codigoean",className:"col-4",label:"C\xf3digo EAN",value:this.state.input_codigoean,onChange:this.onChangeInput}),Object(C.jsx)(wt,{type:"select",id:"modalproduto-idunidade",className:"col-3",label:"Unidade de venda",dbtable:"unidade",dbcolumn:"descricao",Pool:this.props.Pool,value:this.state.input_idunidade,onChange:this.onChangeInput}),Object(C.jsx)(wt,{type:"select",id:"modalproduto-precovariavel",className:"col-3",label:"Pre\xe7o vari\xe1vel",options:{S:"Sim",N:"N\xe3o"},value:this.state.input_precovariavel,onChange:this.onChangeInput}),Object(C.jsx)(wt,{type:"text",id:"modalproduto-preco",className:"col-3",inputClassName:"text-center",label:"Pre\xe7o de venda",InformarValor:{money:!0,decimal:2},value:this.state.input_preco,onChange:this.onChangeInput,disabled:"S"===this.state.input_precovariavel}),Object(C.jsx)(wt,{type:"select",id:"modalproduto-status",className:"col-3",label:"Status",options:{A:"Ativo",I:"Inativo"},value:this.state.input_status,onChange:this.onChangeInput}),Object(C.jsx)(R,{size:"3",labelMargin:!0,children:Object(C.jsx)(T,{text:"Tributa\xe7\xf5es...",icon:"file-text",color:"blue",block:!0,onClick:function(){t.changeDiv("tributacao")}})})]}),Object(C.jsx)(St,{className:"mt-0"}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(T,{text:"Exclu\xedr",icon:"bin",color:"red",onClick:this.excluir,className:this.props.idproduto?"":"d-none"})}),Object(C.jsxs)(R,{size:"6",className:"text-right",children:[Object(C.jsx)(T,{text:"Cancelar",icon:"undo",color:"red",onClick:this.cancelar}),Object(C.jsx)(T,{text:"Gravar produto",icon:"thumbs-up",color:"green",className:"ml-2",onClick:this.gravar})]})]})]}),Object(C.jsx)("div",{className:"tributacao"!==this.state.showDiv?"d-none":"",children:Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"12",children:Object(C.jsx)(Ct,{type:"checkbox",id:"modalproduto-sinctributacao",label:"Usar as mesmas tributa\xe7\xf5es da categoria",className:"col-12",value:this.state.input_sinctributacao,onChange:this.onChangeSincTributacao})}),Object(C.jsx)(wt,{type:"text",id:"modalproduto-codigoncm",label:"NCM do produto",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"9999.99.99"},value:this.state.input_codigoncm,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"select",id:"modalproduto-origem",className:"col-6",label:"Origem do produto",options:{0:"0 - Nacional, exceto as indicadas nos c\xf3digos 3, 4, 5 e 8",1:"1 - Estrangeira - Importa\xe7\xe3o direta, exceto a indicada no c\xf3digo 6",2:"2 - Estrangeira - Adquirida no mercado interno, exceto a indicada no c\xf3digo 7",3:"3 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o superior a 40% e inferior ou igual a 70%",4:"4 - Nacional, cuja produ\xe7\xe3o tenha sido feita em conformidade com os processos produtivos b\xe1sicos de que tratam o Decreto-Lei n\xba 288/67, e as Leis n\xbas 8.248/91, 8.387/91, 10.176/01 e 11.484/ 07",5:"5 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o inferior ou igual a 40%",6:"6 - Estrangeira - Importa\xe7\xe3o direta, sem similar nacional, constante em lista da Resolu\xe7\xe3o CAMEX n\xba 79/2012 e g\xe1s natural",7:"7 - Estrangeira - Adquirida no mercado interno, sem similar nacional, constante em lista da Resolu\xe7\xe3o CAMEX n\xba 79/2012 e g\xe1s natural",8:"8 - Nacional, mercadoria ou bem com Conte\xfado de Importa\xe7\xe3o superior a 70%"},value:this.state.input_origem,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalproduto-cfop",label:"CFOP",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"9.999"},value:this.state.input_cfop,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"select",id:"modalproduto-csosn",className:"col-3",inputClassName:"text-center",label:"CSOSN",options:{102:"102",300:"300",400:"400",500:"500"},value:this.state.input_csosn,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalproduto-aliqicms",label:"Al\xedquota de ICMS",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqicms,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalproduto-cstpis",label:"CST do PIS",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_cstpis,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalproduto-aliqpis",label:"Al\xedquota de PIS",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqpis,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalproduto-cstcofins",label:"CST do Cofins",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_cstcofins,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalproduto-aliqcofins",label:"Al\xedquota de Cofins",className:"col-3",inputClassName:"text-center",InformarValor:{decimal:2},value:this.state.input_aliqcofins,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalproduto-codcontribsocial",label:"Contribui\xe7\xe3o social",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99"},value:this.state.input_codcontribsocial,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(wt,{type:"text",id:"modalproduto-cest",label:"CEST",className:"col-3",inputClassName:"text-center",InformarValor:{mask:"99.999.99"},value:this.state.input_cest,onChange:this.onChangeInput,disabled:"S"===this.state.input_sinctributacao}),Object(C.jsx)(R,{size:"12",className:"text-right",children:Object(C.jsx)(T,{text:"Voltar para o produto...",icon:"file-text",color:"blue",onClick:function(){t.changeDiv("principal")}})})]})})]})}}]),a}(d.a.Component),fe=(a(392),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={dataGrid:[],pesquisa:"",idproduto:null,showModalProduto:!1,redirectToCategoria:!1},o.beforeCloseModal=o.beforeCloseModal.bind(Object(O.a)(o)),o.loadDataGrid=o.loadDataGrid.bind(Object(O.a)(o)),o.novoProduto=o.novoProduto.bind(Object(O.a)(o)),o.onChangePesquisa=o.onChangePesquisa.bind(Object(O.a)(o)),o.onClickBtnCategoria=o.onClickBtnCategoria.bind(Object(O.a)(o)),o.onKeyUpPesquisa=o.onKeyUpPesquisa.bind(Object(O.a)(o)),o.pesquisaLimpar=o.pesquisaLimpar.bind(Object(O.a)(o)),o.Pool=new ut,o}return Object(s.a)(a,[{key:"beforeCloseModal",value:function(){var t=this;this.setState({showModalProduto:!1},(function(){t.loadDataGrid()}))}},{key:"carregarProduto",value:function(t){this.setState({showModalProduto:!0,idproduto:t})}},{key:"componentDidMount",value:function(){this.loadDataGrid()}},{key:"componentWillUnmount",value:function(){this.Pool.end()}},{key:"loadDataGrid",value:function(){var t=this,e=["SELECT produto.idproduto, produto.descricao, categoria.descricao AS categoria,","  produto.preco, produto.codigoean, produto.dthrcriacao","FROM produto","LEFT JOIN categoria USING (idcategoria)","WHERE produto.descricao ILIKE '%'||$1||'%'","  OR produto.codigoean ILIKE '%'||$1||'%'","ORDER BY produto.descricao"].join(" ");this.Pool.query(e,[this.state.pesquisa],(function(e,a){if(e)return K(e.message),!1;var o=[],r=function(e){var r=a.rows[e];o.push({data:[{text:r.descricao,align:"left"},{text:r.categoria,align:"left"},{text:r.preco.format(2,",","."),align:"center"},{text:r.codigoean,align:"center"},{text:r.dthrcriacao.toLocaleString(),align:"center"}],onClick:function(){t.carregarProduto(r.idproduto)}})};for(var n in a.rows)r(n);t.setState({dataGrid:o})}))}},{key:"novoProduto",value:function(){this.setState({showModalProduto:!0,idproduto:null})}},{key:"onChangePesquisa",value:function(t){this.setState({pesquisa:t.target.value})}},{key:"onClickBtnCategoria",value:function(){this.setState({redirectToCategoria:!0})}},{key:"onKeyUpPesquisa",value:function(t){13===t.keyCode&&this.loadDataGrid()}},{key:"pesquisaLimpar",value:function(){var t=this;this.setState({pesquisa:""},(function(){t.loadDataGrid()}))}},{key:"render",value:function(){if(this.state.redirectToCategoria)return Object(C.jsx)(b.a,{to:"/categoria"});return Object(C.jsxs)(lt,{children:[Object(C.jsxs)(Nt,{model:"2",children:["Cadastro de ",Object(C.jsx)("b",{children:"Produtos"})]}),Object(C.jsxs)(q,{className:"mb-4",children:[Object(C.jsxs)(R,{size:"4",children:[Object(C.jsx)(Ct,{type:"search",id:"pesquisa",value:this.state.pesquisa,placeholder:"Pesquise um produto...",onKeyUp:this.onKeyUpPesquisa,onChange:this.onChangePesquisa}),Object(C.jsx)(k,{name:"cross",id:"pesquisa-limpar",onClick:this.pesquisaLimpar,className:this.state.pesquisa.length>0?null:"d-none"})]}),Object(C.jsx)(R,{size:"2",className:"pl-0",children:Object(C.jsx)(T,{text:"Buscar",icon:"search",color:"green",onClick:this.loadDataGrid})}),Object(C.jsxs)(R,{size:"6",className:"text-right",children:[Object(C.jsx)(T,{text:"Categorias",icon:"layers",color:"blue",className:"mr-3",onClick:this.onClickBtnCategoria}),Object(C.jsx)(T,{text:"Novo produto",icon:"plus",color:"green",onClick:this.novoProduto})]})]}),Object(C.jsx)(dt,{header:[{text:"Descri\xe7\xe3o",align:"left"},{text:"Categoria",align:"left"},{text:"Pre\xe7o",align:"center"},{text:"EAN",align:"left"},{text:"Criado em",align:"center"}],data:this.state.dataGrid}),Object(C.jsx)(be,{Pool:this.Pool,show:this.state.showModalProduto,idproduto:this.state.idproduto,beforeClose:this.beforeCloseModal})]})}}]),a}(d.a.Component)),ve=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={redirect:null},o}return Object(s.a)(a,[{key:"render",value:function(){var t=this;return this.state.redirect?Object(C.jsx)(b.a,{to:this.state.redirect}):Object(C.jsxs)(lt,{children:[Object(C.jsx)(Nt,{children:"Relat\xf3rios"}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"3",offset:"3",children:Object(C.jsx)(T,{text:"Fechamento",icon:"calendar",size:"xxl",block:!0,onClick:function(){t.setState({redirect:"/fechamento"})}})}),Object(C.jsx)(R,{size:"3",children:Object(C.jsx)(T,{text:"Estat\xedsticas",icon:"chart-dots",size:"xxl",block:!0,onClick:function(){t.setState({redirect:"/estatistica"})}})})]}),Object(C.jsx)(q,{className:"mt-4",children:Object(C.jsx)(R,{size:"3",offset:"3",children:Object(C.jsx)(T,{text:"Or\xe7amentos",icon:"files-empty",size:"xxl",block:!0,onClick:function(){t.setState({redirect:"/relorcamento"})}})})})]})}}]),a}(d.a.Component),je=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={dtinicial:null,dtfinal:null,redirect:null},o.acaoOrcamento=o.acaoOrcamento.bind(Object(O.a)(o)),o.gerar=o.gerar.bind(Object(O.a)(o)),o.imprimir=o.imprimir.bind(Object(O.a)(o)),o.Pool=new ut,o.Printer=new ae(o.Pool),o}return Object(s.a)(a,[{key:"acaoOrcamento",value:function(t){var e=this,a=["N\xfamero: "+String(t.iddocumento).lpad(6,"0"),"Cliente: "+(t.nomeorcamento?t.nomeorcamento:""),"Quantidade: "+t.totalquantidade.format(J(t.totalquantidade),",","."),"Total: R$ "+t.totaldocumento.format(2,",",".")].join("<br>");window.MessageBox.show({title:"O que voc\xea deseja fazer com o or\xe7amento?",text:a,size:"lg",buttons:[{text:"Efetivar or\xe7amento",color:"green",icon:"thumbs-up",onClick:function(){window.MessageBox.hide(),e.setState({redirect:"venda/"+t.iddocumento})}},{text:"Excluir",color:"red",icon:"bin",className:"btn-sm",onClick:function(){window.MessageBox.show({title:"Exclus\xe3o de or\xe7amento",text:"Tem certeza que deseja exclu\xedr o or\xe7amento?<br>Essa a\xe7\xe3o n\xe3o poder\xe1 ser desfeita.",buttons:[{text:"Sim",color:"green",icon:"thumbs-up",onClick:function(){var a=Object(n.a)(r.a.mark((function a(){return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return window.MessageBox.hide(),window.Loading.show(),a.prev=2,a.next=5,e.Pool.query("DELETE FROM documento WHERE iddocumento = $1",[t.iddocumento]);case 5:return a.next=7,e.gerar();case 7:a.next=12;break;case 9:a.prev=9,a.t0=a.catch(2),K(a.t0);case 12:return a.prev=12,window.Loading.hide(),a.finish(12);case 15:case"end":return a.stop()}}),a,null,[[2,9,12,15]])})));return function(){return a.apply(this,arguments)}}()},{text:"N\xe3o",color:"red",icon:"thumbs-down",onClick:function(){window.MessageBox.hide()}}]})}},{text:"Voltar",color:"blue",icon:"undo",onClick:function(){window.MessageBox.hide()}}]})}},{key:"gerar",value:function(){var t=Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(v()("#dtinicial").val()){t.next=3;break}return window.MessageBox.show({text:"Por favor, informe a data inicial do fechamento antes de prosseguir."}),t.abrupt("return",!1);case 3:if(v()("#dtfinal").val()){t.next=6;break}return window.MessageBox.show({text:"Por favor, informe a data final do fechamento antes de prosseguir."}),t.abrupt("return",!1);case 6:return t.next=8,this.prepararImpressao();case 8:this.setState({dtinicial:v()("#dtinicial").val(),dtfinal:v()("#dtfinal").val()});case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"imprimir",value:function(){var t=Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.Printer.alimentar(3);case 3:return t.next=5,this.Printer.guilhotina();case 5:return t.next=7,this.Printer.imprimir();case 7:window.FastMessage.show("Relat\xf3rio impresso com sucesso!"),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),K(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}()},{key:"prepararImpressao",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.Printer.reiniciar();case 2:return e=v()("#dtinicial").val().split("-").reverse().join("/"),a=v()("#dtfinal").val().split("-").reverse().join("/"),t.t0=this.Printer,t.next=7,rt(this.Pool,"EMITENTE","NOMEFANTASIA");case 7:return t.t1=t.sent,t.next=10,t.t0.texto.call(t.t0,t.t1,"center",!0);case 10:return t.next=12,this.Printer.texto("OR\xc7AMENTOS: "+(e===a?e:e+" \xe0 "+a),"center",!0);case 12:return t.next=14,this.Printer.alimentar();case 14:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){if(this.state.redirect)return Object(C.jsx)(b.a,{to:this.state.redirect});var t=!this.state.dtinicial||!this.state.dtfinal;return Object(C.jsxs)(lt,{className:"RelOrcamento",children:[Object(C.jsx)(Nt,{children:"Relat\xf3rio de Or\xe7amento"}),Object(C.jsx)(q,{children:Object(C.jsxs)(R,{size:"6",offset:"3",children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(wt,{type:"date",id:"dtinicial",label:"Data inicial",className:"col-6",defaultValue:Y()}),Object(C.jsx)(wt,{type:"date",id:"dtfinal",label:"Data final",className:"col-6",defaultValue:Y()})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",className:"pr-0",children:Object(C.jsx)(T,{text:"Gerar",block:!0,color:"green",icon:"file-play",onClick:this.gerar})}),Object(C.jsx)(R,{size:"6",className:"pl-0",children:Object(C.jsx)(T,{text:"Imprimir",block:!0,color:"blue",icon:"printer",onClick:this.imprimir,disabled:t})})]})]})}),Object(C.jsx)(xe,{Pool:this.Pool,Printer:this.Printer,dtinicial:this.state.dtinicial,dtfinal:this.state.dtfinal,acaoOrcamento:this.acaoOrcamento})]})}}]),a}(d.a.Component),xe=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={dados:[]},o}return Object(s.a)(a,[{key:"carregarDados",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a,o,n,i,s,c,u,l,d,p,h,m,b,f,v,j;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=void 0===e?this.props:e,a=["SELECT iddocumento, totalquantidade, totaldocumento, nomeorcamento,","  dthrcriacao::DATE as dtcriacao, dthrcriacao::TIME as hrcriacao","FROM documento","WHERE operacao = $1","  AND dthrcriacao::DATE BETWEEN $2 AND $3","ORDER BY dthrcriacao"].join(" "),t.next=4,e.Pool.query(a,["OR",e.dtinicial,e.dtfinal]);case 4:return o=t.sent,n=this.props.Printer.colunas,u=n-(i=7)-(s=6)-(c=10),l="N\xfamero".substr(0,i).rpad(i," "),l+="Cliente".substr(0,u).cpad(u," "),l+="Qtde".substr(0,s).cpad(s," "),l+="Total".substr(0,c).lpad(c," "),t.next=16,this.props.Printer.texto(l,"left",!0);case 16:d=0,p=0,t.t0=r.a.keys(o.rows);case 19:if((t.t1=t.t0()).done){t.next=36;break}return h=t.t1.value,m=o.rows[h],b=String(m.iddocumento).lpad(6,"0"),f=null===m.nomeorcamento?"":String(m.nomeorcamento),v=m.totalquantidade.format(J(m.totalquantidade),",","."),j=m.totaldocumento.format(2,",","."),l=b.substr(0,i).rpad(i," "),l+=f.substr(0,u).rpad(u," "),l+=v.substr(0,s).cpad(s," "),l+=j.substr(0,c).lpad(c," "),t.next=32,this.props.Printer.texto(l);case 32:d+=parseFloat(m.totalquantidade),p+=parseFloat(m.totaldocumento),t.next=19;break;case 36:return d=d.format(J(d),",","."),p=p.format(2,",","."),l="Total".substr(0,i+u).rpad(i+u," "),l+=String(d).substr(0,s).cpad(s," "),l+=String(p).substr(0,c).lpad(c," "),t.next=43,this.props.Printer.texto(l,"left",!0);case 43:return t.next=45,this.props.Printer.alimentar(2);case 45:this.setState({dados:o.rows});case 46:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"componentWillUpdate",value:function(t){t!==this.props&&this.carregarDados(t)}},{key:"render",value:function(){var t=this;if(!this.props.dtinicial||!this.props.dtfinal)return null;var e=0,a=0;return Object(C.jsx)(q,{className:"mt-5",children:Object(C.jsx)(R,{size:"8",offset:"2",children:Object(C.jsxs)("table",{className:"table table-striped mb-5",children:[Object(C.jsx)("thead",{children:Object(C.jsxs)("tr",{children:[Object(C.jsx)("th",{className:"text-center",children:"N\xfamero"}),Object(C.jsx)("th",{className:"text-left",children:"Cliente"}),Object(C.jsx)("th",{className:"text-center",children:"Quantidade"}),Object(C.jsx)("th",{className:"text-center",children:"Total"})]})}),Object(C.jsx)("tbody",{children:this.state.dados.map((function(o,r){return e+=parseFloat(o.totalquantidade),a+=parseFloat(o.totaldocumento),Object(C.jsxs)("tr",{onClick:function(){t.props.acaoOrcamento(o)},children:[Object(C.jsx)("td",{className:"text-center",children:String(o.iddocumento).lpad(6,"0")}),Object(C.jsx)("td",{className:"text-left",children:o.nomeorcamento}),Object(C.jsx)("td",{className:"text-center",children:o.totalquantidade.format(J(o.totalquantidade),",",".")}),Object(C.jsx)("td",{className:"text-right",children:"R$ "+o.totaldocumento.format(2,",",".")})]},r)}))}),Object(C.jsx)("tfoot",{children:Object(C.jsxs)("tr",{children:[Object(C.jsx)("th",{}),Object(C.jsx)("th",{}),Object(C.jsx)("th",{className:"text-center",children:e.format(J(e),",",".")}),Object(C.jsx)("th",{className:"text-right",children:"R$ "+a.format(2,",",".")})]})})]})})})}}]),a}(d.a.Component),Oe=window.require("fs"),ge=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=Object.assign({},this.props);if(t.src)if(Oe.existsSync(t.src)){var e=t.src.split(".").reverse()[0],a=Oe.readFileSync(t.src,"base64");t.src="data:image/"+e+";base64,"+a}else t.src=null;return Object(C.jsx)("img",Object(g.a)(Object(g.a)({},t),{},{alt:""}))}}]),a}(d.a.Component),Ce=(a(393),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={logotipo:null,informativo:null,telefone:null,email:null,endereco:null},o.carregarDados=o.carregarDados.bind(Object(O.a)(o)),o.Pool=new ut,o}return Object(s.a)(a,[{key:"carregarDados",value:function(){var t=this;this.Pool.query("SELECT nome, valor FROM parametro WHERE grupo = $1",["REVENDA"],(function(e,a){if(e)return K(e),!1;var o,r={},n=Object(Dt.a)(a.rows);try{for(n.s();!(o=n.n()).done;){var i=o.value;r[i.nome.toLowerCase()]=i.valor.replaceAll("\n","</br>")}}catch(e){n.e(e)}finally{n.f()}t.setState(r)}))}},{key:"componentDidMount",value:function(){this.carregarDados()}},{key:"render",value:function(){return Object(C.jsxs)(lt,{children:[Object(C.jsx)(Nt,{children:"Suporte"}),Object(C.jsx)(q,{children:Object(C.jsx)(R,{size:"5",offset:"1",children:Object(C.jsx)(ge,{className:"logotipo",src:this.state.logotipo})})}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"5",offset:"1",children:Object(C.jsx)("p",{className:"informativo",dangerouslySetInnerHTML:{__html:this.state.informativo}})}),Object(C.jsxs)(R,{className:"contatos",size:"4",offset:"1",children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"1",children:Object(C.jsx)(k,{name:"phone"})}),Object(C.jsx)(R,{size:"11",children:Object(C.jsx)("p",{dangerouslySetInnerHTML:{__html:this.state.telefone}})})]}),Object(C.jsx)(St,{}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"1",children:Object(C.jsx)(k,{name:"mail"})}),Object(C.jsx)(R,{size:"11",children:Object(C.jsx)("p",{dangerouslySetInnerHTML:{__html:this.state.email}})})]}),Object(C.jsx)(St,{}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"1",children:Object(C.jsx)(k,{name:"location"})}),Object(C.jsx)(R,{size:"11",children:Object(C.jsx)("p",{dangerouslySetInnerHTML:{__html:this.state.endereco}})})]})]})]})]})}}]),a}(d.a.Component)),ke=a(67),ye=a.n(ke),we=(a(394),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={pesquisa:t.pesquisa,produtos:[],totalproduto:null},o.carregarProdutos=o.carregarProdutos.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"carregarProdutos",value:function(t){var e=this;if("string"===typeof(t=t||this.props.pesquisa)&&0!==t.length){var a=null,o=null,r=[];13===t.length&&"2"===t.substr(0,1)?(a=parseInt(t.substr(1,6),10),o=parseInt(t.substr(7,5),10)/100,t=a,r.push("produto.codigoean = $1")):(r.push("produto.descricao ILIKE '%'||$1||'%'"),r.push("produto.codigoean = $1")),this.totalproduto=o;var n=["SELECT produto.idproduto, produto.descricao, produto.precovariavel,","  produto.preco, categoria.cor, unidade.precisao, unidade.descricao AS unidade","FROM produto","INNER JOIN categoria USING (idcategoria)","INNER JOIN unidade USING (idunidade)","WHERE "+r.join(" OR "),"ORDER BY descricao"].join(" ");this.props.Pool.query(n,[t],(function(t,a){if(t)return K(t),!1;e.setState({produtos:a.rows})}))}else this.setState({produtos:[]})}},{key:"componentDidMount",value:function(){this.carregarProdutos()}},{key:"componentWillReceiveProps",value:function(t){this.carregarProdutos(t.pesquisa)}},{key:"render",value:function(){var t=this,e=["painelrapido","painelrapido-pesquisa"];"0"===this.props.layoutVendas&&e.push("painelrapido-poucosprodutos");var a=!isNaN(this.props.pesquisa)&&1===this.state.produtos.length;return Object(C.jsx)("div",{className:e.join(" "),children:Object(C.jsx)(q,{className:"painelrapido-produto",children:this.state.produtos.map((function(e,o){return Object(C.jsx)(Se,Object(g.a)(Object(g.a)({},e),{},{onSelectProduto:t.props.onSelectProduto,layoutVendas:t.props.layoutVendas,selecionarProduto:a,totalproduto:t.totalproduto}),o)}))})})}}]),a}(d.a.Component)),Se=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).onClick=o.onClick.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.props.selecionarProduto&&this.props.onSelectProduto(this.props,null,this.props.totalproduto)}},{key:"onClick",value:function(t){this.props.onSelectProduto&&this.props.onSelectProduto(this.props,t,this.props.totalproduto)}},{key:"render",value:function(){var t="0"===this.props.layoutVendas?3:2;return Object(C.jsx)(R,{size:t,children:Object(C.jsx)("div",{className:"painelrapido-produto-item",style:{borderColor:this.props.cor},onClick:this.onClick,children:Object(C.jsx)("span",{children:this.props.descricao})})})}}]),a}(d.a.Component),Ee=(a(395),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={categorias:[],produtos:[],categoria:null},o.carregarCategorias=o.carregarCategorias.bind(Object(O.a)(o)),o.carregarProdutos=o.carregarProdutos.bind(Object(O.a)(o)),o.trocarCategoria=o.trocarCategoria.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"carregarCategorias",value:function(){var t=this;this.props.Pool.query("SELECT idcategoria, descricao, cor FROM categoria ORDER BY descricao",(function(e,a){if(e)return K(e),!1;t.setState({categorias:a.rows,categoria:a.rows.length>0?a.rows[0]:null},(function(){t.carregarProdutos()}))}))}},{key:"carregarProdutos",value:function(){var t=this;if(null===this.state.categoria)return!1;var e=["SELECT produto.idproduto, produto.descricao, produto.precovariavel,","  produto.preco, unidade.precisao, unidade.descricao AS unidade","FROM produto","INNER JOIN unidade USING (idunidade)","WHERE produto.status = $1","  AND produto.idcategoria = $2","ORDER BY produto.descricao"].join(" ");this.props.Pool.query(e,["A",this.state.categoria.idcategoria],(function(e,a){if(e)return K(e),!1;t.setState({produtos:a.rows})}))}},{key:"componentDidMount",value:function(){this.carregarCategorias()}},{key:"trocarCategoria",value:function(t){var e=this;this.setState({categoria:t},(function(){e.carregarProdutos()}))}},{key:"render",value:function(){var t=this;return Object(C.jsxs)("div",{className:"painelrapido painelrapido-poucosprodutos",children:[Object(C.jsx)(q,{className:"painelrapido-categoria",children:this.state.categorias.map((function(e,a){return Object(C.jsx)(Ne,Object(g.a)(Object(g.a)({},e),{},{trocarCategoria:t.trocarCategoria}),a)}))}),Object(C.jsx)(q,{className:"painelrapido-produto",children:this.state.produtos.map((function(e,a){return Object(C.jsx)(Pe,Object(g.a)(Object(g.a)({},e),{},{cor:t.state.categoria.cor,onSelectProduto:t.props.onSelectProduto}),a)}))})]})}}]),a}(d.a.Component)),Ne=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).onClick=o.onClick.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"onClick",value:function(){this.props.trocarCategoria(this.props)}},{key:"render",value:function(){return Object(C.jsx)(R,{size:"3",children:Object(C.jsx)("div",{className:"painelrapido-categoria-item",style:{backgroundColor:this.props.cor},onClick:this.onClick,children:Object(C.jsx)("span",{children:this.props.descricao})})})}}]),a}(d.a.Component),Pe=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).onClick=o.onClick.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"onClick",value:function(t){this.props.onSelectProduto&&this.props.onSelectProduto(this.props,t)}},{key:"render",value:function(){return Object(C.jsx)(R,{size:"3",children:Object(C.jsx)("div",{className:"painelrapido-produto-item",style:{borderColor:this.props.cor},onClick:this.onClick,children:Object(C.jsx)("span",{children:this.props.descricao})})})}}]),a}(d.a.Component),De=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={categorias:[],produtos:[],categoria:null},o.carregarCategorias=o.carregarCategorias.bind(Object(O.a)(o)),o.carregarProdutos=o.carregarProdutos.bind(Object(O.a)(o)),o.trocarCategoria=o.trocarCategoria.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"carregarCategorias",value:function(){var t=this;this.props.Pool.query("SELECT idcategoria, descricao, cor FROM categoria ORDER BY descricao",(function(e,a){if(e)return K(e),!1;t.setState({categorias:a.rows,categoria:a.rows.length>0?a.rows[0]:null},(function(){t.carregarProdutos()}))}))}},{key:"carregarProdutos",value:function(){var t=this;if(null!==this.state.categoria){var e=["SELECT produto.idproduto, produto.descricao, produto.precovariavel,","  produto.preco, unidade.precisao, unidade.descricao AS unidade","FROM produto","INNER JOIN unidade USING (idunidade)","WHERE produto.status = $1","  AND produto.idcategoria = $2","ORDER BY produto.descricao"].join(" ");this.props.Pool.query(e,["A",this.state.categoria.idcategoria],(function(e,a){if(e)return K(e),!1;t.setState({produtos:a.rows})}))}}},{key:"componentDidMount",value:function(){this.carregarCategorias()}},{key:"trocarCategoria",value:function(t){var e=this;this.setState({categoria:t},(function(){e.carregarProdutos()}))}},{key:"render",value:function(){var t=this;return Object(C.jsxs)("div",{className:"painelrapido painelrapido-mediosprodutos",children:[Object(C.jsx)(q,{className:"painelrapido-categoria",children:this.state.categorias.map((function(e,a){return Object(C.jsx)(Ae,Object(g.a)(Object(g.a)({},e),{},{trocarCategoria:t.trocarCategoria}),a)}))}),Object(C.jsx)(q,{className:"painelrapido-produto",children:this.state.produtos.map((function(e,a){return Object(C.jsx)(Te,Object(g.a)(Object(g.a)({},e),{},{cor:t.state.categoria.cor,onSelectProduto:t.props.onSelectProduto}),a)}))})]})}}]),a}(d.a.Component),Ae=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).onClick=o.onClick.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"onClick",value:function(){this.props.trocarCategoria(this.props)}},{key:"render",value:function(){return Object(C.jsx)(R,{size:"2",children:Object(C.jsx)("div",{className:"painelrapido-categoria-item",style:{backgroundColor:this.props.cor},onClick:this.onClick,children:Object(C.jsx)("span",{children:this.props.descricao})})})}}]),a}(d.a.Component),Te=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).onClick=o.onClick.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"onClick",value:function(t){this.props.onSelectProduto&&this.props.onSelectProduto(this.props,t)}},{key:"render",value:function(){return Object(C.jsx)(R,{size:"2",children:Object(C.jsx)("div",{className:"painelrapido-produto-item",style:{borderColor:this.props.cor},onClick:this.onClick,children:Object(C.jsx)("span",{children:this.props.descricao})})})}}]),a}(d.a.Component),Re=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={categorias:[],produtos:[],categoria:null},o.carregarCategorias=o.carregarCategorias.bind(Object(O.a)(o)),o.carregarProdutos=o.carregarProdutos.bind(Object(O.a)(o)),o.trocarCategoria=o.trocarCategoria.bind(Object(O.a)(o)),o.voltarCategoria=o.voltarCategoria.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"carregarCategorias",value:function(){var t=this;this.props.Pool.query("SELECT idcategoria, descricao, cor FROM categoria ORDER BY descricao",(function(e,a){if(e)return K(e),!1;t.setState({categorias:a.rows,categoria:null},(function(){t.carregarProdutos()}))}))}},{key:"carregarProdutos",value:function(){var t=this;if(null!==this.state.categoria){var e=["SELECT produto.idproduto, produto.descricao, produto.precovariavel,","  produto.preco, unidade.precisao, unidade.descricao AS unidade","FROM produto","INNER JOIN unidade USING (idunidade)","WHERE produto.status = $1","  AND produto.idcategoria = $2","ORDER BY produto.descricao"].join(" ");this.props.Pool.query(e,["A",this.state.categoria.idcategoria],(function(e,a){if(e)return K(e),!1;t.setState({produtos:a.rows})}))}}},{key:"componentDidMount",value:function(){this.carregarCategorias()}},{key:"trocarCategoria",value:function(t){var e=this;this.setState({categoria:t},(function(){e.carregarProdutos()}))}},{key:"voltarCategoria",value:function(){this.setState({categoria:null,produtos:[]})}},{key:"render",value:function(){var t=this,e=null;null===this.state.categoria&&(e=Object(C.jsx)(q,{className:"painelrapido-categoria",children:this.state.categorias.map((function(e,a){return Object(C.jsx)(Ie,{idcategoria:e.idcategoria,descricao:e.descricao,cor:e.cor,trocarCategoria:t.trocarCategoria},a)}))}));var a=null;return null!==this.state.categoria&&(a=Object(C.jsxs)(q,{className:"painelrapido-produto",children:[Object(C.jsx)(R,{size:"2",children:Object(C.jsx)("div",{className:"painelrapido-categoria-item",style:{backgroundColor:this.state.categoria.cor},onClick:this.voltarCategoria,children:Object(C.jsx)(k,{name:"chevron-left"})})}),this.state.produtos.map((function(e,a){return Object(C.jsx)(Me,Object(g.a)(Object(g.a)({},e),{},{cor:t.state.categoria.cor,onSelectProduto:t.props.onSelectProduto}),a)}))]})),Object(C.jsxs)("div",{className:"painelrapido painelrapido-muitosprodutos",children:[e,a]})}}]),a}(d.a.Component),Ie=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).onClick=o.onClick.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"onClick",value:function(){this.props.trocarCategoria(this.props)}},{key:"render",value:function(){return Object(C.jsx)(R,{size:"2",children:Object(C.jsx)("div",{className:"painelrapido-categoria-item",style:{backgroundColor:this.props.cor},onClick:this.onClick,children:Object(C.jsx)("span",{children:this.props.descricao})})})}}]),a}(d.a.Component),Me=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).onClick=o.onClick.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"onClick",value:function(t){this.props.onSelectProduto&&this.props.onSelectProduto(this.props,t)}},{key:"render",value:function(){return Object(C.jsx)(R,{size:"2",children:Object(C.jsx)("div",{className:"painelrapido-produto-item",style:{borderColor:this.props.cor},onClick:this.onClick,children:Object(C.jsx)("span",{children:this.props.descricao})})})}}]),a}(d.a.Component),qe=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={layoutVendas:null},o}return Object(s.a)(a,[{key:"ajustarAltura",value:function(){if(v()(".painelrapido").length>0){var t=window.innerHeight-v()(".painelrapido").offset().top;v()(".painelrapido").height(t)}}},{key:"componentDidMount",value:function(){var t=this;window.addEventListener("resize",this.ajustarAltura),rt(this.props.Pool,"DIVERSOS","LAYOUTVENDAS",(function(e){t.setState({layoutVendas:e})}),(function(t){K(t)})),this.ajustarAltura()}},{key:"componentDidUpdate",value:function(){this.ajustarAltura()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.ajustarAltura)}},{key:"render",value:function(){if(this.props.pesquisa.length>0)return Object(C.jsx)(we,Object(g.a)(Object(g.a)({},this.props),{},{layoutVendas:this.state.layoutVendas}));switch(this.state.layoutVendas){case"0":return Object(C.jsx)(Ee,Object(g.a)({},this.props));case"1":return Object(C.jsx)(De,Object(g.a)({},this.props));case"2":return Object(C.jsx)(Re,Object(g.a)({},this.props));default:return null}}}]),a}(d.a.Component),Le=(a(396),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={acrescimovalor:0,acrescimopercentual:0,totaldocumento:t.totalbruto,show:t.show},o.cancelar=o.cancelar.bind(Object(O.a)(o)),o.confirmar=o.confirmar.bind(Object(O.a)(o)),o.onChangeAcrescimoPercentual=o.onChangeAcrescimoPercentual.bind(Object(O.a)(o)),o.onChangeAcrescimoValor=o.onChangeAcrescimoValor.bind(Object(O.a)(o)),o.onChangeTotalLiquido=o.onChangeTotalLiquido.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"componentWillReceiveProps",value:function(t){this.setState({acrescimovalor:0,acrescimopercentual:0,totaldocumento:t.totalbruto,show:t.show})}},{key:"confirmar",value:function(){this.props.aplicarAcrescimo(this.props.totalbruto,this.state.acrescimovalor)}},{key:"onChangeAcrescimoPercentual",value:function(t){var e=t.target.value.toFloat(),a=this.props.totalbruto*e/100,o=this.props.totalbruto-this.props.totaldesconto+a;this.setState({acrescimopercentual:e,acrescimovalor:a,totaldocumento:o})}},{key:"onChangeAcrescimoValor",value:function(t){var e=t.target.value.toFloat(),a=e/this.props.totalbruto*100,o=this.props.totalbruto-this.props.totaldesconto+e;this.setState({acrescimopercentual:a,acrescimovalor:e,totaldocumento:o})}},{key:"onChangeTotalLiquido",value:function(t){var e=t.target.value.toFloat();e<this.props.totalbruto&&(e=this.props.totalbruto);var a=e-this.props.totalbruto+this.props.totaldesconto,o=a/this.props.totalbruto*100;this.setState({acrescimopercentual:o,acrescimovalor:a,totaldocumento:e})}},{key:"render",value:function(){return Object(C.jsxs)(M,{id:"VendaAplicarAcrescimo",title:"Aplicando acr\xe9scimo...",show:this.state.show,size:"md",beforeClose:this.props.beforeClose,children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(yt,{children:"Total dos itens"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(Ct,{type:"text",className:"text-center",disabled:!0,value:this.props.totalbruto.format(2,",",".")})})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(yt,{children:"Total de desconto"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(Ct,{type:"text",className:"text-center",disabled:!0,value:this.props.totaldesconto.format(2,",",".")})})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(yt,{children:"Acr\xe9scimo em percentual"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(Ct,{type:"text",className:"text-center",value:this.state.acrescimopercentual.format(0,",","."),InformarValor:{decimal:0},onChange:this.onChangeAcrescimoPercentual})})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(yt,{children:"Acr\xe9scimo em valor"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(Ct,{type:"text",className:"text-center",value:this.state.acrescimovalor.format(2,",","."),InformarValor:{decimal:2,money:!0},onChange:this.onChangeAcrescimoValor})})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(yt,{children:"Total final"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(Ct,{type:"text",className:"text-center",value:this.state.totaldocumento.format(2,",","."),InformarValor:{decimal:2,money:!0},onChange:this.onChangeTotalLiquido})})]}),Object(C.jsxs)("div",{className:"text-right mt-2",children:[Object(C.jsx)(T,{icon:"undo",color:"red",className:"float-left",onClick:this.cancelar}),Object(C.jsx)(T,{text:"Confirmar",icon:"thumbs-up",color:"green",onClick:this.confirmar})]})]})}}]),a}(d.a.Component)),Fe=(a(397),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={descontovalor:0,descontopercentual:0,totaldocumento:t.totalbruto,show:t.show},o.cancelar=o.cancelar.bind(Object(O.a)(o)),o.confirmar=o.confirmar.bind(Object(O.a)(o)),o.onChangeDescontoPercentual=o.onChangeDescontoPercentual.bind(Object(O.a)(o)),o.onChangeDescontoValor=o.onChangeDescontoValor.bind(Object(O.a)(o)),o.onChangeTotalLiquido=o.onChangeTotalLiquido.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"componentWillReceiveProps",value:function(t){this.setState({descontovalor:0,descontopercentual:0,totaldocumento:t.totalbruto,show:t.show})}},{key:"confirmar",value:function(){this.props.aplicarDesconto(this.props.totalbruto,this.state.descontovalor)}},{key:"onChangeDescontoPercentual",value:function(t){var e=t.target.value.toFloat(),a=this.props.totalbruto*e/100,o=this.props.totalbruto-a;this.setState({descontopercentual:e,descontovalor:a,totaldocumento:o})}},{key:"onChangeDescontoValor",value:function(t){var e=t.target.value.toFloat(),a=e/this.props.totalbruto*100,o=this.props.totalbruto-e;this.setState({descontopercentual:a,descontovalor:e,totaldocumento:o})}},{key:"onChangeTotalLiquido",value:function(t){var e=t.target.value.toFloat();e>this.props.totalbruto&&(e=this.props.totalbruto);var a=this.props.totalbruto-e,o=a/this.props.totalbruto*100;this.setState({descontopercentual:o,descontovalor:a,totaldocumento:e})}},{key:"render",value:function(){return Object(C.jsxs)(M,{id:"VendaAplicarDesconto",title:"Aplicando desconto...",show:this.state.show,size:"md",beforeClose:this.props.beforeClose,children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(yt,{children:"Total dos itens"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(Ct,{type:"text",className:"text-center",disabled:!0,value:this.props.totalbruto.format(2,",",".")})})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(yt,{children:"Desconto em percentual"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(Ct,{type:"text",className:"text-center",value:this.state.descontopercentual.format(0,",","."),InformarValor:{decimal:0},onChange:this.onChangeDescontoPercentual})})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(yt,{children:"Desconto em valor"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(Ct,{type:"text",className:"text-center",value:this.state.descontovalor.format(2,",","."),InformarValor:{decimal:2,money:!0},onChange:this.onChangeDescontoValor})})]}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(yt,{children:"Total final"})}),Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(Ct,{type:"text",className:"text-center",value:this.state.totaldocumento.format(2,",","."),InformarValor:{decimal:2,money:!0},onChange:this.onChangeTotalLiquido})})]}),Object(C.jsxs)("div",{className:"text-right mt-2",children:[Object(C.jsx)(T,{icon:"undo",color:"red",className:"float-left",onClick:this.cancelar}),Object(C.jsx)(T,{text:"Confirmar",icon:"thumbs-up",color:"green",onClick:this.confirmar})]})]})}}]),a}(d.a.Component)),ze=a(172),Ue=a.n(ze),Ve=window.require("fs"),Be=window.require("child_process"),_e=function(){function t(){Object(i.a)(this,t),this.appPath="C:/SAT-Flex/resources/app/",this.childProcess=Be,this.fs=Ve,this.srcPath=this.appPath+"/src",this.comDLLPath=this.srcPath+"/lib/comdll-1.0.0"}return Object(s.a)(t,[{key:"execute",value:function(t,e,a,o){try{var r=this.comDLLPath+"/ComDLL.exe",n=[this.srcPath+"/"+t,e].concat(a),i=this.comDLLPath+"/entrada.xml",s=this.comDLLPath+"/retorno.txt";return this.fs.existsSync(i)&&this.fs.unlinkSync(i),this.fs.existsSync(s)&&this.fs.unlinkSync(s),void 0!==o&&this.fs.writeFileSync(i,o,"utf8"),this.childProcess.execFileSync(r,n,{timeout:6e4}),this.fs.readFileSync(s).toString().trim()}catch(c){if("ETIMEDOUT"===c.code)throw new Error("O tempo m\xe1ximo de comunica\xe7\xe3o com o equipamento fiscal SAT foi excedido.<br>Desconecte todos os cabos conectados ao SAT, espere 5 segundos, conecte-os de volta e tente efetuar a opera\xe7\xe3o novamente.<br><br>Caso o problema persista, entre em contato com o suporte.");throw c}}}]),t}(),$e=window.require("fs"),He=window.require("os"),We=function(){function t(e){Object(i.a)(this,t),this.Pool=e,this.ComDLL=new _e,this.jsontoxml=Ue.a,this.os=He,this.fs=$e,this.error=null}return Object(s.a)(t,[{key:"cancelarDocumento",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a,o,n,i,s,c,u,l,d,p;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,rt(this.Pool,"SAT","MODELO");case 2:return a=t.sent,t.next=5,rt(this.Pool,"SAT","ATIVACAO");case 5:return o=t.sent,t.next=8,this.carregarDadosDocumento(e);case 8:if(n=t.sent,i=n.documento,s=null,"sweda"!==a){t.next=17;break}return t.next=14,this.gerarXMLCancelamento(e);case 14:s=t.sent,t.next=18;break;case 17:s=i.xml;case 18:if(it("cancelamento.xml",s),"nenhum"!==a){t.next=21;break}return t.abrupt("return",{xmlcanc:null,chavecanc:null});case 21:c="lib/comdll-1.0.0/SAT-"+a+".dll",u=null,l=null;case 24:if(null!==u&&"06098"!==l[1]){t.next=34;break}if(null===u){t.next=28;break}return t.next=28,tt(500);case 28:if(!1!==(u=this.ComDLL.execute(c,"CancelarUltimaVenda",[o,i.chave],s))){t.next=31;break}return t.abrupt("return",!1);case 31:l=u.split("|"),t.next=24;break;case 34:if(this.validarRetorno(u)){t.next=36;break}return t.abrupt("return",!1);case 36:return d=atob(l[6]),p=l[8].trim(),"string"===typeof d&&0===d.length&&"sweda"===a&&(l=this.fs.readFileSync("C:/Sweda/Retorno.txt").toString(),d=atob(l[6])),t.abrupt("return",{xmlcanc:d,chavecanc:p});case 40:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"carregarDadosDocumento",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a,o,n,i,s,c,u,l;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.Pool.constructor.name,s=null,"Pool"!==i){t.next=8;break}return t.next=5,this.Pool.connect();case 5:s=t.sent,t.next=9;break;case 8:s=this.Pool;case 9:return t.prev=9,t.next=12,s.query("SELECT * FROM documento WHERE iddocumento = $1",[e]);case 12:if(0!==(c=t.sent).rows.length){t.next=15;break}throw new Error("Nenhum documento foi encontrado.");case 15:return a=c.rows[0],u=["SELECT documentoproduto.*, unidade.sigla","FROM documentoproduto","LEFT JOIN produto USING (idproduto)","LEFT JOIN unidade USING (idunidade)","WHERE documentoproduto.iddocumento = $1","ORDER BY documentoproduto.sequencial"].join(" "),t.next=19,s.query(u,[e]);case 19:return c=t.sent,o=c.rows,l=["SELECT documentopagamento.*, formapagamento.especie","FROM documentopagamento","LEFT JOIN formapagamento USING (idformapagamento)","WHERE documentopagamento.iddocumento = $1"].join(" "),t.next=24,s.query(l,[e]);case 24:c=t.sent,n=c.rows,t.next=31;break;case 28:throw t.prev=28,t.t0=t.catch(9),t.t0;case 31:return t.prev=31,"Pool"===i&&s.release(),t.finish(31);case 34:return t.abrupt("return",{documento:a,documentoprodutos:o,documentopagamentos:n});case 35:case"end":return t.stop()}}),t,this,[[9,28,31,34]])})));return function(e){return t.apply(this,arguments)}}()},{key:"consultarUltimaSessaoFiscal",value:function(){var t=Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"gerarXMLCancelamento",value:function(){var t=Object(n.a)(r.a.mark((function t(e,a,o){var n,i,s,c,u,l,d,p;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.carregarDadosDocumento(e);case 2:return n=t.sent,i=n.documento,t.next=6,rt(this.Pool,"DESENVOLVEDORA","CNPJ");case 6:return s=t.sent,t.next=9,rt(this.Pool,"DESENVOLVEDORA","ASSINATURA");case 9:return c=t.sent,t.next=12,rt(this.Pool,"SAT","CAIXA");case 12:return u=t.sent,l=[{name:"infCFe",attrs:{chCanc:i.chave},children:[{name:"ide",children:{CNPJ:s.removeFormat(),signAC:c,numeroCaixa:u.lpad(3,"0")}},{name:"emit",children:[]},{name:"dest",children:[]},{name:"total",children:[]},{name:"infAdic",children:[]}]}],d=[{name:"CFeCanc",children:[l]}],p=this.jsontoxml(d),"function"===typeof a&&a(p),t.abrupt("return",p);case 18:case"end":return t.stop()}}),t,this)})));return function(e,a,o){return t.apply(this,arguments)}}()},{key:"gerarXMLDocumento",value:function(){var t=Object(n.a)(r.a.mark((function t(e,a,o){var n,i,s,c,u,l,d,p,h,m,b,f,v,j,x,O,g,C,k,y,w,S,E,N,P,D;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.carregarDadosDocumento(e);case 2:return n=t.sent,i=n.documento,s=n.documentoprodutos,c=n.documentopagamentos,t.next=8,rt(this.Pool,"DESENVOLVEDORA","CNPJ");case 8:return u=t.sent,t.next=11,rt(this.Pool,"DESENVOLVEDORA","ASSINATURA");case 11:return l=t.sent,t.next=14,rt(this.Pool,"SAT","CAIXA");case 14:return d=t.sent,t.next=17,rt(this.Pool,"EMITENTE","CNPJ");case 17:return p=t.sent,t.next=20,rt(this.Pool,"EMITENTE","IE");case 20:return h=t.sent,t.next=23,rt(this.Pool,"EMITENTE","IMPOSTOFEDERAL");case 23:return m=t.sent,t.next=26,rt(this.Pool,"EMITENTE","IMPOSTOESTADUAL");case 26:return b=t.sent,m||(m=0),b||(b=0),f={name:"ide",children:{CNPJ:u.removeFormat(),signAC:l,numeroCaixa:d.lpad(3,"0")}},v={name:"emit",children:{CNPJ:p.removeFormat(),IE:h.removeFormat(),cRegTribISSQN:1,indRatISSQN:"N"}},j={},(x=i.cpfcnpj?i.cpfcnpj.removeFormat():"").length>11?j={CNPJ:x}:x.length>9&&(j={CPF:x}),O={name:"dest",children:j},g=s.map((function(t){var e=[{name:"cProd",text:t.idproduto},{name:"xProd",text:t.descricao.replaceAll("&","&amp;")},{name:"NCM",text:t.codigoncm.removeFormat()},{name:"CFOP",text:t.cfop.removeFormat()},{name:"uCom",text:t.sigla},{name:"qCom",text:t.quantidade.format(4,".","")},{name:"vUnCom",text:t.preco},{name:"indRegra",text:"T"},{name:"vDesc",text:t.totaldesconto},{name:"vOutro",text:t.totalacrescimo}];null!==t.cest&&t.cest.length>0&&e.push({name:"obsFiscoDet",attrs:{xCampoDet:"Cod. CEST"},children:{xTextoDet:t.cest.removeFormat()}});var a={};["102","300","400","500"].indexOf(t.csosn)>-1&&(a={ICMSSN102:{Orig:t.origem,CSOSN:t.csosn}});var o={};["01","02"].indexOf(t.cstpis)>-1?o={PISAliq:{CST:t.cstpis,vBC:t.basepis,pPIS:t.aliqpis.format(4,".","")}}:["03"].indexOf(t.cstpis)>-1?o={PISQtde:{CST:t.cstpis,qBCProd:t.quantidade,vAliqProd:t.aliqpis.format(4,".","")}}:["04","06","07","08","09"].indexOf(t.cstpis)>-1?o={PISNT:{CST:t.cstpis}}:["49"].indexOf(t.cstpis)>-1?o={PISSN:{CST:t.cstpis}}:["99"].indexOf(t.cstpis)>-1&&(o={PISOutr:{CST:t.cstpis,vBC:t.basepis,pPIS:t.aliqpis.format(4,".","")}});var r={};return["01","02"].indexOf(t.cstcofins)>-1?r={COFINSAliq:{CST:t.cstcofins,vBC:t.basecofins,pCOFINS:t.aliqcofins.format(4,".","")}}:["03"].indexOf(t.cstcofins)>-1?r={COFINSQtde:{CST:t.cstcofins,qBCProd:t.quantidade,vAliqProd:t.aliqcofins.format(4,".","")}}:["04","06","07","08","09"].indexOf(t.cstcofins)>-1?r={COFINSNT:{CST:t.cstcofins}}:["49"].indexOf(t.cstcofins)>-1?r={COFINSSN:{CST:t.cstcofins}}:["99"].indexOf(t.cstcofins)>-1&&(r={COFINSOutr:{CST:t.cstcofins,vBC:t.basecofins,pCOFINS:t.aliqcofins.format(4,".","")}}),{name:"det",attrs:{nItem:t.sequencial},children:{prod:e,imposto:{ICMS:a,PIS:o,COFINS:r}}}})),C={name:"total"},k=c.map((function(t){return{name:"MP",children:{cMP:t.especie,vMP:t.totalpagamento}}})),y={name:"pgto",children:k},w=(i.totaldocumento*m.toFloat()/100).format(2,",","."),S=(i.totaldocumento*b.toFloat()/100).format(2,",","."),E={name:"infAdic",children:{infCpl:"Valor aprox. imposto: R$ "+w+" Fed / R$ "+S+" Est / Fonte SEBRAE"}},N=[f,v,O].concat(g).concat([C,y,E]),P=[{name:"CFe",children:[[{name:"infCFe",attrs:{versaoDadosEnt:"0.07"},children:N}]]}],D=this.jsontoxml(P),"function"===typeof a&&a(D),t.abrupt("return",D);case 49:case"end":return t.stop()}}),t,this)})));return function(e,a,o){return t.apply(this,arguments)}}()},{key:"novoNumSessao",value:function(){return String(Math.round(Math.random()*Math.pow(10,6))).lpad(6,"0")}},{key:"transmitirDocumento",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a,o,n,i,s,c,u,l,d;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,rt(this.Pool,"SAT","MODELO");case 2:return a=t.sent,t.next=5,rt(this.Pool,"SAT","ATIVACAO");case 5:return o=t.sent,t.next=8,this.gerarXMLDocumento(e);case 8:if(it("venda.xml",n=t.sent),"nenhum"!==a){t.next=12;break}return t.abrupt("return",{xml:null,chave:null,numero:null});case 12:i="lib/comdll-1.0.0/SAT-"+a+".dll",s=null,c=null;case 15:if(null!==s&&"06098"!==c[1]){t.next=25;break}if(null===s){t.next=19;break}return t.next=19,tt(500);case 19:if(!1!==(s=this.ComDLL.execute(i,"EnviarDadosVenda",[o],n))){t.next=22;break}return t.abrupt("return",!1);case 22:c=s.split("|"),t.next=15;break;case 25:if(this.validarRetorno(s)){t.next=27;break}return t.abrupt("return",!1);case 27:return u=atob(c[6]),l=c[8].trim(),d=l.substr(-13,6),"string"===typeof u&&0===u.length&&"sweda"===a&&(c=this.fs.readFileSync("C:/Sweda/Retorno.txt").toString(),u=atob(c[6])),t.abrupt("return",{xml:u,chave:l,numero:d});case 32:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"validarRetorno",value:function(t){var e=t.split("|");this.error=null;var a=!1;switch(e[1]){case"04000":case"04006":case"06000":case"07000":case"08000":case"09000":case"10000":a=!0;break;default:this.error=e[3],void 0===this.error||null===this.error||0===this.error.length?this.error="Erro desconhecido. (C\xf3digo "+e[1]+")":["98","99"].indexOf(e[1].substr(-2))>-1&&(this.error="N\xe3o foi poss\xedvel comunicar com o equipamento fiscal SAT.<br><br>Reinicie o equipamento da seguinte maneira:<br>1. Desconecte todos os cabos ligados ao SAT.<br>2. Aguarde 5 segundos.<br>3. Conecte os cabos de volta ao SAT.<br>4. Tente efetuar a venda novamente.<br><br>Caso o problema persista, entre em contato com nosso suporte."),a=!1}return a}}]),t}(),Ge=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={iddocumento:null,numero:null,totaldocumento:null,cpfcnpj:null,show:!1},o.atualizarState=o.atualizarState.bind(Object(O.a)(o)),o.cancelar=o.cancelar.bind(Object(O.a)(o)),o.carregarUltimoDocumento=o.carregarUltimoDocumento.bind(Object(O.a)(o)),o.confirmar=o.confirmar.bind(Object(O.a)(o)),o.outroCupom=o.outroCupom.bind(Object(O.a)(o)),o.Printer=new ae(o.props.Pool),o.SAT=new We(o.props.Pool),o}return Object(s.a)(a,[{key:"atualizarState",value:function(t){var e=t.numero?t.numero:"",a=t.cpfcnpj?t.cpfcnpj:"n\xe3o informado";this.setState({iddocumento:t.iddocumento,numero:String(e).lpad(6,"0"),totaldocumento:"R$ "+t.totaldocumento.format(2,",","."),cpfcnpj:a})}},{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"carregarDocumento",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a,o,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=["SELECT iddocumento, numero, totaldocumento, cpfcnpj","FROM documento","WHERE operacao = $1","  AND numero = $2","ORDER BY iddocumento DESC","LIMIT 1"].join(" "),t.next=3,this.props.Pool.query(a,["CU",e]);case 3:if(0!==(o=t.sent).rowCount){t.next=8;break}return this.setState({show:!1}),window.MessageBox.show({title:"Houve uma falha",text:"Nenhum documento foi encontrado com o n\xfamero "+e+"."}),t.abrupt("return",!1);case 8:n=o.rows[0],this.atualizarState(n);case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"carregarUltimoDocumento",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=["SELECT iddocumento, numero, totaldocumento, cpfcnpj","FROM documento","WHERE operacao = $1","ORDER BY iddocumento DESC","LIMIT 1"].join(" "),t.next=3,this.props.Pool.query(e,["CU"]);case 3:if(0!==(a=t.sent).rowCount){t.next=8;break}return this.setState({show:!1}),window.MessageBox.show({title:"Houve uma falha",text:"Nenhum documento foi encontrado."}),t.abrupt("return",!1);case 8:o=a.rows[0],this.atualizarState(o);case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(t){this.setState({show:t.show}),!this.state.show&&t.show&&this.carregarUltimoDocumento()}},{key:"confirmar",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o,n,i,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,window.Loading.show(),t.next=4,rt(this.props.Pool,"SAT","MODELO");case 4:if(e=t.sent,a={xmlcanc:null,chavecanc:null},"nenhum"===e){t.next=12;break}return t.next=9,this.SAT.cancelarDocumento(this.state.iddocumento);case 9:if(!1!==(a=t.sent)){t.next=12;break}throw new Error(this.SAT.error);case 12:return o=["UPDATE documento SET","  status = $2, dthrcancelamento = $3,","  xmlcanc = $4, chavecanc = $5","WHERE iddocumento = $1"].join(" "),n=[this.state.iddocumento,"C",Q(),a.xmlcanc,a.chavecanc],t.next=16,this.props.Pool.query(o,n);case 16:return t.t0=ye.a,t.next=19,rt(this.props.Pool,"IMPRESSORA","NUMEROVIAS");case 19:for(t.t1=t.sent,i=t.t0.parse.call(t.t0,t.t1),s=1;s<=i.cancelamento;s++)this.Printer.imprimirDocumento(this.state.iddocumento);window.FastMessage.show("Venda cancelada com sucesso!"),this.setState({show:!1}),t.next=30;break;case 26:t.prev=26,t.t2=t.catch(0),console.error(t.t2.stack),K(t.t2.message);case 30:return t.prev=30,window.Loading.hide(),t.finish(30);case 33:case"end":return t.stop()}}),t,this,[[0,26,30,33]])})));return function(){return t.apply(this,arguments)}}()},{key:"outroCupom",value:function(){var t=this;window.InformarValor.show({title:"Informe o n\xfamero do cupom",mask:"999999",success:function(e){t.carregarDocumento(e)}})}},{key:"render",value:function(){return Object(C.jsxs)(M,{id:"VendaCancelarCupom",title:"Cancelamento de venda",show:this.state.show,size:"md",beforeClose:this.props.beforeClose,children:[Object(C.jsx)(q,{children:Object(C.jsxs)(R,{size:"12",className:"text-left",children:["Tem certeza que deseja cancelar a venda?",Object(C.jsx)("br",{}),Object(C.jsx)("br",{}),"Cupom: ",this.state.numero,Object(C.jsx)("br",{}),"Total: ",this.state.totaldocumento,Object(C.jsx)("br",{}),"CPF: ",this.state.cpfcnpj]})}),Object(C.jsx)(St,{}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"5",children:Object(C.jsx)(T,{text:"Outro cupom",color:"blue",onClick:this.outroCupom})}),Object(C.jsxs)(R,{size:"7",className:"text-right",children:[Object(C.jsx)(T,{text:"Sim",icon:"thumbs-up",color:"green",className:"mr-2",onClick:this.confirmar}),Object(C.jsx)(T,{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:this.cancelar})]})]})]})}}]),a}(d.a.Component),Ye=(a(398),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={height:"0px"},o.ajustarAltura=o.ajustarAltura.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"ajustarAltura",value:function(){this.setState({height:window.innerHeight})}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.ajustarAltura),this.ajustarAltura()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.ajustarAltura)}},{key:"render",value:function(){return Object(C.jsxs)("div",{className:"vendadetalhe",style:{height:this.state.height},children:[Object(C.jsx)(Qe,{cancelarUltimaVenda:this.props.cancelarUltimaVenda,cancelarVendaAtual:this.props.cancelarVendaAtual,carregarOrcamento:this.props.carregarOrcamento,listaDocumentoProduto:this.props.listaDocumentoProduto,operacao:this.props.operacao,reimprimirCupom:this.props.reimprimirCupom,trocarOperacao:this.props.trocarOperacao}),Object(C.jsx)(Je,{aumentarQuantidade:this.props.aumentarQuantidade,diminuirQuantidade:this.props.diminuirQuantidade,editarProduto:this.props.editarProduto,listaDocumentoProduto:this.props.listaDocumentoProduto,removerProduto:this.props.removerProduto}),Object(C.jsx)(Xe,{abrirFinalizacao:this.props.abrirFinalizacao,cpfcnpj:this.props.cpfcnpj,informarCPF:this.props.informarCPF,listaDocumentoProduto:this.props.listaDocumentoProduto,operacao:this.props.operacao})]})}}]),a}(d.a.Component)),Qe=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).alternarOrcamento=o.alternarOrcamento.bind(Object(O.a)(o)),o.alternarVenda=o.alternarVenda.bind(Object(O.a)(o)),o.efetivarOrcamento=o.efetivarOrcamento.bind(Object(O.a)(o)),o.onClickDocument=o.onClickDocument.bind(Object(O.a)(o)),o.onClickIcon=o.onClickIcon.bind(Object(O.a)(o)),o.exibindoOpcoes=!1,o}return Object(s.a)(a,[{key:"abrirOpcoes",value:function(){var t=h.a.findDOMNode(this.opcoes);v()(t).stop().animate({height:"show"},350),this.exibindoOpcoes=!0}},{key:"alternarOrcamento",value:function(){this.props.trocarOperacao("OR")}},{key:"alternarVenda",value:function(){this.props.trocarOperacao("CU")}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.onClickDocument)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onClickDocument)}},{key:"efetivarOrcamento",value:function(){var t=this;window.InformarValor.show({title:"N\xfamero do or\xe7amento",mask:"999999",success:function(e){e.length>0&&t.props.carregarOrcamento(e)}})}},{key:"fecharOpcoes",value:function(){var t=h.a.findDOMNode(this.opcoes);v()(t).stop().animate({height:"hide"},350),this.exibindoOpcoes=!1}},{key:"onClickDocument",value:function(t){var e=h.a.findDOMNode(this.icon);!this.iconClicked&&e.contains(t.target)?this.iconClicked=!0:this.exibindoOpcoes&&(this.iconClicked=!1,this.fecharOpcoes())}},{key:"onClickIcon",value:function(){this.abrirOpcoes()}},{key:"render",value:function(){var t=this,e=this.props.listaDocumentoProduto.length,a=this.props.operacao,o=null;if("OR"===a)o="Or\xe7amento";else o="Detalhe da venda";return Object(C.jsx)("div",{className:"vendadetalhe-cabecalho",children:Object(C.jsxs)("div",{children:[Object(C.jsx)("h4",{children:o}),Object(C.jsx)(k,{name:"menu",onClick:this.onClickIcon,ref:function(e){t.icon=e}}),Object(C.jsx)("div",{className:"vendadetalhe-cabecalho-opcoes",ref:function(e){t.opcoes=e},children:Object(C.jsxs)(pe,{children:[Object(C.jsx)(he,{className:0===e?" d-none":"",onClick:this.props.cancelarVendaAtual,children:"Cancelar venda atual"}),Object(C.jsx)(he,{className:0===e?"":" d-none",onClick:this.props.cancelarUltimaVenda,children:"Cancelar \xfaltima venda"}),Object(C.jsx)(he,{onClick:this.props.reimprimirCupom,children:"Reimprimir cupom"}),Object(C.jsx)(he,{className:"CU"!==a?"":" d-none",onClick:this.alternarVenda,children:"Alternar para venda"}),Object(C.jsx)(he,{className:"OR"!==a?"":" d-none",onClick:this.alternarOrcamento,children:"Alternar para or\xe7amento"}),Object(C.jsx)(he,{onClick:this.efetivarOrcamento,children:"Efetivar um or\xe7amento"})]})})]})})}}]),a}(d.a.Component),Je=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).countLista=t.listaDocumentoProduto.length,o}return Object(s.a)(a,[{key:"componentDidUpdate",value:function(){this.props.listaDocumentoProduto.length>this.countLista&&this.scrollToBottom(),this.countLista=this.props.listaDocumentoProduto.length}},{key:"scrollToBottom",value:function(){v()("#vendadetalhe-corpo-conteudo").stop().animate({scrollTop:v()("#vendadetalhe-corpo-conteudo").get(0).scrollHeight},1e3)}},{key:"render",value:function(){var t=this;return Object(C.jsx)("div",{className:"vendadetalhe-corpo",children:Object(C.jsx)("div",{children:Object(C.jsx)("div",{id:"vendadetalhe-corpo-conteudo",children:this.props.listaDocumentoProduto.map((function(e,a){return e.i=a,Object(C.jsx)(Ke,{documentoproduto:e,aumentarQuantidade:t.props.aumentarQuantidade,diminuirQuantidade:t.props.diminuirQuantidade,editarProduto:t.props.editarProduto,removerProduto:t.props.removerProduto},a)}))})})})}}]),a}(d.a.Component),Ke=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(t){var e=this,a="   ",o="R$ "+this.props.documentoproduto.preco.format(2,",","."),r=this.props.documentoproduto.quantidade.format(this.props.documentoproduto.precisao,",","."),n="R$ "+this.props.documentoproduto.totaldesconto.format(2,",","."),i="R$ "+this.props.documentoproduto.totalacrescimo.format(2,",","."),s="R$ "+this.props.documentoproduto.totalproduto.format(2,",","."),c=null;return c=this.props.documentoproduto.descontounitario>0&&this.props.documentoproduto.acrescimounitario>0?o+a+"x"+a+r+"   -"+a+n+"   +"+a+i+"   ="+"   <b>"+s+"</b>":this.props.documentoproduto.descontounitario>0?o+a+"x"+a+r+"   -"+a+n+"   ="+"   <b>"+s+"</b>":this.props.documentoproduto.acrescimounitario>0?o+a+"x"+a+r+"   +"+a+i+"   ="+"   <b>"+s+"</b>":o+a+"x"+a+r+"   ="+"   <b>"+s+"</b>",Object(C.jsxs)("div",{children:[Object(C.jsxs)(q,{className:"vendadetalhe-produto",onClick:function(){e.props.editarProduto(e.props.documentoproduto)},children:[Object(C.jsxs)(R,{size:"8",children:[Object(C.jsx)("div",{className:"vendadetalhe-produto-descricao",children:this.props.documentoproduto.descricao}),Object(C.jsx)("div",{className:"vendadetalhe-produto-calculo",dangerouslySetInnerHTML:{__html:c}})]}),Object(C.jsxs)(R,{size:"4",className:"vendadetalhe-produto-botao text-right",children:[Object(C.jsxs)("div",{children:[Object(C.jsx)(T,{icon:"plus",color:"green",onClick:function(t){e.props.aumentarQuantidade(e.props.documentoproduto),t.stopPropagation()}}),Object(C.jsx)(T,{icon:"minus",color:"red",onClick:function(t){e.props.diminuirQuantidade(e.props.documentoproduto),t.stopPropagation()}})]}),Object(C.jsx)(T,{icon:"bin",color:"red",onClick:function(t){e.props.removerProduto(e.props.documentoproduto),t.stopPropagation()}})]})]}),Object(C.jsx)(St,{})]})}}]),a}(d.a.Component),Xe=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={cpfcnpj:t.cpfcnpj},o}return Object(s.a)(a,[{key:"componentWillReceiveProps",value:function(t){this.setState({cpfcnpj:t.cpfcnpj})}},{key:"render",value:function(){var t=0,e=0,a=0,o=0;return this.props.listaDocumentoProduto.forEach((function(r){t+=parseFloat(r.quantidade),e+=parseFloat(r.preco*r.quantidade),a+=parseFloat(r.totaldesconto),o+=parseFloat(r.totalproduto)})),Object(C.jsx)("div",{className:"vendadetalhe-rodape",children:Object(C.jsx)("div",{children:Object(C.jsxs)(q,{children:[Object(C.jsxs)(R,{size:"6",children:[Object(C.jsxs)("div",{className:"vendadetalhe-rodape-informacao mb-3 mt-1",children:[Object(C.jsxs)("div",{children:["Quantidade de itens ",Object(C.jsx)("strong",{children:t})]}),Object(C.jsxs)("div",{children:["Total dos itens ",Object(C.jsxs)("strong",{children:[Object(C.jsx)("small",{children:"R$"}),e.format(2,",",".")]})]}),Object(C.jsxs)("div",{children:["Total de desconto ",Object(C.jsxs)("strong",{children:[Object(C.jsx)("small",{children:"R$"}),a.format(2,",",".")]})]})]}),Object(C.jsxs)("div",{className:"CU"===this.props.operacao?"":"d-none",children:[Object(C.jsxs)("div",{className:"vendadetalhe-rodape-cpfcnpj"+(this.state.cpfcnpj?"":" d-none"),style:{position:"absolute",bottom:"0px"},children:[Object(C.jsxs)("span",{children:["CPF: ",Object(C.jsx)("strong",{children:this.state.cpfcnpj})]}),Object(C.jsx)(T,{text:"alterar",color:"green",size:"xs",className:"ml-2",onClick:this.props.informarCPF})]}),Object(C.jsx)("div",{className:this.state.cpfcnpj?" d-none":"",style:{position:"absolute",bottom:"0px"},children:Object(C.jsx)(T,{text:"Informar CPF",color:"green",size:"sm",onClick:this.props.informarCPF})})]})]}),Object(C.jsxs)(R,{size:"6",children:[Object(C.jsx)("div",{className:"vendadetalhe-rodape-totaldocumento",children:o.format(2,",",".")}),Object(C.jsx)(T,{text:"F I N A L I Z A R",icon:"dollar2",size:"lg",block:"true",color:"green",disabled:0===o,onClick:this.props.abrirFinalizacao})]})]})})})}}]),a}(d.a.Component),Ze=(a(399),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={quantidade:o.props.documentoproduto.quantidade,preco:o.props.documentoproduto.preco,descontounitario:o.props.documentoproduto.descontounitario,acrescimounitario:o.props.documentoproduto.acrescimounitario,totaldesconto:o.props.documentoproduto.totaldesconto,totalacrescimo:o.props.documentoproduto.totalacrescimo,totalproduto:o.props.documentoproduto.totalproduto,show:o.props.show},o.calcularTotais=o.calcularTotais.bind(Object(O.a)(o)),o.cancelar=o.cancelar.bind(Object(O.a)(o)),o.confirmar=o.confirmar.bind(Object(O.a)(o)),o.onChangeAcrescimoPercentual=o.onChangeAcrescimoPercentual.bind(Object(O.a)(o)),o.onChangeAcrescimoUnitario=o.onChangeAcrescimoUnitario.bind(Object(O.a)(o)),o.onChangeDescontoPercentual=o.onChangeDescontoPercentual.bind(Object(O.a)(o)),o.onChangeDescontoUnitario=o.onChangeDescontoUnitario.bind(Object(O.a)(o)),o.onChangePreco=o.onChangePreco.bind(Object(O.a)(o)),o.onChangeQuantidade=o.onChangeQuantidade.bind(Object(O.a)(o)),o.onChangeTotalAcrescimo=o.onChangeTotalAcrescimo.bind(Object(O.a)(o)),o.onChangeTotalDesconto=o.onChangeTotalDesconto.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"calcularTotais",value:function(){var t=this.state.preco*this.state.quantidade,e=this.state.acrescimounitario*this.state.quantidade,a=this.state.descontounitario*this.state.quantidade,o=t-a+e;this.setState({totalbruto:t,totalacrescimo:e,totaldesconto:a,totalproduto:o})}},{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"componentWillReceiveProps",value:function(t){this.setState({quantidade:t.documentoproduto.quantidade,preco:t.documentoproduto.preco,descontounitario:t.documentoproduto.descontounitario,acrescimounitario:t.documentoproduto.acrescimounitario,show:t.show},this.calcularTotais)}},{key:"confirmar",value:function(){var t=this,e=Object.assign({},this.props.documentoproduto);e.quantidade=this.state.quantidade,e.preco=this.state.preco,e.descontounitario=this.state.descontounitario,e.acrescimounitario=this.state.acrescimounitario,e.totaldesconto=this.state.totaldesconto,e.totalacrescimo=this.state.totalacrescimo,e.totalproduto=this.state.totalproduto,this.setState({show:!1},(function(){t.props.atualizarDocumentoProduto(e)}))}},{key:"onChangeAcrescimoPercentual",value:function(t){var e=t.target.value.toFloat(),a=this.state.preco*e/100;this.setState({acrescimounitario:a},this.calcularTotais)}},{key:"onChangeAcrescimoUnitario",value:function(t){var e=t.target.value.toFloat();this.setState({acrescimounitario:e},this.calcularTotais)}},{key:"onChangeDescontoPercentual",value:function(t){var e=t.target.value.toFloat(),a=this.state.preco*e/100;this.setState({descontounitario:a},this.calcularTotais)}},{key:"onChangeDescontoUnitario",value:function(t){var e=t.target.value.toFloat();this.setState({descontounitario:e},this.calcularTotais)}},{key:"onChangePreco",value:function(t){var e=t.target.value.toFloat();this.setState({preco:e},this.calcularTotais)}},{key:"onChangeQuantidade",value:function(t){var e=t.target.value.toFloat();this.setState({quantidade:e},this.calcularTotais)}},{key:"onChangeTotalAcrescimo",value:function(t){var e=t.target.value.toFloat()/this.state.quantidade;this.setState({acrescimounitario:e},this.calcularTotais)}},{key:"onChangeTotalDesconto",value:function(t){var e=t.target.value.toFloat()/this.state.quantidade;this.setState({descontounitario:e},this.calcularTotais)}},{key:"render",value:function(){var t=this.state.preco*this.state.quantidade,e=t>0?this.state.totalacrescimo/t*100:0,a=t>0?this.state.totaldesconto/t*100:0,o=this.props.documentoproduto.precisao;return Object(C.jsxs)(M,{id:"VendaEditarProduto",title:this.props.documentoproduto.descricao,show:this.state.show,size:"md",beforeClose:this.props.beforeClose,children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(wt,{type:"text",label:"Quantidade",className:"col-4",inputClassName:"text-center",value:this.state.quantidade.format(o,",","."),onChange:this.onChangeQuantidade,InformarValor:{decimal:o}}),Object(C.jsx)(wt,{type:"text",label:"Pre\xe7o unit\xe1rio",className:"col-4",inputClassName:"text-center",value:this.state.preco.format(2,",","."),onChange:this.onChangePreco,InformarValor:{decimal:2,money:!0}}),Object(C.jsx)(wt,{type:"text",label:"Valor do item",className:"col-4",inputClassName:"text-center",value:t.format(2,",","."),disabled:!0,readOnly:!0}),Object(C.jsx)(wt,{type:"text",label:"Desconto unit\xe1rio",className:"col-4",inputClassName:"text-center",value:this.state.descontounitario.format(2,",","."),onChange:this.onChangeDescontoUnitario,InformarValor:{decimal:2,money:!0}}),Object(C.jsx)(wt,{type:"text",label:"Desconto percentual",className:"col-4",inputClassName:"text-center",value:a.format(2,",","."),onChange:this.onChangeDescontoPercentual,InformarValor:{decimal:0}}),Object(C.jsx)(wt,{type:"text",label:"Total de desconto",className:"col-4",inputClassName:"text-center",value:this.state.totaldesconto.format(2,",","."),onChange:this.onChangeTotalDesconto,InformarValor:{decimal:2,money:!0}}),Object(C.jsx)(wt,{type:"text",label:"Acr\xe9scimo unit\xe1rio",className:"col-4",inputClassName:"text-center",value:this.state.acrescimounitario.format(2,",","."),onChange:this.onChangeAcrescimoUnitario,InformarValor:{decimal:2,money:!0}}),Object(C.jsx)(wt,{type:"text",label:"Acr\xe9sc percentual",className:"col-4",inputClassName:"text-center",value:e.format(2,",","."),onChange:this.onChangeAcrescimoPercentual,InformarValor:{decimal:0}}),Object(C.jsx)(wt,{type:"text",label:"Total de acr\xe9scimo",className:"col-4",inputClassName:"text-center",value:this.state.totalacrescimo.format(2,",","."),onChange:this.onChangeTotalAcrescimo,InformarValor:{decimal:2,money:!0}}),Object(C.jsx)(wt,{type:"text",label:"Total final",className:"col-4 offset-8",inputClassName:"text-center",value:this.state.totalproduto.format(2,",","."),disabled:!0,readOnly:!0})]}),Object(C.jsx)(St,{}),Object(C.jsxs)("div",{className:"text-right",children:[Object(C.jsx)(T,{text:"Confirmar",icon:"thumbs-up",color:"green",className:"mr-2",onClick:this.confirmar}),Object(C.jsx)(T,{text:"Voltar",icon:"thumbs-down",color:"red",onClick:this.cancelar})]})]})}}]),a}(d.a.Component)),ta=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=[this.props.className];return t.push("card"),Object(C.jsx)("div",{className:t.join(" "),children:this.props.children})}}]),a}(d.a.Component),ea=(a(400),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={documentopagamentos:t.listaDocumentoPagamento,formaspagamento:[],show:!1},o.finalizarVenda=o.finalizarVenda.bind(Object(O.a)(o)),o.removerPagamento=o.removerPagamento.bind(Object(O.a)(o)),o.totalpago=0,o.totalrestante=0,o.totaltroco=0,o}return Object(s.a)(a,[{key:"carregarFormasPagamento",value:function(){var t=this;this.props.Pool.query("SELECT idformapagamento, descricao, especie FROM formapagamento WHERE status = $1 ORDER BY especie",["A"],(function(e,a){if(e)return K(e),!1;t.setState({formaspagamento:a.rows})}))}},{key:"componentDidMount",value:function(){this.carregarFormasPagamento()}},{key:"componentWillReceiveProps",value:function(t){this.setState({documentopagamentos:t.listaDocumentoPagamento,show:t.show})}},{key:"finalizarVenda",value:function(){this.props.finalizarVenda(this.state.documentopagamentos,this.totaltroco)}},{key:"iconEspecie",value:function(t){switch(t){case"01":return"dollar";case"02":return"keyboard";case"03":case"04":return"credit-card";case"10":case"11":case"12":case"13":return"discout";default:return"money"}}},{key:"incluirPagamento",value:function(t){var e=this;window.InformarValor.show({title:t.descricao,decimal:2,money:!0,value:this.totalrestante.format(2,",","."),success:function(a){if((a=a.toFloat())>0){var o=e.state.documentopagamentos;o.push({idformapagamento:t.idformapagamento,descricao:t.descricao,totalpagamento:a}),e.setState({documentopagamentos:o},(function(){"01"===t.especie&&0===e.totalrestante&&e.finalizarVenda()}))}}})}},{key:"removerPagamento",value:function(t){var e=this.state.documentopagamentos;e.splice(t,1),this.setState({documentopagamentos:e})}},{key:"render",value:function(){var t=this;this.totalpago=0;var e,a=Object(Dt.a)(this.state.documentopagamentos);try{for(a.s();!(e=a.n()).done;){var o=e.value;this.totalpago+=o.totalpagamento}}catch(r){a.e(r)}finally{a.f()}return this.totalpago>this.props.totaldocumento?(this.totalrestante=0,this.totaltroco=Math.round(100*(this.totalpago-this.props.totaldocumento))/100):(this.totalrestante=Math.round(100*(this.props.totaldocumento-this.totalpago))/100,this.totaltroco=0),Object(C.jsxs)("div",{className:"vendafinalizacao"+(this.state.show?"":" d-none"),children:[Object(C.jsxs)(M,{title:"Finaliza\xe7\xe3o da venda",size:"lg",show:this.state.show,beforeClose:this.props.beforeClose,children:[Object(C.jsx)("div",{className:"vendafinalizacao-totaldocumento",children:this.props.totaldocumento.format(2,",",".")}),Object(C.jsx)(q,{className:"vendafinalizacao-formapagamento",children:this.state.formaspagamento.map((function(e,a){return Object(C.jsx)(R,{size:"4",children:Object(C.jsx)(T,{text:e.descricao,block:!0,size:"lg",icon:t.iconEspecie(e.especie),disabled:0===t.totalrestante,onClick:function(){t.incluirPagamento(e)}})},a)}))}),Object(C.jsx)(St,{}),Object(C.jsxs)(q,{children:[Object(C.jsx)(wt,{label:"Total pago",className:"col-3",inputClassName:"text-center",size:"lg",value:this.totalpago.format(2,",","."),disabled:!0}),Object(C.jsx)(wt,{label:"Total restante",className:"col-3",inputClassName:"text-center",size:"lg",value:this.totalrestante.format(2,",","."),disabled:!0,warning:this.totalrestante}),Object(C.jsx)(wt,{label:"Total de troco",className:"col-3",inputClassName:"text-center",size:"lg",value:this.totaltroco.format(2,",","."),disabled:!0,warning:this.totaltroco}),Object(C.jsx)(R,{size:"3",labelMargin:!0,children:Object(C.jsx)(T,{text:"Finalizar!",icon:"thumbs-up",block:!0,size:"lg",color:"green",disabled:this.totalrestante>0,onClick:this.finalizarVenda})})]}),Object(C.jsx)(aa,{documentopagamentos:this.state.documentopagamentos,removerPagamento:this.removerPagamento})]}),Object(C.jsx)("div",{className:"vendafinalizacao-botoesextras",children:Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"4",children:Object(C.jsx)(T,{text:"Desconto",icon:"folder-minus",size:"sm",block:!0,disabled:this.totalpago>0,onClick:this.props.aplicarDesconto})}),Object(C.jsx)(R,{size:"4",children:Object(C.jsx)(T,{text:"Acr\xe9scimo",icon:"folder-plus",size:"sm",block:!0,disabled:this.totalpago>0,onClick:this.props.aplicarAcrescimo})}),Object(C.jsx)(R,{size:"4",children:Object(C.jsx)(T,{text:"Incluir 10%",icon:"user-plus",size:"sm",block:!0,onClick:this.props.incluirDezPorcento})})]})})]})}}]),a}(d.a.Component)),aa=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=this;return 0===this.props.documentopagamentos.length?null:Object(C.jsxs)("div",{children:[Object(C.jsx)(St,{className:"mt-0"}),Object(C.jsx)(q,{className:"justify-content-center",children:this.props.documentopagamentos.map((function(e,a){return Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(ta,{children:Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"5",children:Object(C.jsx)("span",{children:e.descricao})}),Object(C.jsx)(R,{size:"4",children:Object(C.jsx)("span",{children:e.totalpagamento.format(2,",",".")})}),Object(C.jsx)(R,{size:"3",children:Object(C.jsx)(T,{icon:"bin",color:"red",size:"sm",block:!0,onClick:function(){t.props.removerPagamento(a)}})})]})})},a)}))})]})}}]),a}(d.a.Component),oa=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={nomeorcamento:o.props.nomeorcamento,cpfcnpj:o.props.cpfcnpj,show:o.props.show},o.cancelar=o.cancelar.bind(Object(O.a)(o)),o.confirmar=o.confirmar.bind(Object(O.a)(o)),o.onChangeCpfCnpj=o.onChangeCpfCnpj.bind(Object(O.a)(o)),o.onChangeNomeOrcamento=o.onChangeNomeOrcamento.bind(Object(O.a)(o)),o.onFocusCpfCnpj=o.onFocusCpfCnpj.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"componentWillReceiveProps",value:function(t){this.setState({nomeorcamento:t.nomeorcamento,cpfcnpj:t.cpfcnpj,show:t.show})}},{key:"confirmar",value:function(){this.props.finalizarOrcamento(this.state.nomeorcamento,this.state.cpfcnpj)}},{key:"onChangeCpfCnpj",value:function(t){this.setState({cpfcnpj:t.target.value})}},{key:"onChangeNomeOrcamento",value:function(t){this.setState({nomeorcamento:t.target.value})}},{key:"onFocusCpfCnpj",value:function(t){var e=this;window.InformarValor.show({title:"Informe o CPF ou CNPJ",mask:"99999999999999",success:function(t){var a=null;if(11===t.length&&ot(t))a=t.substr(0,3)+"."+t.substr(3,3)+"."+t.substr(6,3)+"-"+t.substr(9,2);else if(14===t.length&&at(t))a=t.substr(0,2)+"."+t.substr(2,3)+"."+t.substr(5,3)+"/"+t.substr(8,4)+"-"+t.substr(12,2);else if(t.length>0)return window.MessageBox.show({title:"CPF ou CNPJ inv\xe1lido",text:"O CPF ou CNPJ informado \xe9 inv\xe1lido."}),!1;e.setState({cpfcnpj:a})},fail:function(){e.setState({cpfcnpj:null})}})}},{key:"render",value:function(){return Object(C.jsxs)(M,{id:"VendaFinalizacaoOrcamento",show:this.state.show,size:"sm",beforeClose:this.props.beforeClose,children:[Object(C.jsxs)(q,{children:[Object(C.jsx)(wt,{type:"text",className:"col-12",label:"Nome do cliente",value:this.state.nomeorcamento,onChange:this.onChangeNomeOrcamento}),Object(C.jsx)(wt,{type:"text",className:"col-12",label:"CPF/CNPJ",value:this.state.cpfcnpj,onChange:this.onChangeCpfCnpj,onFocus:this.onFocusCpfCnpj})]}),Object(C.jsx)(St,{className:"mt-0"}),Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"6",children:Object(C.jsx)(T,{text:"Cancelar",color:"red",block:!0,onClick:this.cancelar})}),Object(C.jsx)(R,{size:"6",className:"pl-0",children:Object(C.jsx)(T,{text:"Confirmar",color:"green",block:!0,onClick:this.confirmar})})]})]})}}]),a}(d.a.Component),ra=(a(401),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),(o=e.call(this,t)).state={listaUltimosDocumentos:[],show:!1},o.carregarUltimosDocumentos=o.carregarUltimosDocumentos.bind(Object(O.a)(o)),o.imprimir=o.imprimir.bind(Object(O.a)(o)),o}return Object(s.a)(a,[{key:"atualizarState",value:function(t){var e=t.numero?t.numero:"",a=t.cpfcnpj?t.cpfcnpj:"n\xe3o informado";this.setState({iddocumento:t.iddocumento,numero:String(e).lpad(6,"0"),totaldocumento:"R$ "+t.totaldocumento.format(2,",","."),cpfcnpj:a})}},{key:"cancelar",value:function(){this.setState({show:!1})}},{key:"carregarDocumento",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a,o,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=["SELECT iddocumento, numero, totaldocumento, cpfcnpj","FROM documento","WHERE operacao = $1","  AND numero = $2","ORDER BY iddocumento DESC","LIMIT 1"].join(" "),t.next=3,this.props.Pool.query(a,["CU",e]);case 3:if(0!==(o=t.sent).rowCount){t.next=8;break}return this.setState({show:!1}),window.MessageBox.show({title:"Houve uma falha",text:"Nenhum documento foi encontrado com o n\xfamero "+e+"."}),t.abrupt("return",!1);case 8:n=o.rows[0],this.atualizarState(n);case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"carregarUltimosDocumentos",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o,n,i,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=["SELECT iddocumento, dthrcriacao, totaldocumento, totalquantidade, cpfcnpj","FROM documento","WHERE operacao = $1","ORDER BY dthrcriacao DESC","LIMIT 3"].join(" "),t.next=3,this.props.Pool.query(e,["CU"]);case 3:a=t.sent,o=[],n=Object(Dt.a)(a.rows);try{for(n.s();!(i=n.n()).done;)s=i.value,o.push(s)}catch(r){n.e(r)}finally{n.f()}this.setState({listaUltimosDocumentos:o});case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(t){this.setState({show:t.show}),!this.state.show&&t.show&&this.carregarUltimosDocumentos()}},{key:"imprimir",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a,o=this;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=new ae(this.props.Pool),t.next=3,a.imprimirDocumento(e,(function(){o.setState({show:!1}),window.FastMessage.show("Cupom enviado para impressora com sucesso!")}),(function(t){t&&K(t)}));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return Object(C.jsx)(M,{id:"VendaReimprimirCupom",title:"Reimpress\xe3o de cupom",show:this.state.show,size:"md",beforeClose:this.props.beforeClose,children:Object(C.jsx)(pe,{children:this.state.listaUltimosDocumentos.map((function(e,a){var o=e.dthrcriacao.toLocaleString(),r="R$ "+e.totaldocumento.format(2,",","."),n=Math.round(e.totalquantidade),i=e.cpfcnpj;return Object(C.jsx)(he,{onClick:function(){t.imprimir(e.iddocumento)},children:Object(C.jsxs)(q,{children:[Object(C.jsx)(R,{size:"12",children:Object(C.jsx)("h3",{className:"text-center",children:o})}),Object(C.jsxs)(R,{size:"4",className:"text-center",children:[Object(C.jsx)("span",{children:"Total documento"}),Object(C.jsx)("h4",{children:r})]}),Object(C.jsxs)(R,{size:"4",className:"text-center",children:[Object(C.jsx)("span",{children:"Qtde de itens"}),Object(C.jsx)("h4",{children:n})]}),Object(C.jsxs)(R,{size:"4",className:"text-center",children:[Object(C.jsx)("span",{children:"CPF/CNPJ"}),Object(C.jsx)("h4",{children:i})]})]})},a)}))})})}}]),a}(d.a.Component)),na=(a(402),a(403),window.require("fs")),ia=function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;Object(i.a)(this,a);var r=(o=e.call(this,t)).criarObjetoDocumentoProduto();return o.state={documentoproduto:r,listaDocumentoProduto:[],listaDocumentoPagamento:[],operacao:"CU",cpfcnpj:null,nomeorcamento:null,iddocumentoorcamento:null,pesquisa:"",pesquisaEfetiva:"",showEditarProduto:!1,showVendaAplicarDesconto:!1,showVendaAplicarAcrescimo:!1,showVendaCancelarCupom:!1,showVendaFinalizacao:!1,showVendaFinalizacaoOrcamento:!1,showVendaReimprimirCupom:!1},o.abrirFinalizacao=o.abrirFinalizacao.bind(Object(O.a)(o)),o.aplicarAcrescimo=o.aplicarAcrescimo.bind(Object(O.a)(o)),o.aplicarDesconto=o.aplicarDesconto.bind(Object(O.a)(o)),o.atualizarDocumentoProduto=o.atualizarDocumentoProduto.bind(Object(O.a)(o)),o.aumentarQuantidade=o.aumentarQuantidade.bind(Object(O.a)(o)),o.cancelarUltimaVenda=o.cancelarUltimaVenda.bind(Object(O.a)(o)),o.cancelarVendaAtual=o.cancelarVendaAtual.bind(Object(O.a)(o)),o.carregarOrcamento=o.carregarOrcamento.bind(Object(O.a)(o)),o.carregarTemporario=o.carregarTemporario.bind(Object(O.a)(o)),o.diminuirQuantidade=o.diminuirQuantidade.bind(Object(O.a)(o)),o.editarProduto=o.editarProduto.bind(Object(O.a)(o)),o.finalizarDocumento=o.finalizarDocumento.bind(Object(O.a)(o)),o.finalizarOrcamento=o.finalizarOrcamento.bind(Object(O.a)(o)),o.finalizarVenda=o.finalizarVenda.bind(Object(O.a)(o)),o.gravarTemporario=o.gravarTemporario.bind(Object(O.a)(o)),o.incluirDezPorcento=o.incluirDezPorcento.bind(Object(O.a)(o)),o.incluirProduto=o.incluirProduto.bind(Object(O.a)(o)),o.informarCPF=o.informarCPF.bind(Object(O.a)(o)),o.onChangePesquisa=o.onChangePesquisa.bind(Object(O.a)(o)),o.onClickBuscar=o.onClickBuscar.bind(Object(O.a)(o)),o.onKeyUpPesquisa=o.onKeyUpPesquisa.bind(Object(O.a)(o)),o.pesquisaLimpar=o.pesquisaLimpar.bind(Object(O.a)(o)),o.reimprimirCupom=o.reimprimirCupom.bind(Object(O.a)(o)),o.reiniciar=o.reiniciar.bind(Object(O.a)(o)),o.removerProduto=o.removerProduto.bind(Object(O.a)(o)),o.trocarOperacao=o.trocarOperacao.bind(Object(O.a)(o)),o.Pool=new ut,o.temporaryFileName="venda.tmp",o}return Object(s.a)(a,[{key:"abrirFinalizacao",value:function(){switch(this.state.operacao){case"CU":this.setState({showVendaFinalizacao:!0});break;case"OR":this.setState({showVendaFinalizacaoOrcamento:!0})}}},{key:"aplicarAcrescimo",value:function(t,e){var a=this;if(isNaN(t)||isNaN(e))this.setState({showVendaAplicarAcrescimo:!0});else{var o=this.state.listaDocumentoProduto;o.forEach((function(o){var r=o.preco*o.quantidade,n=e*(r/t)/o.quantidade;o.acrescimounitario=n,a.calcularDocumentoProduto(o)})),this.setState({listaDocumentoProduto:o,showVendaAplicarAcrescimo:!1})}}},{key:"aplicarDesconto",value:function(t,e){var a=this;if(isNaN(t)||isNaN(e))this.setState({showVendaAplicarDesconto:!0});else{var o=this.state.listaDocumentoProduto;o.forEach((function(o){var r=o.preco*o.quantidade,n=Math.round(e*(r/t)*100)/100,i=Math.round(n/o.quantidade*100)/100;o.descontounitario=i,a.calcularDocumentoProduto(o)}));for(var r=function(){var t=0;o.forEach((function(e){t+=e.descontounitario*e.quantidade}));var a=e-t;return a=Math.round(100*a)/100},n=0,i=r();0!==i&&n++<20;){var s=Math.round(Math.random()*(o.length-1)),c=o[s],u=c.descontounitario,l=u*c.quantidade+i;u=Math.round(l/c.quantidade*100)/100,c.descontounitario=u,this.calcularDocumentoProduto(c),i=r()}this.setState({listaDocumentoProduto:o,showVendaAplicarDesconto:!1})}}},{key:"atualizarDocumentoProduto",value:function(t){var e=t.i,a=this.state.listaDocumentoProduto;a[e]=t,this.setState({listaDocumentoProduto:a})}},{key:"aumentarQuantidade",value:function(t){var e=t.i,a=this.state.listaDocumentoProduto;(t=a[e]).quantidade++,this.calcularDocumentoProduto(t),a[e]=t,this.setState({listaDocumentoProduto:a})}},{key:"calcularDocumentoProduto",value:function(t){t.totaldesconto=t.descontounitario*t.quantidade,t.totalacrescimo=t.acrescimounitario*t.quantidade,t.totalproduto=t.preco*t.quantidade-t.totaldesconto+t.totalacrescimo}},{key:"cancelarUltimaVenda",value:function(){this.setState({showVendaCancelarCupom:!0})}},{key:"cancelarVendaAtual",value:function(){var t=this;window.MessageBox.show({title:"Cancelamento de venda",text:"Tem certeza que deseja cancelar a venda atual?",buttons:[{text:"Sim",icon:"thumbs-up",color:"green",onClick:function(){window.MessageBox.hide(),t.setState({cpfcnpj:null,listaDocumentoProduto:[],listaDocumentoPagamento:[]})}},{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:function(){window.MessageBox.hide()}}]})}},{key:"carregarOrcamento",value:function(){var t=Object(n.a)(r.a.mark((function t(e){var a,o,n,i,s,c,u;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,window.Loading.show(),"SELECT iddocumento, cpfcnpj, nomeorcamento FROM documento WHERE operacao = $1 AND iddocumento = $2",t.next=5,this.Pool.query("SELECT iddocumento, cpfcnpj, nomeorcamento FROM documento WHERE operacao = $1 AND iddocumento = $2",["OR",e]);case 5:if(0!==(a=t.sent).rows.length){t.next=8;break}throw new Error("Or\xe7amento de n\xfamero <b>"+e+"</b> n\xe3o p\xf4de ser encontrado.");case 8:return o=a.rows[0],n=[],"SELECT * FROM documentoproduto WHERE iddocumento = $1",t.next=13,this.Pool.query("SELECT * FROM documentoproduto WHERE iddocumento = $1",[o.iddocumento]);case 13:i=t.sent,s=Object(Dt.a)(i.rows);try{for(s.s();!(c=s.n()).done;)u=c.value,n.push(this.criarObjetoDocumentoProduto({idproduto:u.idproduto,descricao:u.descricao,unidade:u.unidade,precisao:u.precisao,precovariavel:u.precovariavel,quantidade:u.quantidade,preco:u.preco,descontounitario:u.descontounitario,totaldesconto:u.totaldesconto,acrescimounitario:u.acrescimounitario,totalacrescimo:u.totalacrescimo,totalproduto:u.totalproduto}))}catch(r){s.e(r)}finally{s.f()}this.setState({operacao:"CU",cpfcnpj:o.cpfcnpj,nomeorcamento:o.nomeorcamento,listaDocumentoProduto:n,iddocumentoorcamento:e}),t.next=22;break;case 19:t.prev=19,t.t0=t.catch(0),K(t.t0);case 22:return t.prev=22,window.Loading.hide(),t.finish(22);case 25:case"end":return t.stop()}}),t,this,[[0,19,22,25]])})));return function(e){return t.apply(this,arguments)}}()},{key:"carregarTemporario",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=et()+"/"+this.temporaryFileName,na.existsSync(e)&&(a=na.readFileSync(e),"object"===typeof(o=JSON.parse(a))&&this.setState(o));case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.props.match.params.id?this.carregarOrcamento(this.props.match.params.id):this.carregarTemporario()}},{key:"componentWillUnmount",value:function(){this.Pool.end()}},{key:"componentWillUpdate",value:function(t,e){this.gravarTemporario(e)}},{key:"criarObjetoDocumentoProduto",value:function(t){return v.a.extend({idproduto:null,descricao:null,unidade:"Unidade",precisao:0,precovariavel:"N",quantidade:0,preco:0,descontounitario:0,totaldesconto:0,acrescimounitario:0,totalacrescimo:0,totalproduto:0},t)}},{key:"diminuirQuantidade",value:function(t){var e=t.i,a=this.state.listaDocumentoProduto;if((t=a[e]).quantidade-1<=0)return!0;t.quantidade--,this.calcularDocumentoProduto(t),a[e]=t,this.setState({listaDocumentoProduto:a})}},{key:"editarProduto",value:function(t){this.setState({documentoproduto:t,showEditarProduto:!0})}},{key:"finalizarDocumento",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o,i,s,c,u,l,d,p,h,m,b,f,v,j,x,O,g,C,k,y,w,S,E,N,P,D,A,T,R,I,M=this;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return window.Loading.show(),t.next=3,this.Pool.connect();case 3:return e=t.sent,t.prev=4,t.next=7,e.query("BEGIN");case 7:return a=["INSERT INTO documento (operacao, modelo, cpfcnpj, nomeorcamento, totaltroco)","VALUES ($1, $2, $3, $4, $5)","RETURNING iddocumento"].join(" "),t.next=10,e.query(a,[this.state.operacao,"65",this.state.cpfcnpj,this.state.nomeorcamento,this.state.totaltroco]);case 10:o=t.sent,i=o.rows[0].iddocumento,s=[],c=Object(Dt.a)(this.state.listaDocumentoProduto);try{for(c.s();!(u=c.n()).done;)l=u.value,s.push(l.idproduto)}catch(q){c.e(q)}finally{c.f()}return d=["SELECT produto.idproduto, ncm.codigoncm, produto.origem,","  produto.csosn, produto.aliqicms, produto.cstpis, produto.aliqpis,","  produto.cstcofins, produto.aliqcofins, produto.codcontribsocial,","  produto.cest, produto.cfop","FROM produto","LEFT JOIN ncm USING (idncm)","WHERE idproduto IN ("+s.join(", ")+")"].join(" "),t.next=18,e.query(d);case 18:p=t.sent,h={},m=Object(Dt.a)(p.rows);try{for(m.s();!(b=m.n()).done;)f=b.value,v=f.idproduto,delete f.idproduto,h[v]=f}catch(q){m.e(q)}finally{m.f()}j=1,x=Object(Dt.a)(this.state.listaDocumentoProduto),t.prev=24,x.s();case 26:if((O=x.n()).done){t.next=34;break}return g=O.value,C=h[g.idproduto],k=["INSERT INTO documentoproduto (","  iddocumento, sequencial, idproduto,","  descricao, preco, quantidade,","  descontounitario, acrescimounitario, codigoncm,","  origem, csosn, aliqicms,","  cstpis, aliqpis, cstcofins,","  aliqcofins, codcontribsocial, cest,","  cfop",") VALUES (","  $1, $2, $3,","  $4, $5, $6,","  $7, $8, $9,","  $10, $11, $12,","  $13, $14, $15,","  $16, $17, $18,","  $19",")"].join(" "),t.next=32,e.query(k,[i,j++,g.idproduto,g.descricao,g.preco,g.quantidade,g.descontounitario,g.acrescimounitario,C.codigoncm,C.origem,C.csosn,C.aliqicms,C.cstpis,C.aliqpis,C.cstcofins,C.aliqcofins,C.codcontribsocial,C.cest,C.cfop]);case 32:t.next=26;break;case 34:t.next=39;break;case 36:t.prev=36,t.t0=t.catch(24),x.e(t.t0);case 39:return t.prev=39,x.f(),t.finish(39);case 42:if("CU"!==this.state.operacao){t.next=71;break}y=this.state.listaDocumentoPagamento,this.state.totaltroco>0&&(w=y.length-1,y[w].totalpagamento-=this.state.totaltroco),S=Object(Dt.a)(y),t.prev=46,S.s();case 48:if((E=S.n()).done){t.next=55;break}return N=E.value,P=["INSERT INTO documentopagamento (iddocumento, idformapagamento, totalpagamento)","VALUES ($1, $2, $3)"].join(" "),t.next=53,e.query(P,[i,N.idformapagamento,N.totalpagamento]);case 53:t.next=48;break;case 55:t.next=60;break;case 57:t.prev=57,t.t1=t.catch(46),S.e(t.t1);case 60:return t.prev=60,S.f(),t.finish(60);case 63:return D=new We(e),t.next=66,D.transmitirDocumento(i);case 66:if(!1!==(A=t.sent)){t.next=69;break}throw new Error(D.error);case 69:return t.next=71,e.query("UPDATE documento SET xml = $1, chave = $2, numero = $3 WHERE iddocumento = $4",[A.xml,A.chave,A.numero,i]);case 71:if(!this.state.iddocumentoorcamento){t.next=74;break}return t.next=74,e.query("DELETE FROM documento WHERE iddocumento = $1",[this.state.iddocumentoorcamento]);case 74:return t.next=76,e.query("COMMIT");case 76:if(!(this.state.totaltroco>0)){t.next=80;break}window.MessageBox.show({text:"<div class='text-center'><h5>Venda finalizada com sucesso!</h5><h3>Total de troco</h3><h1><small>R$</small>"+this.state.totaltroco.format(2,",",".")+"</h1></div>"}),t.next=87;break;case 80:t.t2=this.state.operacao,t.next="CU"===t.t2?83:"OR"===t.t2?85:83;break;case 83:return window.FastMessage.show("Venda finalizada com sucesso!"),t.abrupt("break",87);case 85:return window.FastMessage.show("Or\xe7amento finalizado com sucesso!"),t.abrupt("break",87);case 87:return t.t3=ye.a,t.next=90,rt(this.Pool,"IMPRESSORA","NUMEROVIAS");case 90:return t.t4=t.sent,T=t.t3.parse.call(t.t3,t.t4),T="OR"===this.state.operacao?T.orcamento:T.venda,t.next=95,rt(this.Pool,"IMPRESSORA","CONFIRMACAO");case 95:if(t.t5=t.sent,"S"!==t.t5){t.next=100;break}window.MessageBox.show({title:"Imprimir cupom",text:"Deseja imprimir o cupom da venda realizada?",buttons:[{text:"Sim",color:"green",icon:"thumbs-up",onClick:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:window.MessageBox.hide(),e=1;case 2:if(!(e<=T)){t.next=9;break}return a=new ae(M.Pool),t.next=6,a.imprimirDocumento(i);case 6:e++,t.next=2;break;case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{text:"N\xe3o",color:"red",icon:"thumbs-down",onClick:function(){window.MessageBox.hide()}}]}),t.next=108;break;case 100:R=1;case 101:if(!(R<=T)){t.next=108;break}return I=new ae(this.Pool),t.next=105,I.imprimirDocumento(i);case 105:R++,t.next=101;break;case 108:this.reiniciar(),t.next=116;break;case 111:return t.prev=111,t.t6=t.catch(4),t.next=115,e.query("ROLLBACK");case 115:K(t.t6);case 116:return t.prev=116,e.release(),window.Loading.hide(),t.finish(116);case 120:case"end":return t.stop()}}),t,this,[[4,111,116,120],[24,36,39,42],[46,57,60,63]])})));return function(){return t.apply(this,arguments)}}()},{key:"finalizarOrcamento",value:function(t,e){var a=this;this.setState({nomeorcamento:t,cpfcnpj:e,listaDocumentoPagamento:[],totaltroco:0,showVendaFinalizacaoOrcamento:!1},(function(){a.finalizarDocumento()}))}},{key:"finalizarVenda",value:function(t,e){var a=this;this.setState({listaDocumentoPagamento:t,totaltroco:e},(function(){a.finalizarDocumento()}))}},{key:"gravarTemporario",value:function(){var t=Object(n.a)(r.a.mark((function t(e){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=void 0===e?this.state:e,it(this.temporaryFileName,JSON.stringify(e));case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"incluirDezPorcento",value:function(){var t=this,e=this.state.listaDocumentoProduto;e.forEach((function(e){e.acrescimounitario=.1*e.preco,t.calcularDocumentoProduto(e)})),this.setState({listaDocumentoProduto:e})}},{key:"incluirProduto",value:function(t,e,a){var o=this;t=Object.assign({},t);var r=function(t){window.InformarValor.show({title:"Quantidade em "+t.unidade.toLowerCase()+"s",decimal:t.precisao,success:function(e){t.quantidade=e.toFloat(),o.incluirProdutoDefinitivo(t)}})};"S"===t.precovariavel?window.InformarValor.show({title:"Pre\xe7o do produto",money:!0,decimal:2,success:function(e){t.preco=e.toFloat(),t.precisao>0&&!a?r(t):o.incluirProdutoDefinitivo(t,a)}}):t.precisao>0&&!a?r(t):this.incluirProdutoDefinitivo(t,a)}},{key:"incluirProdutoDefinitivo",value:function(t,e){var a=this,o=this.state.listaDocumentoProduto;e?t.quantidade=e/t.preco:t.quantidade||(t.quantidade=1);var r=this.criarObjetoDocumentoProduto({idproduto:t.idproduto,descricao:t.descricao,unidade:t.unidade,precisao:t.precisao,precovariavel:t.precovariavel,quantidade:t.quantidade,preco:t.preco});this.calcularDocumentoProduto(r);var n=!1;if(o.forEach((function(t){if(n)return!1;var e=Object.assign({},r),o=Object.assign({},t);delete e.quantidade,delete o.quantidade,delete e.totalproduto,delete o.totalproduto,delete o.i,JSON.stringify(e)===JSON.stringify(o)&&(t.quantidade+=r.quantidade,a.calcularDocumentoProduto(t),n=!0)})),0===parseFloat(r.preco))return window.MessageBox.show({title:"Produto sem pre\xe7o",text:"O pre\xe7o do produto precisa ser maior que zero."}),!1;n||o.push(r),this.setState({listaDocumentoProduto:o,pesquisa:"",pesquisaEfetiva:""})}},{key:"informarCPF",value:function(){var t=this;window.InformarValor.show({title:"Informe o CPF ou CNPJ",mask:"99999999999999",success:function(e){var a=null;if(11===e.length&&ot(e))a=e.substr(0,3)+"."+e.substr(3,3)+"."+e.substr(6,3)+"-"+e.substr(9,2);else if(14===e.length&&at(e))a=e.substr(0,2)+"."+e.substr(2,3)+"."+e.substr(5,3)+"/"+e.substr(8,4)+"-"+e.substr(12,2);else if(e.length>0)return window.MessageBox.show({title:"CPF ou CNPJ inv\xe1lido",text:"O CPF ou CNPJ informado \xe9 inv\xe1lido.<br>Por favor, digite novamente.",buttons:[{text:"Ok",icon:"thumbs-up",color:"blue",onClick:function(){window.MessageBox.hide(),t.informarCPF()}}]}),!1;t.setState({cpfcnpj:a})},fail:function(){t.setState({cpfcnpj:null})}})}},{key:"onChangePesquisa",value:function(t){this.setState({pesquisa:t.target.value})}},{key:"onClickBuscar",value:function(){this.setState({pesquisaEfetiva:this.state.pesquisa})}},{key:"onKeyUpPesquisa",value:function(t){13===t.keyCode&&this.onClickBuscar()}},{key:"pesquisaLimpar",value:function(){this.setState({pesquisa:"",pesquisaEfetiva:""})}},{key:"reimprimirCupom",value:function(){this.setState({showVendaReimprimirCupom:!0})}},{key:"reiniciar",value:function(){var t=this.criarObjetoDocumentoProduto();this.setState({documentoproduto:t,listaDocumentoProduto:[],listaDocumentoPagamento:[],cpfcnpj:null,nomeorcamento:null,iddocumentoorcamento:null,pesquisa:"",pesquisaEfetiva:"",showEditarProduto:!1,showVendaFinalizacao:!1,showVendaFinalizacaoOrcamento:!1,showVendaAplicarDesconto:!1,showVendaAplicarAcrescimo:!1})}},{key:"removerProduto",value:function(t){var e=this,a="R$ "+t.totalproduto.format(2,",",".");window.MessageBox.show({text:"Tem certeza que deseja remover o produto?<br><br>"+t.descricao+"<span class='float-right'>"+a+"</span>",buttons:[{text:"Sim",icon:"thumbs-up",color:"green",onClick:function(){window.MessageBox.hide();var a=e.state.listaDocumentoProduto;a.splice(t.i,1),e.setState({listaDocumentoProduto:a})}},{text:"N\xe3o",icon:"thumbs-down",color:"red",onClick:function(){window.MessageBox.hide()}}]})}},{key:"trocarOperacao",value:function(t){this.setState({operacao:t})}},{key:"render",value:function(){var t=this,e=0,a=0,o=0;this.state.listaDocumentoProduto.forEach((function(t){e+=parseFloat(t.preco*t.quantidade),a+=parseFloat(t.totaldesconto),o+=parseFloat(t.totalproduto)}));var r="operacao-"+this.state.operacao;return Object(C.jsxs)(lt,{className:r,children:[Object(C.jsxs)(q,{children:[Object(C.jsxs)(R,{size:"7",children:[Object(C.jsxs)(q,{className:"mb-4 mt-4",children:[Object(C.jsxs)(R,{size:"9",children:[Object(C.jsx)(Ct,{type:"search",id:"pesquisa",value:this.state.pesquisa,placeholder:"Pesquise um produto...",onKeyUp:this.onKeyUpPesquisa,onChange:this.onChangePesquisa}),Object(C.jsx)(k,{name:"cross",id:"pesquisa-limpar",onClick:this.pesquisaLimpar,className:this.state.pesquisa.length>0?null:"d-none"})]}),Object(C.jsx)(R,{size:"3",className:"pl-0",children:Object(C.jsx)(T,{text:"Buscar",icon:"search",color:"green",block:!0,onClick:this.onClickBuscar})})]}),Object(C.jsx)(qe,{Pool:this.Pool,pesquisa:this.state.pesquisaEfetiva,onSelectProduto:this.incluirProduto})]}),Object(C.jsx)(R,{size:"5",className:"pr-0",children:Object(C.jsx)(Ye,{abrirFinalizacao:this.abrirFinalizacao,aumentarQuantidade:this.aumentarQuantidade,cancelarUltimaVenda:this.cancelarUltimaVenda,cancelarVendaAtual:this.cancelarVendaAtual,carregarOrcamento:this.carregarOrcamento,reimprimirCupom:this.reimprimirCupom,cpfcnpj:this.state.cpfcnpj,diminuirQuantidade:this.diminuirQuantidade,editarProduto:this.editarProduto,informarCPF:this.informarCPF,listaDocumentoProduto:this.state.listaDocumentoProduto,operacao:this.state.operacao,removerProduto:this.removerProduto,trocarOperacao:this.trocarOperacao})})]}),Object(C.jsx)(Ze,{show:this.state.showEditarProduto,documentoproduto:this.state.documentoproduto,atualizarDocumentoProduto:this.atualizarDocumentoProduto,beforeClose:function(){t.setState({showEditarProduto:!1})}}),Object(C.jsx)(ea,{Pool:this.Pool,show:this.state.showVendaFinalizacao,totaldocumento:o,aplicarAcrescimo:this.aplicarAcrescimo,aplicarDesconto:this.aplicarDesconto,incluirDezPorcento:this.incluirDezPorcento,finalizarVenda:this.finalizarVenda,listaDocumentoPagamento:this.state.listaDocumentoPagamento,beforeClose:function(){t.setState({showVendaFinalizacao:!1})}}),Object(C.jsx)(oa,{nomeorcamento:this.state.nomeorcamento,cpfcnpj:this.state.cpfcnpj,finalizarOrcamento:this.finalizarOrcamento,show:this.state.showVendaFinalizacaoOrcamento,beforeClose:function(){t.setState({showVendaFinalizacaoOrcamento:!1})}}),Object(C.jsx)(Fe,{totalbruto:e,show:this.state.showVendaAplicarDesconto,aplicarDesconto:this.aplicarDesconto,beforeClose:function(){t.setState({showVendaAplicarDesconto:!1})}}),Object(C.jsx)(Le,{totalbruto:e,totaldesconto:a,show:this.state.showVendaAplicarAcrescimo,aplicarAcrescimo:this.aplicarAcrescimo,beforeClose:function(){t.setState({showVendaAplicarAcrescimo:!1})}}),Object(C.jsx)(Ge,{Pool:this.Pool,show:this.state.showVendaCancelarCupom,beforeClose:function(){t.setState({showVendaCancelarCupom:!1})}}),Object(C.jsx)(ra,{Pool:this.Pool,show:this.state.showVendaReimprimirCupom,beforeClose:function(){t.setState({showVendaReimprimirCupom:!1})}})]})}}]),a}(d.a.Component),sa=function(){function t(e,a){Object(i.a)(this,t),this.Pool=e,this.referencia=a,this.dthrinicial=Q()}return Object(s.a)(t,[{key:"atualizarProcesso",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"UPDATE processo SET dthrinicial = $2, dthrfinal = $3 WHERE referencia = $1",e=[this.referencia,this.dthrinicial,Q()],t.next=4,this.Pool.query("UPDATE processo SET dthrinicial = $2, dthrfinal = $3 WHERE referencia = $1",e);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"verificarIntervalo",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.dthrinicial=Q(),t.next=3,this.Pool.query("SELECT status, dthrinicial, intervalo FROM processo WHERE referencia = $1",[this.referencia]);case 3:if(e=t.sent,"A"===(a=e.rows[0]).status){t.next=7;break}return t.abrupt("return",!1);case 7:if(null!==a.dthrinicial){t.next=9;break}return t.abrupt("return",!0);case 9:if(!(Date.now()>=a.dthrinicial.getTime()+6e4*a.intervalo)){t.next=13;break}return t.abrupt("return",!0);case 13:return t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}(),ca=window.require("fs"),ua=window.require("os"),la=window.require("ftp"),da=window.require("child_process"),pa=function(){function t(e){Object(i.a)(this,t),this.Pool=e,this.interval=null,this.running=!1,window.ProcessoAutomatico=this,this.executandoBackup=!1}return Object(s.a)(t,[{key:"iniciar",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e=this;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.interval=setInterval(Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.executar();case 1:case"end":return t.stop()}}),t)}))),6e4),setTimeout(Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.executar();case 1:case"end":return t.stop()}}),t)}))),1e4);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"pausar",value:function(){clearInterval(this.interval)}},{key:"executar",value:function(){var t=Object(n.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.running){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,this.running=!0,t.next=6,this.executarRefreshView();case 6:return t.next=8,this.executarVerificarDtVerificacao();case 8:return t.next=10,this.executarVerificarTerminal();case 10:return t.next=13,this.executarBackup();case 13:t.next=18;break;case 15:throw t.prev=15,t.t0=t.catch(2),t.t0;case 18:return t.prev=18,this.running=!1,t.finish(18);case 21:case"end":return t.stop()}}),t,this,[[2,15,18,21]])})));return function(){return t.apply(this,arguments)}}()},{key:"executarBackup",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o,n,i,s,c,u,l,d,p,h,m,b,f,v=this;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.executandoBackup){t.next=2;break}return t.abrupt("return");case 2:return e=new sa(this.Pool,"BACKUP"),t.next=5,e.verificarIntervalo();case 5:if(t.sent){t.next=7;break}return t.abrupt("return");case 7:if(void 0===this.fs&&(this.fs=ca),void 0===this.os&&(this.os=ua),void 0===this.ftp&&(this.ftp=la),void 0===this.childProcess&&(this.childProcess=da),"darwin"!==this.os.platform()){t.next=13;break}return t.abrupt("return");case 13:return a=null,t.prev=14,t.next=17,rt(this.Pool,"BACKUP","HOST");case 17:return t.t0=t.sent,t.next=20,rt(this.Pool,"BACKUP","PORTA");case 20:return t.t1=t.sent,t.next=23,rt(this.Pool,"BACKUP","USUARIO");case 23:return t.t2=t.sent,t.next=26,rt(this.Pool,"BACKUP","SENHA");case 26:t.t3=t.sent,a={host:t.t0,port:t.t1,user:t.t2,password:t.t3},t.next=34;break;case 30:return t.prev=30,t.t4=t.catch(14),console.log("Erro ao efetuar backup: n\xe3o foi poss\xedvel carregar os par\xe2metros do FTP."),t.abrupt("return",!1);case 34:this.executandoBackup=!0,o=null,t.t5=this.os.platform(),t.next="win32"===t.t5?39:47;break;case 39:return o="C:/Program Files/PostgreSQL/14/bin/pg_dump.exe",this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/13/bin/pg_dump.exe"),this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/12/bin/pg_dump.exe"),this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/11/bin/pg_dump.exe"),this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/10/bin/pg_dump.exe"),this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/9.6/bin/pg_dump.exe"),this.fs.existsSync(o)||(o="C:/Program Files/PostgreSQL/9.3/bin/pg_dump.exe"),t.abrupt("break",48);case 47:return t.abrupt("break",48);case 48:n=et(),this.fs.existsSync(n)||this.fs.mkdirSync(n),i=this.fs.readdirSync(n),s=Object(Dt.a)(i);try{for(s.s();!(c=s.n()).done;)".backup"===(u=c.value).substr(-7)&&this.fs.unlinkSync(n+"/"+u)}catch(r){s.e(r)}finally{s.f()}if(l=new Date,d=l.getFullYear()+"-"+String(l.getMonth()+1).lpad(2,"0")+"-"+String(l.getDate()).lpad(2,"0")+"-"+String(l.getHours()).lpad(2,"0")+"-"+String(l.getMinutes()).lpad(2,"0")+"-"+String(l.getSeconds()).lpad(2,"0"),h='"'+o+'" -F c -b -w -U postgres -f "'+(p=n+"/"+d+".backup")+'" satflex',this.childProcess.execSync(h),void 0!==this.serialNumber){t.next=62;break}return t.next=61,X();case 61:this.serialNumber=t.sent;case 62:m=p,b="/"+this.serialNumber+"/"+d+".backup",(f=new this.ftp).on("ready",(function(){f.cwd("/",(function(){f.mkdir(v.serialNumber,!0,(function(t){if(t)throw v.executandoBackup=!1,t;f.put(m,b,!1,(function(t){if(t)throw t;f.end(),e.atualizarProcesso(),v.executandoBackup=!1}))}))}))})).connect(a);case 66:case"end":return t.stop()}}),t,this,[[14,30]])})));return function(){return t.apply(this,arguments)}}()},{key:"executarRefreshView",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new sa(this.Pool,"REFRESH_VIEW"),t.next=3,e.verificarIntervalo();case 3:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:a=0,o=["v_vendaprodutodiario","v_vendapagamentodiario"];case 7:if(!(a<o.length)){t.next=14;break}return n=o[a],t.next=11,this.Pool.query("REFRESH MATERIALIZED VIEW "+n);case 11:a++,t.next=7;break;case 14:return t.next=16,e.atualizarProcesso();case 16:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"executarVerificarDtVerificacao",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new sa(this.Pool,"VERIFICAR_DTVERIFICACAO"),t.next=3,e.verificarIntervalo();case 3:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,rt(this.Pool,"SISTEMA","DTVERIFICACAO");case 7:return a=t.sent,o=new Date,(null===(a=null!==a&&a.length>0?new Date(a):null)||(o.getTime()-a.getTime())/864e5>10)&&("UPDATE parametro SET valor = $3 WHERE grupo = $1 AND nome = $2",this.Pool.query("UPDATE parametro SET valor = $3 WHERE grupo = $1 AND nome = $2",["SISTEMA","STATUS","0002"])),t.next=13,e.atualizarProcesso();case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"executarVerificarTerminal",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a,o;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new sa(this.Pool,"VERIFICAR_TERMINAL"),t.next=3,e.verificarIntervalo();case 3:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:return this.servidor||(this.servidor=new st(this.Pool)),t.next=8,this.servidor.verificarTerminal();case 8:return!1===(a=t.sent)?console.log("Houve uma falha ao verificar o terminal no servidor."):(this.Pool.query("UPDATE parametro SET valor = $3 WHERE grupo = $1 AND nome = $2",["SISTEMA","STATUS",a]),o=(new Date).toISOString().substr(0,10),this.Pool.query("UPDATE parametro SET valor = $3 WHERE grupo = $1 AND nome = $2",["SISTEMA","DTVERIFICACAO",o])),t.next=12,e.atualizarProcesso();case 12:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}(),ha=(a(404),a(405),function(t){Object(c.a)(a,t);var e=Object(u.a)(a);function a(t){var o;return Object(i.a)(this,a),o=e.call(this,t),window.FastMessage=new N,window.InformarValor=new L,window.Loading=new U,window.MessageBox=new B,o.state={FastMessage:window.FastMessage,InformarValor:window.InformarValor,Loading:window.Loading,MessageBox:window.MessageBox},o.Pool=new ut,o.processoAutomatico=new pa(o.Pool),window.processoAutomatico=o.processoAutomatico,window.servidor=new st(o.Pool),o}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.processoAutomatico.iniciar(),window.addEventListener("keydown",this.onKeyDown),this.verificarTerminal()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.onKeyDown)}},{key:"onKeyDown",value:function(t){t.ctrlKey&&73===t.keyCode&&window.require("electron").ipcRenderer.sendSync("open-dev-tools")}},{key:"verificarTerminal",value:function(){var t=Object(n.a)(r.a.mark((function t(){var e,a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,rt(this.Pool,"SISTEMA","STATUS");case 2:return e=t.sent,t.next=5,rt(this.Pool,"REVENDA","TELEFONE");case 5:a=t.sent,t.t0=e,t.next="0000"===t.t0?9:"0001"===t.t0?10:"0002"===t.t0?12:14;break;case 9:return t.abrupt("break",15);case 10:return window.MessageBox.show({title:"Terminal bloqueado",text:"Seu terminal foi bloqueado, para mais informa\xe7\xf5es, entre em contato com o suporte pelo n\xfamero <b>"+a+"</b>.",buttons:[{text:"Sair do SAT-Flex",color:"primary",onClick:function(){window.close()}}]}),t.abrupt("break",15);case 12:return window.MessageBox.show({title:"Terminal bloqueado",text:"Seu terminal foi bloqueado por falta de comunica\xe7\xe3o com a Internet. Verifique sua conex\xe3o com a Internet e tente novamente.<br> Caso o problema persista, entre em contato com o suporte pelo n\xfamero <b>"+a+"</b>.",buttons:[{text:"Sair do SAT-Flex",color:"primary",onClick:function(){window.close()}}]}),t.abrupt("break",15);case 14:return t.abrupt("break",15);case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return Object(C.jsxs)("div",{children:[Object(C.jsx)(m.a,{children:Object(C.jsx)(b.b,{path:"/",children:Object(C.jsxs)("div",{children:[Object(C.jsx)(y,{}),Object(C.jsxs)("div",{id:"viewContainer",children:[Object(C.jsx)(b.b,{exact:!0,path:"/",component:ia}),Object(C.jsx)(b.b,{exact:!0,path:"/venda",component:ia}),Object(C.jsx)(b.b,{exact:!0,path:"/venda/:id",component:ia}),Object(C.jsx)(b.b,{path:"/categoria",component:Pt}),Object(C.jsx)(b.b,{path:"/configuracao",component:Ft}),Object(C.jsx)(b.b,{path:"/contador",component:$t}),Object(C.jsx)(b.b,{path:"/estatistica",component:Qt}),Object(C.jsx)(b.b,{path:"/fechamento",component:oe}),Object(C.jsx)(b.b,{path:"/ferramentas",component:de}),Object(C.jsx)(b.b,{path:"/parametro",component:me}),Object(C.jsx)(b.b,{path:"/produto",component:fe}),Object(C.jsx)(b.b,{path:"/relatorio",component:ve}),Object(C.jsx)(b.b,{path:"/relorcamento",component:je}),Object(C.jsx)(b.b,{path:"/suporte",component:Ce})]})]})})}),Object(C.jsx)(P,{FastMessageEmitter:this.state.FastMessage}),Object(C.jsx)(F,{InformarValorEmitter:this.state.InformarValor}),Object(C.jsx)(V,{LoadingEmitter:this.state.Loading}),Object(C.jsx)(_,{MessageBoxEmitter:this.state.MessageBox})]})}}]),a}(d.a.Component));h.a.render(Object(C.jsx)(ha,{}),document.getElementById("root"))}},[[406,1,2]]]);
//# sourceMappingURL=main.a31f2f17.chunk.js.map